(function(){const B=document.createElement("link").relList;if(B&&B.supports&&B.supports("modulepreload"))return;for(const ee of document.querySelectorAll('link[rel="modulepreload"]'))X(ee);new MutationObserver(ee=>{for(const te of ee)if(te.type==="childList")for(const ne of te.addedNodes)ne.tagName==="LINK"&&ne.rel==="modulepreload"&&X(ne)}).observe(document,{childList:!0,subtree:!0});function j(ee){const te={};return ee.integrity&&(te.integrity=ee.integrity),ee.referrerpolicy&&(te.referrerPolicy=ee.referrerpolicy),ee.crossorigin==="use-credentials"?te.credentials="include":ee.crossorigin==="anonymous"?te.credentials="omit":te.credentials="same-origin",te}function X(ee){if(ee.ep)return;ee.ep=!0;const te=j(ee);fetch(ee.href,te)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$3=window,e$5=t$3.ShadowRoot&&(t$3.ShadyCSS===void 0||t$3.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$4=Symbol(),n$4=new WeakMap;class o$5{constructor(B,j,X){if(this._$cssResult$=!0,X!==s$4)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=B,this.t=j}get styleSheet(){let B=this.o;const j=this.t;if(e$5&&B===void 0){const X=j!==void 0&&j.length===1;X&&(B=n$4.get(j)),B===void 0&&((this.o=B=new CSSStyleSheet).replaceSync(this.cssText),X&&n$4.set(j,B))}return B}toString(){return this.cssText}}const r$3=q=>new o$5(typeof q=="string"?q:q+"",void 0,s$4),i$5=(q,...B)=>{const j=q.length===1?q[0]:B.reduce((X,ee,te)=>X+(ne=>{if(ne._$cssResult$===!0)return ne.cssText;if(typeof ne=="number")return ne;throw Error("Value passed to 'css' function must be a 'css' function result: "+ne+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(ee)+q[te+1],q[0]);return new o$5(j,q,s$4)},S$1=(q,B)=>{e$5?q.adoptedStyleSheets=B.map(j=>j instanceof CSSStyleSheet?j:j.styleSheet):B.forEach(j=>{const X=document.createElement("style"),ee=t$3.litNonce;ee!==void 0&&X.setAttribute("nonce",ee),X.textContent=j.cssText,q.appendChild(X)})},c$3=e$5?q=>q:q=>q instanceof CSSStyleSheet?(B=>{let j="";for(const X of B.cssRules)j+=X.cssText;return r$3(j)})(q):q;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var s$3;const e$4=window,r$2=e$4.trustedTypes,h$1=r$2?r$2.emptyScript:"",o$4=e$4.reactiveElementPolyfillSupport,n$3={toAttribute(q,B){switch(B){case Boolean:q=q?h$1:null;break;case Object:case Array:q=q==null?q:JSON.stringify(q)}return q},fromAttribute(q,B){let j=q;switch(B){case Boolean:j=q!==null;break;case Number:j=q===null?null:Number(q);break;case Object:case Array:try{j=JSON.parse(q)}catch{j=null}}return j}},a$2=(q,B)=>B!==q&&(B==B||q==q),l$3={attribute:!0,type:String,converter:n$3,reflect:!1,hasChanged:a$2};class d$1 extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(B){var j;(j=this.h)!==null&&j!==void 0||(this.h=[]),this.h.push(B)}static get observedAttributes(){this.finalize();const B=[];return this.elementProperties.forEach((j,X)=>{const ee=this._$Ep(X,j);ee!==void 0&&(this._$Ev.set(ee,X),B.push(ee))}),B}static createProperty(B,j=l$3){if(j.state&&(j.attribute=!1),this.finalize(),this.elementProperties.set(B,j),!j.noAccessor&&!this.prototype.hasOwnProperty(B)){const X=typeof B=="symbol"?Symbol():"__"+B,ee=this.getPropertyDescriptor(B,X,j);ee!==void 0&&Object.defineProperty(this.prototype,B,ee)}}static getPropertyDescriptor(B,j,X){return{get(){return this[j]},set(ee){const te=this[B];this[j]=ee,this.requestUpdate(B,te,X)},configurable:!0,enumerable:!0}}static getPropertyOptions(B){return this.elementProperties.get(B)||l$3}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const B=Object.getPrototypeOf(this);if(B.finalize(),this.elementProperties=new Map(B.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const j=this.properties,X=[...Object.getOwnPropertyNames(j),...Object.getOwnPropertySymbols(j)];for(const ee of X)this.createProperty(ee,j[ee])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(B){const j=[];if(Array.isArray(B)){const X=new Set(B.flat(1/0).reverse());for(const ee of X)j.unshift(c$3(ee))}else B!==void 0&&j.push(c$3(B));return j}static _$Ep(B,j){const X=j.attribute;return X===!1?void 0:typeof X=="string"?X:typeof B=="string"?B.toLowerCase():void 0}u(){var B;this._$E_=new Promise(j=>this.enableUpdating=j),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(B=this.constructor.h)===null||B===void 0||B.forEach(j=>j(this))}addController(B){var j,X;((j=this._$ES)!==null&&j!==void 0?j:this._$ES=[]).push(B),this.renderRoot!==void 0&&this.isConnected&&((X=B.hostConnected)===null||X===void 0||X.call(B))}removeController(B){var j;(j=this._$ES)===null||j===void 0||j.splice(this._$ES.indexOf(B)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((B,j)=>{this.hasOwnProperty(j)&&(this._$Ei.set(j,this[j]),delete this[j])})}createRenderRoot(){var B;const j=(B=this.shadowRoot)!==null&&B!==void 0?B:this.attachShadow(this.constructor.shadowRootOptions);return S$1(j,this.constructor.elementStyles),j}connectedCallback(){var B;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(B=this._$ES)===null||B===void 0||B.forEach(j=>{var X;return(X=j.hostConnected)===null||X===void 0?void 0:X.call(j)})}enableUpdating(B){}disconnectedCallback(){var B;(B=this._$ES)===null||B===void 0||B.forEach(j=>{var X;return(X=j.hostDisconnected)===null||X===void 0?void 0:X.call(j)})}attributeChangedCallback(B,j,X){this._$AK(B,X)}_$EO(B,j,X=l$3){var ee;const te=this.constructor._$Ep(B,X);if(te!==void 0&&X.reflect===!0){const ne=(((ee=X.converter)===null||ee===void 0?void 0:ee.toAttribute)!==void 0?X.converter:n$3).toAttribute(j,X.type);this._$El=B,ne==null?this.removeAttribute(te):this.setAttribute(te,ne),this._$El=null}}_$AK(B,j){var X;const ee=this.constructor,te=ee._$Ev.get(B);if(te!==void 0&&this._$El!==te){const ne=ee.getPropertyOptions(te),re=typeof ne.converter=="function"?{fromAttribute:ne.converter}:((X=ne.converter)===null||X===void 0?void 0:X.fromAttribute)!==void 0?ne.converter:n$3;this._$El=te,this[te]=re.fromAttribute(j,ne.type),this._$El=null}}requestUpdate(B,j,X){let ee=!0;B!==void 0&&(((X=X||this.constructor.getPropertyOptions(B)).hasChanged||a$2)(this[B],j)?(this._$AL.has(B)||this._$AL.set(B,j),X.reflect===!0&&this._$El!==B&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(B,X))):ee=!1),!this.isUpdatePending&&ee&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(j){Promise.reject(j)}const B=this.scheduleUpdate();return B!=null&&await B,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var B;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((ee,te)=>this[te]=ee),this._$Ei=void 0);let j=!1;const X=this._$AL;try{j=this.shouldUpdate(X),j?(this.willUpdate(X),(B=this._$ES)===null||B===void 0||B.forEach(ee=>{var te;return(te=ee.hostUpdate)===null||te===void 0?void 0:te.call(ee)}),this.update(X)):this._$Ek()}catch(ee){throw j=!1,this._$Ek(),ee}j&&this._$AE(X)}willUpdate(B){}_$AE(B){var j;(j=this._$ES)===null||j===void 0||j.forEach(X=>{var ee;return(ee=X.hostUpdated)===null||ee===void 0?void 0:ee.call(X)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(B)),this.updated(B)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(B){return!0}update(B){this._$EC!==void 0&&(this._$EC.forEach((j,X)=>this._$EO(X,this[X],j)),this._$EC=void 0),this._$Ek()}updated(B){}firstUpdated(B){}}d$1.finalized=!0,d$1.elementProperties=new Map,d$1.elementStyles=[],d$1.shadowRootOptions={mode:"open"},o$4==null||o$4({ReactiveElement:d$1}),((s$3=e$4.reactiveElementVersions)!==null&&s$3!==void 0?s$3:e$4.reactiveElementVersions=[]).push("1.4.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var t$2;const i$4=window,s$2=i$4.trustedTypes,e$3=s$2?s$2.createPolicy("lit-html",{createHTML:q=>q}):void 0,o$3=`lit$${(Math.random()+"").slice(9)}$`,n$2="?"+o$3,l$2=`<${n$2}>`,h=document,r$1=(q="")=>h.createComment(q),d=q=>q===null||typeof q!="object"&&typeof q!="function",u$2=Array.isArray,c$2=q=>u$2(q)||typeof(q==null?void 0:q[Symbol.iterator])=="function",v=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,a$1=/-->/g,f$1=/>/g,_=RegExp(`>|[ 	
\f\r](?:([^\\s"'>=/]+)([ 	
\f\r]*=[ 	
\f\r]*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),m$1=/'/g,p$1=/"/g,$=/^(?:script|style|textarea|title)$/i,g=q=>(B,...j)=>({_$litType$:q,strings:B,values:j}),y=g(1),w=g(2),x=Symbol.for("lit-noChange"),b=Symbol.for("lit-nothing"),T=new WeakMap,A=(q,B,j)=>{var X,ee;const te=(X=j==null?void 0:j.renderBefore)!==null&&X!==void 0?X:B;let ne=te._$litPart$;if(ne===void 0){const re=(ee=j==null?void 0:j.renderBefore)!==null&&ee!==void 0?ee:null;te._$litPart$=ne=new S(B.insertBefore(r$1(),re),re,void 0,j!=null?j:{})}return ne._$AI(q),ne},E=h.createTreeWalker(h,129,null,!1),C=(q,B)=>{const j=q.length-1,X=[];let ee,te=B===2?"<svg>":"",ne=v;for(let ie=0;ie<j;ie++){const fe=q[ie];let ce,se,oe=-1,ae=0;for(;ae<fe.length&&(ne.lastIndex=ae,se=ne.exec(fe),se!==null);)ae=ne.lastIndex,ne===v?se[1]==="!--"?ne=a$1:se[1]!==void 0?ne=f$1:se[2]!==void 0?($.test(se[2])&&(ee=RegExp("</"+se[2],"g")),ne=_):se[3]!==void 0&&(ne=_):ne===_?se[0]===">"?(ne=ee!=null?ee:v,oe=-1):se[1]===void 0?oe=-2:(oe=ne.lastIndex-se[2].length,ce=se[1],ne=se[3]===void 0?_:se[3]==='"'?p$1:m$1):ne===p$1||ne===m$1?ne=_:ne===a$1||ne===f$1?ne=v:(ne=_,ee=void 0);const le=ne===_&&q[ie+1].startsWith("/>")?" ":"";te+=ne===v?fe+l$2:oe>=0?(X.push(ce),fe.slice(0,oe)+"$lit$"+fe.slice(oe)+o$3+le):fe+o$3+(oe===-2?(X.push(void 0),ie):le)}const re=te+(q[j]||"<?>")+(B===2?"</svg>":"");if(!Array.isArray(q)||!q.hasOwnProperty("raw"))throw Error("invalid template strings array");return[e$3!==void 0?e$3.createHTML(re):re,X]};class P{constructor({strings:B,_$litType$:j},X){let ee;this.parts=[];let te=0,ne=0;const re=B.length-1,ie=this.parts,[fe,ce]=C(B,j);if(this.el=P.createElement(fe,X),E.currentNode=this.el.content,j===2){const se=this.el.content,oe=se.firstChild;oe.remove(),se.append(...oe.childNodes)}for(;(ee=E.nextNode())!==null&&ie.length<re;){if(ee.nodeType===1){if(ee.hasAttributes()){const se=[];for(const oe of ee.getAttributeNames())if(oe.endsWith("$lit$")||oe.startsWith(o$3)){const ae=ce[ne++];if(se.push(oe),ae!==void 0){const le=ee.getAttribute(ae.toLowerCase()+"$lit$").split(o$3),pe=/([.?@])?(.*)/.exec(ae);ie.push({type:1,index:te,name:pe[2],strings:le,ctor:pe[1]==="."?R:pe[1]==="?"?H:pe[1]==="@"?I:M})}else ie.push({type:6,index:te})}for(const oe of se)ee.removeAttribute(oe)}if($.test(ee.tagName)){const se=ee.textContent.split(o$3),oe=se.length-1;if(oe>0){ee.textContent=s$2?s$2.emptyScript:"";for(let ae=0;ae<oe;ae++)ee.append(se[ae],r$1()),E.nextNode(),ie.push({type:2,index:++te});ee.append(se[oe],r$1())}}}else if(ee.nodeType===8)if(ee.data===n$2)ie.push({type:2,index:te});else{let se=-1;for(;(se=ee.data.indexOf(o$3,se+1))!==-1;)ie.push({type:7,index:te}),se+=o$3.length-1}te++}}static createElement(B,j){const X=h.createElement("template");return X.innerHTML=B,X}}function V(q,B,j=q,X){var ee,te,ne,re;if(B===x)return B;let ie=X!==void 0?(ee=j._$Cl)===null||ee===void 0?void 0:ee[X]:j._$Cu;const fe=d(B)?void 0:B._$litDirective$;return(ie==null?void 0:ie.constructor)!==fe&&((te=ie==null?void 0:ie._$AO)===null||te===void 0||te.call(ie,!1),fe===void 0?ie=void 0:(ie=new fe(q),ie._$AT(q,j,X)),X!==void 0?((ne=(re=j)._$Cl)!==null&&ne!==void 0?ne:re._$Cl=[])[X]=ie:j._$Cu=ie),ie!==void 0&&(B=V(q,ie._$AS(q,B.values),ie,X)),B}class N{constructor(B,j){this.v=[],this._$AN=void 0,this._$AD=B,this._$AM=j}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(B){var j;const{el:{content:X},parts:ee}=this._$AD,te=((j=B==null?void 0:B.creationScope)!==null&&j!==void 0?j:h).importNode(X,!0);E.currentNode=te;let ne=E.nextNode(),re=0,ie=0,fe=ee[0];for(;fe!==void 0;){if(re===fe.index){let ce;fe.type===2?ce=new S(ne,ne.nextSibling,this,B):fe.type===1?ce=new fe.ctor(ne,fe.name,fe.strings,this,B):fe.type===6&&(ce=new L(ne,this,B)),this.v.push(ce),fe=ee[++ie]}re!==(fe==null?void 0:fe.index)&&(ne=E.nextNode(),re++)}return te}m(B){let j=0;for(const X of this.v)X!==void 0&&(X.strings!==void 0?(X._$AI(B,X,j),j+=X.strings.length-2):X._$AI(B[j])),j++}}class S{constructor(B,j,X,ee){var te;this.type=2,this._$AH=b,this._$AN=void 0,this._$AA=B,this._$AB=j,this._$AM=X,this.options=ee,this._$C_=(te=ee==null?void 0:ee.isConnected)===null||te===void 0||te}get _$AU(){var B,j;return(j=(B=this._$AM)===null||B===void 0?void 0:B._$AU)!==null&&j!==void 0?j:this._$C_}get parentNode(){let B=this._$AA.parentNode;const j=this._$AM;return j!==void 0&&B.nodeType===11&&(B=j.parentNode),B}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(B,j=this){B=V(this,B,j),d(B)?B===b||B==null||B===""?(this._$AH!==b&&this._$AR(),this._$AH=b):B!==this._$AH&&B!==x&&this.$(B):B._$litType$!==void 0?this.T(B):B.nodeType!==void 0?this.k(B):c$2(B)?this.O(B):this.$(B)}S(B,j=this._$AB){return this._$AA.parentNode.insertBefore(B,j)}k(B){this._$AH!==B&&(this._$AR(),this._$AH=this.S(B))}$(B){this._$AH!==b&&d(this._$AH)?this._$AA.nextSibling.data=B:this.k(h.createTextNode(B)),this._$AH=B}T(B){var j;const{values:X,_$litType$:ee}=B,te=typeof ee=="number"?this._$AC(B):(ee.el===void 0&&(ee.el=P.createElement(ee.h,this.options)),ee);if(((j=this._$AH)===null||j===void 0?void 0:j._$AD)===te)this._$AH.m(X);else{const ne=new N(te,this),re=ne.p(this.options);ne.m(X),this.k(re),this._$AH=ne}}_$AC(B){let j=T.get(B.strings);return j===void 0&&T.set(B.strings,j=new P(B)),j}O(B){u$2(this._$AH)||(this._$AH=[],this._$AR());const j=this._$AH;let X,ee=0;for(const te of B)ee===j.length?j.push(X=new S(this.S(r$1()),this.S(r$1()),this,this.options)):X=j[ee],X._$AI(te),ee++;ee<j.length&&(this._$AR(X&&X._$AB.nextSibling,ee),j.length=ee)}_$AR(B=this._$AA.nextSibling,j){var X;for((X=this._$AP)===null||X===void 0||X.call(this,!1,!0,j);B&&B!==this._$AB;){const ee=B.nextSibling;B.remove(),B=ee}}setConnected(B){var j;this._$AM===void 0&&(this._$C_=B,(j=this._$AP)===null||j===void 0||j.call(this,B))}}class M{constructor(B,j,X,ee,te){this.type=1,this._$AH=b,this._$AN=void 0,this.element=B,this.name=j,this._$AM=ee,this.options=te,X.length>2||X[0]!==""||X[1]!==""?(this._$AH=Array(X.length-1).fill(new String),this.strings=X):this._$AH=b}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(B,j=this,X,ee){const te=this.strings;let ne=!1;if(te===void 0)B=V(this,B,j,0),ne=!d(B)||B!==this._$AH&&B!==x,ne&&(this._$AH=B);else{const re=B;let ie,fe;for(B=te[0],ie=0;ie<te.length-1;ie++)fe=V(this,re[X+ie],j,ie),fe===x&&(fe=this._$AH[ie]),ne||(ne=!d(fe)||fe!==this._$AH[ie]),fe===b?B=b:B!==b&&(B+=(fe!=null?fe:"")+te[ie+1]),this._$AH[ie]=fe}ne&&!ee&&this.P(B)}P(B){B===b?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,B!=null?B:"")}}class R extends M{constructor(){super(...arguments),this.type=3}P(B){this.element[this.name]=B===b?void 0:B}}const k$1=s$2?s$2.emptyScript:"";class H extends M{constructor(){super(...arguments),this.type=4}P(B){B&&B!==b?this.element.setAttribute(this.name,k$1):this.element.removeAttribute(this.name)}}class I extends M{constructor(B,j,X,ee,te){super(B,j,X,ee,te),this.type=5}_$AI(B,j=this){var X;if((B=(X=V(this,B,j,0))!==null&&X!==void 0?X:b)===x)return;const ee=this._$AH,te=B===b&&ee!==b||B.capture!==ee.capture||B.once!==ee.once||B.passive!==ee.passive,ne=B!==b&&(ee===b||te);te&&this.element.removeEventListener(this.name,this,ee),ne&&this.element.addEventListener(this.name,this,B),this._$AH=B}handleEvent(B){var j,X;typeof this._$AH=="function"?this._$AH.call((X=(j=this.options)===null||j===void 0?void 0:j.host)!==null&&X!==void 0?X:this.element,B):this._$AH.handleEvent(B)}}class L{constructor(B,j,X){this.element=B,this.type=6,this._$AN=void 0,this._$AM=j,this.options=X}get _$AU(){return this._$AM._$AU}_$AI(B){V(this,B)}}const z={A:"$lit$",M:o$3,C:n$2,L:1,R:C,D:N,V:c$2,I:V,H:S,N:M,U:H,B:I,F:R,W:L},Z=i$4.litHtmlPolyfillSupport;Z==null||Z(P,S),((t$2=i$4.litHtmlVersions)!==null&&t$2!==void 0?t$2:i$4.litHtmlVersions=[]).push("2.3.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var l$1,o$2;class s$1 extends d$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var B,j;const X=super.createRenderRoot();return(B=(j=this.renderOptions).renderBefore)!==null&&B!==void 0||(j.renderBefore=X.firstChild),X}update(B){const j=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(B),this._$Do=A(j,this.renderRoot,this.renderOptions)}connectedCallback(){var B;super.connectedCallback(),(B=this._$Do)===null||B===void 0||B.setConnected(!0)}disconnectedCallback(){var B;super.disconnectedCallback(),(B=this._$Do)===null||B===void 0||B.setConnected(!1)}render(){return x}}s$1.finalized=!0,s$1._$litElement$=!0,(l$1=globalThis.litElementHydrateSupport)===null||l$1===void 0||l$1.call(globalThis,{LitElement:s$1});const n$1=globalThis.litElementPolyfillSupport;n$1==null||n$1({LitElement:s$1});((o$2=globalThis.litElementVersions)!==null&&o$2!==void 0?o$2:globalThis.litElementVersions=[]).push("3.2.2");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const e$2=q=>B=>typeof B=="function"?((j,X)=>(customElements.define(j,X),X))(q,B):((j,X)=>{const{kind:ee,elements:te}=X;return{kind:ee,elements:te,finisher(ne){customElements.define(j,ne)}}})(q,B);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const i$3=(q,B)=>B.kind==="method"&&B.descriptor&&!("value"in B.descriptor)?{...B,finisher(j){j.createProperty(B.key,q)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:B.key,initializer(){typeof B.initializer=="function"&&(this[B.key]=B.initializer.call(this))},finisher(j){j.createProperty(B.key,q)}};function e$1(q){return(B,j)=>j!==void 0?((X,ee,te)=>{ee.constructor.createProperty(te,X)})(q,B,j):i$3(q,B)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function t$1(q){return e$1({...q,state:!0})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o$1=({finisher:q,descriptor:B})=>(j,X)=>{var ee;if(X===void 0){const te=(ee=j.originalKey)!==null&&ee!==void 0?ee:j.key,ne=B!=null?{kind:"method",placement:"prototype",key:te,descriptor:B(j.key)}:{...j,key:te};return q!=null&&(ne.finisher=function(re){q(re,te)}),ne}{const te=j.constructor;B!==void 0&&Object.defineProperty(j,X,B(X)),q==null||q(te,X)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function i$2(q,B){return o$1({descriptor:j=>{const X={get(){var ee,te;return(te=(ee=this.renderRoot)===null||ee===void 0?void 0:ee.querySelector(q))!==null&&te!==void 0?te:null},enumerable:!0,configurable:!0};if(B){const ee=typeof j=="symbol"?Symbol():"__"+j;X.get=function(){var te,ne;return this[ee]===void 0&&(this[ee]=(ne=(te=this.renderRoot)===null||te===void 0?void 0:te.querySelector(q))!==null&&ne!==void 0?ne:null),this[ee]}}return X}})}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var n;((n=window.HTMLSlotElement)===null||n===void 0?void 0:n.prototype.assignedElements)!=null;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=q=>(...B)=>({_$litDirective$:q,values:B});class i$1{constructor(B){}get _$AU(){return this._$AM._$AU}_$AT(B,j,X){this._$Ct=B,this._$AM=j,this._$Ci=X}_$AS(B,j){return this.update(B,j)}update(B,j){return this.render(...j)}}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const i=e(class extends i$1{constructor(q){var B;if(super(q),q.type!==t.ATTRIBUTE||q.name!=="style"||((B=q.strings)===null||B===void 0?void 0:B.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(q){return Object.keys(q).reduce((B,j)=>{const X=q[j];return X==null?B:B+`${j=j.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${X};`},"")}update(q,[B]){const{style:j}=q.element;if(this.vt===void 0){this.vt=new Set;for(const X in B)this.vt.add(X);return this.render(B)}this.vt.forEach(X=>{B[X]==null&&(this.vt.delete(X),X.includes("-")?j.removeProperty(X):j[X]="")});for(const X in B){const ee=B[X];ee!=null&&(this.vt.add(X),X.includes("-")?j.setProperty(X,ee):j[X]=ee)}return x}}),fromCharCode=String.fromCharCode,toLowerCase=q=>q.toLowerCase(),trimLeftRegex=/^\s*/g,trimLeft=q=>q.replace(trimLeftRegex,""),fromCamelCaseRegex=/([A-Z])/g,fromCamelCase=(q,B)=>trimLeft(q.replace(fromCamelCaseRegex,j=>`${B}${toLowerCase(j)}`)),_encodeUtf8Polyfill=q=>{const B=unescape(encodeURIComponent(q)),j=B.length,X=new Uint8Array(j);for(let ee=0;ee<j;ee++)X[ee]=B.codePointAt(ee);return X},utf8TextEncoder=typeof TextEncoder<"u"?new TextEncoder:null,_encodeUtf8Native=q=>utf8TextEncoder.encode(q),encodeUtf8=utf8TextEncoder?_encodeUtf8Native:_encodeUtf8Polyfill;let utf8TextDecoder=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});utf8TextDecoder&&utf8TextDecoder.decode(new Uint8Array).length===1&&(utf8TextDecoder=null);const create$5=()=>new Map,copy=q=>{const B=create$5();return q.forEach((j,X)=>{B.set(X,j)}),B},setIfUndefined=(q,B,j)=>{let X=q.get(B);return X===void 0&&q.set(B,X=j()),X},map$1=(q,B)=>{const j=[];for(const[X,ee]of q)j.push(B(ee,X));return j},any=(q,B)=>{for(const[j,X]of q)if(B(X,j))return!0;return!1},undefinedToNull=q=>q===void 0?null:q;class VarStoragePolyfill{constructor(){this.map=new Map}setItem(B,j){this.map.set(B,j)}getItem(B){return this.map.get(B)}}let _localStorage=new VarStoragePolyfill,usePolyfill=!0;try{typeof localStorage<"u"&&(_localStorage=localStorage,usePolyfill=!1)}catch{}const varStorage=_localStorage,onChange=q=>usePolyfill||addEventListener("storage",q),isNode=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),isBrowser=typeof window<"u"&&!isNode;typeof navigator<"u"&&/Mac/.test(navigator.platform);let params$1;const computeParams=()=>{if(params$1===void 0)if(isNode){params$1=create$5();const q=process.argv;let B=null;for(let j=0;j<q.length;j++){const X=q[j];X[0]==="-"?(B!==null&&params$1.set(B,""),B=X):B!==null&&(params$1.set(B,X),B=null)}B!==null&&params$1.set(B,"")}else typeof location=="object"?(params$1=create$5(),(location.search||"?").slice(1).split("&").forEach(q=>{if(q.length!==0){const[B,j]=q.split("=");params$1.set(`--${fromCamelCase(B,"-")}`,j),params$1.set(`-${fromCamelCase(B,"-")}`,j)}})):params$1=create$5();return params$1},hasParam=q=>computeParams().has(q),getVariable=q=>undefinedToNull(isNode?process.env[q.toUpperCase()]:varStorage.getItem(q)),hasConf=q=>hasParam("--"+q)||getVariable(q)!==null;hasConf("production");const BIT1=1,BIT2=2,BIT3=4,BIT4=8,BIT6=32,BIT7=64,BIT8=128,BITS5=31,BITS6=63,BITS7=127,BITS31=2147483647,floor=Math.floor,abs=Math.abs,log10=Math.log10,min=(q,B)=>q<B?q:B,max=(q,B)=>q>B?q:B,pow=Math.pow,isNegativeZero=q=>q!==0?q<0:1/q<0,MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER,isInteger=Number.isInteger||(q=>typeof q=="number"&&isFinite(q)&&floor(q)===q);class Decoder{constructor(B){this.arr=B,this.pos=0}}const createDecoder=q=>new Decoder(q),hasContent=q=>q.pos!==q.arr.length,readUint8Array=(q,B)=>{const j=createUint8ArrayViewFromArrayBuffer(q.arr.buffer,q.pos+q.arr.byteOffset,B);return q.pos+=B,j},readVarUint8Array=q=>readUint8Array(q,readVarUint(q)),readUint8=q=>q.arr[q.pos++],readVarUint=q=>{let B=0,j=1;for(;;){const X=q.arr[q.pos++];if(B=B+(X&BITS7)*j,j*=128,X<BIT8)return B;if(B>MAX_SAFE_INTEGER)throw new Error("Integer out of range!")}},readVarInt=q=>{let B=q.arr[q.pos++],j=B&BITS6,X=64;const ee=(B&BIT7)>0?-1:1;if((B&BIT8)===0)return ee*j;for(;;){if(B=q.arr[q.pos++],j=j+(B&BITS7)*X,X*=128,B<BIT8)return ee*j;if(j>MAX_SAFE_INTEGER)throw new Error("Integer out of range!")}},_readVarStringPolyfill=q=>{let B=readVarUint(q);if(B===0)return"";{let j=String.fromCodePoint(readUint8(q));if(--B<100)for(;B--;)j+=String.fromCodePoint(readUint8(q));else for(;B>0;){const X=B<1e4?B:1e4,ee=q.arr.subarray(q.pos,q.pos+X);q.pos+=X,j+=String.fromCodePoint.apply(null,ee),B-=X}return decodeURIComponent(escape(j))}},_readVarStringNative=q=>utf8TextDecoder.decode(readVarUint8Array(q)),readVarString=utf8TextDecoder?_readVarStringNative:_readVarStringPolyfill,readFromDataView=(q,B)=>{const j=new DataView(q.arr.buffer,q.arr.byteOffset+q.pos,B);return q.pos+=B,j},readFloat32=q=>readFromDataView(q,4).getFloat32(0,!1),readFloat64=q=>readFromDataView(q,8).getFloat64(0,!1),readBigInt64=q=>readFromDataView(q,8).getBigInt64(0,!1),readAnyLookupTable=[q=>{},q=>null,readVarInt,readFloat32,readFloat64,readBigInt64,q=>!1,q=>!0,readVarString,q=>{const B=readVarUint(q),j={};for(let X=0;X<B;X++){const ee=readVarString(q);j[ee]=readAny(q)}return j},q=>{const B=readVarUint(q),j=[];for(let X=0;X<B;X++)j.push(readAny(q));return j},readVarUint8Array],readAny=q=>readAnyLookupTable[127-readUint8(q)](q);class RleDecoder extends Decoder{constructor(B,j){super(B),this.reader=j,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),hasContent(this)?this.count=readVarUint(this)+1:this.count=-1),this.count--,this.s}}class UintOptRleDecoder extends Decoder{constructor(B){super(B),this.s=0,this.count=0}read(){if(this.count===0){this.s=readVarInt(this);const B=isNegativeZero(this.s);this.count=1,B&&(this.s=-this.s,this.count=readVarUint(this)+2)}return this.count--,this.s}}class IntDiffOptRleDecoder extends Decoder{constructor(B){super(B),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const B=readVarInt(this),j=B&1;this.diff=floor(B/2),this.count=1,j&&(this.count=readVarUint(this)+2)}return this.s+=this.diff,this.count--,this.s}}class StringDecoder{constructor(B){this.decoder=new UintOptRleDecoder(B),this.str=readVarString(this.decoder),this.spos=0}read(){const B=this.spos+this.decoder.read(),j=this.str.slice(this.spos,B);return this.spos=B,j}}const createUint8ArrayFromLen=q=>new Uint8Array(q),createUint8ArrayViewFromArrayBuffer=(q,B,j)=>new Uint8Array(q,B,j),createUint8ArrayFromArrayBuffer=q=>new Uint8Array(q),toBase64Browser=q=>{let B="";for(let j=0;j<q.byteLength;j++)B+=fromCharCode(q[j]);return btoa(B)},toBase64Node=q=>Buffer.from(q.buffer,q.byteOffset,q.byteLength).toString("base64"),fromBase64Browser=q=>{const B=atob(q),j=createUint8ArrayFromLen(B.length);for(let X=0;X<B.length;X++)j[X]=B.charCodeAt(X);return j},fromBase64Node=q=>{const B=Buffer.from(q,"base64");return new Uint8Array(B.buffer,B.byteOffset,B.byteLength)},toBase64=isBrowser?toBase64Browser:toBase64Node,fromBase64=isBrowser?fromBase64Browser:fromBase64Node,copyUint8Array=q=>{const B=createUint8ArrayFromLen(q.byteLength);return B.set(q),B};class Encoder{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const createEncoder=()=>new Encoder,length$1=q=>{let B=q.cpos;for(let j=0;j<q.bufs.length;j++)B+=q.bufs[j].length;return B},toUint8Array=q=>{const B=new Uint8Array(length$1(q));let j=0;for(let X=0;X<q.bufs.length;X++){const ee=q.bufs[X];B.set(ee,j),j+=ee.length}return B.set(createUint8ArrayViewFromArrayBuffer(q.cbuf.buffer,0,q.cpos),j),B},verifyLen=(q,B)=>{const j=q.cbuf.length;j-q.cpos<B&&(q.bufs.push(createUint8ArrayViewFromArrayBuffer(q.cbuf.buffer,0,q.cpos)),q.cbuf=new Uint8Array(max(j,B)*2),q.cpos=0)},write=(q,B)=>{const j=q.cbuf.length;q.cpos===j&&(q.bufs.push(q.cbuf),q.cbuf=new Uint8Array(j*2),q.cpos=0),q.cbuf[q.cpos++]=B},writeUint8=write,writeVarUint=(q,B)=>{for(;B>BITS7;)write(q,BIT8|BITS7&B),B=floor(B/128);write(q,BITS7&B)},writeVarInt=(q,B)=>{const j=isNegativeZero(B);for(j&&(B=-B),write(q,(B>BITS6?BIT8:0)|(j?BIT7:0)|BITS6&B),B=floor(B/64);B>0;)write(q,(B>BITS7?BIT8:0)|BITS7&B),B=floor(B/128)},_strBuffer=new Uint8Array(3e4),_maxStrBSize=_strBuffer.length/3,_writeVarStringNative=(q,B)=>{if(B.length<_maxStrBSize){const j=utf8TextEncoder.encodeInto(B,_strBuffer).written||0;writeVarUint(q,j);for(let X=0;X<j;X++)write(q,_strBuffer[X])}else writeVarUint8Array(q,encodeUtf8(B))},_writeVarStringPolyfill=(q,B)=>{const j=unescape(encodeURIComponent(B)),X=j.length;writeVarUint(q,X);for(let ee=0;ee<X;ee++)write(q,j.codePointAt(ee))},writeVarString=utf8TextEncoder?_writeVarStringNative:_writeVarStringPolyfill,writeUint8Array=(q,B)=>{const j=q.cbuf.length,X=q.cpos,ee=min(j-X,B.length),te=B.length-ee;q.cbuf.set(B.subarray(0,ee),X),q.cpos+=ee,te>0&&(q.bufs.push(q.cbuf),q.cbuf=new Uint8Array(max(j*2,te)),q.cbuf.set(B.subarray(ee)),q.cpos=te)},writeVarUint8Array=(q,B)=>{writeVarUint(q,B.byteLength),writeUint8Array(q,B)},writeOnDataView=(q,B)=>{verifyLen(q,B);const j=new DataView(q.cbuf.buffer,q.cpos,B);return q.cpos+=B,j},writeFloat32=(q,B)=>writeOnDataView(q,4).setFloat32(0,B,!1),writeFloat64=(q,B)=>writeOnDataView(q,8).setFloat64(0,B,!1),writeBigInt64=(q,B)=>writeOnDataView(q,8).setBigInt64(0,B,!1),floatTestBed=new DataView(new ArrayBuffer(4)),isFloat32=q=>(floatTestBed.setFloat32(0,q),floatTestBed.getFloat32(0)===q),writeAny=(q,B)=>{switch(typeof B){case"string":write(q,119),writeVarString(q,B);break;case"number":isInteger(B)&&abs(B)<=BITS31?(write(q,125),writeVarInt(q,B)):isFloat32(B)?(write(q,124),writeFloat32(q,B)):(write(q,123),writeFloat64(q,B));break;case"bigint":write(q,122),writeBigInt64(q,B);break;case"object":if(B===null)write(q,126);else if(B instanceof Array){write(q,117),writeVarUint(q,B.length);for(let j=0;j<B.length;j++)writeAny(q,B[j])}else if(B instanceof Uint8Array)write(q,116),writeVarUint8Array(q,B);else{write(q,118);const j=Object.keys(B);writeVarUint(q,j.length);for(let X=0;X<j.length;X++){const ee=j[X];writeVarString(q,ee),writeAny(q,B[ee])}}break;case"boolean":write(q,B?120:121);break;default:write(q,127)}};class RleEncoder extends Encoder{constructor(B){super(),this.w=B,this.s=null,this.count=0}write(B){this.s===B?this.count++:(this.count>0&&writeVarUint(this,this.count-1),this.count=1,this.w(this,B),this.s=B)}}const flushUintOptRleEncoder=q=>{q.count>0&&(writeVarInt(q.encoder,q.count===1?q.s:-q.s),q.count>1&&writeVarUint(q.encoder,q.count-2))};class UintOptRleEncoder{constructor(){this.encoder=new Encoder,this.s=0,this.count=0}write(B){this.s===B?this.count++:(flushUintOptRleEncoder(this),this.count=1,this.s=B)}toUint8Array(){return flushUintOptRleEncoder(this),toUint8Array(this.encoder)}}const flushIntDiffOptRleEncoder=q=>{if(q.count>0){const B=q.diff*2+(q.count===1?0:1);writeVarInt(q.encoder,B),q.count>1&&writeVarUint(q.encoder,q.count-2)}};class IntDiffOptRleEncoder{constructor(){this.encoder=new Encoder,this.s=0,this.count=0,this.diff=0}write(B){this.diff===B-this.s?(this.s=B,this.count++):(flushIntDiffOptRleEncoder(this),this.count=1,this.diff=B-this.s,this.s=B)}toUint8Array(){return flushIntDiffOptRleEncoder(this),toUint8Array(this.encoder)}}class StringEncoder{constructor(){this.sarr=[],this.s="",this.lensE=new UintOptRleEncoder}write(B){this.s+=B,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(B.length)}toUint8Array(){const B=new Encoder;return this.sarr.push(this.s),this.s="",writeVarString(B,this.sarr.join("")),writeUint8Array(B,this.lensE.toUint8Array()),toUint8Array(B)}}const getUnixTime=Date.now,create$4=()=>new Set,last=q=>q[q.length-1],appendTo=(q,B)=>{for(let j=0;j<B.length;j++)q.push(B[j])},from=Array.from,isArray=Array.isArray;class Observable{constructor(){this._observers=create$5()}on(B,j){setIfUndefined(this._observers,B,create$4).add(j)}once(B,j){const X=(...ee)=>{this.off(B,X),j(...ee)};this.on(B,X)}off(B,j){const X=this._observers.get(B);X!==void 0&&(X.delete(j),X.size===0&&this._observers.delete(B))}emit(B,j){return from((this._observers.get(B)||create$5()).values()).forEach(X=>X(...j))}destroy(){this._observers=create$5()}}const keys=Object.keys,map=(q,B)=>{const j=[];for(const X in q)j.push(B(q[X],X));return j},length=q=>keys(q).length,every=(q,B)=>{for(const j in q)if(!B(q[j],j))return!1;return!0},hasProperty=(q,B)=>Object.prototype.hasOwnProperty.call(q,B),equalFlat=(q,B)=>q===B||length(q)===length(B)&&every(q,(j,X)=>(j!==void 0||hasProperty(B,X))&&B[X]===j),callAll=(q,B,j=0)=>{try{for(;j<q.length;j++)q[j](...B)}finally{j<q.length&&callAll(q,B,j+1)}},nop=()=>{},equalityStrict=(q,B)=>q===B,equalityDeep=(q,B)=>{if(q==null||B==null)return equalityStrict(q,B);if(q.constructor!==B.constructor)return!1;if(q===B)return!0;switch(q.constructor){case ArrayBuffer:q=new Uint8Array(q),B=new Uint8Array(B);case Uint8Array:{if(q.byteLength!==B.byteLength)return!1;for(let j=0;j<q.length;j++)if(q[j]!==B[j])return!1;break}case Set:{if(q.size!==B.size)return!1;for(const j of q)if(!B.has(j))return!1;break}case Map:{if(q.size!==B.size)return!1;for(const j of q.keys())if(!B.has(j)||!equalityDeep(q.get(j),B.get(j)))return!1;break}case Object:if(length(q)!==length(B))return!1;for(const j in q)if(!hasProperty(q,j)||!equalityDeep(q[j],B[j]))return!1;break;case Array:if(q.length!==B.length)return!1;for(let j=0;j<q.length;j++)if(!equalityDeep(q[j],B[j]))return!1;break;default:return!1}return!0},isoCrypto=typeof crypto>"u"?null:crypto,cryptoRandomBuffer=isoCrypto!==null?q=>{const B=new ArrayBuffer(q),j=new Uint8Array(B);return isoCrypto.getRandomValues(j),B}:q=>{const B=new ArrayBuffer(q),j=new Uint8Array(B);for(let X=0;X<q;X++)j[X]=Math.ceil(Math.random()*4294967295>>>0);return B},rand=Math.random,uint32=()=>new Uint32Array(cryptoRandomBuffer(4))[0],uuidv4Template=[1e7]+-1e3+-4e3+-8e3+-1e11,uuidv4$1=()=>uuidv4Template.replace(/[018]/g,q=>(q^uint32()&15>>q/4).toString(16)),create$3=q=>new Promise(q),reject=q=>Promise.reject(q),resolve=q=>Promise.resolve(q),create$2=q=>new Error(q),methodUnimplemented=()=>{throw create$2("Method unimplemented")},unexpectedCase=()=>{throw create$2("Unexpected case")},create$1=Symbol;class Pair{constructor(B,j){this.left=B,this.right=j}}const create=(q,B)=>new Pair(q,B),doc=typeof document<"u"?document:{};typeof DOMParser<"u"&&new DOMParser;const mapToStyleString=q=>map$1(q,(B,j)=>`${j}:${B};`).join("");doc.ELEMENT_NODE;doc.TEXT_NODE;doc.CDATA_SECTION_NODE;doc.COMMENT_NODE;doc.DOCUMENT_NODE;doc.DOCUMENT_TYPE_NODE;doc.DOCUMENT_FRAGMENT_NODE;const BOLD=create$1(),UNBOLD=create$1(),BLUE=create$1(),GREY=create$1(),GREEN=create$1(),RED=create$1(),PURPLE=create$1(),ORANGE=create$1(),UNCOLOR=create$1(),_browserStyleMap={[BOLD]:create("font-weight","bold"),[UNBOLD]:create("font-weight","normal"),[BLUE]:create("color","blue"),[GREEN]:create("color","green"),[GREY]:create("color","grey"),[RED]:create("color","red"),[PURPLE]:create("color","purple"),[ORANGE]:create("color","orange"),[UNCOLOR]:create("color","black")},_nodeStyleMap={[BOLD]:"\x1B[1m",[UNBOLD]:"\x1B[2m",[BLUE]:"\x1B[34m",[GREEN]:"\x1B[32m",[GREY]:"\x1B[37m",[RED]:"\x1B[31m",[PURPLE]:"\x1B[35m",[ORANGE]:"\x1B[38;5;208m",[UNCOLOR]:"\x1B[0m"},computeBrowserLoggingArgs=q=>{const B=[],j=[],X=create$5();let ee=[],te=0;for(;te<q.length;te++){const ne=q[te],re=_browserStyleMap[ne];if(re!==void 0)X.set(re.left,re.right);else if(ne.constructor===String||ne.constructor===Number){const ie=mapToStyleString(X);te>0||ie.length>0?(B.push("%c"+ne),j.push(ie)):B.push(ne)}else break}for(te>0&&(ee=j,ee.unshift(B.join("")));te<q.length;te++){const ne=q[te];ne instanceof Symbol||ee.push(ne)}return ee},computeNodeLoggingArgs=q=>{const B=[],j=[];let X=0;for(;X<q.length;X++){const ee=q[X],te=_nodeStyleMap[ee];if(te!==void 0)B.push(te);else if(ee.constructor===String||ee.constructor===Number)B.push(ee);else break}for(X>0&&(B.push("\x1B[0m"),j.push(B.join("")));X<q.length;X++){const ee=q[X];ee instanceof Symbol||j.push(ee)}return j},computeLoggingArgs=isNode?computeNodeLoggingArgs:computeBrowserLoggingArgs,print=(...q)=>{console.log(...computeLoggingArgs(q)),vconsoles.forEach(B=>B.print(q))},vconsoles=new Set,loggingColors=[GREEN,PURPLE,ORANGE,BLUE];let nextColor=0,lastLoggingTime=getUnixTime();const createModuleLogger=q=>{const B=loggingColors[nextColor],j=getVariable("log"),X=j!==null&&(j==="*"||j==="true"||new RegExp(j,"gi").test(q));return nextColor=(nextColor+1)%loggingColors.length,q+=": ",X?(...ee)=>{const te=getUnixTime(),ne=te-lastLoggingTime;lastLoggingTime=te,print(B,q,UNCOLOR,...ee.map(re=>typeof re=="string"||typeof re=="symbol"?re:JSON.stringify(re)),B," +"+ne+"ms")}:nop},createIterator=q=>({[Symbol.iterator](){return this},next:q}),iteratorFilter=(q,B)=>createIterator(()=>{let j;do j=q.next();while(!j.done&&!B(j.value));return j}),iteratorMap=(q,B)=>createIterator(()=>{const{done:j,value:X}=q.next();return{done:j,value:j?void 0:B(X)}});class DeleteItem{constructor(B,j){this.clock=B,this.len=j}}class DeleteSet{constructor(){this.clients=new Map}}const iterateDeletedStructs=(q,B,j)=>B.clients.forEach((X,ee)=>{const te=q.doc.store.clients.get(ee);for(let ne=0;ne<X.length;ne++){const re=X[ne];iterateStructs(q,te,re.clock,re.len,j)}}),findIndexDS=(q,B)=>{let j=0,X=q.length-1;for(;j<=X;){const ee=floor((j+X)/2),te=q[ee],ne=te.clock;if(ne<=B){if(B<ne+te.len)return ee;j=ee+1}else X=ee-1}return null},isDeleted=(q,B)=>{const j=q.clients.get(B.client);return j!==void 0&&findIndexDS(j,B.clock)!==null},sortAndMergeDeleteSet=q=>{q.clients.forEach(B=>{B.sort((ee,te)=>ee.clock-te.clock);let j,X;for(j=1,X=1;j<B.length;j++){const ee=B[X-1],te=B[j];ee.clock+ee.len>=te.clock?ee.len=max(ee.len,te.clock+te.len-ee.clock):(X<j&&(B[X]=te),X++)}B.length=X})},mergeDeleteSets=q=>{const B=new DeleteSet;for(let j=0;j<q.length;j++)q[j].clients.forEach((X,ee)=>{if(!B.clients.has(ee)){const te=X.slice();for(let ne=j+1;ne<q.length;ne++)appendTo(te,q[ne].clients.get(ee)||[]);B.clients.set(ee,te)}});return sortAndMergeDeleteSet(B),B},addToDeleteSet=(q,B,j,X)=>{setIfUndefined(q.clients,B,()=>[]).push(new DeleteItem(j,X))},createDeleteSet=()=>new DeleteSet,createDeleteSetFromStructStore=q=>{const B=createDeleteSet();return q.clients.forEach((j,X)=>{const ee=[];for(let te=0;te<j.length;te++){const ne=j[te];if(ne.deleted){const re=ne.id.clock;let ie=ne.length;if(te+1<j.length)for(let fe=j[te+1];te+1<j.length&&fe.deleted;fe=j[++te+1])ie+=fe.length;ee.push(new DeleteItem(re,ie))}}ee.length>0&&B.clients.set(X,ee)}),B},writeDeleteSet=(q,B)=>{writeVarUint(q.restEncoder,B.clients.size),B.clients.forEach((j,X)=>{q.resetDsCurVal(),writeVarUint(q.restEncoder,X);const ee=j.length;writeVarUint(q.restEncoder,ee);for(let te=0;te<ee;te++){const ne=j[te];q.writeDsClock(ne.clock),q.writeDsLen(ne.len)}})},readDeleteSet=q=>{const B=new DeleteSet,j=readVarUint(q.restDecoder);for(let X=0;X<j;X++){q.resetDsCurVal();const ee=readVarUint(q.restDecoder),te=readVarUint(q.restDecoder);if(te>0){const ne=setIfUndefined(B.clients,ee,()=>[]);for(let re=0;re<te;re++)ne.push(new DeleteItem(q.readDsClock(),q.readDsLen()))}}return B},readAndApplyDeleteSet=(q,B,j)=>{const X=new DeleteSet,ee=readVarUint(q.restDecoder);for(let te=0;te<ee;te++){q.resetDsCurVal();const ne=readVarUint(q.restDecoder),re=readVarUint(q.restDecoder),ie=j.clients.get(ne)||[],fe=getState(j,ne);for(let ce=0;ce<re;ce++){const se=q.readDsClock(),oe=se+q.readDsLen();if(se<fe){fe<oe&&addToDeleteSet(X,ne,fe,oe-fe);let ae=findIndexSS(ie,se),le=ie[ae];for(!le.deleted&&le.id.clock<se&&(ie.splice(ae+1,0,splitItem(B,le,se-le.id.clock)),ae++);ae<ie.length&&(le=ie[ae++],le.id.clock<oe);)le.deleted||(oe<le.id.clock+le.length&&ie.splice(ae,0,splitItem(B,le,oe-le.id.clock)),le.delete(B))}else addToDeleteSet(X,ne,se,oe-se)}}if(X.clients.size>0){const te=new UpdateEncoderV2;return writeVarUint(te.restEncoder,0),writeDeleteSet(te,X),te.toUint8Array()}return null},generateNewClientId=uint32;class Doc extends Observable{constructor({guid:B=uuidv4$1(),collectionid:j=null,gc:X=!0,gcFilter:ee=()=>!0,meta:te=null,autoLoad:ne=!1,shouldLoad:re=!0}={}){super(),this.gc=X,this.gcFilter=ee,this.clientID=generateNewClientId(),this.guid=B,this.collectionid=j,this.share=new Map,this.store=new StructStore,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=re,this.autoLoad=ne,this.meta=te,this.isLoaded=!1,this.whenLoaded=create$3(ie=>{this.on("load",()=>{this.isLoaded=!0,ie(this)})})}load(){const B=this._item;B!==null&&!this.shouldLoad&&transact$1(B.parent.doc,j=>{j.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map(B=>B.guid))}transact(B,j=null){transact$1(this,B,j)}get(B,j=AbstractType){const X=setIfUndefined(this.share,B,()=>{const te=new j;return te._integrate(this,null),te}),ee=X.constructor;if(j!==AbstractType&&ee!==j)if(ee===AbstractType){const te=new j;te._map=X._map,X._map.forEach(ne=>{for(;ne!==null;ne=ne.left)ne.parent=te}),te._start=X._start;for(let ne=te._start;ne!==null;ne=ne.right)ne.parent=te;return te._length=X._length,this.share.set(B,te),te._integrate(this,null),te}else throw new Error(`Type with the name ${B} has already been defined with a different constructor`);return X}getArray(B=""){return this.get(B,YArray)}getText(B=""){return this.get(B,YText)}getMap(B=""){return this.get(B,YMap)}getXmlFragment(B=""){return this.get(B,YXmlFragment)}toJSON(){const B={};return this.share.forEach((j,X)=>{B[X]=j.toJSON()}),B}destroy(){from(this.subdocs).forEach(j=>j.destroy());const B=this._item;if(B!==null){this._item=null;const j=B.content;j.doc=new Doc({guid:this.guid,...j.opts,shouldLoad:!1}),j.doc._item=B,transact$1(B.parent.doc,X=>{const ee=j.doc;B.deleted||X.subdocsAdded.add(ee),X.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(B,j){super.on(B,j)}off(B,j){super.off(B,j)}}class DSDecoderV1{constructor(B){this.restDecoder=B}resetDsCurVal(){}readDsClock(){return readVarUint(this.restDecoder)}readDsLen(){return readVarUint(this.restDecoder)}}class UpdateDecoderV1 extends DSDecoderV1{readLeftID(){return createID(readVarUint(this.restDecoder),readVarUint(this.restDecoder))}readRightID(){return createID(readVarUint(this.restDecoder),readVarUint(this.restDecoder))}readClient(){return readVarUint(this.restDecoder)}readInfo(){return readUint8(this.restDecoder)}readString(){return readVarString(this.restDecoder)}readParentInfo(){return readVarUint(this.restDecoder)===1}readTypeRef(){return readVarUint(this.restDecoder)}readLen(){return readVarUint(this.restDecoder)}readAny(){return readAny(this.restDecoder)}readBuf(){return copyUint8Array(readVarUint8Array(this.restDecoder))}readJSON(){return JSON.parse(readVarString(this.restDecoder))}readKey(){return readVarString(this.restDecoder)}}class DSDecoderV2{constructor(B){this.dsCurrVal=0,this.restDecoder=B}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=readVarUint(this.restDecoder),this.dsCurrVal}readDsLen(){const B=readVarUint(this.restDecoder)+1;return this.dsCurrVal+=B,B}}class UpdateDecoderV2 extends DSDecoderV2{constructor(B){super(B),this.keys=[],readVarUint(B),this.keyClockDecoder=new IntDiffOptRleDecoder(readVarUint8Array(B)),this.clientDecoder=new UintOptRleDecoder(readVarUint8Array(B)),this.leftClockDecoder=new IntDiffOptRleDecoder(readVarUint8Array(B)),this.rightClockDecoder=new IntDiffOptRleDecoder(readVarUint8Array(B)),this.infoDecoder=new RleDecoder(readVarUint8Array(B),readUint8),this.stringDecoder=new StringDecoder(readVarUint8Array(B)),this.parentInfoDecoder=new RleDecoder(readVarUint8Array(B),readUint8),this.typeRefDecoder=new UintOptRleDecoder(readVarUint8Array(B)),this.lenDecoder=new UintOptRleDecoder(readVarUint8Array(B))}readLeftID(){return new ID(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ID(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return readAny(this.restDecoder)}readBuf(){return readVarUint8Array(this.restDecoder)}readJSON(){return readAny(this.restDecoder)}readKey(){const B=this.keyClockDecoder.read();if(B<this.keys.length)return this.keys[B];{const j=this.stringDecoder.read();return this.keys.push(j),j}}}class DSEncoderV1{constructor(){this.restEncoder=createEncoder()}toUint8Array(){return toUint8Array(this.restEncoder)}resetDsCurVal(){}writeDsClock(B){writeVarUint(this.restEncoder,B)}writeDsLen(B){writeVarUint(this.restEncoder,B)}}class UpdateEncoderV1 extends DSEncoderV1{writeLeftID(B){writeVarUint(this.restEncoder,B.client),writeVarUint(this.restEncoder,B.clock)}writeRightID(B){writeVarUint(this.restEncoder,B.client),writeVarUint(this.restEncoder,B.clock)}writeClient(B){writeVarUint(this.restEncoder,B)}writeInfo(B){writeUint8(this.restEncoder,B)}writeString(B){writeVarString(this.restEncoder,B)}writeParentInfo(B){writeVarUint(this.restEncoder,B?1:0)}writeTypeRef(B){writeVarUint(this.restEncoder,B)}writeLen(B){writeVarUint(this.restEncoder,B)}writeAny(B){writeAny(this.restEncoder,B)}writeBuf(B){writeVarUint8Array(this.restEncoder,B)}writeJSON(B){writeVarString(this.restEncoder,JSON.stringify(B))}writeKey(B){writeVarString(this.restEncoder,B)}}class DSEncoderV2{constructor(){this.restEncoder=createEncoder(),this.dsCurrVal=0}toUint8Array(){return toUint8Array(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(B){const j=B-this.dsCurrVal;this.dsCurrVal=B,writeVarUint(this.restEncoder,j)}writeDsLen(B){B===0&&unexpectedCase(),writeVarUint(this.restEncoder,B-1),this.dsCurrVal+=B}}class UpdateEncoderV2 extends DSEncoderV2{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new IntDiffOptRleEncoder,this.clientEncoder=new UintOptRleEncoder,this.leftClockEncoder=new IntDiffOptRleEncoder,this.rightClockEncoder=new IntDiffOptRleEncoder,this.infoEncoder=new RleEncoder(writeUint8),this.stringEncoder=new StringEncoder,this.parentInfoEncoder=new RleEncoder(writeUint8),this.typeRefEncoder=new UintOptRleEncoder,this.lenEncoder=new UintOptRleEncoder}toUint8Array(){const B=createEncoder();return writeVarUint(B,0),writeVarUint8Array(B,this.keyClockEncoder.toUint8Array()),writeVarUint8Array(B,this.clientEncoder.toUint8Array()),writeVarUint8Array(B,this.leftClockEncoder.toUint8Array()),writeVarUint8Array(B,this.rightClockEncoder.toUint8Array()),writeVarUint8Array(B,toUint8Array(this.infoEncoder)),writeVarUint8Array(B,this.stringEncoder.toUint8Array()),writeVarUint8Array(B,toUint8Array(this.parentInfoEncoder)),writeVarUint8Array(B,this.typeRefEncoder.toUint8Array()),writeVarUint8Array(B,this.lenEncoder.toUint8Array()),writeUint8Array(B,toUint8Array(this.restEncoder)),toUint8Array(B)}writeLeftID(B){this.clientEncoder.write(B.client),this.leftClockEncoder.write(B.clock)}writeRightID(B){this.clientEncoder.write(B.client),this.rightClockEncoder.write(B.clock)}writeClient(B){this.clientEncoder.write(B)}writeInfo(B){this.infoEncoder.write(B)}writeString(B){this.stringEncoder.write(B)}writeParentInfo(B){this.parentInfoEncoder.write(B?1:0)}writeTypeRef(B){this.typeRefEncoder.write(B)}writeLen(B){this.lenEncoder.write(B)}writeAny(B){writeAny(this.restEncoder,B)}writeBuf(B){writeVarUint8Array(this.restEncoder,B)}writeJSON(B){writeAny(this.restEncoder,B)}writeKey(B){const j=this.keyMap.get(B);j===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(B)):this.keyClockEncoder.write(j)}}const writeStructs=(q,B,j,X)=>{X=max(X,B[0].id.clock);const ee=findIndexSS(B,X);writeVarUint(q.restEncoder,B.length-ee),q.writeClient(j),writeVarUint(q.restEncoder,X);const te=B[ee];te.write(q,X-te.id.clock);for(let ne=ee+1;ne<B.length;ne++)B[ne].write(q,0)},writeClientsStructs=(q,B,j)=>{const X=new Map;j.forEach((ee,te)=>{getState(B,te)>ee&&X.set(te,ee)}),getStateVector(B).forEach((ee,te)=>{j.has(te)||X.set(te,0)}),writeVarUint(q.restEncoder,X.size),Array.from(X.entries()).sort((ee,te)=>te[0]-ee[0]).forEach(([ee,te])=>{writeStructs(q,B.clients.get(ee),ee,te)})},readClientsStructRefs=(q,B)=>{const j=create$5(),X=readVarUint(q.restDecoder);for(let ee=0;ee<X;ee++){const te=readVarUint(q.restDecoder),ne=new Array(te),re=q.readClient();let ie=readVarUint(q.restDecoder);j.set(re,{i:0,refs:ne});for(let fe=0;fe<te;fe++){const ce=q.readInfo();switch(BITS5&ce){case 0:{const se=q.readLen();ne[fe]=new GC(createID(re,ie),se),ie+=se;break}case 10:{const se=readVarUint(q.restDecoder);ne[fe]=new Skip(createID(re,ie),se),ie+=se;break}default:{const se=(ce&(BIT7|BIT8))===0,oe=new Item(createID(re,ie),null,(ce&BIT8)===BIT8?q.readLeftID():null,null,(ce&BIT7)===BIT7?q.readRightID():null,se?q.readParentInfo()?B.get(q.readString()):q.readLeftID():null,se&&(ce&BIT6)===BIT6?q.readString():null,readItemContent(q,ce));ne[fe]=oe,ie+=oe.length}}}}return j},integrateStructs=(q,B,j)=>{const X=[];let ee=Array.from(j.keys()).sort((ae,le)=>ae-le);if(ee.length===0)return null;const te=()=>{if(ee.length===0)return null;let ae=j.get(ee[ee.length-1]);for(;ae.refs.length===ae.i;)if(ee.pop(),ee.length>0)ae=j.get(ee[ee.length-1]);else return null;return ae};let ne=te();if(ne===null&&X.length===0)return null;const re=new StructStore,ie=new Map,fe=(ae,le)=>{const pe=ie.get(ae);(pe==null||pe>le)&&ie.set(ae,le)};let ce=ne.refs[ne.i++];const se=new Map,oe=()=>{for(const ae of X){const le=ae.id.client,pe=j.get(le);pe?(pe.i--,re.clients.set(le,pe.refs.slice(pe.i)),j.delete(le),pe.i=0,pe.refs=[]):re.clients.set(le,[ae]),ee=ee.filter(ve=>ve!==le)}X.length=0};for(;;){if(ce.constructor!==Skip){const le=setIfUndefined(se,ce.id.client,()=>getState(B,ce.id.client))-ce.id.clock;if(le<0)X.push(ce),fe(ce.id.client,ce.id.clock-1),oe();else{const pe=ce.getMissing(q,B);if(pe!==null){X.push(ce);const ve=j.get(pe)||{refs:[],i:0};if(ve.refs.length===ve.i)fe(pe,getState(B,pe)),oe();else{ce=ve.refs[ve.i++];continue}}else(le===0||le<ce.length)&&(ce.integrate(q,le),se.set(ce.id.client,ce.id.clock+ce.length))}}if(X.length>0)ce=X.pop();else if(ne!==null&&ne.i<ne.refs.length)ce=ne.refs[ne.i++];else{if(ne=te(),ne===null)break;ce=ne.refs[ne.i++]}}if(re.clients.size>0){const ae=new UpdateEncoderV2;return writeClientsStructs(ae,re,new Map),writeVarUint(ae.restEncoder,0),{missing:ie,update:ae.toUint8Array()}}return null},writeStructsFromTransaction=(q,B)=>writeClientsStructs(q,B.doc.store,B.beforeState),readUpdateV2=(q,B,j,X=new UpdateDecoderV2(q))=>transact$1(B,ee=>{ee.local=!1;let te=!1;const ne=ee.doc,re=ne.store,ie=readClientsStructRefs(X,ne),fe=integrateStructs(ee,re,ie),ce=re.pendingStructs;if(ce){for(const[oe,ae]of ce.missing)if(ae<getState(re,oe)){te=!0;break}if(fe){for(const[oe,ae]of fe.missing){const le=ce.missing.get(oe);(le==null||le>ae)&&ce.missing.set(oe,ae)}ce.update=mergeUpdatesV2([ce.update,fe.update])}}else re.pendingStructs=fe;const se=readAndApplyDeleteSet(X,ee,re);if(re.pendingDs){const oe=new UpdateDecoderV2(createDecoder(re.pendingDs));readVarUint(oe.restDecoder);const ae=readAndApplyDeleteSet(oe,ee,re);se&&ae?re.pendingDs=mergeUpdatesV2([se,ae]):re.pendingDs=se||ae}else re.pendingDs=se;if(te){const oe=re.pendingStructs.update;re.pendingStructs=null,applyUpdateV2(ee.doc,oe)}},j,!1),applyUpdateV2=(q,B,j,X=UpdateDecoderV2)=>{const ee=createDecoder(B);readUpdateV2(ee,q,j,new X(ee))},applyUpdate=(q,B,j)=>applyUpdateV2(q,B,j,UpdateDecoderV1),writeStateAsUpdate=(q,B,j=new Map)=>{writeClientsStructs(q,B.store,j),writeDeleteSet(q,createDeleteSetFromStructStore(B.store))},encodeStateAsUpdateV2=(q,B=new Uint8Array([0]),j=new UpdateEncoderV2)=>{const X=decodeStateVector(B);writeStateAsUpdate(j,q,X);const ee=[j.toUint8Array()];if(q.store.pendingDs&&ee.push(q.store.pendingDs),q.store.pendingStructs&&ee.push(diffUpdateV2(q.store.pendingStructs.update,B)),ee.length>1){if(j.constructor===UpdateEncoderV1)return mergeUpdates(ee.map((te,ne)=>ne===0?te:convertUpdateFormatV2ToV1(te)));if(j.constructor===UpdateEncoderV2)return mergeUpdatesV2(ee)}return ee[0]},encodeStateAsUpdate=(q,B)=>encodeStateAsUpdateV2(q,B,new UpdateEncoderV1),readStateVector=q=>{const B=new Map,j=readVarUint(q.restDecoder);for(let X=0;X<j;X++){const ee=readVarUint(q.restDecoder),te=readVarUint(q.restDecoder);B.set(ee,te)}return B},decodeStateVector=q=>readStateVector(new DSDecoderV1(createDecoder(q))),writeStateVector=(q,B)=>(writeVarUint(q.restEncoder,B.size),Array.from(B.entries()).sort((j,X)=>X[0]-j[0]).forEach(([j,X])=>{writeVarUint(q.restEncoder,j),writeVarUint(q.restEncoder,X)}),q),writeDocumentStateVector=(q,B)=>writeStateVector(q,getStateVector(B.store)),encodeStateVectorV2=(q,B=new DSEncoderV2)=>(q instanceof Map?writeStateVector(B,q):writeDocumentStateVector(B,q),B.toUint8Array()),encodeStateVector=q=>encodeStateVectorV2(q,new DSEncoderV1);class EventHandler{constructor(){this.l=[]}}const createEventHandler=()=>new EventHandler,addEventHandlerListener=(q,B)=>q.l.push(B),removeEventHandlerListener=(q,B)=>{const j=q.l,X=j.length;q.l=j.filter(ee=>B!==ee),X===q.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},callEventHandlerListeners=(q,B,j)=>callAll(q.l,[B,j]);class ID{constructor(B,j){this.client=B,this.clock=j}}const compareIDs=(q,B)=>q===B||q!==null&&B!==null&&q.client===B.client&&q.clock===B.clock,createID=(q,B)=>new ID(q,B),findRootTypeKey=q=>{for(const[B,j]of q.doc.share.entries())if(j===q)return B;throw unexpectedCase()},isParentOf=(q,B)=>{for(;B!==null;){if(B.parent===q)return!0;B=B.parent._item}return!1};class RelativePosition{constructor(B,j,X,ee=0){this.type=B,this.tname=j,this.item=X,this.assoc=ee}}class AbsolutePosition{constructor(B,j,X=0){this.type=B,this.index=j,this.assoc=X}}const createAbsolutePosition=(q,B,j=0)=>new AbsolutePosition(q,B,j),createRelativePosition=(q,B,j)=>{let X=null,ee=null;return q._item===null?ee=findRootTypeKey(q):X=createID(q._item.id.client,q._item.id.clock),new RelativePosition(X,ee,B,j)},createRelativePositionFromTypeIndex=(q,B,j=0)=>{let X=q._start;if(j<0){if(B===0)return createRelativePosition(q,null,j);B--}for(;X!==null;){if(!X.deleted&&X.countable){if(X.length>B)return createRelativePosition(q,createID(X.id.client,X.id.clock+B),j);B-=X.length}if(X.right===null&&j<0)return createRelativePosition(q,X.lastId,j);X=X.right}return createRelativePosition(q,null,j)},createAbsolutePositionFromRelativePosition=(q,B)=>{const j=B.store,X=q.item,ee=q.type,te=q.tname,ne=q.assoc;let re=null,ie=0;if(X!==null){if(getState(j,X.client)<=X.clock)return null;const fe=followRedone(j,X),ce=fe.item;if(!(ce instanceof Item))return null;if(re=ce.parent,re._item===null||!re._item.deleted){ie=ce.deleted||!ce.countable?0:fe.diff+(ne>=0?0:1);let se=ce.left;for(;se!==null;)!se.deleted&&se.countable&&(ie+=se.length),se=se.left}}else{if(te!==null)re=B.get(te);else if(ee!==null){if(getState(j,ee.client)<=ee.clock)return null;const{item:fe}=followRedone(j,ee);if(fe instanceof Item&&fe.content instanceof ContentType)re=fe.content.type;else return null}else throw unexpectedCase();ne>=0?ie=re._length:ie=0}return createAbsolutePosition(re,ie,q.assoc)};class Snapshot{constructor(B,j){this.ds=B,this.sv=j}}const createSnapshot=(q,B)=>new Snapshot(q,B);createSnapshot(createDeleteSet(),new Map);const isVisible=(q,B)=>B===void 0?!q.deleted:B.sv.has(q.id.client)&&(B.sv.get(q.id.client)||0)>q.id.clock&&!isDeleted(B.ds,q.id),splitSnapshotAffectedStructs=(q,B)=>{const j=setIfUndefined(q.meta,splitSnapshotAffectedStructs,create$4),X=q.doc.store;j.has(B)||(B.sv.forEach((ee,te)=>{ee<getState(X,te)&&getItemCleanStart(q,createID(te,ee))}),iterateDeletedStructs(q,B.ds,ee=>{}),j.add(B))};class StructStore{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const getStateVector=q=>{const B=new Map;return q.clients.forEach((j,X)=>{const ee=j[j.length-1];B.set(X,ee.id.clock+ee.length)}),B},getState=(q,B)=>{const j=q.clients.get(B);if(j===void 0)return 0;const X=j[j.length-1];return X.id.clock+X.length},addStruct=(q,B)=>{let j=q.clients.get(B.id.client);if(j===void 0)j=[],q.clients.set(B.id.client,j);else{const X=j[j.length-1];if(X.id.clock+X.length!==B.id.clock)throw unexpectedCase()}j.push(B)},findIndexSS=(q,B)=>{let j=0,X=q.length-1,ee=q[X],te=ee.id.clock;if(te===B)return X;let ne=floor(B/(te+ee.length-1)*X);for(;j<=X;){if(ee=q[ne],te=ee.id.clock,te<=B){if(B<te+ee.length)return ne;j=ne+1}else X=ne-1;ne=floor((j+X)/2)}throw unexpectedCase()},find=(q,B)=>{const j=q.clients.get(B.client);return j[findIndexSS(j,B.clock)]},getItem=find,findIndexCleanStart=(q,B,j)=>{const X=findIndexSS(B,j),ee=B[X];return ee.id.clock<j&&ee instanceof Item?(B.splice(X+1,0,splitItem(q,ee,j-ee.id.clock)),X+1):X},getItemCleanStart=(q,B)=>{const j=q.doc.store.clients.get(B.client);return j[findIndexCleanStart(q,j,B.clock)]},getItemCleanEnd=(q,B,j)=>{const X=B.clients.get(j.client),ee=findIndexSS(X,j.clock),te=X[ee];return j.clock!==te.id.clock+te.length-1&&te.constructor!==GC&&X.splice(ee+1,0,splitItem(q,te,j.clock-te.id.clock+1)),te},replaceStruct=(q,B,j)=>{const X=q.clients.get(B.id.client);X[findIndexSS(X,B.id.clock)]=j},iterateStructs=(q,B,j,X,ee)=>{if(X===0)return;const te=j+X;let ne=findIndexCleanStart(q,B,j),re;do re=B[ne++],te<re.id.clock+re.length&&findIndexCleanStart(q,B,te),ee(re);while(ne<B.length&&B[ne].id.clock<te)};class Transaction{constructor(B,j,X){this.doc=B,this.deleteSet=new DeleteSet,this.beforeState=getStateVector(B.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=j,this.meta=new Map,this.local=X,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const writeUpdateMessageFromTransaction=(q,B)=>B.deleteSet.clients.size===0&&!any(B.afterState,(j,X)=>B.beforeState.get(X)!==j)?!1:(sortAndMergeDeleteSet(B.deleteSet),writeStructsFromTransaction(q,B),writeDeleteSet(q,B.deleteSet),!0),addChangedTypeToTransaction=(q,B,j)=>{const X=B._item;(X===null||X.id.clock<(q.beforeState.get(X.id.client)||0)&&!X.deleted)&&setIfUndefined(q.changed,B,create$4).add(j)},tryToMergeWithLeft=(q,B)=>{const j=q[B-1],X=q[B];j.deleted===X.deleted&&j.constructor===X.constructor&&j.mergeWith(X)&&(q.splice(B,1),X instanceof Item&&X.parentSub!==null&&X.parent._map.get(X.parentSub)===X&&X.parent._map.set(X.parentSub,j))},tryGcDeleteSet=(q,B,j)=>{for(const[X,ee]of q.clients.entries()){const te=B.clients.get(X);for(let ne=ee.length-1;ne>=0;ne--){const re=ee[ne],ie=re.clock+re.len;for(let fe=findIndexSS(te,re.clock),ce=te[fe];fe<te.length&&ce.id.clock<ie;ce=te[++fe]){const se=te[fe];if(re.clock+re.len<=se.id.clock)break;se instanceof Item&&se.deleted&&!se.keep&&j(se)&&se.gc(B,!1)}}}},tryMergeDeleteSet=(q,B)=>{q.clients.forEach((j,X)=>{const ee=B.clients.get(X);for(let te=j.length-1;te>=0;te--){const ne=j[te],re=min(ee.length-1,1+findIndexSS(ee,ne.clock+ne.len-1));for(let ie=re,fe=ee[ie];ie>0&&fe.id.clock>=ne.clock;fe=ee[--ie])tryToMergeWithLeft(ee,ie)}})},cleanupTransactions=(q,B)=>{if(B<q.length){const j=q[B],X=j.doc,ee=X.store,te=j.deleteSet,ne=j._mergeStructs;try{sortAndMergeDeleteSet(te),j.afterState=getStateVector(j.doc.store),X._transaction=null,X.emit("beforeObserverCalls",[j,X]);const re=[];j.changed.forEach((ie,fe)=>re.push(()=>{(fe._item===null||!fe._item.deleted)&&fe._callObserver(j,ie)})),re.push(()=>{j.changedParentTypes.forEach((ie,fe)=>re.push(()=>{(fe._item===null||!fe._item.deleted)&&(ie=ie.filter(ce=>ce.target._item===null||!ce.target._item.deleted),ie.forEach(ce=>{ce.currentTarget=fe}),ie.sort((ce,se)=>ce.path.length-se.path.length),callEventHandlerListeners(fe._dEH,ie,j))})),re.push(()=>X.emit("afterTransaction",[j,X]))}),callAll(re,[])}finally{X.gc&&tryGcDeleteSet(te,ee,X.gcFilter),tryMergeDeleteSet(te,ee),j.afterState.forEach((ce,se)=>{const oe=j.beforeState.get(se)||0;if(oe!==ce){const ae=ee.clients.get(se),le=max(findIndexSS(ae,oe),1);for(let pe=ae.length-1;pe>=le;pe--)tryToMergeWithLeft(ae,pe)}});for(let ce=0;ce<ne.length;ce++){const{client:se,clock:oe}=ne[ce].id,ae=ee.clients.get(se),le=findIndexSS(ae,oe);le+1<ae.length&&tryToMergeWithLeft(ae,le+1),le>0&&tryToMergeWithLeft(ae,le)}if(!j.local&&j.afterState.get(X.clientID)!==j.beforeState.get(X.clientID)&&(print(ORANGE,BOLD,"[yjs] ",UNBOLD,RED,"Changed the client-id because another client seems to be using it."),X.clientID=generateNewClientId()),X.emit("afterTransactionCleanup",[j,X]),X._observers.has("update")){const ce=new UpdateEncoderV1;writeUpdateMessageFromTransaction(ce,j)&&X.emit("update",[ce.toUint8Array(),j.origin,X,j])}if(X._observers.has("updateV2")){const ce=new UpdateEncoderV2;writeUpdateMessageFromTransaction(ce,j)&&X.emit("updateV2",[ce.toUint8Array(),j.origin,X,j])}const{subdocsAdded:re,subdocsLoaded:ie,subdocsRemoved:fe}=j;(re.size>0||fe.size>0||ie.size>0)&&(re.forEach(ce=>{ce.clientID=X.clientID,ce.collectionid==null&&(ce.collectionid=X.collectionid),X.subdocs.add(ce)}),fe.forEach(ce=>X.subdocs.delete(ce)),X.emit("subdocs",[{loaded:ie,added:re,removed:fe},X,j]),fe.forEach(ce=>ce.destroy())),q.length<=B+1?(X._transactionCleanups=[],X.emit("afterAllTransactions",[X,q])):cleanupTransactions(q,B+1)}}},transact$1=(q,B,j=null,X=!0)=>{const ee=q._transactionCleanups;let te=!1;q._transaction===null&&(te=!0,q._transaction=new Transaction(q,j,X),ee.push(q._transaction),ee.length===1&&q.emit("beforeAllTransactions",[q]),q.emit("beforeTransaction",[q._transaction,q]));try{B(q._transaction)}finally{te&&ee[0]===q._transaction&&cleanupTransactions(ee,0)}};class StackItem{constructor(B,j){this.insertions=j,this.deletions=B,this.meta=new Map}}const clearUndoManagerStackItem=(q,B,j)=>{iterateDeletedStructs(q,j.deletions,X=>{X instanceof Item&&B.scope.some(ee=>isParentOf(ee,X))&&keepItem(X,!1)})},popStackItem=(q,B,j)=>{let X=null,ee=null;const te=q.doc,ne=q.scope;if(transact$1(te,re=>{for(;B.length>0&&X===null;){const ie=te.store,fe=B.pop(),ce=new Set,se=[];let oe=!1;iterateDeletedStructs(re,fe.insertions,ae=>{if(ae instanceof Item){if(ae.redone!==null){let{item:le,diff:pe}=followRedone(ie,ae.id);pe>0&&(le=getItemCleanStart(re,createID(le.id.client,le.id.clock+pe))),ae=le}!ae.deleted&&ne.some(le=>isParentOf(le,ae))&&se.push(ae)}}),iterateDeletedStructs(re,fe.deletions,ae=>{ae instanceof Item&&ne.some(le=>isParentOf(le,ae))&&!isDeleted(fe.insertions,ae.id)&&ce.add(ae)}),ce.forEach(ae=>{oe=redoItem(re,ae,ce,fe.insertions,q.ignoreRemoteMapChanges)!==null||oe});for(let ae=se.length-1;ae>=0;ae--){const le=se[ae];q.deleteFilter(le)&&(le.delete(re),oe=!0)}X=oe?fe:null}re.changed.forEach((ie,fe)=>{ie.has(null)&&fe._searchMarker&&(fe._searchMarker.length=0)}),ee=re},q),X!=null){const re=ee.changedParentTypes;q.emit("stack-item-popped",[{stackItem:X,type:j,changedParentTypes:re},q])}return X};class UndoManager extends Observable{constructor(B,{captureTimeout:j=500,captureTransaction:X=ie=>!0,deleteFilter:ee=()=>!0,trackedOrigins:te=new Set([null]),ignoreRemoteMapChanges:ne=!1,doc:re=isArray(B)?B[0].doc:B.doc}={}){super(),this.scope=[],this.addToScope(B),this.deleteFilter=ee,te.add(this),this.trackedOrigins=te,this.captureTransaction=X,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=re,this.lastChange=0,this.ignoreRemoteMapChanges=ne,this.afterTransactionHandler=ie=>{if(!this.captureTransaction(ie)||!this.scope.some(ve=>ie.changedParentTypes.has(ve))||!this.trackedOrigins.has(ie.origin)&&(!ie.origin||!this.trackedOrigins.has(ie.origin.constructor)))return;const fe=this.undoing,ce=this.redoing,se=fe?this.redoStack:this.undoStack;fe?this.stopCapturing():ce||this.clear(!1,!0);const oe=new DeleteSet;ie.afterState.forEach((ve,ge)=>{const de=ie.beforeState.get(ge)||0,ue=ve-de;ue>0&&addToDeleteSet(oe,ge,de,ue)});const ae=getUnixTime();let le=!1;if(ae-this.lastChange<j&&se.length>0&&!fe&&!ce){const ve=se[se.length-1];ve.deletions=mergeDeleteSets([ve.deletions,ie.deleteSet]),ve.insertions=mergeDeleteSets([ve.insertions,oe])}else se.push(new StackItem(ie.deleteSet,oe)),le=!0;!fe&&!ce&&(this.lastChange=ae),iterateDeletedStructs(ie,ie.deleteSet,ve=>{ve instanceof Item&&this.scope.some(ge=>isParentOf(ge,ve))&&keepItem(ve,!0)});const pe=[{stackItem:se[se.length-1],origin:ie.origin,type:fe?"redo":"undo",changedParentTypes:ie.changedParentTypes},this];le?this.emit("stack-item-added",pe):this.emit("stack-item-updated",pe)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(B){B=isArray(B)?B:[B],B.forEach(j=>{this.scope.every(X=>X!==j)&&this.scope.push(j)})}addTrackedOrigin(B){this.trackedOrigins.add(B)}removeTrackedOrigin(B){this.trackedOrigins.delete(B)}clear(B=!0,j=!0){(B&&this.canUndo()||j&&this.canRedo())&&this.doc.transact(X=>{B&&(this.undoStack.forEach(ee=>clearUndoManagerStackItem(X,this,ee)),this.undoStack=[]),j&&(this.redoStack.forEach(ee=>clearUndoManagerStackItem(X,this,ee)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:B,redoStackCleared:j}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let B;try{B=popStackItem(this,this.undoStack,"undo")}finally{this.undoing=!1}return B}redo(){this.redoing=!0;let B;try{B=popStackItem(this,this.redoStack,"redo")}finally{this.redoing=!1}return B}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*lazyStructReaderGenerator(q){const B=readVarUint(q.restDecoder);for(let j=0;j<B;j++){const X=readVarUint(q.restDecoder),ee=q.readClient();let te=readVarUint(q.restDecoder);for(let ne=0;ne<X;ne++){const re=q.readInfo();if(re===10){const ie=readVarUint(q.restDecoder);yield new Skip(createID(ee,te),ie),te+=ie}else if((BITS5&re)!==0){const ie=(re&(BIT7|BIT8))===0,fe=new Item(createID(ee,te),null,(re&BIT8)===BIT8?q.readLeftID():null,null,(re&BIT7)===BIT7?q.readRightID():null,ie?q.readParentInfo()?q.readString():q.readLeftID():null,ie&&(re&BIT6)===BIT6?q.readString():null,readItemContent(q,re));yield fe,te+=fe.length}else{const ie=q.readLen();yield new GC(createID(ee,te),ie),te+=ie}}}}class LazyStructReader{constructor(B,j){this.gen=lazyStructReaderGenerator(B),this.curr=null,this.done=!1,this.filterSkips=j,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Skip);return this.curr}}class LazyStructWriter{constructor(B){this.currClient=0,this.startClock=0,this.written=0,this.encoder=B,this.clientStructs=[]}}const mergeUpdates=q=>mergeUpdatesV2(q,UpdateDecoderV1,UpdateEncoderV1),sliceStruct=(q,B)=>{if(q.constructor===GC){const{client:j,clock:X}=q.id;return new GC(createID(j,X+B),q.length-B)}else if(q.constructor===Skip){const{client:j,clock:X}=q.id;return new Skip(createID(j,X+B),q.length-B)}else{const j=q,{client:X,clock:ee}=j.id;return new Item(createID(X,ee+B),null,createID(X,ee+B-1),null,j.rightOrigin,j.parent,j.parentSub,j.content.splice(B))}},mergeUpdatesV2=(q,B=UpdateDecoderV2,j=UpdateEncoderV2)=>{if(q.length===1)return q[0];const X=q.map(ce=>new B(createDecoder(ce)));let ee=X.map(ce=>new LazyStructReader(ce,!0)),te=null;const ne=new j,re=new LazyStructWriter(ne);for(;ee=ee.filter(oe=>oe.curr!==null),ee.sort((oe,ae)=>{if(oe.curr.id.client===ae.curr.id.client){const le=oe.curr.id.clock-ae.curr.id.clock;return le===0?oe.curr.constructor===ae.curr.constructor?0:oe.curr.constructor===Skip?1:-1:le}else return ae.curr.id.client-oe.curr.id.client}),ee.length!==0;){const ce=ee[0],se=ce.curr.id.client;if(te!==null){let oe=ce.curr,ae=!1;for(;oe!==null&&oe.id.clock+oe.length<=te.struct.id.clock+te.struct.length&&oe.id.client>=te.struct.id.client;)oe=ce.next(),ae=!0;if(oe===null||oe.id.client!==se||ae&&oe.id.clock>te.struct.id.clock+te.struct.length)continue;if(se!==te.struct.id.client)writeStructToLazyStructWriter(re,te.struct,te.offset),te={struct:oe,offset:0},ce.next();else if(te.struct.id.clock+te.struct.length<oe.id.clock)if(te.struct.constructor===Skip)te.struct.length=oe.id.clock+oe.length-te.struct.id.clock;else{writeStructToLazyStructWriter(re,te.struct,te.offset);const le=oe.id.clock-te.struct.id.clock-te.struct.length;te={struct:new Skip(createID(se,te.struct.id.clock+te.struct.length),le),offset:0}}else{const le=te.struct.id.clock+te.struct.length-oe.id.clock;le>0&&(te.struct.constructor===Skip?te.struct.length-=le:oe=sliceStruct(oe,le)),te.struct.mergeWith(oe)||(writeStructToLazyStructWriter(re,te.struct,te.offset),te={struct:oe,offset:0},ce.next())}}else te={struct:ce.curr,offset:0},ce.next();for(let oe=ce.curr;oe!==null&&oe.id.client===se&&oe.id.clock===te.struct.id.clock+te.struct.length&&oe.constructor!==Skip;oe=ce.next())writeStructToLazyStructWriter(re,te.struct,te.offset),te={struct:oe,offset:0}}te!==null&&(writeStructToLazyStructWriter(re,te.struct,te.offset),te=null),finishLazyStructWriting(re);const ie=X.map(ce=>readDeleteSet(ce)),fe=mergeDeleteSets(ie);return writeDeleteSet(ne,fe),ne.toUint8Array()},diffUpdateV2=(q,B,j=UpdateDecoderV2,X=UpdateEncoderV2)=>{const ee=decodeStateVector(B),te=new X,ne=new LazyStructWriter(te),re=new j(createDecoder(q)),ie=new LazyStructReader(re,!1);for(;ie.curr;){const ce=ie.curr,se=ce.id.client,oe=ee.get(se)||0;if(ie.curr.constructor===Skip){ie.next();continue}if(ce.id.clock+ce.length>oe)for(writeStructToLazyStructWriter(ne,ce,max(oe-ce.id.clock,0)),ie.next();ie.curr&&ie.curr.id.client===se;)writeStructToLazyStructWriter(ne,ie.curr,0),ie.next();else for(;ie.curr&&ie.curr.id.client===se&&ie.curr.id.clock+ie.curr.length<=oe;)ie.next()}finishLazyStructWriting(ne);const fe=readDeleteSet(re);return writeDeleteSet(te,fe),te.toUint8Array()},flushLazyStructWriter=q=>{q.written>0&&(q.clientStructs.push({written:q.written,restEncoder:toUint8Array(q.encoder.restEncoder)}),q.encoder.restEncoder=createEncoder(),q.written=0)},writeStructToLazyStructWriter=(q,B,j)=>{q.written>0&&q.currClient!==B.id.client&&flushLazyStructWriter(q),q.written===0&&(q.currClient=B.id.client,q.encoder.writeClient(B.id.client),writeVarUint(q.encoder.restEncoder,B.id.clock+j)),B.write(q.encoder,j),q.written++},finishLazyStructWriting=q=>{flushLazyStructWriter(q);const B=q.encoder.restEncoder;writeVarUint(B,q.clientStructs.length);for(let j=0;j<q.clientStructs.length;j++){const X=q.clientStructs[j];writeVarUint(B,X.written),writeUint8Array(B,X.restEncoder)}},convertUpdateFormat=(q,B,j)=>{const X=new B(createDecoder(q)),ee=new LazyStructReader(X,!1),te=new j,ne=new LazyStructWriter(te);for(let ie=ee.curr;ie!==null;ie=ee.next())writeStructToLazyStructWriter(ne,ie,0);finishLazyStructWriting(ne);const re=readDeleteSet(X);return writeDeleteSet(te,re),te.toUint8Array()},convertUpdateFormatV2ToV1=q=>convertUpdateFormat(q,UpdateDecoderV2,UpdateEncoderV1);class YEvent{constructor(B,j){this.target=B,this.currentTarget=B,this.transaction=j,this._changes=null,this._keys=null,this._delta=null}get path(){return getPathTo(this.currentTarget,this.target)}deletes(B){return isDeleted(this.transaction.deleteSet,B.id)}get keys(){if(this._keys===null){const B=new Map,j=this.target;this.transaction.changed.get(j).forEach(ee=>{if(ee!==null){const te=j._map.get(ee);let ne,re;if(this.adds(te)){let ie=te.left;for(;ie!==null&&this.adds(ie);)ie=ie.left;if(this.deletes(te))if(ie!==null&&this.deletes(ie))ne="delete",re=last(ie.content.getContent());else return;else ie!==null&&this.deletes(ie)?(ne="update",re=last(ie.content.getContent())):(ne="add",re=void 0)}else if(this.deletes(te))ne="delete",re=last(te.content.getContent());else return;B.set(ee,{action:ne,oldValue:re})}}),this._keys=B}return this._keys}get delta(){return this.changes.delta}adds(B){return B.id.clock>=(this.transaction.beforeState.get(B.id.client)||0)}get changes(){let B=this._changes;if(B===null){const j=this.target,X=create$4(),ee=create$4(),te=[];if(B={added:X,deleted:ee,delta:te,keys:this.keys},this.transaction.changed.get(j).has(null)){let re=null;const ie=()=>{re&&te.push(re)};for(let fe=j._start;fe!==null;fe=fe.right)fe.deleted?this.deletes(fe)&&!this.adds(fe)&&((re===null||re.delete===void 0)&&(ie(),re={delete:0}),re.delete+=fe.length,ee.add(fe)):this.adds(fe)?((re===null||re.insert===void 0)&&(ie(),re={insert:[]}),re.insert=re.insert.concat(fe.content.getContent()),X.add(fe)):((re===null||re.retain===void 0)&&(ie(),re={retain:0}),re.retain+=fe.length);re!==null&&re.retain===void 0&&ie()}this._changes=B}return B}}const getPathTo=(q,B)=>{const j=[];for(;B._item!==null&&B!==q;){if(B._item.parentSub!==null)j.unshift(B._item.parentSub);else{let X=0,ee=B._item.parent._start;for(;ee!==B._item&&ee!==null;)ee.deleted||X++,ee=ee.right;j.unshift(X)}B=B._item.parent}return j},maxSearchMarker=80;let globalSearchMarkerTimestamp=0;class ArraySearchMarker{constructor(B,j){B.marker=!0,this.p=B,this.index=j,this.timestamp=globalSearchMarkerTimestamp++}}const refreshMarkerTimestamp=q=>{q.timestamp=globalSearchMarkerTimestamp++},overwriteMarker=(q,B,j)=>{q.p.marker=!1,q.p=B,B.marker=!0,q.index=j,q.timestamp=globalSearchMarkerTimestamp++},markPosition=(q,B,j)=>{if(q.length>=maxSearchMarker){const X=q.reduce((ee,te)=>ee.timestamp<te.timestamp?ee:te);return overwriteMarker(X,B,j),X}else{const X=new ArraySearchMarker(B,j);return q.push(X),X}},findMarker=(q,B)=>{if(q._start===null||B===0||q._searchMarker===null)return null;const j=q._searchMarker.length===0?null:q._searchMarker.reduce((te,ne)=>abs(B-te.index)<abs(B-ne.index)?te:ne);let X=q._start,ee=0;for(j!==null&&(X=j.p,ee=j.index,refreshMarkerTimestamp(j));X.right!==null&&ee<B;){if(!X.deleted&&X.countable){if(B<ee+X.length)break;ee+=X.length}X=X.right}for(;X.left!==null&&ee>B;)X=X.left,!X.deleted&&X.countable&&(ee-=X.length);for(;X.left!==null&&X.left.id.client===X.id.client&&X.left.id.clock+X.left.length===X.id.clock;)X=X.left,!X.deleted&&X.countable&&(ee-=X.length);return j!==null&&abs(j.index-ee)<X.parent.length/maxSearchMarker?(overwriteMarker(j,X,ee),j):markPosition(q._searchMarker,X,ee)},updateMarkerChanges=(q,B,j)=>{for(let X=q.length-1;X>=0;X--){const ee=q[X];if(j>0){let te=ee.p;for(te.marker=!1;te&&(te.deleted||!te.countable);)te=te.left,te&&!te.deleted&&te.countable&&(ee.index-=te.length);if(te===null||te.marker===!0){q.splice(X,1);continue}ee.p=te,te.marker=!0}(B<ee.index||j>0&&B===ee.index)&&(ee.index=max(B,ee.index+j))}},callTypeObservers=(q,B,j)=>{const X=q,ee=B.changedParentTypes;for(;setIfUndefined(ee,q,()=>[]).push(j),q._item!==null;)q=q._item.parent;callEventHandlerListeners(X._eH,j,B)};class AbstractType{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=createEventHandler(),this._dEH=createEventHandler(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(B,j){this.doc=B,this._item=j}_copy(){throw methodUnimplemented()}clone(){throw methodUnimplemented()}_write(B){}get _first(){let B=this._start;for(;B!==null&&B.deleted;)B=B.right;return B}_callObserver(B,j){!B.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(B){addEventHandlerListener(this._eH,B)}observeDeep(B){addEventHandlerListener(this._dEH,B)}unobserve(B){removeEventHandlerListener(this._eH,B)}unobserveDeep(B){removeEventHandlerListener(this._dEH,B)}toJSON(){}}const typeListSlice=(q,B,j)=>{B<0&&(B=q._length+B),j<0&&(j=q._length+j);let X=j-B;const ee=[];let te=q._start;for(;te!==null&&X>0;){if(te.countable&&!te.deleted){const ne=te.content.getContent();if(ne.length<=B)B-=ne.length;else{for(let re=B;re<ne.length&&X>0;re++)ee.push(ne[re]),X--;B=0}}te=te.right}return ee},typeListToArray=q=>{const B=[];let j=q._start;for(;j!==null;){if(j.countable&&!j.deleted){const X=j.content.getContent();for(let ee=0;ee<X.length;ee++)B.push(X[ee])}j=j.right}return B},typeListForEach=(q,B)=>{let j=0,X=q._start;for(;X!==null;){if(X.countable&&!X.deleted){const ee=X.content.getContent();for(let te=0;te<ee.length;te++)B(ee[te],j++,q)}X=X.right}},typeListMap=(q,B)=>{const j=[];return typeListForEach(q,(X,ee)=>{j.push(B(X,ee,q))}),j},typeListCreateIterator=q=>{let B=q._start,j=null,X=0;return{[Symbol.iterator](){return this},next:()=>{if(j===null){for(;B!==null&&B.deleted;)B=B.right;if(B===null)return{done:!0,value:void 0};j=B.content.getContent(),X=0,B=B.right}const ee=j[X++];return j.length<=X&&(j=null),{done:!1,value:ee}}}},typeListGet=(q,B)=>{const j=findMarker(q,B);let X=q._start;for(j!==null&&(X=j.p,B-=j.index);X!==null;X=X.right)if(!X.deleted&&X.countable){if(B<X.length)return X.content.getContent()[B];B-=X.length}},typeListInsertGenericsAfter=(q,B,j,X)=>{let ee=j;const te=q.doc,ne=te.clientID,re=te.store,ie=j===null?B._start:j.right;let fe=[];const ce=()=>{fe.length>0&&(ee=new Item(createID(ne,getState(re,ne)),ee,ee&&ee.lastId,ie,ie&&ie.id,B,null,new ContentAny(fe)),ee.integrate(q,0),fe=[])};X.forEach(se=>{if(se===null)fe.push(se);else switch(se.constructor){case Number:case Object:case Boolean:case Array:case String:fe.push(se);break;default:switch(ce(),se.constructor){case Uint8Array:case ArrayBuffer:ee=new Item(createID(ne,getState(re,ne)),ee,ee&&ee.lastId,ie,ie&&ie.id,B,null,new ContentBinary(new Uint8Array(se))),ee.integrate(q,0);break;case Doc:ee=new Item(createID(ne,getState(re,ne)),ee,ee&&ee.lastId,ie,ie&&ie.id,B,null,new ContentDoc(se)),ee.integrate(q,0);break;default:if(se instanceof AbstractType)ee=new Item(createID(ne,getState(re,ne)),ee,ee&&ee.lastId,ie,ie&&ie.id,B,null,new ContentType(se)),ee.integrate(q,0);else throw new Error("Unexpected content type in insert operation")}}}),ce()},lengthExceeded=create$2("Length exceeded!"),typeListInsertGenerics=(q,B,j,X)=>{if(j>B._length)throw lengthExceeded;if(j===0)return B._searchMarker&&updateMarkerChanges(B._searchMarker,j,X.length),typeListInsertGenericsAfter(q,B,null,X);const ee=j,te=findMarker(B,j);let ne=B._start;for(te!==null&&(ne=te.p,j-=te.index,j===0&&(ne=ne.prev,j+=ne&&ne.countable&&!ne.deleted?ne.length:0));ne!==null;ne=ne.right)if(!ne.deleted&&ne.countable){if(j<=ne.length){j<ne.length&&getItemCleanStart(q,createID(ne.id.client,ne.id.clock+j));break}j-=ne.length}return B._searchMarker&&updateMarkerChanges(B._searchMarker,ee,X.length),typeListInsertGenericsAfter(q,B,ne,X)},typeListPushGenerics=(q,B,j)=>{let ee=(B._searchMarker||[]).reduce((te,ne)=>ne.index>te.index?ne:te,{index:0,p:B._start}).p;if(ee)for(;ee.right;)ee=ee.right;return typeListInsertGenericsAfter(q,B,ee,j)},typeListDelete=(q,B,j,X)=>{if(X===0)return;const ee=j,te=X,ne=findMarker(B,j);let re=B._start;for(ne!==null&&(re=ne.p,j-=ne.index);re!==null&&j>0;re=re.right)!re.deleted&&re.countable&&(j<re.length&&getItemCleanStart(q,createID(re.id.client,re.id.clock+j)),j-=re.length);for(;X>0&&re!==null;)re.deleted||(X<re.length&&getItemCleanStart(q,createID(re.id.client,re.id.clock+X)),re.delete(q),X-=re.length),re=re.right;if(X>0)throw lengthExceeded;B._searchMarker&&updateMarkerChanges(B._searchMarker,ee,-te+X)},typeMapDelete=(q,B,j)=>{const X=B._map.get(j);X!==void 0&&X.delete(q)},typeMapSet=(q,B,j,X)=>{const ee=B._map.get(j)||null,te=q.doc,ne=te.clientID;let re;if(X==null)re=new ContentAny([X]);else switch(X.constructor){case Number:case Object:case Boolean:case Array:case String:re=new ContentAny([X]);break;case Uint8Array:re=new ContentBinary(X);break;case Doc:re=new ContentDoc(X);break;default:if(X instanceof AbstractType)re=new ContentType(X);else throw new Error("Unexpected content type")}new Item(createID(ne,getState(te.store,ne)),ee,ee&&ee.lastId,null,null,B,j,re).integrate(q,0)},typeMapGet=(q,B)=>{const j=q._map.get(B);return j!==void 0&&!j.deleted?j.content.getContent()[j.length-1]:void 0},typeMapGetAll=q=>{const B={};return q._map.forEach((j,X)=>{j.deleted||(B[X]=j.content.getContent()[j.length-1])}),B},typeMapHas=(q,B)=>{const j=q._map.get(B);return j!==void 0&&!j.deleted},createMapIterator=q=>iteratorFilter(q.entries(),B=>!B[1].deleted);class YArrayEvent extends YEvent{constructor(B,j){super(B,j),this._transaction=j}}class YArray extends AbstractType{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(B){const j=new YArray;return j.push(B),j}_integrate(B,j){super._integrate(B,j),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new YArray}clone(){const B=new YArray;return B.insert(0,this.toArray().map(j=>j instanceof AbstractType?j.clone():j)),B}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(B,j){super._callObserver(B,j),callTypeObservers(this,B,new YArrayEvent(this,B))}insert(B,j){this.doc!==null?transact$1(this.doc,X=>{typeListInsertGenerics(X,this,B,j)}):this._prelimContent.splice(B,0,...j)}push(B){this.doc!==null?transact$1(this.doc,j=>{typeListPushGenerics(j,this,B)}):this._prelimContent.push(...B)}unshift(B){this.insert(0,B)}delete(B,j=1){this.doc!==null?transact$1(this.doc,X=>{typeListDelete(X,this,B,j)}):this._prelimContent.splice(B,j)}get(B){return typeListGet(this,B)}toArray(){return typeListToArray(this)}slice(B=0,j=this.length){return typeListSlice(this,B,j)}toJSON(){return this.map(B=>B instanceof AbstractType?B.toJSON():B)}map(B){return typeListMap(this,B)}forEach(B){typeListForEach(this,B)}[Symbol.iterator](){return typeListCreateIterator(this)}_write(B){B.writeTypeRef(YArrayRefID)}}const readYArray=q=>new YArray;class YMapEvent extends YEvent{constructor(B,j,X){super(B,j),this.keysChanged=X}}class YMap extends AbstractType{constructor(B){super(),this._prelimContent=null,B===void 0?this._prelimContent=new Map:this._prelimContent=new Map(B)}_integrate(B,j){super._integrate(B,j),this._prelimContent.forEach((X,ee)=>{this.set(ee,X)}),this._prelimContent=null}_copy(){return new YMap}clone(){const B=new YMap;return this.forEach((j,X)=>{B.set(X,j instanceof AbstractType?j.clone():j)}),B}_callObserver(B,j){callTypeObservers(this,B,new YMapEvent(this,B,j))}toJSON(){const B={};return this._map.forEach((j,X)=>{if(!j.deleted){const ee=j.content.getContent()[j.length-1];B[X]=ee instanceof AbstractType?ee.toJSON():ee}}),B}get size(){return[...createMapIterator(this._map)].length}keys(){return iteratorMap(createMapIterator(this._map),B=>B[0])}values(){return iteratorMap(createMapIterator(this._map),B=>B[1].content.getContent()[B[1].length-1])}entries(){return iteratorMap(createMapIterator(this._map),B=>[B[0],B[1].content.getContent()[B[1].length-1]])}forEach(B){const j={};return this._map.forEach((X,ee)=>{X.deleted||B(X.content.getContent()[X.length-1],ee,this)}),j}[Symbol.iterator](){return this.entries()}delete(B){this.doc!==null?transact$1(this.doc,j=>{typeMapDelete(j,this,B)}):this._prelimContent.delete(B)}set(B,j){return this.doc!==null?transact$1(this.doc,X=>{typeMapSet(X,this,B,j)}):this._prelimContent.set(B,j),j}get(B){return typeMapGet(this,B)}has(B){return typeMapHas(this,B)}clear(){this.doc!==null?transact$1(this.doc,B=>{this.forEach(function(j,X,ee){typeMapDelete(B,ee,X)})}):this._prelimContent.clear()}_write(B){B.writeTypeRef(YMapRefID)}}const readYMap=q=>new YMap,equalAttrs=(q,B)=>q===B||typeof q=="object"&&typeof B=="object"&&q&&B&&equalFlat(q,B);class ItemTextListPosition{constructor(B,j,X,ee){this.left=B,this.right=j,this.index=X,this.currentAttributes=ee}forward(){switch(this.right===null&&unexpectedCase(),this.right.content.constructor){case ContentFormat:this.right.deleted||updateCurrentAttributes(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const findNextPosition=(q,B,j)=>{for(;B.right!==null&&j>0;){switch(B.right.content.constructor){case ContentFormat:B.right.deleted||updateCurrentAttributes(B.currentAttributes,B.right.content);break;default:B.right.deleted||(j<B.right.length&&getItemCleanStart(q,createID(B.right.id.client,B.right.id.clock+j)),B.index+=B.right.length,j-=B.right.length);break}B.left=B.right,B.right=B.right.right}return B},findPosition=(q,B,j)=>{const X=new Map,ee=findMarker(B,j);if(ee){const te=new ItemTextListPosition(ee.p.left,ee.p,ee.index,X);return findNextPosition(q,te,j-ee.index)}else{const te=new ItemTextListPosition(null,B._start,0,X);return findNextPosition(q,te,j)}},insertNegatedAttributes=(q,B,j,X)=>{for(;j.right!==null&&(j.right.deleted===!0||j.right.content.constructor===ContentFormat&&equalAttrs(X.get(j.right.content.key),j.right.content.value));)j.right.deleted||X.delete(j.right.content.key),j.forward();const ee=q.doc,te=ee.clientID;X.forEach((ne,re)=>{const ie=j.left,fe=j.right,ce=new Item(createID(te,getState(ee.store,te)),ie,ie&&ie.lastId,fe,fe&&fe.id,B,null,new ContentFormat(re,ne));ce.integrate(q,0),j.right=ce,j.forward()})},updateCurrentAttributes=(q,B)=>{const{key:j,value:X}=B;X===null?q.delete(j):q.set(j,X)},minimizeAttributeChanges=(q,B)=>{for(;q.right!==null;){if(!(q.right.deleted||q.right.content.constructor===ContentFormat&&equalAttrs(B[q.right.content.key]||null,q.right.content.value)))break;q.forward()}},insertAttributes=(q,B,j,X)=>{const ee=q.doc,te=ee.clientID,ne=new Map;for(const re in X){const ie=X[re],fe=j.currentAttributes.get(re)||null;if(!equalAttrs(fe,ie)){ne.set(re,fe);const{left:ce,right:se}=j;j.right=new Item(createID(te,getState(ee.store,te)),ce,ce&&ce.lastId,se,se&&se.id,B,null,new ContentFormat(re,ie)),j.right.integrate(q,0),j.forward()}}return ne},insertText=(q,B,j,X,ee)=>{j.currentAttributes.forEach((oe,ae)=>{ee[ae]===void 0&&(ee[ae]=null)});const te=q.doc,ne=te.clientID;minimizeAttributeChanges(j,ee);const re=insertAttributes(q,B,j,ee),ie=X.constructor===String?new ContentString(X):X instanceof AbstractType?new ContentType(X):new ContentEmbed(X);let{left:fe,right:ce,index:se}=j;B._searchMarker&&updateMarkerChanges(B._searchMarker,j.index,ie.getLength()),ce=new Item(createID(ne,getState(te.store,ne)),fe,fe&&fe.lastId,ce,ce&&ce.id,B,null,ie),ce.integrate(q,0),j.right=ce,j.index=se,j.forward(),insertNegatedAttributes(q,B,j,re)},formatText=(q,B,j,X,ee)=>{const te=q.doc,ne=te.clientID;minimizeAttributeChanges(j,ee);const re=insertAttributes(q,B,j,ee);e:for(;j.right!==null&&(X>0||re.size>0&&(j.right.deleted||j.right.content.constructor===ContentFormat));){if(!j.right.deleted)switch(j.right.content.constructor){case ContentFormat:{const{key:ie,value:fe}=j.right.content,ce=ee[ie];if(ce!==void 0){if(equalAttrs(ce,fe))re.delete(ie);else{if(X===0)break e;re.set(ie,fe)}j.right.delete(q)}else j.currentAttributes.set(ie,fe);break}default:X<j.right.length&&getItemCleanStart(q,createID(j.right.id.client,j.right.id.clock+X)),X-=j.right.length;break}j.forward()}if(X>0){let ie="";for(;X>0;X--)ie+=`
`;j.right=new Item(createID(ne,getState(te.store,ne)),j.left,j.left&&j.left.lastId,j.right,j.right&&j.right.id,B,null,new ContentString(ie)),j.right.integrate(q,0),j.forward()}insertNegatedAttributes(q,B,j,re)},cleanupFormattingGap=(q,B,j,X,ee)=>{let te=j;const ne=copy(ee);for(;te&&(!te.countable||te.deleted);)!te.deleted&&te.content.constructor===ContentFormat&&updateCurrentAttributes(ne,te.content),te=te.right;let re=0,ie=!1;for(;B!==te;){if(j===B&&(ie=!0),!B.deleted){const fe=B.content;switch(fe.constructor){case ContentFormat:{const{key:ce,value:se}=fe;((ne.get(ce)||null)!==se||(X.get(ce)||null)===se)&&(B.delete(q),re++,!ie&&(ee.get(ce)||null)===se&&(X.get(ce)||null)!==se&&ee.delete(ce));break}}}B=B.right}return re},cleanupContextlessFormattingGap=(q,B)=>{for(;B&&B.right&&(B.right.deleted||!B.right.countable);)B=B.right;const j=new Set;for(;B&&(B.deleted||!B.countable);){if(!B.deleted&&B.content.constructor===ContentFormat){const X=B.content.key;j.has(X)?B.delete(q):j.add(X)}B=B.left}},cleanupYTextFormatting=q=>{let B=0;return transact$1(q.doc,j=>{let X=q._start,ee=q._start,te=create$5();const ne=copy(te);for(;ee;){if(ee.deleted===!1)switch(ee.content.constructor){case ContentFormat:updateCurrentAttributes(ne,ee.content);break;default:B+=cleanupFormattingGap(j,X,ee,te,ne),te=copy(ne),X=ee;break}ee=ee.right}}),B},deleteText=(q,B,j)=>{const X=j,ee=copy(B.currentAttributes),te=B.right;for(;j>0&&B.right!==null;){if(B.right.deleted===!1)switch(B.right.content.constructor){case ContentType:case ContentEmbed:case ContentString:j<B.right.length&&getItemCleanStart(q,createID(B.right.id.client,B.right.id.clock+j)),j-=B.right.length,B.right.delete(q);break}B.forward()}te&&cleanupFormattingGap(q,te,B.right,ee,B.currentAttributes);const ne=(B.left||B.right).parent;return ne._searchMarker&&updateMarkerChanges(ne._searchMarker,B.index,-X+j),B};class YTextEvent extends YEvent{constructor(B,j,X){super(B,j),this.childListChanged=!1,this.keysChanged=new Set,X.forEach(ee=>{ee===null?this.childListChanged=!0:this.keysChanged.add(ee)})}get changes(){if(this._changes===null){const B={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=B}return this._changes}get delta(){if(this._delta===null){const B=this.target.doc,j=[];transact$1(B,X=>{const ee=new Map,te=new Map;let ne=this.target._start,re=null;const ie={};let fe="",ce=0,se=0;const oe=()=>{if(re!==null){let ae;switch(re){case"delete":ae={delete:se},se=0;break;case"insert":ae={insert:fe},ee.size>0&&(ae.attributes={},ee.forEach((le,pe)=>{le!==null&&(ae.attributes[pe]=le)})),fe="";break;case"retain":if(ae={retain:ce},Object.keys(ie).length>0){ae.attributes={};for(const le in ie)ae.attributes[le]=ie[le]}ce=0;break}j.push(ae),re=null}};for(;ne!==null;){switch(ne.content.constructor){case ContentType:case ContentEmbed:this.adds(ne)?this.deletes(ne)||(oe(),re="insert",fe=ne.content.getContent()[0],oe()):this.deletes(ne)?(re!=="delete"&&(oe(),re="delete"),se+=1):ne.deleted||(re!=="retain"&&(oe(),re="retain"),ce+=1);break;case ContentString:this.adds(ne)?this.deletes(ne)||(re!=="insert"&&(oe(),re="insert"),fe+=ne.content.str):this.deletes(ne)?(re!=="delete"&&(oe(),re="delete"),se+=ne.length):ne.deleted||(re!=="retain"&&(oe(),re="retain"),ce+=ne.length);break;case ContentFormat:{const{key:ae,value:le}=ne.content;if(this.adds(ne)){if(!this.deletes(ne)){const pe=ee.get(ae)||null;equalAttrs(pe,le)?le!==null&&ne.delete(X):(re==="retain"&&oe(),equalAttrs(le,te.get(ae)||null)?delete ie[ae]:ie[ae]=le)}}else if(this.deletes(ne)){te.set(ae,le);const pe=ee.get(ae)||null;equalAttrs(pe,le)||(re==="retain"&&oe(),ie[ae]=pe)}else if(!ne.deleted){te.set(ae,le);const pe=ie[ae];pe!==void 0&&(equalAttrs(pe,le)?pe!==null&&ne.delete(X):(re==="retain"&&oe(),le===null?delete ie[ae]:ie[ae]=le))}ne.deleted||(re==="insert"&&oe(),updateCurrentAttributes(ee,ne.content));break}}ne=ne.right}for(oe();j.length>0;){const ae=j[j.length-1];if(ae.retain!==void 0&&ae.attributes===void 0)j.pop();else break}}),this._delta=j}return this._delta}}class YText extends AbstractType{constructor(B){super(),this._pending=B!==void 0?[()=>this.insert(0,B)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(B,j){super._integrate(B,j);try{this._pending.forEach(X=>X())}catch(X){console.error(X)}this._pending=null}_copy(){return new YText}clone(){const B=new YText;return B.applyDelta(this.toDelta()),B}_callObserver(B,j){super._callObserver(B,j);const X=new YTextEvent(this,B,j),ee=B.doc;if(callTypeObservers(this,B,X),!B.local){let te=!1;for(const[ne,re]of B.afterState.entries()){const ie=B.beforeState.get(ne)||0;if(re!==ie&&(iterateStructs(B,ee.store.clients.get(ne),ie,re,fe=>{!fe.deleted&&fe.content.constructor===ContentFormat&&(te=!0)}),te))break}te||iterateDeletedStructs(B,B.deleteSet,ne=>{ne instanceof GC||te||ne.parent===this&&ne.content.constructor===ContentFormat&&(te=!0)}),transact$1(ee,ne=>{te?cleanupYTextFormatting(this):iterateDeletedStructs(ne,ne.deleteSet,re=>{re instanceof GC||re.parent===this&&cleanupContextlessFormattingGap(ne,re)})})}}toString(){let B="",j=this._start;for(;j!==null;)!j.deleted&&j.countable&&j.content.constructor===ContentString&&(B+=j.content.str),j=j.right;return B}toJSON(){return this.toString()}applyDelta(B,{sanitize:j=!0}={}){this.doc!==null?transact$1(this.doc,X=>{const ee=new ItemTextListPosition(null,this._start,0,new Map);for(let te=0;te<B.length;te++){const ne=B[te];if(ne.insert!==void 0){const re=!j&&typeof ne.insert=="string"&&te===B.length-1&&ee.right===null&&ne.insert.slice(-1)===`
`?ne.insert.slice(0,-1):ne.insert;(typeof re!="string"||re.length>0)&&insertText(X,this,ee,re,ne.attributes||{})}else ne.retain!==void 0?formatText(X,this,ee,ne.retain,ne.attributes||{}):ne.delete!==void 0&&deleteText(X,ee,ne.delete)}}):this._pending.push(()=>this.applyDelta(B))}toDelta(B,j,X){const ee=[],te=new Map,ne=this.doc;let re="",ie=this._start;function fe(){if(re.length>0){const ce={};let se=!1;te.forEach((ae,le)=>{se=!0,ce[le]=ae});const oe={insert:re};se&&(oe.attributes=ce),ee.push(oe),re=""}}return transact$1(ne,ce=>{for(B&&splitSnapshotAffectedStructs(ce,B),j&&splitSnapshotAffectedStructs(ce,j);ie!==null;){if(isVisible(ie,B)||j!==void 0&&isVisible(ie,j))switch(ie.content.constructor){case ContentString:{const se=te.get("ychange");B!==void 0&&!isVisible(ie,B)?(se===void 0||se.user!==ie.id.client||se.state!=="removed")&&(fe(),te.set("ychange",X?X("removed",ie.id):{type:"removed"})):j!==void 0&&!isVisible(ie,j)?(se===void 0||se.user!==ie.id.client||se.state!=="added")&&(fe(),te.set("ychange",X?X("added",ie.id):{type:"added"})):se!==void 0&&(fe(),te.delete("ychange")),re+=ie.content.str;break}case ContentType:case ContentEmbed:{fe();const se={insert:ie.content.getContent()[0]};if(te.size>0){const oe={};se.attributes=oe,te.forEach((ae,le)=>{oe[le]=ae})}ee.push(se);break}case ContentFormat:isVisible(ie,B)&&(fe(),updateCurrentAttributes(te,ie.content));break}ie=ie.right}fe()},splitSnapshotAffectedStructs),ee}insert(B,j,X){if(j.length<=0)return;const ee=this.doc;ee!==null?transact$1(ee,te=>{const ne=findPosition(te,this,B);X||(X={},ne.currentAttributes.forEach((re,ie)=>{X[ie]=re})),insertText(te,this,ne,j,X)}):this._pending.push(()=>this.insert(B,j,X))}insertEmbed(B,j,X={}){const ee=this.doc;ee!==null?transact$1(ee,te=>{const ne=findPosition(te,this,B);insertText(te,this,ne,j,X)}):this._pending.push(()=>this.insertEmbed(B,j,X))}delete(B,j){if(j===0)return;const X=this.doc;X!==null?transact$1(X,ee=>{deleteText(ee,findPosition(ee,this,B),j)}):this._pending.push(()=>this.delete(B,j))}format(B,j,X){if(j===0)return;const ee=this.doc;ee!==null?transact$1(ee,te=>{const ne=findPosition(te,this,B);ne.right!==null&&formatText(te,this,ne,j,X)}):this._pending.push(()=>this.format(B,j,X))}removeAttribute(B){this.doc!==null?transact$1(this.doc,j=>{typeMapDelete(j,this,B)}):this._pending.push(()=>this.removeAttribute(B))}setAttribute(B,j){this.doc!==null?transact$1(this.doc,X=>{typeMapSet(X,this,B,j)}):this._pending.push(()=>this.setAttribute(B,j))}getAttribute(B){return typeMapGet(this,B)}getAttributes(B){return typeMapGetAll(this)}_write(B){B.writeTypeRef(YTextRefID)}}const readYText=q=>new YText;class YXmlTreeWalker{constructor(B,j=()=>!0){this._filter=j,this._root=B,this._currentNode=B._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let B=this._currentNode,j=B&&B.content&&B.content.type;if(B!==null&&(!this._firstCall||B.deleted||!this._filter(j)))do if(j=B.content.type,!B.deleted&&(j.constructor===YXmlElement||j.constructor===YXmlFragment)&&j._start!==null)B=j._start;else for(;B!==null;)if(B.right!==null){B=B.right;break}else B.parent===this._root?B=null:B=B.parent._item;while(B!==null&&(B.deleted||!this._filter(B.content.type)));return this._firstCall=!1,B===null?{value:void 0,done:!0}:(this._currentNode=B,{value:B.content.type,done:!1})}}class YXmlFragment extends AbstractType{constructor(){super(),this._prelimContent=[]}get firstChild(){const B=this._first;return B?B.content.getContent()[0]:null}_integrate(B,j){super._integrate(B,j),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new YXmlFragment}clone(){const B=new YXmlFragment;return B.insert(0,this.toArray().map(j=>j instanceof AbstractType?j.clone():j)),B}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(B){return new YXmlTreeWalker(this,B)}querySelector(B){B=B.toUpperCase();const X=new YXmlTreeWalker(this,ee=>ee.nodeName&&ee.nodeName.toUpperCase()===B).next();return X.done?null:X.value}querySelectorAll(B){return B=B.toUpperCase(),Array.from(new YXmlTreeWalker(this,j=>j.nodeName&&j.nodeName.toUpperCase()===B))}_callObserver(B,j){callTypeObservers(this,B,new YXmlEvent(this,j,B))}toString(){return typeListMap(this,B=>B.toString()).join("")}toJSON(){return this.toString()}toDOM(B=document,j={},X){const ee=B.createDocumentFragment();return X!==void 0&&X._createAssociation(ee,this),typeListForEach(this,te=>{ee.insertBefore(te.toDOM(B,j,X),null)}),ee}insert(B,j){this.doc!==null?transact$1(this.doc,X=>{typeListInsertGenerics(X,this,B,j)}):this._prelimContent.splice(B,0,...j)}insertAfter(B,j){if(this.doc!==null)transact$1(this.doc,X=>{const ee=B&&B instanceof AbstractType?B._item:B;typeListInsertGenericsAfter(X,this,ee,j)});else{const X=this._prelimContent,ee=B===null?0:X.findIndex(te=>te===B)+1;if(ee===0&&B!==null)throw create$2("Reference item not found");X.splice(ee,0,...j)}}delete(B,j=1){this.doc!==null?transact$1(this.doc,X=>{typeListDelete(X,this,B,j)}):this._prelimContent.splice(B,j)}toArray(){return typeListToArray(this)}push(B){this.insert(this.length,B)}unshift(B){this.insert(0,B)}get(B){return typeListGet(this,B)}slice(B=0,j=this.length){return typeListSlice(this,B,j)}forEach(B){typeListForEach(this,B)}_write(B){B.writeTypeRef(YXmlFragmentRefID)}}const readYXmlFragment=q=>new YXmlFragment;class YXmlElement extends YXmlFragment{constructor(B="UNDEFINED"){super(),this.nodeName=B,this._prelimAttrs=new Map}get nextSibling(){const B=this._item?this._item.next:null;return B?B.content.type:null}get prevSibling(){const B=this._item?this._item.prev:null;return B?B.content.type:null}_integrate(B,j){super._integrate(B,j),this._prelimAttrs.forEach((X,ee)=>{this.setAttribute(ee,X)}),this._prelimAttrs=null}_copy(){return new YXmlElement(this.nodeName)}clone(){const B=new YXmlElement(this.nodeName),j=this.getAttributes();for(const X in j)B.setAttribute(X,j[X]);return B.insert(0,this.toArray().map(X=>X instanceof AbstractType?X.clone():X)),B}toString(){const B=this.getAttributes(),j=[],X=[];for(const re in B)X.push(re);X.sort();const ee=X.length;for(let re=0;re<ee;re++){const ie=X[re];j.push(ie+'="'+B[ie]+'"')}const te=this.nodeName.toLocaleLowerCase(),ne=j.length>0?" "+j.join(" "):"";return`<${te}${ne}>${super.toString()}</${te}>`}removeAttribute(B){this.doc!==null?transact$1(this.doc,j=>{typeMapDelete(j,this,B)}):this._prelimAttrs.delete(B)}setAttribute(B,j){this.doc!==null?transact$1(this.doc,X=>{typeMapSet(X,this,B,j)}):this._prelimAttrs.set(B,j)}getAttribute(B){return typeMapGet(this,B)}hasAttribute(B){return typeMapHas(this,B)}getAttributes(B){return typeMapGetAll(this)}toDOM(B=document,j={},X){const ee=B.createElement(this.nodeName),te=this.getAttributes();for(const ne in te)ee.setAttribute(ne,te[ne]);return typeListForEach(this,ne=>{ee.appendChild(ne.toDOM(B,j,X))}),X!==void 0&&X._createAssociation(ee,this),ee}_write(B){B.writeTypeRef(YXmlElementRefID),B.writeKey(this.nodeName)}}const readYXmlElement=q=>new YXmlElement(q.readKey());class YXmlEvent extends YEvent{constructor(B,j,X){super(B,X),this.childListChanged=!1,this.attributesChanged=new Set,j.forEach(ee=>{ee===null?this.childListChanged=!0:this.attributesChanged.add(ee)})}}class YXmlHook extends YMap{constructor(B){super(),this.hookName=B}_copy(){return new YXmlHook(this.hookName)}clone(){const B=new YXmlHook(this.hookName);return this.forEach((j,X)=>{B.set(X,j)}),B}toDOM(B=document,j={},X){const ee=j[this.hookName];let te;return ee!==void 0?te=ee.createDom(this):te=document.createElement(this.hookName),te.setAttribute("data-yjs-hook",this.hookName),X!==void 0&&X._createAssociation(te,this),te}_write(B){B.writeTypeRef(YXmlHookRefID),B.writeKey(this.hookName)}}const readYXmlHook=q=>new YXmlHook(q.readKey());class YXmlText extends YText{get nextSibling(){const B=this._item?this._item.next:null;return B?B.content.type:null}get prevSibling(){const B=this._item?this._item.prev:null;return B?B.content.type:null}_copy(){return new YXmlText}clone(){const B=new YXmlText;return B.applyDelta(this.toDelta()),B}toDOM(B=document,j,X){const ee=B.createTextNode(this.toString());return X!==void 0&&X._createAssociation(ee,this),ee}toString(){return this.toDelta().map(B=>{const j=[];for(const ee in B.attributes){const te=[];for(const ne in B.attributes[ee])te.push({key:ne,value:B.attributes[ee][ne]});te.sort((ne,re)=>ne.key<re.key?-1:1),j.push({nodeName:ee,attrs:te})}j.sort((ee,te)=>ee.nodeName<te.nodeName?-1:1);let X="";for(let ee=0;ee<j.length;ee++){const te=j[ee];X+=`<${te.nodeName}`;for(let ne=0;ne<te.attrs.length;ne++){const re=te.attrs[ne];X+=` ${re.key}="${re.value}"`}X+=">"}X+=B.insert;for(let ee=j.length-1;ee>=0;ee--)X+=`</${j[ee].nodeName}>`;return X}).join("")}toJSON(){return this.toString()}_write(B){B.writeTypeRef(YXmlTextRefID)}}const readYXmlText=q=>new YXmlText;class AbstractStruct{constructor(B,j){this.id=B,this.length=j}get deleted(){throw methodUnimplemented()}mergeWith(B){return!1}write(B,j,X){throw methodUnimplemented()}integrate(B,j){throw methodUnimplemented()}}const structGCRefNumber=0;class GC extends AbstractStruct{get deleted(){return!0}delete(){}mergeWith(B){return this.constructor!==B.constructor?!1:(this.length+=B.length,!0)}integrate(B,j){j>0&&(this.id.clock+=j,this.length-=j),addStruct(B.doc.store,this)}write(B,j){B.writeInfo(structGCRefNumber),B.writeLen(this.length-j)}getMissing(B,j){return null}}class ContentBinary{constructor(B){this.content=B}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ContentBinary(this.content)}splice(B){throw methodUnimplemented()}mergeWith(B){return!1}integrate(B,j){}delete(B){}gc(B){}write(B,j){B.writeBuf(this.content)}getRef(){return 3}}const readContentBinary=q=>new ContentBinary(q.readBuf());class ContentDeleted{constructor(B){this.len=B}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ContentDeleted(this.len)}splice(B){const j=new ContentDeleted(this.len-B);return this.len=B,j}mergeWith(B){return this.len+=B.len,!0}integrate(B,j){addToDeleteSet(B.deleteSet,j.id.client,j.id.clock,this.len),j.markDeleted()}delete(B){}gc(B){}write(B,j){B.writeLen(this.len-j)}getRef(){return 1}}const readContentDeleted=q=>new ContentDeleted(q.readLen()),createDocFromOpts=(q,B)=>new Doc({guid:q,...B,shouldLoad:B.shouldLoad||B.autoLoad||!1});class ContentDoc{constructor(B){B._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=B;const j={};this.opts=j,B.gc||(j.gc=!1),B.autoLoad&&(j.autoLoad=!0),B.meta!==null&&(j.meta=B.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ContentDoc(createDocFromOpts(this.doc.guid,this.opts))}splice(B){throw methodUnimplemented()}mergeWith(B){return!1}integrate(B,j){this.doc._item=j,B.subdocsAdded.add(this.doc),this.doc.shouldLoad&&B.subdocsLoaded.add(this.doc)}delete(B){B.subdocsAdded.has(this.doc)?B.subdocsAdded.delete(this.doc):B.subdocsRemoved.add(this.doc)}gc(B){}write(B,j){B.writeString(this.doc.guid),B.writeAny(this.opts)}getRef(){return 9}}const readContentDoc=q=>new ContentDoc(createDocFromOpts(q.readString(),q.readAny()));class ContentEmbed{constructor(B){this.embed=B}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ContentEmbed(this.embed)}splice(B){throw methodUnimplemented()}mergeWith(B){return!1}integrate(B,j){}delete(B){}gc(B){}write(B,j){B.writeJSON(this.embed)}getRef(){return 5}}const readContentEmbed=q=>new ContentEmbed(q.readJSON());class ContentFormat{constructor(B,j){this.key=B,this.value=j}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ContentFormat(this.key,this.value)}splice(B){throw methodUnimplemented()}mergeWith(B){return!1}integrate(B,j){j.parent._searchMarker=null}delete(B){}gc(B){}write(B,j){B.writeKey(this.key),B.writeJSON(this.value)}getRef(){return 6}}const readContentFormat=q=>new ContentFormat(q.readKey(),q.readJSON());class ContentJSON{constructor(B){this.arr=B}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentJSON(this.arr)}splice(B){const j=new ContentJSON(this.arr.slice(B));return this.arr=this.arr.slice(0,B),j}mergeWith(B){return this.arr=this.arr.concat(B.arr),!0}integrate(B,j){}delete(B){}gc(B){}write(B,j){const X=this.arr.length;B.writeLen(X-j);for(let ee=j;ee<X;ee++){const te=this.arr[ee];B.writeString(te===void 0?"undefined":JSON.stringify(te))}}getRef(){return 2}}const readContentJSON=q=>{const B=q.readLen(),j=[];for(let X=0;X<B;X++){const ee=q.readString();ee==="undefined"?j.push(void 0):j.push(JSON.parse(ee))}return new ContentJSON(j)};class ContentAny{constructor(B){this.arr=B}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentAny(this.arr)}splice(B){const j=new ContentAny(this.arr.slice(B));return this.arr=this.arr.slice(0,B),j}mergeWith(B){return this.arr=this.arr.concat(B.arr),!0}integrate(B,j){}delete(B){}gc(B){}write(B,j){const X=this.arr.length;B.writeLen(X-j);for(let ee=j;ee<X;ee++){const te=this.arr[ee];B.writeAny(te)}}getRef(){return 8}}const readContentAny=q=>{const B=q.readLen(),j=[];for(let X=0;X<B;X++)j.push(q.readAny());return new ContentAny(j)};class ContentString{constructor(B){this.str=B}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ContentString(this.str)}splice(B){const j=new ContentString(this.str.slice(B));this.str=this.str.slice(0,B);const X=this.str.charCodeAt(B-1);return X>=55296&&X<=56319&&(this.str=this.str.slice(0,B-1)+"\uFFFD",j.str="\uFFFD"+j.str.slice(1)),j}mergeWith(B){return this.str+=B.str,!0}integrate(B,j){}delete(B){}gc(B){}write(B,j){B.writeString(j===0?this.str:this.str.slice(j))}getRef(){return 4}}const readContentString=q=>new ContentString(q.readString()),typeRefs=[readYArray,readYMap,readYText,readYXmlElement,readYXmlFragment,readYXmlHook,readYXmlText],YArrayRefID=0,YMapRefID=1,YTextRefID=2,YXmlElementRefID=3,YXmlFragmentRefID=4,YXmlHookRefID=5,YXmlTextRefID=6;class ContentType{constructor(B){this.type=B}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ContentType(this.type._copy())}splice(B){throw methodUnimplemented()}mergeWith(B){return!1}integrate(B,j){this.type._integrate(B.doc,j)}delete(B){let j=this.type._start;for(;j!==null;)j.deleted?B._mergeStructs.push(j):j.delete(B),j=j.right;this.type._map.forEach(X=>{X.deleted?B._mergeStructs.push(X):X.delete(B)}),B.changed.delete(this.type)}gc(B){let j=this.type._start;for(;j!==null;)j.gc(B,!0),j=j.right;this.type._start=null,this.type._map.forEach(X=>{for(;X!==null;)X.gc(B,!0),X=X.left}),this.type._map=new Map}write(B,j){this.type._write(B)}getRef(){return 7}}const readContentType=q=>new ContentType(typeRefs[q.readTypeRef()](q)),followRedone=(q,B)=>{let j=B,X=0,ee;do X>0&&(j=createID(j.client,j.clock+X)),ee=getItem(q,j),X=j.clock-ee.id.clock,j=ee.redone;while(j!==null&&ee instanceof Item);return{item:ee,diff:X}},keepItem=(q,B)=>{for(;q!==null&&q.keep!==B;)q.keep=B,q=q.parent._item},splitItem=(q,B,j)=>{const{client:X,clock:ee}=B.id,te=new Item(createID(X,ee+j),B,createID(X,ee+j-1),B.right,B.rightOrigin,B.parent,B.parentSub,B.content.splice(j));return B.deleted&&te.markDeleted(),B.keep&&(te.keep=!0),B.redone!==null&&(te.redone=createID(B.redone.client,B.redone.clock+j)),B.right=te,te.right!==null&&(te.right.left=te),q._mergeStructs.push(te),te.parentSub!==null&&te.right===null&&te.parent._map.set(te.parentSub,te),B.length=j,te},redoItem=(q,B,j,X,ee)=>{const te=q.doc,ne=te.store,re=te.clientID,ie=B.redone;if(ie!==null)return getItemCleanStart(q,ie);let fe=B.parent._item,ce=null,se;if(fe!==null&&fe.deleted===!0){if(fe.redone===null&&(!j.has(fe)||redoItem(q,fe,j,X,ee)===null))return null;for(;fe.redone!==null;)fe=getItemCleanStart(q,fe.redone)}const oe=fe===null?B.parent:fe.content.type;if(B.parentSub===null){for(ce=B.left,se=B;ce!==null;){let ve=ce;for(;ve!==null&&ve.parent._item!==fe;)ve=ve.redone===null?null:getItemCleanStart(q,ve.redone);if(ve!==null&&ve.parent._item===fe){ce=ve;break}ce=ce.left}for(;se!==null;){let ve=se;for(;ve!==null&&ve.parent._item!==fe;)ve=ve.redone===null?null:getItemCleanStart(q,ve.redone);if(ve!==null&&ve.parent._item===fe){se=ve;break}se=se.right}}else if(se=null,B.right&&!ee){for(ce=B;ce!==null&&ce.right!==null&&isDeleted(X,ce.right.id);)ce=ce.right;for(;ce!==null&&ce.redone!==null;)ce=getItemCleanStart(q,ce.redone);if(ce&&ce.right!==null)return null}else ce=oe._map.get(B.parentSub)||null;const ae=getState(ne,re),le=createID(re,ae),pe=new Item(le,ce,ce&&ce.lastId,se,se&&se.id,oe,B.parentSub,B.content.copy());return B.redone=le,keepItem(pe,!0),pe.integrate(q,0),pe};class Item extends AbstractStruct{constructor(B,j,X,ee,te,ne,re,ie){super(B,ie.getLength()),this.origin=X,this.left=j,this.right=ee,this.rightOrigin=te,this.parent=ne,this.parentSub=re,this.redone=null,this.content=ie,this.info=this.content.isCountable()?BIT2:0}set marker(B){(this.info&BIT4)>0!==B&&(this.info^=BIT4)}get marker(){return(this.info&BIT4)>0}get keep(){return(this.info&BIT1)>0}set keep(B){this.keep!==B&&(this.info^=BIT1)}get countable(){return(this.info&BIT2)>0}get deleted(){return(this.info&BIT3)>0}set deleted(B){this.deleted!==B&&(this.info^=BIT3)}markDeleted(){this.info|=BIT3}getMissing(B,j){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=getState(j,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=getState(j,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ID&&this.id.client!==this.parent.client&&this.parent.clock>=getState(j,this.parent.client))return this.parent.client;if(this.origin&&(this.left=getItemCleanEnd(B,j,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=getItemCleanStart(B,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===GC||this.right&&this.right.constructor===GC)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===Item&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Item&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ID){const X=getItem(j,this.parent);X.constructor===GC?this.parent=null:this.parent=X.content.type}return null}integrate(B,j){if(j>0&&(this.id.clock+=j,this.left=getItemCleanEnd(B,B.doc.store,createID(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(j),this.length-=j),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let X=this.left,ee;if(X!==null)ee=X.right;else if(this.parentSub!==null)for(ee=this.parent._map.get(this.parentSub)||null;ee!==null&&ee.left!==null;)ee=ee.left;else ee=this.parent._start;const te=new Set,ne=new Set;for(;ee!==null&&ee!==this.right;){if(ne.add(ee),te.add(ee),compareIDs(this.origin,ee.origin)){if(ee.id.client<this.id.client)X=ee,te.clear();else if(compareIDs(this.rightOrigin,ee.rightOrigin))break}else if(ee.origin!==null&&ne.has(getItem(B.doc.store,ee.origin)))te.has(getItem(B.doc.store,ee.origin))||(X=ee,te.clear());else break;ee=ee.right}this.left=X}if(this.left!==null){const X=this.left.right;this.right=X,this.left.right=this}else{let X;if(this.parentSub!==null)for(X=this.parent._map.get(this.parentSub)||null;X!==null&&X.left!==null;)X=X.left;else X=this.parent._start,this.parent._start=this;this.right=X}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(B)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),addStruct(B.doc.store,this),this.content.integrate(B,this),addChangedTypeToTransaction(B,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(B)}else new GC(this.id,this.length).integrate(B,0)}get next(){let B=this.right;for(;B!==null&&B.deleted;)B=B.right;return B}get prev(){let B=this.left;for(;B!==null&&B.deleted;)B=B.left;return B}get lastId(){return this.length===1?this.id:createID(this.id.client,this.id.clock+this.length-1)}mergeWith(B){if(this.constructor===B.constructor&&compareIDs(B.origin,this.lastId)&&this.right===B&&compareIDs(this.rightOrigin,B.rightOrigin)&&this.id.client===B.id.client&&this.id.clock+this.length===B.id.clock&&this.deleted===B.deleted&&this.redone===null&&B.redone===null&&this.content.constructor===B.content.constructor&&this.content.mergeWith(B.content)){const j=this.parent._searchMarker;return j&&j.forEach(X=>{X.p===B&&(X.p=this,!this.deleted&&this.countable&&(X.index-=this.length))}),B.keep&&(this.keep=!0),this.right=B.right,this.right!==null&&(this.right.left=this),this.length+=B.length,!0}return!1}delete(B){if(!this.deleted){const j=this.parent;this.countable&&this.parentSub===null&&(j._length-=this.length),this.markDeleted(),addToDeleteSet(B.deleteSet,this.id.client,this.id.clock,this.length),addChangedTypeToTransaction(B,j,this.parentSub),this.content.delete(B)}}gc(B,j){if(!this.deleted)throw unexpectedCase();this.content.gc(B),j?replaceStruct(B,this,new GC(this.id,this.length)):this.content=new ContentDeleted(this.length)}write(B,j){const X=j>0?createID(this.id.client,this.id.clock+j-1):this.origin,ee=this.rightOrigin,te=this.parentSub,ne=this.content.getRef()&BITS5|(X===null?0:BIT8)|(ee===null?0:BIT7)|(te===null?0:BIT6);if(B.writeInfo(ne),X!==null&&B.writeLeftID(X),ee!==null&&B.writeRightID(ee),X===null&&ee===null){const re=this.parent;if(re._item!==void 0){const ie=re._item;if(ie===null){const fe=findRootTypeKey(re);B.writeParentInfo(!0),B.writeString(fe)}else B.writeParentInfo(!1),B.writeLeftID(ie.id)}else re.constructor===String?(B.writeParentInfo(!0),B.writeString(re)):re.constructor===ID?(B.writeParentInfo(!1),B.writeLeftID(re)):unexpectedCase();te!==null&&B.writeString(te)}this.content.write(B,j)}}const readItemContent=(q,B)=>contentRefs[B&BITS5](q),contentRefs=[()=>{unexpectedCase()},readContentDeleted,readContentJSON,readContentBinary,readContentString,readContentEmbed,readContentFormat,readContentType,readContentAny,readContentDoc,()=>{unexpectedCase()}],structSkipRefNumber=10;class Skip extends AbstractStruct{get deleted(){return!0}delete(){}mergeWith(B){return this.constructor!==B.constructor?!1:(this.length+=B.length,!0)}integrate(B,j){unexpectedCase()}write(B,j){B.writeInfo(structSkipRefNumber),writeVarUint(B.restEncoder,this.length-j)}getMissing(B,j){return null}}const glo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},importIdentifier$3="__ $YJS$ __";glo[importIdentifier$3]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");glo[importIdentifier$3]=!0;const outdatedTimeout=3e4;class Awareness extends Observable{constructor(B){super(),this.doc=B,this.clientID=B.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const j=getUnixTime();this.getLocalState()!==null&&outdatedTimeout/2<=j-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const X=[];this.meta.forEach((ee,te)=>{te!==this.clientID&&outdatedTimeout<=j-ee.lastUpdated&&this.states.has(te)&&X.push(te)}),X.length>0&&removeAwarenessStates(this,X,"timeout")},floor(outdatedTimeout/10)),B.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(B){const j=this.clientID,X=this.meta.get(j),ee=X===void 0?0:X.clock+1,te=this.states.get(j);B===null?this.states.delete(j):this.states.set(j,B),this.meta.set(j,{clock:ee,lastUpdated:getUnixTime()});const ne=[],re=[],ie=[],fe=[];B===null?fe.push(j):te==null?B!=null&&ne.push(j):(re.push(j),equalityDeep(te,B)||ie.push(j)),(ne.length>0||ie.length>0||fe.length>0)&&this.emit("change",[{added:ne,updated:ie,removed:fe},"local"]),this.emit("update",[{added:ne,updated:re,removed:fe},"local"])}setLocalStateField(B,j){const X=this.getLocalState();X!==null&&this.setLocalState({...X,[B]:j})}getStates(){return this.states}}const removeAwarenessStates=(q,B,j)=>{const X=[];for(let ee=0;ee<B.length;ee++){const te=B[ee];if(q.states.has(te)){if(q.states.delete(te),te===q.clientID){const ne=q.meta.get(te);q.meta.set(te,{clock:ne.clock+1,lastUpdated:getUnixTime()})}X.push(te)}}X.length>0&&(q.emit("change",[{added:[],updated:[],removed:X},j]),q.emit("update",[{added:[],updated:[],removed:X},j]))},encodeAwarenessUpdate=(q,B,j=q.states)=>{const X=B.length,ee=createEncoder();writeVarUint(ee,X);for(let te=0;te<X;te++){const ne=B[te],re=j.get(ne)||null,ie=q.meta.get(ne).clock;writeVarUint(ee,ne),writeVarUint(ee,ie),writeVarString(ee,JSON.stringify(re))}return toUint8Array(ee)},applyAwarenessUpdate=(q,B,j)=>{const X=createDecoder(B),ee=getUnixTime(),te=[],ne=[],re=[],ie=[],fe=readVarUint(X);for(let ce=0;ce<fe;ce++){const se=readVarUint(X);let oe=readVarUint(X);const ae=JSON.parse(readVarString(X)),le=q.meta.get(se),pe=q.states.get(se),ve=le===void 0?0:le.clock;(ve<oe||ve===oe&&ae===null&&q.states.has(se))&&(ae===null?se===q.clientID&&q.getLocalState()!=null?oe++:q.states.delete(se):q.states.set(se,ae),q.meta.set(se,{clock:oe,lastUpdated:ee}),le===void 0&&ae!==null?te.push(se):le!==void 0&&ae===null?ie.push(se):ae!==null&&(equalityDeep(ae,pe)||re.push(se),ne.push(se)))}(te.length>0||re.length>0||ie.length>0)&&q.emit("change",[{added:te,updated:re,removed:ie},j]),(te.length>0||ne.length>0||ie.length>0)&&q.emit("update",[{added:te,updated:ne,removed:ie},j])};function flattenDisposable(q){return{dispose:()=>{q.forEach(B=>{try{B.dispose()}catch(j){console.error(j)}}),q.length=0}}}class Signal{constructor(){this.emitting=!1,this.callbacks=[],this.disposables=[]}static fromEvent(B,j,X){const ee=new Signal,te=ne=>{ee.emit(ne)};return B.addEventListener(j,te,X),ee.disposables.push({dispose:()=>{B.removeEventListener(j,te)}}),ee}filter(B){const j=new Signal;return j.disposables.push({dispose:()=>this.dispose()}),this.on(X=>{B(X)&&j.emit(X)}),j}on(B){if(this.emitting){const j=[...this.callbacks,B];this.callbacks=j}else this.callbacks.push(B);return{dispose:()=>{if(this.emitting)this.callbacks=this.callbacks.filter(j=>j!==B);else{const j=this.callbacks.indexOf(B);j>-1&&this.callbacks.splice(j,1)}}}}once(B){let j;const X=ee=>{B(ee),j&&j()};j=this.on(X).dispose}unshift(B){if(this.emitting){const j=[B,...this.callbacks];this.callbacks=j}else this.callbacks.unshift(B);return{dispose:()=>{if(this.emitting)this.callbacks=this.callbacks.filter(j=>j!==B);else{const j=this.callbacks.indexOf(B);j>-1&&this.callbacks.splice(j,1)}}}}emit(B){const j=this.emitting;this.emitting=!0,this.callbacks.forEach(X=>{try{X(B)}catch(ee){console.error(ee)}}),this.emitting=j}pipe(B){return this.callbacks.push(j=>B.emit(j)),this}dispose(){flattenDisposable(this.disposables).dispose(),this.callbacks.length=0}toDispose(B){return B.push(this),this}}class AwarenessAdapter{constructor(B,j){this.signals={update:new Signal},this._onAwarenessChange=X=>{const{added:ee,removed:te,updated:ne}=X,re=this.awareness.getStates();ee.forEach(ie=>{this.signals.update.emit({id:ie,type:"add",state:re.get(ie)})}),ne.forEach(ie=>{this.signals.update.emit({id:ie,type:"update",state:re.get(ie)})}),te.forEach(ie=>{this.signals.update.emit({id:ie,type:"remove"})})},this._onAwarenessMessage=X=>{X.id===this.awareness.clientID?this.updateLocalCursor():this._resetRemoteCursor()},this.space=B,this.awareness=j,this.awareness.on("change",this._onAwarenessChange),this.signals.update.on(this._onAwarenessMessage)}setLocalCursor(B){this.awareness.setLocalStateField("cursor",B)}getLocalCursor(){const j=this.awareness.getStates().get(this.awareness.clientID);return j==null?void 0:j.cursor}getStates(){return this.awareness.getStates()}_resetRemoteCursor(){this.space.richTextAdapters.forEach(B=>B.quillCursors.clearCursors()),this.getStates().forEach((B,j)=>{if(j!==this.awareness.clientID&&B.cursor){const X=createAbsolutePositionFromRelativePosition(B.cursor.anchor,this.space.doc),ee=createAbsolutePositionFromRelativePosition(B.cursor.focus,this.space.doc),te=this.space.richTextAdapters.get(B.cursor.id||"");if(X&&ee&&te){const ne=B.user||{},re=ne.color||"#ffa500",ie=ne.name||"other";te.quillCursors.createCursor(j.toString(),ie,re),te.quillCursors.moveCursor(j.toString(),{index:X.index,length:ee.index-X.index})}}})}updateLocalCursor(){const B=this.space.awareness.getLocalCursor();if(!B)return;const j=createAbsolutePositionFromRelativePosition(B.anchor,this.space.doc),X=createAbsolutePositionFromRelativePosition(B.focus,this.space.doc);if(j&&X){const ee=this.space.richTextAdapters.get(B.id||"");ee==null||ee.quill.setSelection(j.index,X.index-j.index)}}destroy(){this.awareness&&(this.awareness.off("change",this._onAwarenessChange),this.signals.update.dispose())}}class BaseBlockModel{constructor(B,j){this.propsUpdated=new Signal,this.childrenUpdated=new Signal,this.childMap=new Map,this.page=B,this.id=j.id,this.children=[]}firstChild(){const B=this.children;return B!=null&&B.length?B[0]:null}lastChild(){return this.children.length?this.children[this.children.length-1].lastChild():this}block2html(B,j,X,ee,te){var ie;return`${((ie=this.text)==null?void 0:ie.sliceToDelta(ee||0,te)).reduce((fe,ce)=>fe+this._deltaLeaf2Html(ce),"")}${B}`}block2Text(B,j,X){var te;return`${(((te=this.text)==null?void 0:te.toString())||"").slice(j||0,X)}${B}`}_deltaLeaf2Html(B){let j=B.insert;const X=B.attributes;return X&&(X.code&&(j=`<code>${j}</code>`),X.bold&&(j=`<strong>${j}</strong>`),X.italic&&(j=`<em>${j}</em>`),X.underline&&(j=`<u>${j}</u>`),X.strikethrough&&(j=`<s>${j}</s>`),X.link&&(j=`<a href='${X.link}'>${j}</a>`)),j}dispose(){this.propsUpdated.dispose(),this.childrenUpdated.dispose()}}const UNSUPPORTED_MSG="PrelimText does not support ";class PrelimText{constructor(B,j){this.ready=!1,this.type=B,this.index=j}get length(){return 0}clone(){throw new Error(UNSUPPORTED_MSG+"clone")}insert(){throw new Error(UNSUPPORTED_MSG+"insert")}insertList(){throw new Error(UNSUPPORTED_MSG+"insertList")}split(){throw new Error(UNSUPPORTED_MSG+"split")}join(){throw new Error(UNSUPPORTED_MSG+"join")}clear(){throw new Error(UNSUPPORTED_MSG+"clear")}delete(){throw new Error(UNSUPPORTED_MSG+"delete")}replace(){throw new Error(UNSUPPORTED_MSG+"replace")}format(){throw new Error(UNSUPPORTED_MSG+"format")}applyDelta(){throw new Error(UNSUPPORTED_MSG+"applyDelta")}sliceToDelta(){throw new Error(UNSUPPORTED_MSG+"sliceToDelta")}}class Text$1{constructor(B,j){this._shouldTransact=!0,this._space=B,typeof j=="string"?this._yText=new YText(j):this._yText=j}static fromDelta(B,j){const X=new Text$1(B,"");return X.applyDelta(j),X}get length(){return this._yText.length}_transact(B){const{_space:j,_shouldTransact:X}=this;X?j.transact(B):B()}clone(){return new Text$1(this._space,this._yText.clone())}split(B){return[new PrelimText("splitLeft",B),new PrelimText("splitRight",B)]}insert(B,j,X){this._transact(()=>{this._yText.insert(j,B,X),this._yText.meta={split:!0}})}insertList(B,j){this._transact(()=>{for(let X=B.length-1;X>=0;X--)this._yText.insert(j,B[X].insert||"",B[X].attributes);this._yText.meta={split:!0}})}join(B){this._transact(()=>{const X=B._yText.toDelta();X.splice(0,0,{retain:this._yText.length}),this._yText.applyDelta(X),this._yText.meta={join:!0}})}format(B,j,X){this._transact(()=>{this._yText.format(B,j,X),this._yText.meta={format:!0}})}delete(B,j){this._transact(()=>{this._yText.delete(B,j),this._yText.meta={delete:!0}})}replace(B,j,X,ee){this._transact(()=>{this._yText.delete(B,j),this._yText.insert(B,X,ee),this._yText.meta={replace:!0}})}clear(){this._transact(()=>{this._yText.delete(0,this._yText.length),this._yText.meta={clear:!0}})}applyDelta(B){this._transact(()=>{this._yText.applyDelta(B)})}toDelta(){var B;return((B=this._yText)==null?void 0:B.toDelta())||[]}sliceToDelta(B,j){if(j&&B>=j)return[];const X=this.toDelta();if(B<1&&!j)return X;const ee=[];if(X&&X instanceof Array){let te=0;for(let ne=0;ne<X.length;ne++){const re=X[ne];let ie=re.insert||"";const fe=ie.length;if(j&&te+fe>j&&(ie=ie.slice(0,j-te)),te+fe>B&&ee.length===0&&(ie=ie.slice(B-te)),te+fe>B&&ee.length===0?ee.push({...re,insert:ie}):ee.length>0&&ee.push(re),j&&te+fe>j)break;te=te+fe}}return ee}toString(){var B;return((B=this._yText)==null?void 0:B.toString())||""}}class RichTextAdapter{constructor(B,j,X){this._yObserver=te=>{var ce,se;const re=!(te.transaction.origin===this.doc.clientID),ie=!!((ce=te.target)!=null&&ce.meta);if(re||ie){const oe=te.delta,ae=[];for(let le=0;le<oe.length;le++){const pe=oe[le];pe.insert!==void 0?ae.push(Object.assign({},pe,{attributes:Object.assign({},this._negatedUsedFormats,pe.attributes||{})})):ae.push(pe)}this.quill.updateContents(ae,this.doc.clientID),(se=te.target)!=null&&se.meta&&delete te.target.meta}},this._quillObserver=(te,ne,re,ie)=>{const{yText:fe}=this;if(ne&&ne.ops){const ce=ne.ops;ce.forEach(se=>{if(se.attributes!==void 0)for(const oe in se.attributes)this._negatedUsedFormats[oe]===void 0&&(this._negatedUsedFormats[oe]=!1)}),ie==="user"&&this.space.transact(()=>{fe.applyDelta(ce)})}},this.space=B,this.yText=j,this.doc=B.doc,this.quill=X,this.awareness=B.awareness;const ee=X.getModule("cursors")||null;this.quillCursors=ee,this._negatedUsedFormats={},this.yText.observe(this._yObserver),X.setContents(j.toDelta(),this),X.on("editor-change",this._quillObserver)}getCursor(){const B=this.quill.getSelection();if(!B)return null;const j=createRelativePositionFromTypeIndex(this.yText,B.index),X=createRelativePositionFromTypeIndex(this.yText,B.index+B.length);return{anchor:j,focus:X}}destroy(){this.yText.unobserve(this._yObserver),this.quill.off("editor-change",this._quillObserver)}}const SYS_KEYS=new Set(["id","flavour","children"]);function isPrimitive(q){return q!==Object(q)}function assertExists$1(q){if(q==null)throw new Error("val does not exist")}function assertFlavours$1(q,B){if(!B.includes(q.flavour))throw new Error(`model flavour ${q.flavour} is not allowed`)}function matchFlavours$1(q,B){return B.includes(q.flavour)}function assertValidChildren(q,B){!Array.isArray(B.children)||B.children.forEach(j=>{if(!q.has(j.id))throw new Error("Invalid child id: "+j.id)})}function initSysProps(q,B){q.set("sys:id",B.id),q.set("sys:flavour",B.flavour);const j=new YArray;q.set("sys:children",j),Array.isArray(B.children)&&B.children.forEach(X=>j.push([X.id]))}function syncBlockProps(q,B,j){var X,ee,te;Object.keys(B).forEach(ne=>{if(!(SYS_KEYS.has(ne)||j.has(ne))&&ne!=="text"){if(!isPrimitive(B[ne]))throw new Error("Only top level primitives are supported for now");B[ne]!==void 0&&q.set("prop:"+ne,B[ne])}}),B.flavour==="affine:paragraph"&&!B.type&&!q.has("prop:type")&&q.set("prop:type","text"),B.flavour==="affine:list"&&!q.has("prop:type")&&q.set("prop:type",(X=B.type)!=null?X:"bulleted"),B.flavour==="affine:list"&&!q.has("prop:checked")&&q.set("prop:checked",(ee=B.checked)!=null?ee:!1),B.flavour==="affine:group"&&!q.has("prop:xywh")&&q.set("prop:xywh",(te=B.xywh)!=null?te:"[0,0,720,480]")}function trySyncTextProp(q,B,j){if(!!j){if(j instanceof Text$1){B.set("prop:text",j._yText);return}if(j instanceof PrelimText){const X=q.values(),ee=X.next().value,te=X.next().value,ne=X.next().value;if(!te.ready)throw new Error("PrelimText left is not ready");if(te.type!=="splitLeft"||ne.type!=="splitRight"||ne!==j)throw new Error("Unmatched text entity");const re=ee._yText;re.meta={split:!0};const ie=re.clone();B.set("prop:text",ie),ie.delete(0,ne.index),re.delete(ne.index,re.length-ne.index),q.clear()}}}function toBlockProps(q){const B={};return Object.keys(q).forEach(j=>{q[j]&&(B[j.replace("sys:","")]=q[j])}),Object.keys(q).forEach(j=>{if(SYS_KEYS.has(j))return;const X=j.replace("prop:","");B[X]=q[j]}),B}const createAutoIncrement=()=>{let q=0;return function(){return(q++).toString()}},uuidv4=()=>uuidv4$1(),IS_WEB=typeof window<"u";function createChildMap(q){return new Map(q.map((B,j)=>[B,j]))}class Space{constructor(B,j,X,ee=uuidv4){this.richTextAdapters=new Map,this.signals={historyUpdated:new Signal,rootAdded:new Signal,rootDeleted:new Signal,textUpdated:new Signal,updated:new Signal,attributesUpdated:new Signal},this._root=null,this._flavourMap=new Map,this._blockMap=new Map,this._splitSet=new Set,this.attributes=new Map,this._ignoredKeys=new Set(Object.keys(new BaseBlockModel(this,{}))),this.setAttribute=(re,ie)=>{this.attributes.set(re,ie),this.signals.attributesUpdated.emit(this.attributes)},this._historyAddObserver=re=>{IS_WEB&&re.stackItem.meta.set("cursor-location",this.awareness.getLocalCursor()),this._historyObserver()},this._historyPopObserver=re=>{const ie=re.stackItem.meta.get("cursor-location");!ie||(this.awareness.setLocalCursor(ie),this._historyObserver())},this._historyObserver=()=>{this.signals.historyUpdated.emit()},this.id=B,this.doc=j,this._idGenerator=ee;const te=X!=null?X:new Awareness(this.doc);this.awareness=new AwarenessAdapter(this,te);const ne=re=>{for(const ie of re)this._handleYEvent(ie);this.signals.updated.emit()};this._yBlocks.observeDeep(ne),this._history=new UndoManager([this._yBlocks],{trackedOrigins:new Set([this.doc.clientID]),doc:this.doc}),this._history.on("stack-cleared",this._historyObserver),this._history.on("stack-item-added",this._historyAddObserver),this._history.on("stack-item-popped",this._historyPopObserver),this._history.on("stack-item-updated",this._historyObserver)}get _yBlocks(){return this.doc.getMap(this.id)}get root(){return this._root}get isEmpty(){return this._yBlocks.size===0}get canUndo(){return this._history.canUndo()}get canRedo(){return this._history.canRedo()}undo(){this._history.undo()}redo(){this._history.redo()}captureSync(){this._history.stopCapturing()}resetHistory(){this._history.clear()}transact(B){this.doc.transact(B,this.doc.clientID)}register(B){return Object.keys(B).forEach(j=>{this._flavourMap.set(j,B[j])}),this}getBlockById(B){var j;return(j=this._blockMap.get(B))!=null?j:null}getBlockByFlavour(B){return[...this._blockMap.values()].filter(({flavour:j})=>B===j)}getParentById(B,j){if(B===j.id)return null;const X=this._blockMap.get(B);if(!X)return null;for(const[ee]of X.childMap){if(ee===j.id)return X;const te=this.getParentById(ee,j);if(te!==null)return te}return null}getParent(B){return this._root?this.getParentById(this._root.id,B):null}getPreviousSibling(B){var ee,te;const j=this.getParent(B),X=(ee=j==null?void 0:j.children.indexOf(B))!=null?ee:-1;return(te=j==null?void 0:j.children[X-1])!=null?te:null}getNextSibling(B){var ee,te;const j=this.getParent(B),X=(ee=j==null?void 0:j.children.indexOf(B))!=null?ee:-1;return X===-1?null:(te=j==null?void 0:j.children[X+1])!=null?te:null}addBlock(B,j,X){if(!B.flavour)throw new Error("Block props must contain flavour");const ee={...B},te=this._idGenerator();return ee.id=te,this.transact(()=>{var ie,fe;const ne=new YMap;assertValidChildren(this._yBlocks,ee),initSysProps(ne,ee),syncBlockProps(ne,ee,this._ignoredKeys),trySyncTextProp(this._splitSet,ne,ee.text),typeof j=="string"&&(j=this._blockMap.get(j));const re=(fe=j==null?void 0:j.id)!=null?fe:(ie=this._root)==null?void 0:ie.id;if(re){const se=this._yBlocks.get(re).get("sys:children"),oe=X!=null?X:se.length;se.insert(oe,[te])}this._yBlocks.set(te,ne)}),te}updateBlockById(B,j){const X=this._blockMap.get(B);this.updateBlock(X,j)}updateBlock(B,j){const X=this._yBlocks.get(B.id);this.transact(()=>{j.text instanceof PrelimText?j.text.ready=!0:j.text instanceof Text$1&&(B.text=j.text,X.set("prop:text",j.text._yText)),syncBlockProps(X,j,this._ignoredKeys)})}deleteBlockById(B){const j=this._blockMap.get(B);this.deleteBlock(j)}deleteBlock(B){var ee;const j=this.getParent(B),X=(ee=j==null?void 0:j.children.indexOf(B))!=null?ee:-1;X>-1&&(j==null||j.children.splice(j.children.indexOf(B),1)),this.transact(()=>{if(this._yBlocks.delete(B.id),B.dispose(),j){const ne=this._yBlocks.get(j.id).get("sys:children");X>-1&&ne.delete(X,1)}})}get Text(){return Text$1}attachRichText(B,j){const ee=this._getYBlock(B).get("prop:text");if(!ee)throw new Error(`Block "${B}" does not have text`);const te=new RichTextAdapter(this,ee,j);this.richTextAdapters.set(B,te),j.on("selection-change",()=>{const ne=te.getCursor();!ne||this.awareness.setLocalCursor({...ne,id:B})})}detachRichText(B){const j=this.richTextAdapters.get(B);j==null||j.destroy(),this.richTextAdapters.delete(B)}markTextSplit(B,j,X){this._splitSet.add(B).add(j).add(X)}_getYBlock(B){const j=this._yBlocks.get(B);if(!j)throw new Error(`Block with id ${B} does not exist`);return j}_createBlockModel(B){const j=this._flavourMap.get(B.flavour);if(!j)throw new Error(`Block flavour ${B.flavour} is not registered`);return new j(this,B)}_handleYBlockAdd(B,j){const X=this._getYBlock(j),ee=this._blockMap.size===0,te=X.toJSON(),ne=toBlockProps(te),re=this._createBlockModel({...ne,id:j});this._blockMap.set(ne.id,re),matchFlavours$1(re,["affine:paragraph","affine:list"])&&!X.get("prop:text")&&this.transact(()=>X.set("prop:text",new YText));const ie=X.get("prop:text"),fe=new Text$1(this,ie);re.text=fe;const ce=X.get("sys:children");if(ce instanceof YArray&&(re.childMap=createChildMap(ce),ce.forEach(se=>{const oe=re.childMap.get(se);if(Number.isInteger(oe)){this._blockMap.has(se)||(B.add(se),this._handleYBlockAdd(B,se));const le=this._blockMap.get(se);re.children[oe]=le}})),ee)this._root=re,this.signals.rootAdded.emit(re);else{const se=this.getParent(re),oe=se==null?void 0:se.childMap.get(re.id);se&&oe!==void 0&&(se.children[oe]=re,se.childrenUpdated.emit())}}_handleYBlockDelete(B){this._blockMap.get(B)===this._root&&this.signals.rootDeleted.emit(B),this._blockMap.delete(B)}_handleYBlockUpdate(B){const j=B.target.get("sys:id"),X=this.getBlockById(j);if(!X)return;const ee={};for(const te of B.keysChanged)te!=="prop:text"&&(ee[te.replace("prop:","")]=B.target.get(te));Object.assign(X,ee),X.propsUpdated.emit()}_handleYEvent(B){if(B.target===this._yBlocks){const j=new Set;B.keys.forEach((X,ee)=>{if(X.action==="add"){if(j.has(ee))return;j.add(ee),this._handleYBlockAdd(j,ee)}else X.action==="delete"&&this._handleYBlockDelete(ee)})}else if(B.target.parent===this._yBlocks)B instanceof YTextEvent?this.signals.textUpdated.emit(B):B instanceof YMapEvent&&this._handleYBlockUpdate(B);else if(B.target.parent instanceof YMap&&B.target.parent.has("sys:id")&&B instanceof YArrayEvent){const j=B.target.parent.get("sys:id"),X=this._blockMap.get(j);if(!X)throw new Error(`Block with id ${j} does not exist`);if(B.path[B.path.length-1]==="sys:children"){const te=B.target.toArray();X.children=te.map(ne=>this._blockMap.get(ne)),X.childMap=createChildMap(B.target),X.childrenUpdated.emit()}}}}const testSymbol=Symbol.for("react.test.json"),isValidRecord=q=>!(typeof q!="object"||q===null),IGNORE_PROPS=["sys:id","sys:flavour","sys:children"],yDocToJSXNode=(q,B)=>{var ne;if(!isValidRecord(q))throw new Error("Failed to parse doc record! Invalid data.");const j=q[B];if(!j)throw new Error(`Failed to parse doc record! Node not found! id: ${B}.`);const X=j["sys:flavour"],ee=j["sys:children"],te=Object.fromEntries(Object.entries(j).filter(([re])=>!IGNORE_PROPS.includes(re)));return"prop:text"in te&&(te["prop:text"]=parseDelta(te["prop:text"])),{$$typeof:testSymbol,type:X,props:te,children:(ne=ee==null?void 0:ee.map(re=>yDocToJSXNode(q,re)))!=null?ne:[]}},serializeYDoc=q=>{const B={};return q.share.forEach((j,X)=>{j instanceof YMap?B[X]=serializeYMap(j):B[X]=j.toJSON()}),B},serializeYMap=q=>{const B={};return q.forEach((j,X)=>{j instanceof YMap?B[X]=serializeYMap(j):j instanceof YText?B[X]=serializeYText(j):j instanceof YArray||j instanceof AbstractType?B[X]=j.toJSON():B[X]=j}),B},serializeYText=q=>q.toDelta(),parseDelta=q=>{if(!!q.length)return q.length===1&&!q[0].attributes?q[0].insert:{$$typeof:testSymbol,type:"",props:{},children:q==null?void 0:q.map(({insert:B,attributes:j})=>({$$typeof:testSymbol,type:"text",props:{insert:B,...j}}))}},DEFAULT_ROOM="virgo-default";class Store{constructor({room:B=DEFAULT_ROOM,providers:j=[],awareness:X,idGenerator:ee}={}){this.doc=new Doc,this.providers=[],this.spaces=new Map,this.awareness=X!=null?X:new Awareness(this.doc),this.idGenerator=ee!=null?ee:uuidv4,this.providers=j.map(te=>new te(B,this.doc,{awareness:this.awareness}))}getSpaceById(B){return this.spaces.get(B)}addSpace(B){this.spaces.set(B.id,B)}serializeDoc(){return serializeYDoc(this.doc)}toJSXElement(B="0"){const j=this.serializeDoc();if(!("space:page0"in j))throw new Error("Failed to convert to JSX: 'space:page0' not found");return j["space:page0"][B]?yDocToJSXNode(j["space:page0"],B):null}}function promisifyRequest(q){return new Promise((B,j)=>{q.oncomplete=q.onsuccess=()=>B(q.result),q.onabort=q.onerror=()=>j(q.error)})}function createStore(q,B){const j=indexedDB.open(q);j.onupgradeneeded=()=>j.result.createObjectStore(B);const X=promisifyRequest(j);return(ee,te)=>X.then(ne=>te(ne.transaction(B,ee).objectStore(B)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get$1(q,B=defaultGetStore()){return B("readonly",j=>promisifyRequest(j.get(q)))}function set(q,B,j=defaultGetStore()){return j("readwrite",X=>(X.put(B,q),promisifyRequest(X.transaction)))}function del$1(q,B=defaultGetStore()){return B("readwrite",j=>(j.delete(q),promisifyRequest(j.transaction)))}function clear(q=defaultGetStore()){return q("readwrite",B=>(B.clear(),promisifyRequest(B.transaction)))}function eachCursor(q,B){return q.openCursor().onsuccess=function(){!this.result||(B(this.result),this.result.continue())},promisifyRequest(q.transaction)}function entries(q=defaultGetStore()){return q("readonly",B=>{if(B.getAll&&B.getAllKeys)return Promise.all([promisifyRequest(B.getAllKeys()),promisifyRequest(B.getAll())]).then(([X,ee])=>X.map((te,ne)=>[te,ee[ne]]));const j=[];return q("readonly",X=>eachCursor(X,ee=>j.push([ee.key,ee.value])).then(()=>j))})}var __defProp$e=Object.defineProperty,__getOwnPropDesc$e=Object.getOwnPropertyDescriptor,__decorateClass$e=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$e(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$e(B,j,ee),ee};function staticImplements(){return q=>q}let IndexedDBBlobProvider=class{constructor(){this.blobs=new Set,this.signals={blobAdded:new Signal}}static async init(){const q=new IndexedDBBlobProvider;return await q._initBlobs(),q}async _initBlobs(){const q=await entries();for(const[B]of q){const j=B;this.signals.blobAdded.emit(j),this.blobs.add(j)}}async get(q){const B=await get$1(q);return B?URL.createObjectURL(B):null}async set(q){const B=uuidv4$1();return await set(B,q),this.blobs.add(B),this.signals.blobAdded.emit(B),B}async delete(q){this.blobs.delete(q),await del$1(q)}async clear(){this.blobs.clear(),await clear()}};IndexedDBBlobProvider=__decorateClass$e([staticImplements()],IndexedDBBlobProvider);const reconnectTimeoutBase=1200,maxReconnectTimeout=2500,messageReconnectTimeout$1=3e4,setupWS$1=q=>{if(q.shouldConnect&&q.ws===null){const B=new WebSocket(q.url),j=q.binaryType;let X=null;j&&(B.binaryType=j),q.ws=B,q.connecting=!0,q.connected=!1,B.onmessage=ne=>{q.lastMessageReceived=getUnixTime();const re=ne.data,ie=typeof re=="string"?JSON.parse(re):re;ie&&ie.type==="pong"&&(clearTimeout(X),X=setTimeout(te,messageReconnectTimeout$1/2)),q.emit("message",[ie,q])};const ee=ne=>{q.ws!==null&&(q.ws=null,q.connecting=!1,q.connected?(q.connected=!1,q.emit("disconnect",[{type:"disconnect",error:ne},q])):q.unsuccessfulReconnects++,setTimeout(setupWS$1,min(log10(q.unsuccessfulReconnects+1)*reconnectTimeoutBase,maxReconnectTimeout),q)),clearTimeout(X)},te=()=>{q.ws===B&&q.send({type:"ping"})};B.onclose=()=>ee(null),B.onerror=ne=>ee(ne),B.onopen=()=>{q.lastMessageReceived=getUnixTime(),q.connecting=!1,q.connected=!0,q.unsuccessfulReconnects=0,q.emit("connect",[{type:"connect"},q]),X=setTimeout(te,messageReconnectTimeout$1/2)}}};class WebsocketClient extends Observable{constructor(B,{binaryType:j}={}){super(),this.url=B,this.ws=null,this.binaryType=j||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&messageReconnectTimeout$1<getUnixTime()-this.lastMessageReceived&&this.ws.close()},messageReconnectTimeout$1/2),setupWS$1(this)}send(B){this.ws&&this.ws.send(JSON.stringify(B))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&setupWS$1(this)}}const channels=new Map;class LocalStoragePolyfill{constructor(B){this.room=B,this.onmessage=null,onChange(j=>j.key===B&&this.onmessage!==null&&this.onmessage({data:fromBase64(j.newValue||"")}))}postMessage(B){varStorage.setItem(this.room,toBase64(createUint8ArrayFromArrayBuffer(B)))}}const BC=typeof BroadcastChannel>"u"?LocalStoragePolyfill:BroadcastChannel,getChannel=q=>setIfUndefined(channels,q,()=>{const B=new Set,j=new BC(q);return j.onmessage=X=>B.forEach(ee=>ee(X.data,"broadcastchannel")),{bc:j,subs:B}}),subscribe=(q,B)=>getChannel(q).subs.add(B),unsubscribe=(q,B)=>getChannel(q).subs.delete(B),publish=(q,B,j=null)=>{const X=getChannel(q);X.bc.postMessage(B),X.subs.forEach(ee=>ee(B,j))},createMutex=()=>{let q=!0;return(B,j)=>{if(q){q=!1;try{B()}finally{q=!0}}else j!==void 0&&j()}};var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(q){return q&&q.__esModule&&Object.prototype.hasOwnProperty.call(q,"default")?q.default:q}function commonjsRequire(q){throw new Error('Could not dynamically require "'+q+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var simplepeer_min={exports:{}};(function(q,B){(function(j){q.exports=j()})(function(){var j=Math.floor,X=Math.abs,ee=Math.pow;return function(){function te(ne,re,ie){function fe(oe,ae){if(!re[oe]){if(!ne[oe]){var le=typeof commonjsRequire=="function"&&commonjsRequire;if(!ae&&le)return le(oe,!0);if(ce)return ce(oe,!0);var pe=new Error("Cannot find module '"+oe+"'");throw pe.code="MODULE_NOT_FOUND",pe}var ve=re[oe]={exports:{}};ne[oe][0].call(ve.exports,function(ge){var de=ne[oe][1][ge];return fe(de||ge)},ve,ve.exports,te,ne,re,ie)}return re[oe].exports}for(var ce=typeof commonjsRequire=="function"&&commonjsRequire,se=0;se<ie.length;se++)fe(ie[se]);return fe}return te}()({1:[function(te,ne,re){function ie(he){var me=he.length;if(0<me%4)throw new Error("Invalid string. Length must be a multiple of 4");var _e=he.indexOf("=");_e===-1&&(_e=me);var be=_e===me?0:4-_e%4;return[_e,be]}function fe(he,me,_e){return 3*(me+_e)/4-_e}function ce(he){var me,_e,be=ie(he),Se=be[0],Te=be[1],we=new ve(fe(he,Se,Te)),ke=0,xe=0<Te?Se-4:Se;for(_e=0;_e<xe;_e+=4)me=pe[he.charCodeAt(_e)]<<18|pe[he.charCodeAt(_e+1)]<<12|pe[he.charCodeAt(_e+2)]<<6|pe[he.charCodeAt(_e+3)],we[ke++]=255&me>>16,we[ke++]=255&me>>8,we[ke++]=255&me;return Te===2&&(me=pe[he.charCodeAt(_e)]<<2|pe[he.charCodeAt(_e+1)]>>4,we[ke++]=255&me),Te===1&&(me=pe[he.charCodeAt(_e)]<<10|pe[he.charCodeAt(_e+1)]<<4|pe[he.charCodeAt(_e+2)]>>2,we[ke++]=255&me>>8,we[ke++]=255&me),we}function se(he){return le[63&he>>18]+le[63&he>>12]+le[63&he>>6]+le[63&he]}function oe(he,me,_e){for(var be,Se=[],Te=me;Te<_e;Te+=3)be=(16711680&he[Te]<<16)+(65280&he[Te+1]<<8)+(255&he[Te+2]),Se.push(se(be));return Se.join("")}function ae(he){for(var me,_e=he.length,be=_e%3,Se=[],Te=16383,we=0,ke=_e-be;we<ke;we+=Te)Se.push(oe(he,we,we+Te>ke?ke:we+Te));return be===1?(me=he[_e-1],Se.push(le[me>>2]+le[63&me<<4]+"==")):be===2&&(me=(he[_e-2]<<8)+he[_e-1],Se.push(le[me>>10]+le[63&me>>4]+le[63&me<<2]+"=")),Se.join("")}re.byteLength=function(he){var me=ie(he),_e=me[0],be=me[1];return 3*(_e+be)/4-be},re.toByteArray=ce,re.fromByteArray=ae;for(var le=[],pe=[],ve=typeof Uint8Array>"u"?Array:Uint8Array,ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",de=0,ue=ge.length;de<ue;++de)le[de]=ge[de],pe[ge.charCodeAt(de)]=de;pe[45]=62,pe[95]=63},{}],2:[function(){},{}],3:[function(te,ne,re){(function(){(function(){var ie=String.fromCharCode,fe=Math.min;function ce(ye){if(2147483647<ye)throw new RangeError('The value "'+ye+'" is invalid for option "size"');var Ce=new Uint8Array(ye);return Ce.__proto__=se.prototype,Ce}function se(ye,Ce,Ee){if(typeof ye=="number"){if(typeof Ce=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return pe(ye)}return oe(ye,Ce,Ee)}function oe(ye,Ce,Ee){if(typeof ye=="string")return ve(ye,Ce);if(ArrayBuffer.isView(ye))return ge(ye);if(ye==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ye);if(Re(ye,ArrayBuffer)||ye&&Re(ye.buffer,ArrayBuffer))return de(ye,Ce,Ee);if(typeof ye=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Fe=ye.valueOf&&ye.valueOf();if(Fe!=null&&Fe!==ye)return se.from(Fe,Ce,Ee);var ze=ue(ye);if(ze)return ze;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ye[Symbol.toPrimitive]=="function")return se.from(ye[Symbol.toPrimitive]("string"),Ce,Ee);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ye)}function ae(ye){if(typeof ye!="number")throw new TypeError('"size" argument must be of type number');if(0>ye)throw new RangeError('The value "'+ye+'" is invalid for option "size"')}function le(ye,Ce,Ee){return ae(ye),0>=ye||Ce===void 0?ce(ye):typeof Ee=="string"?ce(ye).fill(Ce,Ee):ce(ye).fill(Ce)}function pe(ye){return ae(ye),ce(0>ye?0:0|he(ye))}function ve(ye,Ce){if((typeof Ce!="string"||Ce==="")&&(Ce="utf8"),!se.isEncoding(Ce))throw new TypeError("Unknown encoding: "+Ce);var Ee=0|me(ye,Ce),Fe=ce(Ee),ze=Fe.write(ye,Ce);return ze!==Ee&&(Fe=Fe.slice(0,ze)),Fe}function ge(ye){for(var Ce=0>ye.length?0:0|he(ye.length),Ee=ce(Ce),Fe=0;Fe<Ce;Fe+=1)Ee[Fe]=255&ye[Fe];return Ee}function de(ye,Ce,Ee){if(0>Ce||ye.byteLength<Ce)throw new RangeError('"offset" is outside of buffer bounds');if(ye.byteLength<Ce+(Ee||0))throw new RangeError('"length" is outside of buffer bounds');var Fe;return Fe=Ce===void 0&&Ee===void 0?new Uint8Array(ye):Ee===void 0?new Uint8Array(ye,Ce):new Uint8Array(ye,Ce,Ee),Fe.__proto__=se.prototype,Fe}function ue(ye){if(se.isBuffer(ye)){var Ce=0|he(ye.length),Ee=ce(Ce);return Ee.length===0||ye.copy(Ee,0,0,Ce),Ee}return ye.length===void 0?ye.type==="Buffer"&&Array.isArray(ye.data)?ge(ye.data):void 0:typeof ye.length!="number"||Me(ye.length)?ce(0):ge(ye)}function he(ye){if(ye>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|ye}function me(ye,Ce){if(se.isBuffer(ye))return ye.length;if(ArrayBuffer.isView(ye)||Re(ye,ArrayBuffer))return ye.byteLength;if(typeof ye!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ye);var Ee=ye.length,Fe=2<arguments.length&&arguments[2]===!0;if(!Fe&&Ee===0)return 0;for(var ze=!1;;)switch(Ce){case"ascii":case"latin1":case"binary":return Ee;case"utf8":case"utf-8":return nt(ye).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Ee;case"hex":return Ee>>>1;case"base64":return ct(ye).length;default:if(ze)return Fe?-1:nt(ye).length;Ce=(""+Ce).toLowerCase(),ze=!0}}function _e(ye,Ce,Ee){var Fe=!1;if((Ce===void 0||0>Ce)&&(Ce=0),Ce>this.length||((Ee===void 0||Ee>this.length)&&(Ee=this.length),0>=Ee)||(Ee>>>=0,Ce>>>=0,Ee<=Ce))return"";for(ye||(ye="utf8");;)switch(ye){case"hex":return Ie(this,Ce,Ee);case"utf8":case"utf-8":return Ve(this,Ce,Ee);case"ascii":return je(this,Ce,Ee);case"latin1":case"binary":return He(this,Ce,Ee);case"base64":return $e(this,Ce,Ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ue(this,Ce,Ee);default:if(Fe)throw new TypeError("Unknown encoding: "+ye);ye=(ye+"").toLowerCase(),Fe=!0}}function be(ye,Ce,Ee){var Fe=ye[Ce];ye[Ce]=ye[Ee],ye[Ee]=Fe}function Se(ye,Ce,Ee,Fe,ze){if(ye.length===0)return-1;if(typeof Ee=="string"?(Fe=Ee,Ee=0):2147483647<Ee?Ee=2147483647:-2147483648>Ee&&(Ee=-2147483648),Ee=+Ee,Me(Ee)&&(Ee=ze?0:ye.length-1),0>Ee&&(Ee=ye.length+Ee),Ee>=ye.length){if(ze)return-1;Ee=ye.length-1}else if(0>Ee)if(ze)Ee=0;else return-1;if(typeof Ce=="string"&&(Ce=se.from(Ce,Fe)),se.isBuffer(Ce))return Ce.length===0?-1:Te(ye,Ce,Ee,Fe,ze);if(typeof Ce=="number")return Ce&=255,typeof Uint8Array.prototype.indexOf=="function"?ze?Uint8Array.prototype.indexOf.call(ye,Ce,Ee):Uint8Array.prototype.lastIndexOf.call(ye,Ce,Ee):Te(ye,[Ce],Ee,Fe,ze);throw new TypeError("val must be string, number or Buffer")}function Te(ye,Ce,Ee,Fe,ze){function Ze(Ut,Dt){return st===1?Ut[Dt]:Ut.readUInt16BE(Dt*st)}var st=1,pt=ye.length,dt=Ce.length;if(Fe!==void 0&&(Fe=(Fe+"").toLowerCase(),Fe==="ucs2"||Fe==="ucs-2"||Fe==="utf16le"||Fe==="utf-16le")){if(2>ye.length||2>Ce.length)return-1;st=2,pt/=2,dt/=2,Ee/=2}var ft;if(ze){var tt=-1;for(ft=Ee;ft<pt;ft++)if(Ze(ye,ft)!==Ze(Ce,tt===-1?0:ft-tt))tt!==-1&&(ft-=ft-tt),tt=-1;else if(tt===-1&&(tt=ft),ft-tt+1===dt)return tt*st}else for(Ee+dt>pt&&(Ee=pt-dt),ft=Ee;0<=ft;ft--){for(var mt=!0,Lt=0;Lt<dt;Lt++)if(Ze(ye,ft+Lt)!==Ze(Ce,Lt)){mt=!1;break}if(mt)return ft}return-1}function we(ye,Ce,Ee,Fe){Ee=+Ee||0;var ze=ye.length-Ee;Fe?(Fe=+Fe,Fe>ze&&(Fe=ze)):Fe=ze;var Ze=Ce.length;Fe>Ze/2&&(Fe=Ze/2);for(var st,pt=0;pt<Fe;++pt){if(st=parseInt(Ce.substr(2*pt,2),16),Me(st))return pt;ye[Ee+pt]=st}return pt}function ke(ye,Ce,Ee,Fe){return ut(nt(Ce,ye.length-Ee),ye,Ee,Fe)}function xe(ye,Ce,Ee,Fe){return ut(ot(Ce),ye,Ee,Fe)}function Ae(ye,Ce,Ee,Fe){return xe(ye,Ce,Ee,Fe)}function Le(ye,Ce,Ee,Fe){return ut(ct(Ce),ye,Ee,Fe)}function De(ye,Ce,Ee,Fe){return ut(ht(Ce,ye.length-Ee),ye,Ee,Fe)}function $e(ye,Ce,Ee){return Ce===0&&Ee===ye.length?qe.fromByteArray(ye):qe.fromByteArray(ye.slice(Ce,Ee))}function Ve(ye,Ce,Ee){Ee=fe(ye.length,Ee);for(var Fe=[],ze=Ce;ze<Ee;){var Ze=ye[ze],st=null,pt=239<Ze?4:223<Ze?3:191<Ze?2:1;if(ze+pt<=Ee){var dt,ft,tt,mt;pt===1?128>Ze&&(st=Ze):pt===2?(dt=ye[ze+1],(192&dt)==128&&(mt=(31&Ze)<<6|63&dt,127<mt&&(st=mt))):pt===3?(dt=ye[ze+1],ft=ye[ze+2],(192&dt)==128&&(192&ft)==128&&(mt=(15&Ze)<<12|(63&dt)<<6|63&ft,2047<mt&&(55296>mt||57343<mt)&&(st=mt))):pt===4&&(dt=ye[ze+1],ft=ye[ze+2],tt=ye[ze+3],(192&dt)==128&&(192&ft)==128&&(192&tt)==128&&(mt=(15&Ze)<<18|(63&dt)<<12|(63&ft)<<6|63&tt,65535<mt&&1114112>mt&&(st=mt)))}st===null?(st=65533,pt=1):65535<st&&(st-=65536,Fe.push(55296|1023&st>>>10),st=56320|1023&st),Fe.push(st),ze+=pt}return Qe(Fe)}function Qe(ye){var Ce=ye.length;if(Ce<=4096)return ie.apply(String,ye);for(var Ee="",Fe=0;Fe<Ce;)Ee+=ie.apply(String,ye.slice(Fe,Fe+=4096));return Ee}function je(ye,Ce,Ee){var Fe="";Ee=fe(ye.length,Ee);for(var ze=Ce;ze<Ee;++ze)Fe+=ie(127&ye[ze]);return Fe}function He(ye,Ce,Ee){var Fe="";Ee=fe(ye.length,Ee);for(var ze=Ce;ze<Ee;++ze)Fe+=ie(ye[ze]);return Fe}function Ie(ye,Ce,Ee){var Fe=ye.length;(!Ce||0>Ce)&&(Ce=0),(!Ee||0>Ee||Ee>Fe)&&(Ee=Fe);for(var ze="",Ze=Ce;Ze<Ee;++Ze)ze+=Je(ye[Ze]);return ze}function Ue(ye,Ce,Ee){for(var Fe=ye.slice(Ce,Ee),ze="",Ze=0;Ze<Fe.length;Ze+=2)ze+=ie(Fe[Ze]+256*Fe[Ze+1]);return ze}function Pe(ye,Ce,Ee){if(ye%1!=0||0>ye)throw new RangeError("offset is not uint");if(ye+Ce>Ee)throw new RangeError("Trying to access beyond buffer length")}function We(ye,Ce,Ee,Fe,ze,Ze){if(!se.isBuffer(ye))throw new TypeError('"buffer" argument must be a Buffer instance');if(Ce>ze||Ce<Ze)throw new RangeError('"value" argument is out of bounds');if(Ee+Fe>ye.length)throw new RangeError("Index out of range")}function Ye(ye,Ce,Ee,Fe){if(Ee+Fe>ye.length)throw new RangeError("Index out of range");if(0>Ee)throw new RangeError("Index out of range")}function Ne(ye,Ce,Ee,Fe,ze){return Ce=+Ce,Ee>>>=0,ze||Ye(ye,Ce,Ee,4),Be.write(ye,Ce,Ee,Fe,23,4),Ee+4}function Ke(ye,Ce,Ee,Fe,ze){return Ce=+Ce,Ee>>>=0,ze||Ye(ye,Ce,Ee,8),Be.write(ye,Ce,Ee,Fe,52,8),Ee+8}function Xe(ye){if(ye=ye.split("=")[0],ye=ye.trim().replace(Oe,""),2>ye.length)return"";for(;ye.length%4!=0;)ye+="=";return ye}function Je(ye){return 16>ye?"0"+ye.toString(16):ye.toString(16)}function nt(ye,Ce){Ce=Ce||1/0;for(var Ee,Fe=ye.length,ze=null,Ze=[],st=0;st<Fe;++st){if(Ee=ye.charCodeAt(st),55295<Ee&&57344>Ee){if(!ze){if(56319<Ee){-1<(Ce-=3)&&Ze.push(239,191,189);continue}else if(st+1===Fe){-1<(Ce-=3)&&Ze.push(239,191,189);continue}ze=Ee;continue}if(56320>Ee){-1<(Ce-=3)&&Ze.push(239,191,189),ze=Ee;continue}Ee=(ze-55296<<10|Ee-56320)+65536}else ze&&-1<(Ce-=3)&&Ze.push(239,191,189);if(ze=null,128>Ee){if(0>(Ce-=1))break;Ze.push(Ee)}else if(2048>Ee){if(0>(Ce-=2))break;Ze.push(192|Ee>>6,128|63&Ee)}else if(65536>Ee){if(0>(Ce-=3))break;Ze.push(224|Ee>>12,128|63&Ee>>6,128|63&Ee)}else if(1114112>Ee){if(0>(Ce-=4))break;Ze.push(240|Ee>>18,128|63&Ee>>12,128|63&Ee>>6,128|63&Ee)}else throw new Error("Invalid code point")}return Ze}function ot(ye){for(var Ce=[],Ee=0;Ee<ye.length;++Ee)Ce.push(255&ye.charCodeAt(Ee));return Ce}function ht(ye,Ce){for(var Ee,Fe,ze,Ze=[],st=0;st<ye.length&&!(0>(Ce-=2));++st)Ee=ye.charCodeAt(st),Fe=Ee>>8,ze=Ee%256,Ze.push(ze),Ze.push(Fe);return Ze}function ct(ye){return qe.toByteArray(Xe(ye))}function ut(ye,Ce,Ee,Fe){for(var ze=0;ze<Fe&&!(ze+Ee>=Ce.length||ze>=ye.length);++ze)Ce[ze+Ee]=ye[ze];return ze}function Re(ye,Ce){return ye instanceof Ce||ye!=null&&ye.constructor!=null&&ye.constructor.name!=null&&ye.constructor.name===Ce.name}function Me(ye){return ye!==ye}var qe=te("base64-js"),Be=te("ieee754");re.Buffer=se,re.SlowBuffer=function(ye){return+ye!=ye&&(ye=0),se.alloc(+ye)},re.INSPECT_MAX_BYTES=50,re.kMaxLength=2147483647,se.TYPED_ARRAY_SUPPORT=function(){try{var ye=new Uint8Array(1);return ye.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ye.foo()===42}catch{return!1}}(),se.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(se.prototype,"parent",{enumerable:!0,get:function(){return se.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(se.prototype,"offset",{enumerable:!0,get:function(){return se.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&se[Symbol.species]===se&&Object.defineProperty(se,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),se.poolSize=8192,se.from=function(ye,Ce,Ee){return oe(ye,Ce,Ee)},se.prototype.__proto__=Uint8Array.prototype,se.__proto__=Uint8Array,se.alloc=function(ye,Ce,Ee){return le(ye,Ce,Ee)},se.allocUnsafe=function(ye){return pe(ye)},se.allocUnsafeSlow=function(ye){return pe(ye)},se.isBuffer=function(ye){return ye!=null&&ye._isBuffer===!0&&ye!==se.prototype},se.compare=function(ye,Ce){if(Re(ye,Uint8Array)&&(ye=se.from(ye,ye.offset,ye.byteLength)),Re(Ce,Uint8Array)&&(Ce=se.from(Ce,Ce.offset,Ce.byteLength)),!se.isBuffer(ye)||!se.isBuffer(Ce))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ye===Ce)return 0;for(var Ee=ye.length,Fe=Ce.length,ze=0,Ze=fe(Ee,Fe);ze<Ze;++ze)if(ye[ze]!==Ce[ze]){Ee=ye[ze],Fe=Ce[ze];break}return Ee<Fe?-1:Fe<Ee?1:0},se.isEncoding=function(ye){switch((ye+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},se.concat=function(ye,Ce){if(!Array.isArray(ye))throw new TypeError('"list" argument must be an Array of Buffers');if(ye.length===0)return se.alloc(0);var Ee;if(Ce===void 0)for(Ce=0,Ee=0;Ee<ye.length;++Ee)Ce+=ye[Ee].length;var Fe=se.allocUnsafe(Ce),ze=0;for(Ee=0;Ee<ye.length;++Ee){var Ze=ye[Ee];if(Re(Ze,Uint8Array)&&(Ze=se.from(Ze)),!se.isBuffer(Ze))throw new TypeError('"list" argument must be an Array of Buffers');Ze.copy(Fe,ze),ze+=Ze.length}return Fe},se.byteLength=me,se.prototype._isBuffer=!0,se.prototype.swap16=function(){var ye=this.length;if(ye%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Ce=0;Ce<ye;Ce+=2)be(this,Ce,Ce+1);return this},se.prototype.swap32=function(){var ye=this.length;if(ye%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Ce=0;Ce<ye;Ce+=4)be(this,Ce,Ce+3),be(this,Ce+1,Ce+2);return this},se.prototype.swap64=function(){var ye=this.length;if(ye%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Ce=0;Ce<ye;Ce+=8)be(this,Ce,Ce+7),be(this,Ce+1,Ce+6),be(this,Ce+2,Ce+5),be(this,Ce+3,Ce+4);return this},se.prototype.toString=function(){var ye=this.length;return ye===0?"":arguments.length===0?Ve(this,0,ye):_e.apply(this,arguments)},se.prototype.toLocaleString=se.prototype.toString,se.prototype.equals=function(ye){if(!se.isBuffer(ye))throw new TypeError("Argument must be a Buffer");return this===ye||se.compare(this,ye)===0},se.prototype.inspect=function(){var ye="",Ce=re.INSPECT_MAX_BYTES;return ye=this.toString("hex",0,Ce).replace(/(.{2})/g,"$1 ").trim(),this.length>Ce&&(ye+=" ... "),"<Buffer "+ye+">"},se.prototype.compare=function(ye,Ce,Ee,Fe,ze){if(Re(ye,Uint8Array)&&(ye=se.from(ye,ye.offset,ye.byteLength)),!se.isBuffer(ye))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ye);if(Ce===void 0&&(Ce=0),Ee===void 0&&(Ee=ye?ye.length:0),Fe===void 0&&(Fe=0),ze===void 0&&(ze=this.length),0>Ce||Ee>ye.length||0>Fe||ze>this.length)throw new RangeError("out of range index");if(Fe>=ze&&Ce>=Ee)return 0;if(Fe>=ze)return-1;if(Ce>=Ee)return 1;if(Ce>>>=0,Ee>>>=0,Fe>>>=0,ze>>>=0,this===ye)return 0;for(var Ze=ze-Fe,st=Ee-Ce,pt=fe(Ze,st),dt=this.slice(Fe,ze),ft=ye.slice(Ce,Ee),tt=0;tt<pt;++tt)if(dt[tt]!==ft[tt]){Ze=dt[tt],st=ft[tt];break}return Ze<st?-1:st<Ze?1:0},se.prototype.includes=function(ye,Ce,Ee){return this.indexOf(ye,Ce,Ee)!==-1},se.prototype.indexOf=function(ye,Ce,Ee){return Se(this,ye,Ce,Ee,!0)},se.prototype.lastIndexOf=function(ye,Ce,Ee){return Se(this,ye,Ce,Ee,!1)},se.prototype.write=function(ye,Ce,Ee,Fe){if(Ce===void 0)Fe="utf8",Ee=this.length,Ce=0;else if(Ee===void 0&&typeof Ce=="string")Fe=Ce,Ee=this.length,Ce=0;else if(isFinite(Ce))Ce>>>=0,isFinite(Ee)?(Ee>>>=0,Fe===void 0&&(Fe="utf8")):(Fe=Ee,Ee=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ze=this.length-Ce;if((Ee===void 0||Ee>ze)&&(Ee=ze),0<ye.length&&(0>Ee||0>Ce)||Ce>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");for(var Ze=!1;;)switch(Fe){case"hex":return we(this,ye,Ce,Ee);case"utf8":case"utf-8":return ke(this,ye,Ce,Ee);case"ascii":return xe(this,ye,Ce,Ee);case"latin1":case"binary":return Ae(this,ye,Ce,Ee);case"base64":return Le(this,ye,Ce,Ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,ye,Ce,Ee);default:if(Ze)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),Ze=!0}},se.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},se.prototype.slice=function(ye,Ce){var Ee=this.length;ye=~~ye,Ce=Ce===void 0?Ee:~~Ce,0>ye?(ye+=Ee,0>ye&&(ye=0)):ye>Ee&&(ye=Ee),0>Ce?(Ce+=Ee,0>Ce&&(Ce=0)):Ce>Ee&&(Ce=Ee),Ce<ye&&(Ce=ye);var Fe=this.subarray(ye,Ce);return Fe.__proto__=se.prototype,Fe},se.prototype.readUIntLE=function(ye,Ce,Ee){ye>>>=0,Ce>>>=0,Ee||Pe(ye,Ce,this.length);for(var Fe=this[ye],ze=1,Ze=0;++Ze<Ce&&(ze*=256);)Fe+=this[ye+Ze]*ze;return Fe},se.prototype.readUIntBE=function(ye,Ce,Ee){ye>>>=0,Ce>>>=0,Ee||Pe(ye,Ce,this.length);for(var Fe=this[ye+--Ce],ze=1;0<Ce&&(ze*=256);)Fe+=this[ye+--Ce]*ze;return Fe},se.prototype.readUInt8=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,1,this.length),this[ye]},se.prototype.readUInt16LE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,2,this.length),this[ye]|this[ye+1]<<8},se.prototype.readUInt16BE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,2,this.length),this[ye]<<8|this[ye+1]},se.prototype.readUInt32LE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,4,this.length),(this[ye]|this[ye+1]<<8|this[ye+2]<<16)+16777216*this[ye+3]},se.prototype.readUInt32BE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,4,this.length),16777216*this[ye]+(this[ye+1]<<16|this[ye+2]<<8|this[ye+3])},se.prototype.readIntLE=function(ye,Ce,Ee){ye>>>=0,Ce>>>=0,Ee||Pe(ye,Ce,this.length);for(var Fe=this[ye],ze=1,Ze=0;++Ze<Ce&&(ze*=256);)Fe+=this[ye+Ze]*ze;return ze*=128,Fe>=ze&&(Fe-=ee(2,8*Ce)),Fe},se.prototype.readIntBE=function(ye,Ce,Ee){ye>>>=0,Ce>>>=0,Ee||Pe(ye,Ce,this.length);for(var Fe=Ce,ze=1,Ze=this[ye+--Fe];0<Fe&&(ze*=256);)Ze+=this[ye+--Fe]*ze;return ze*=128,Ze>=ze&&(Ze-=ee(2,8*Ce)),Ze},se.prototype.readInt8=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,1,this.length),128&this[ye]?-1*(255-this[ye]+1):this[ye]},se.prototype.readInt16LE=function(ye,Ce){ye>>>=0,Ce||Pe(ye,2,this.length);var Ee=this[ye]|this[ye+1]<<8;return 32768&Ee?4294901760|Ee:Ee},se.prototype.readInt16BE=function(ye,Ce){ye>>>=0,Ce||Pe(ye,2,this.length);var Ee=this[ye+1]|this[ye]<<8;return 32768&Ee?4294901760|Ee:Ee},se.prototype.readInt32LE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,4,this.length),this[ye]|this[ye+1]<<8|this[ye+2]<<16|this[ye+3]<<24},se.prototype.readInt32BE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,4,this.length),this[ye]<<24|this[ye+1]<<16|this[ye+2]<<8|this[ye+3]},se.prototype.readFloatLE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,4,this.length),Be.read(this,ye,!0,23,4)},se.prototype.readFloatBE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,4,this.length),Be.read(this,ye,!1,23,4)},se.prototype.readDoubleLE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,8,this.length),Be.read(this,ye,!0,52,8)},se.prototype.readDoubleBE=function(ye,Ce){return ye>>>=0,Ce||Pe(ye,8,this.length),Be.read(this,ye,!1,52,8)},se.prototype.writeUIntLE=function(ye,Ce,Ee,Fe){if(ye=+ye,Ce>>>=0,Ee>>>=0,!Fe){var ze=ee(2,8*Ee)-1;We(this,ye,Ce,Ee,ze,0)}var Ze=1,st=0;for(this[Ce]=255&ye;++st<Ee&&(Ze*=256);)this[Ce+st]=255&ye/Ze;return Ce+Ee},se.prototype.writeUIntBE=function(ye,Ce,Ee,Fe){if(ye=+ye,Ce>>>=0,Ee>>>=0,!Fe){var ze=ee(2,8*Ee)-1;We(this,ye,Ce,Ee,ze,0)}var Ze=Ee-1,st=1;for(this[Ce+Ze]=255&ye;0<=--Ze&&(st*=256);)this[Ce+Ze]=255&ye/st;return Ce+Ee},se.prototype.writeUInt8=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,1,255,0),this[Ce]=255&ye,Ce+1},se.prototype.writeUInt16LE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,2,65535,0),this[Ce]=255&ye,this[Ce+1]=ye>>>8,Ce+2},se.prototype.writeUInt16BE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,2,65535,0),this[Ce]=ye>>>8,this[Ce+1]=255&ye,Ce+2},se.prototype.writeUInt32LE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,4,4294967295,0),this[Ce+3]=ye>>>24,this[Ce+2]=ye>>>16,this[Ce+1]=ye>>>8,this[Ce]=255&ye,Ce+4},se.prototype.writeUInt32BE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,4,4294967295,0),this[Ce]=ye>>>24,this[Ce+1]=ye>>>16,this[Ce+2]=ye>>>8,this[Ce+3]=255&ye,Ce+4},se.prototype.writeIntLE=function(ye,Ce,Ee,Fe){if(ye=+ye,Ce>>>=0,!Fe){var ze=ee(2,8*Ee-1);We(this,ye,Ce,Ee,ze-1,-ze)}var Ze=0,st=1,pt=0;for(this[Ce]=255&ye;++Ze<Ee&&(st*=256);)0>ye&&pt===0&&this[Ce+Ze-1]!==0&&(pt=1),this[Ce+Ze]=255&(ye/st>>0)-pt;return Ce+Ee},se.prototype.writeIntBE=function(ye,Ce,Ee,Fe){if(ye=+ye,Ce>>>=0,!Fe){var ze=ee(2,8*Ee-1);We(this,ye,Ce,Ee,ze-1,-ze)}var Ze=Ee-1,st=1,pt=0;for(this[Ce+Ze]=255&ye;0<=--Ze&&(st*=256);)0>ye&&pt===0&&this[Ce+Ze+1]!==0&&(pt=1),this[Ce+Ze]=255&(ye/st>>0)-pt;return Ce+Ee},se.prototype.writeInt8=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,1,127,-128),0>ye&&(ye=255+ye+1),this[Ce]=255&ye,Ce+1},se.prototype.writeInt16LE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,2,32767,-32768),this[Ce]=255&ye,this[Ce+1]=ye>>>8,Ce+2},se.prototype.writeInt16BE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,2,32767,-32768),this[Ce]=ye>>>8,this[Ce+1]=255&ye,Ce+2},se.prototype.writeInt32LE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,4,2147483647,-2147483648),this[Ce]=255&ye,this[Ce+1]=ye>>>8,this[Ce+2]=ye>>>16,this[Ce+3]=ye>>>24,Ce+4},se.prototype.writeInt32BE=function(ye,Ce,Ee){return ye=+ye,Ce>>>=0,Ee||We(this,ye,Ce,4,2147483647,-2147483648),0>ye&&(ye=4294967295+ye+1),this[Ce]=ye>>>24,this[Ce+1]=ye>>>16,this[Ce+2]=ye>>>8,this[Ce+3]=255&ye,Ce+4},se.prototype.writeFloatLE=function(ye,Ce,Ee){return Ne(this,ye,Ce,!0,Ee)},se.prototype.writeFloatBE=function(ye,Ce,Ee){return Ne(this,ye,Ce,!1,Ee)},se.prototype.writeDoubleLE=function(ye,Ce,Ee){return Ke(this,ye,Ce,!0,Ee)},se.prototype.writeDoubleBE=function(ye,Ce,Ee){return Ke(this,ye,Ce,!1,Ee)},se.prototype.copy=function(ye,Ce,Ee,Fe){if(!se.isBuffer(ye))throw new TypeError("argument should be a Buffer");if(Ee||(Ee=0),Fe||Fe===0||(Fe=this.length),Ce>=ye.length&&(Ce=ye.length),Ce||(Ce=0),0<Fe&&Fe<Ee&&(Fe=Ee),Fe===Ee||ye.length===0||this.length===0)return 0;if(0>Ce)throw new RangeError("targetStart out of bounds");if(0>Ee||Ee>=this.length)throw new RangeError("Index out of range");if(0>Fe)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),ye.length-Ce<Fe-Ee&&(Fe=ye.length-Ce+Ee);var ze=Fe-Ee;if(this===ye&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(Ce,Ee,Fe);else if(this===ye&&Ee<Ce&&Ce<Fe)for(var Ze=ze-1;0<=Ze;--Ze)ye[Ze+Ce]=this[Ze+Ee];else Uint8Array.prototype.set.call(ye,this.subarray(Ee,Fe),Ce);return ze},se.prototype.fill=function(ye,Ce,Ee,Fe){if(typeof ye=="string"){if(typeof Ce=="string"?(Fe=Ce,Ce=0,Ee=this.length):typeof Ee=="string"&&(Fe=Ee,Ee=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!se.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(ye.length===1){var ze=ye.charCodeAt(0);(Fe==="utf8"&&128>ze||Fe==="latin1")&&(ye=ze)}}else typeof ye=="number"&&(ye&=255);if(0>Ce||this.length<Ce||this.length<Ee)throw new RangeError("Out of range index");if(Ee<=Ce)return this;Ce>>>=0,Ee=Ee===void 0?this.length:Ee>>>0,ye||(ye=0);var Ze;if(typeof ye=="number")for(Ze=Ce;Ze<Ee;++Ze)this[Ze]=ye;else{var st=se.isBuffer(ye)?ye:se.from(ye,Fe),pt=st.length;if(pt===0)throw new TypeError('The value "'+ye+'" is invalid for argument "value"');for(Ze=0;Ze<Ee-Ce;++Ze)this[Ze+Ce]=st[Ze%pt]}return this};var Oe=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,te("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(te,ne,re){(function(ie){(function(){function fe(){let se;try{se=re.storage.getItem("debug")}catch{}return!se&&typeof ie<"u"&&"env"in ie&&(se=ie.env.DEBUG),se}re.formatArgs=function(se){if(se[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+se[0]+(this.useColors?"%c ":" ")+"+"+ne.exports.humanize(this.diff),!this.useColors)return;const oe="color: "+this.color;se.splice(1,0,oe,"color: inherit");let ae=0,le=0;se[0].replace(/%[a-zA-Z%]/g,pe=>{pe==="%%"||(ae++,pe==="%c"&&(le=ae))}),se.splice(le,0,oe)},re.save=function(se){try{se?re.storage.setItem("debug",se):re.storage.removeItem("debug")}catch{}},re.load=fe,re.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},re.storage=function(){try{return localStorage}catch{}}(),re.destroy=(()=>{let se=!1;return()=>{se||(se=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),re.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],re.log=console.debug||console.log||(()=>{}),ne.exports=te("./common")(re);const{formatters:ce}=ne.exports;ce.j=function(se){try{return JSON.stringify(se)}catch(oe){return"[UnexpectedJSONParseError]: "+oe.message}}}).call(this)}).call(this,te("_process"))},{"./common":5,_process:12}],5:[function(te,ne){ne.exports=function(re){function ie(se){function oe(...pe){if(!oe.enabled)return;const ve=oe,ge=+new Date,de=ge-(ae||ge);ve.diff=de,ve.prev=ae,ve.curr=ge,ae=ge,pe[0]=ie.coerce(pe[0]),typeof pe[0]!="string"&&pe.unshift("%O");let ue=0;pe[0]=pe[0].replace(/%([a-zA-Z%])/g,(me,_e)=>{if(me==="%%")return"%";ue++;const be=ie.formatters[_e];if(typeof be=="function"){const Se=pe[ue];me=be.call(ve,Se),pe.splice(ue,1),ue--}return me}),ie.formatArgs.call(ve,pe),(ve.log||ie.log).apply(ve,pe)}let ae,le=null;return oe.namespace=se,oe.useColors=ie.useColors(),oe.color=ie.selectColor(se),oe.extend=fe,oe.destroy=ie.destroy,Object.defineProperty(oe,"enabled",{enumerable:!0,configurable:!1,get:()=>le===null?ie.enabled(se):le,set:pe=>{le=pe}}),typeof ie.init=="function"&&ie.init(oe),oe}function fe(se,oe){const ae=ie(this.namespace+(typeof oe>"u"?":":oe)+se);return ae.log=this.log,ae}function ce(se){return se.toString().substring(2,se.toString().length-2).replace(/\.\*\?$/,"*")}return ie.debug=ie,ie.default=ie,ie.coerce=function(se){return se instanceof Error?se.stack||se.message:se},ie.disable=function(){const se=[...ie.names.map(ce),...ie.skips.map(ce).map(oe=>"-"+oe)].join(",");return ie.enable(""),se},ie.enable=function(se){ie.save(se),ie.names=[],ie.skips=[];let oe;const ae=(typeof se=="string"?se:"").split(/[\s,]+/),le=ae.length;for(oe=0;oe<le;oe++)ae[oe]&&(se=ae[oe].replace(/\*/g,".*?"),se[0]==="-"?ie.skips.push(new RegExp("^"+se.substr(1)+"$")):ie.names.push(new RegExp("^"+se+"$")))},ie.enabled=function(se){if(se[se.length-1]==="*")return!0;let oe,ae;for(oe=0,ae=ie.skips.length;oe<ae;oe++)if(ie.skips[oe].test(se))return!1;for(oe=0,ae=ie.names.length;oe<ae;oe++)if(ie.names[oe].test(se))return!0;return!1},ie.humanize=te("ms"),ie.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(re).forEach(se=>{ie[se]=re[se]}),ie.names=[],ie.skips=[],ie.formatters={},ie.selectColor=function(se){let oe=0;for(let ae=0;ae<se.length;ae++)oe=(oe<<5)-oe+se.charCodeAt(ae),oe|=0;return ie.colors[X(oe)%ie.colors.length]},ie.enable(ie.load()),ie}},{ms:11}],6:[function(te,ne){function re(ie,fe){for(const ce in fe)Object.defineProperty(ie,ce,{value:fe[ce],enumerable:!0,configurable:!0});return ie}ne.exports=function(ie,fe,ce){if(!ie||typeof ie=="string")throw new TypeError("Please pass an Error to err-code");ce||(ce={}),typeof fe=="object"&&(ce=fe,fe=""),fe&&(ce.code=fe);try{return re(ie,ce)}catch{ce.message=ie.message,ce.stack=ie.stack;const oe=function(){};return oe.prototype=Object.create(Object.getPrototypeOf(ie)),re(new oe,ce)}}},{}],7:[function(te,ne){function re(we){console&&console.warn&&console.warn(we)}function ie(){ie.init.call(this)}function fe(we){if(typeof we!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof we)}function ce(we){return we._maxListeners===void 0?ie.defaultMaxListeners:we._maxListeners}function se(we,ke,xe,Ae){var Le,De,$e;if(fe(xe),De=we._events,De===void 0?(De=we._events=Object.create(null),we._eventsCount=0):(De.newListener!==void 0&&(we.emit("newListener",ke,xe.listener?xe.listener:xe),De=we._events),$e=De[ke]),$e===void 0)$e=De[ke]=xe,++we._eventsCount;else if(typeof $e=="function"?$e=De[ke]=Ae?[xe,$e]:[$e,xe]:Ae?$e.unshift(xe):$e.push(xe),Le=ce(we),0<Le&&$e.length>Le&&!$e.warned){$e.warned=!0;var Ve=new Error("Possible EventEmitter memory leak detected. "+$e.length+" "+(ke+" listeners added. Use emitter.setMaxListeners() to increase limit"));Ve.name="MaxListenersExceededWarning",Ve.emitter=we,Ve.type=ke,Ve.count=$e.length,re(Ve)}return we}function oe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ae(we,ke,xe){var Ae={fired:!1,wrapFn:void 0,target:we,type:ke,listener:xe},Le=oe.bind(Ae);return Le.listener=xe,Ae.wrapFn=Le,Le}function le(we,ke,xe){var Ae=we._events;if(Ae===void 0)return[];var Le=Ae[ke];return Le===void 0?[]:typeof Le=="function"?xe?[Le.listener||Le]:[Le]:xe?de(Le):ve(Le,Le.length)}function pe(we){var ke=this._events;if(ke!==void 0){var xe=ke[we];if(typeof xe=="function")return 1;if(xe!==void 0)return xe.length}return 0}function ve(we,ke){for(var xe=Array(ke),Ae=0;Ae<ke;++Ae)xe[Ae]=we[Ae];return xe}function ge(we,ke){for(;ke+1<we.length;ke++)we[ke]=we[ke+1];we.pop()}function de(we){for(var ke=Array(we.length),xe=0;xe<ke.length;++xe)ke[xe]=we[xe].listener||we[xe];return ke}function ue(we,ke,xe){typeof we.on=="function"&&he(we,"error",ke,xe)}function he(we,ke,xe,Ae){if(typeof we.on=="function")Ae.once?we.once(ke,xe):we.on(ke,xe);else if(typeof we.addEventListener=="function")we.addEventListener(ke,function Le(De){Ae.once&&we.removeEventListener(ke,Le),xe(De)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof we)}var me,_e=typeof Reflect=="object"?Reflect:null,be=_e&&typeof _e.apply=="function"?_e.apply:function(we,ke,xe){return Function.prototype.apply.call(we,ke,xe)};me=_e&&typeof _e.ownKeys=="function"?_e.ownKeys:Object.getOwnPropertySymbols?function(we){return Object.getOwnPropertyNames(we).concat(Object.getOwnPropertySymbols(we))}:function(we){return Object.getOwnPropertyNames(we)};var Se=Number.isNaN||function(we){return we!==we};ne.exports=ie,ne.exports.once=function(we,ke){return new Promise(function(xe,Ae){function Le($e){we.removeListener(ke,De),Ae($e)}function De(){typeof we.removeListener=="function"&&we.removeListener("error",Le),xe([].slice.call(arguments))}he(we,ke,De,{once:!0}),ke!=="error"&&ue(we,Le,{once:!0})})},ie.EventEmitter=ie,ie.prototype._events=void 0,ie.prototype._eventsCount=0,ie.prototype._maxListeners=void 0;var Te=10;Object.defineProperty(ie,"defaultMaxListeners",{enumerable:!0,get:function(){return Te},set:function(we){if(typeof we!="number"||0>we||Se(we))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+we+".");Te=we}}),ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ie.prototype.setMaxListeners=function(we){if(typeof we!="number"||0>we||Se(we))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+we+".");return this._maxListeners=we,this},ie.prototype.getMaxListeners=function(){return ce(this)},ie.prototype.emit=function(we){for(var ke=[],xe=1;xe<arguments.length;xe++)ke.push(arguments[xe]);var Ae=we==="error",Le=this._events;if(Le!==void 0)Ae=Ae&&Le.error===void 0;else if(!Ae)return!1;if(Ae){var De;if(0<ke.length&&(De=ke[0]),De instanceof Error)throw De;var $e=new Error("Unhandled error."+(De?" ("+De.message+")":""));throw $e.context=De,$e}var Ve=Le[we];if(Ve===void 0)return!1;if(typeof Ve=="function")be(Ve,this,ke);else for(var Qe=Ve.length,je=ve(Ve,Qe),xe=0;xe<Qe;++xe)be(je[xe],this,ke);return!0},ie.prototype.addListener=function(we,ke){return se(this,we,ke,!1)},ie.prototype.on=ie.prototype.addListener,ie.prototype.prependListener=function(we,ke){return se(this,we,ke,!0)},ie.prototype.once=function(we,ke){return fe(ke),this.on(we,ae(this,we,ke)),this},ie.prototype.prependOnceListener=function(we,ke){return fe(ke),this.prependListener(we,ae(this,we,ke)),this},ie.prototype.removeListener=function(we,ke){var xe,Ae,Le,De,$e;if(fe(ke),Ae=this._events,Ae===void 0)return this;if(xe=Ae[we],xe===void 0)return this;if(xe===ke||xe.listener===ke)--this._eventsCount==0?this._events=Object.create(null):(delete Ae[we],Ae.removeListener&&this.emit("removeListener",we,xe.listener||ke));else if(typeof xe!="function"){for(Le=-1,De=xe.length-1;0<=De;De--)if(xe[De]===ke||xe[De].listener===ke){$e=xe[De].listener,Le=De;break}if(0>Le)return this;Le===0?xe.shift():ge(xe,Le),xe.length===1&&(Ae[we]=xe[0]),Ae.removeListener!==void 0&&this.emit("removeListener",we,$e||ke)}return this},ie.prototype.off=ie.prototype.removeListener,ie.prototype.removeAllListeners=function(we){var ke,xe,Ae;if(xe=this._events,xe===void 0)return this;if(xe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xe[we]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete xe[we]),this;if(arguments.length===0){var Le,De=Object.keys(xe);for(Ae=0;Ae<De.length;++Ae)Le=De[Ae],Le!=="removeListener"&&this.removeAllListeners(Le);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(ke=xe[we],typeof ke=="function")this.removeListener(we,ke);else if(ke!==void 0)for(Ae=ke.length-1;0<=Ae;Ae--)this.removeListener(we,ke[Ae]);return this},ie.prototype.listeners=function(we){return le(this,we,!0)},ie.prototype.rawListeners=function(we){return le(this,we,!1)},ie.listenerCount=function(we,ke){return typeof we.listenerCount=="function"?we.listenerCount(ke):pe.call(we,ke)},ie.prototype.listenerCount=pe,ie.prototype.eventNames=function(){return 0<this._eventsCount?me(this._events):[]}},{}],8:[function(te,ne){ne.exports=function(){if(typeof globalThis>"u")return null;var re={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return re.RTCPeerConnection?re:null}},{}],9:[function(te,ne,re){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */re.read=function(ie,fe,ce,se,oe){var ae,le,pe=8*oe-se-1,ve=(1<<pe)-1,ge=ve>>1,de=-7,ue=ce?oe-1:0,he=ce?-1:1,me=ie[fe+ue];for(ue+=he,ae=me&(1<<-de)-1,me>>=-de,de+=pe;0<de;ae=256*ae+ie[fe+ue],ue+=he,de-=8);for(le=ae&(1<<-de)-1,ae>>=-de,de+=se;0<de;le=256*le+ie[fe+ue],ue+=he,de-=8);if(ae===0)ae=1-ge;else{if(ae===ve)return le?NaN:(me?-1:1)*(1/0);le+=ee(2,se),ae-=ge}return(me?-1:1)*le*ee(2,ae-se)},re.write=function(ie,fe,ce,se,oe,ae){var le,pe,ve,ge=Math.LN2,de=Math.log,ue=8*ae-oe-1,he=(1<<ue)-1,me=he>>1,_e=oe===23?ee(2,-24)-ee(2,-77):0,be=se?0:ae-1,Se=se?1:-1,Te=0>fe||fe===0&&0>1/fe?1:0;for(fe=X(fe),isNaN(fe)||fe===1/0?(pe=isNaN(fe)?1:0,le=he):(le=j(de(fe)/ge),1>fe*(ve=ee(2,-le))&&(le--,ve*=2),fe+=1<=le+me?_e/ve:_e*ee(2,1-me),2<=fe*ve&&(le++,ve/=2),le+me>=he?(pe=0,le=he):1<=le+me?(pe=(fe*ve-1)*ee(2,oe),le+=me):(pe=fe*ee(2,me-1)*ee(2,oe),le=0));8<=oe;ie[ce+be]=255&pe,be+=Se,pe/=256,oe-=8);for(le=le<<oe|pe,ue+=oe;0<ue;ie[ce+be]=255&le,be+=Se,le/=256,ue-=8);ie[ce+be-Se]|=128*Te}},{}],10:[function(te,ne){ne.exports=typeof Object.create=="function"?function(re,ie){ie&&(re.super_=ie,re.prototype=Object.create(ie.prototype,{constructor:{value:re,enumerable:!1,writable:!0,configurable:!0}}))}:function(re,ie){if(ie){re.super_=ie;var fe=function(){};fe.prototype=ie.prototype,re.prototype=new fe,re.prototype.constructor=re}}},{}],11:[function(te,ne){var re=Math.round;function ie(oe){if(oe+="",!(100<oe.length)){var ae=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(oe);if(ae){var le=parseFloat(ae[1]),pe=(ae[2]||"ms").toLowerCase();return pe==="years"||pe==="year"||pe==="yrs"||pe==="yr"||pe==="y"?315576e5*le:pe==="weeks"||pe==="week"||pe==="w"?6048e5*le:pe==="days"||pe==="day"||pe==="d"?864e5*le:pe==="hours"||pe==="hour"||pe==="hrs"||pe==="hr"||pe==="h"?36e5*le:pe==="minutes"||pe==="minute"||pe==="mins"||pe==="min"||pe==="m"?6e4*le:pe==="seconds"||pe==="second"||pe==="secs"||pe==="sec"||pe==="s"?1e3*le:pe==="milliseconds"||pe==="millisecond"||pe==="msecs"||pe==="msec"||pe==="ms"?le:void 0}}}function fe(oe){var ae=X(oe);return 864e5<=ae?re(oe/864e5)+"d":36e5<=ae?re(oe/36e5)+"h":6e4<=ae?re(oe/6e4)+"m":1e3<=ae?re(oe/1e3)+"s":oe+"ms"}function ce(oe){var ae=X(oe);return 864e5<=ae?se(oe,ae,864e5,"day"):36e5<=ae?se(oe,ae,36e5,"hour"):6e4<=ae?se(oe,ae,6e4,"minute"):1e3<=ae?se(oe,ae,1e3,"second"):oe+" ms"}function se(oe,ae,le,pe){return re(oe/le)+" "+pe+(ae>=1.5*le?"s":"")}ne.exports=function(oe,ae){ae=ae||{};var le=typeof oe;if(le=="string"&&0<oe.length)return ie(oe);if(le==="number"&&isFinite(oe))return ae.long?ce(oe):fe(oe);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(oe))}},{}],12:[function(te,ne){function re(){throw new Error("setTimeout has not been defined")}function ie(){throw new Error("clearTimeout has not been defined")}function fe(_e){if(pe===setTimeout)return setTimeout(_e,0);if((pe===re||!pe)&&setTimeout)return pe=setTimeout,setTimeout(_e,0);try{return pe(_e,0)}catch{try{return pe.call(null,_e,0)}catch{return pe.call(this,_e,0)}}}function ce(_e){if(ve===clearTimeout)return clearTimeout(_e);if((ve===ie||!ve)&&clearTimeout)return ve=clearTimeout,clearTimeout(_e);try{return ve(_e)}catch{try{return ve.call(null,_e)}catch{return ve.call(this,_e)}}}function se(){he&&de&&(he=!1,de.length?ue=de.concat(ue):me=-1,ue.length&&oe())}function oe(){if(!he){var _e=fe(se);he=!0;for(var be=ue.length;be;){for(de=ue,ue=[];++me<be;)de&&de[me].run();me=-1,be=ue.length}de=null,he=!1,ce(_e)}}function ae(_e,be){this.fun=_e,this.array=be}function le(){}var pe,ve,ge=ne.exports={};(function(){try{pe=typeof setTimeout=="function"?setTimeout:re}catch{pe=re}try{ve=typeof clearTimeout=="function"?clearTimeout:ie}catch{ve=ie}})();var de,ue=[],he=!1,me=-1;ge.nextTick=function(_e){var be=Array(arguments.length-1);if(1<arguments.length)for(var Se=1;Se<arguments.length;Se++)be[Se-1]=arguments[Se];ue.push(new ae(_e,be)),ue.length!==1||he||fe(oe)},ae.prototype.run=function(){this.fun.apply(null,this.array)},ge.title="browser",ge.browser=!0,ge.env={},ge.argv=[],ge.version="",ge.versions={},ge.on=le,ge.addListener=le,ge.once=le,ge.off=le,ge.removeListener=le,ge.removeAllListeners=le,ge.emit=le,ge.prependListener=le,ge.prependOnceListener=le,ge.listeners=function(){return[]},ge.binding=function(){throw new Error("process.binding is not supported")},ge.cwd=function(){return"/"},ge.chdir=function(){throw new Error("process.chdir is not supported")},ge.umask=function(){return 0}},{}],13:[function(te,ne){(function(re){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let ie;ne.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?re:window):fe=>(ie||(ie=Promise.resolve())).then(fe).catch(ce=>setTimeout(()=>{throw ce},0))}).call(this)}).call(this,typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{}],14:[function(te,ne){(function(re,ie){(function(){var fe=te("safe-buffer").Buffer,ce=ie.crypto||ie.msCrypto;ne.exports=ce&&ce.getRandomValues?function(se,oe){if(se>4294967295)throw new RangeError("requested too many random bytes");var ae=fe.allocUnsafe(se);if(0<se)if(65536<se)for(var le=0;le<se;le+=65536)ce.getRandomValues(ae.slice(le,le+65536));else ce.getRandomValues(ae);return typeof oe=="function"?re.nextTick(function(){oe(null,ae)}):ae}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,te("_process"),typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{_process:12,"safe-buffer":30}],15:[function(te,ne){function re(le,pe){le.prototype=Object.create(pe.prototype),le.prototype.constructor=le,le.__proto__=pe}function ie(le,pe,ve){function ge(ue,he,me){return typeof pe=="string"?pe:pe(ue,he,me)}ve||(ve=Error);var de=function(ue){function he(me,_e,be){return ue.call(this,ge(me,_e,be))||this}return re(he,ue),he}(ve);de.prototype.name=ve.name,de.prototype.code=le,ae[le]=de}function fe(le,pe){if(Array.isArray(le)){var ve=le.length;return le=le.map(function(ge){return ge+""}),2<ve?"one of ".concat(pe," ").concat(le.slice(0,ve-1).join(", "),", or ")+le[ve-1]:ve===2?"one of ".concat(pe," ").concat(le[0]," or ").concat(le[1]):"of ".concat(pe," ").concat(le[0])}return"of ".concat(pe," ").concat(le+"")}function ce(le,pe,ve){return le.substr(!ve||0>ve?0:+ve,pe.length)===pe}function se(le,pe,ve){return(ve===void 0||ve>le.length)&&(ve=le.length),le.substring(ve-pe.length,ve)===pe}function oe(le,pe,ve){return typeof ve!="number"&&(ve=0),!(ve+pe.length>le.length)&&le.indexOf(pe,ve)!==-1}var ae={};ie("ERR_INVALID_OPT_VALUE",function(le,pe){return'The value "'+pe+'" is invalid for option "'+le+'"'},TypeError),ie("ERR_INVALID_ARG_TYPE",function(le,pe,ve){var ge;typeof pe=="string"&&ce(pe,"not ")?(ge="must not be",pe=pe.replace(/^not /,"")):ge="must be";var de;if(se(le," argument"))de="The ".concat(le," ").concat(ge," ").concat(fe(pe,"type"));else{var ue=oe(le,".")?"property":"argument";de='The "'.concat(le,'" ').concat(ue," ").concat(ge," ").concat(fe(pe,"type"))}return de+=". Received type ".concat(typeof ve),de},TypeError),ie("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),ie("ERR_METHOD_NOT_IMPLEMENTED",function(le){return"The "+le+" method is not implemented"}),ie("ERR_STREAM_PREMATURE_CLOSE","Premature close"),ie("ERR_STREAM_DESTROYED",function(le){return"Cannot call "+le+" after a stream was destroyed"}),ie("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),ie("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),ie("ERR_STREAM_WRITE_AFTER_END","write after end"),ie("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),ie("ERR_UNKNOWN_ENCODING",function(le){return"Unknown encoding: "+le},TypeError),ie("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ne.exports.codes=ae},{}],16:[function(te,ne){(function(re){(function(){function ie(ge){return this instanceof ie?(oe.call(this,ge),ae.call(this,ge),this.allowHalfOpen=!0,void(ge&&(ge.readable===!1&&(this.readable=!1),ge.writable===!1&&(this.writable=!1),ge.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",fe))))):new ie(ge)}function fe(){this._writableState.ended||re.nextTick(ce,this)}function ce(ge){ge.end()}var se=Object.keys||function(ge){var de=[];for(var ue in ge)de.push(ue);return de};ne.exports=ie;var oe=te("./_stream_readable"),ae=te("./_stream_writable");te("inherits")(ie,oe);for(var le,pe=se(ae.prototype),ve=0;ve<pe.length;ve++)le=pe[ve],ie.prototype[le]||(ie.prototype[le]=ae.prototype[le]);Object.defineProperty(ie.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(ie.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ie.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ie.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(ge){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=ge,this._writableState.destroyed=ge)}})}).call(this)}).call(this,te("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(te,ne){function re(fe){return this instanceof re?void ie.call(this,fe):new re(fe)}ne.exports=re;var ie=te("./_stream_transform");te("inherits")(re,ie),re.prototype._transform=function(fe,ce,se){se(null,fe)}},{"./_stream_transform":19,inherits:10}],18:[function(te,ne){(function(re,ie){(function(){function fe(Oe){return Ue.from(Oe)}function ce(Oe){return Ue.isBuffer(Oe)||Oe instanceof Pe}function se(Oe,ye,Ce){return typeof Oe.prependListener=="function"?Oe.prependListener(ye,Ce):void(Oe._events&&Oe._events[ye]?Array.isArray(Oe._events[ye])?Oe._events[ye].unshift(Ce):Oe._events[ye]=[Ce,Oe._events[ye]]:Oe.on(ye,Ce))}function oe(Oe,ye,Ce){Qe=Qe||te("./_stream_duplex"),Oe=Oe||{},typeof Ce!="boolean"&&(Ce=ye instanceof Qe),this.objectMode=!!Oe.objectMode,Ce&&(this.objectMode=this.objectMode||!!Oe.readableObjectMode),this.highWaterMark=ot(this,Oe,"readableHighWaterMark",Ce),this.buffer=new Xe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Oe.emitClose!==!1,this.autoDestroy=!!Oe.autoDestroy,this.destroyed=!1,this.defaultEncoding=Oe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Oe.encoding&&(!Ye&&(Ye=te("string_decoder/").StringDecoder),this.decoder=new Ye(Oe.encoding),this.encoding=Oe.encoding)}function ae(Oe){if(Qe=Qe||te("./_stream_duplex"),!(this instanceof ae))return new ae(Oe);var ye=this instanceof Qe;this._readableState=new oe(Oe,this,ye),this.readable=!0,Oe&&(typeof Oe.read=="function"&&(this._read=Oe.read),typeof Oe.destroy=="function"&&(this._destroy=Oe.destroy)),Ie.call(this)}function le(Oe,ye,Ce,Ee,Fe){je("readableAddChunk",ye);var ze=Oe._readableState;if(ye===null)ze.reading=!1,ue(Oe,ze);else{var Ze;if(Fe||(Ze=ve(ze,ye)),Ze)qe(Oe,Ze);else if(!(ze.objectMode||ye&&0<ye.length))Ee||(ze.reading=!1,_e(Oe,ze));else if(typeof ye=="string"||ze.objectMode||Object.getPrototypeOf(ye)===Ue.prototype||(ye=fe(ye)),Ee)ze.endEmitted?qe(Oe,new Me):pe(Oe,ze,ye,!0);else if(ze.ended)qe(Oe,new ut);else{if(ze.destroyed)return!1;ze.reading=!1,ze.decoder&&!Ce?(ye=ze.decoder.write(ye),ze.objectMode||ye.length!==0?pe(Oe,ze,ye,!1):_e(Oe,ze)):pe(Oe,ze,ye,!1)}}return!ze.ended&&(ze.length<ze.highWaterMark||ze.length===0)}function pe(Oe,ye,Ce,Ee){ye.flowing&&ye.length===0&&!ye.sync?(ye.awaitDrain=0,Oe.emit("data",Ce)):(ye.length+=ye.objectMode?1:Ce.length,Ee?ye.buffer.unshift(Ce):ye.buffer.push(Ce),ye.needReadable&&he(Oe)),_e(Oe,ye)}function ve(Oe,ye){var Ce;return ce(ye)||typeof ye=="string"||ye===void 0||Oe.objectMode||(Ce=new ct("chunk",["string","Buffer","Uint8Array"],ye)),Ce}function ge(Oe){return 1073741824<=Oe?Oe=1073741824:(Oe--,Oe|=Oe>>>1,Oe|=Oe>>>2,Oe|=Oe>>>4,Oe|=Oe>>>8,Oe|=Oe>>>16,Oe++),Oe}function de(Oe,ye){return 0>=Oe||ye.length===0&&ye.ended?0:ye.objectMode?1:Oe===Oe?(Oe>ye.highWaterMark&&(ye.highWaterMark=ge(Oe)),Oe<=ye.length?Oe:ye.ended?ye.length:(ye.needReadable=!0,0)):ye.flowing&&ye.length?ye.buffer.head.data.length:ye.length}function ue(Oe,ye){if(je("onEofChunk"),!ye.ended){if(ye.decoder){var Ce=ye.decoder.end();Ce&&Ce.length&&(ye.buffer.push(Ce),ye.length+=ye.objectMode?1:Ce.length)}ye.ended=!0,ye.sync?he(Oe):(ye.needReadable=!1,!ye.emittedReadable&&(ye.emittedReadable=!0,me(Oe)))}}function he(Oe){var ye=Oe._readableState;je("emitReadable",ye.needReadable,ye.emittedReadable),ye.needReadable=!1,ye.emittedReadable||(je("emitReadable",ye.flowing),ye.emittedReadable=!0,re.nextTick(me,Oe))}function me(Oe){var ye=Oe._readableState;je("emitReadable_",ye.destroyed,ye.length,ye.ended),!ye.destroyed&&(ye.length||ye.ended)&&(Oe.emit("readable"),ye.emittedReadable=!1),ye.needReadable=!ye.flowing&&!ye.ended&&ye.length<=ye.highWaterMark,Ae(Oe)}function _e(Oe,ye){ye.readingMore||(ye.readingMore=!0,re.nextTick(be,Oe,ye))}function be(Oe,ye){for(;!ye.reading&&!ye.ended&&(ye.length<ye.highWaterMark||ye.flowing&&ye.length===0);){var Ce=ye.length;if(je("maybeReadMore read 0"),Oe.read(0),Ce===ye.length)break}ye.readingMore=!1}function Se(Oe){return function(){var ye=Oe._readableState;je("pipeOnDrain",ye.awaitDrain),ye.awaitDrain&&ye.awaitDrain--,ye.awaitDrain===0&&He(Oe,"data")&&(ye.flowing=!0,Ae(Oe))}}function Te(Oe){var ye=Oe._readableState;ye.readableListening=0<Oe.listenerCount("readable"),ye.resumeScheduled&&!ye.paused?ye.flowing=!0:0<Oe.listenerCount("data")&&Oe.resume()}function we(Oe){je("readable nexttick read 0"),Oe.read(0)}function ke(Oe,ye){ye.resumeScheduled||(ye.resumeScheduled=!0,re.nextTick(xe,Oe,ye))}function xe(Oe,ye){je("resume",ye.reading),ye.reading||Oe.read(0),ye.resumeScheduled=!1,Oe.emit("resume"),Ae(Oe),ye.flowing&&!ye.reading&&Oe.read(0)}function Ae(Oe){var ye=Oe._readableState;for(je("flow",ye.flowing);ye.flowing&&Oe.read()!==null;);}function Le(Oe,ye){if(ye.length===0)return null;var Ce;return ye.objectMode?Ce=ye.buffer.shift():!Oe||Oe>=ye.length?(Ce=ye.decoder?ye.buffer.join(""):ye.buffer.length===1?ye.buffer.first():ye.buffer.concat(ye.length),ye.buffer.clear()):Ce=ye.buffer.consume(Oe,ye.decoder),Ce}function De(Oe){var ye=Oe._readableState;je("endReadable",ye.endEmitted),ye.endEmitted||(ye.ended=!0,re.nextTick($e,ye,Oe))}function $e(Oe,ye){if(je("endReadableNT",Oe.endEmitted,Oe.length),!Oe.endEmitted&&Oe.length===0&&(Oe.endEmitted=!0,ye.readable=!1,ye.emit("end"),Oe.autoDestroy)){var Ce=ye._writableState;(!Ce||Ce.autoDestroy&&Ce.finished)&&ye.destroy()}}function Ve(Oe,ye){for(var Ce=0,Ee=Oe.length;Ce<Ee;Ce++)if(Oe[Ce]===ye)return Ce;return-1}ne.exports=ae;var Qe;ae.ReadableState=oe;var je;te("events").EventEmitter;var He=function(Oe,ye){return Oe.listeners(ye).length},Ie=te("./internal/streams/stream"),Ue=te("buffer").Buffer,Pe=ie.Uint8Array||function(){},We=te("util");je=We&&We.debuglog?We.debuglog("stream"):function(){};var Ye,Ne,Ke,Xe=te("./internal/streams/buffer_list"),Je=te("./internal/streams/destroy"),nt=te("./internal/streams/state"),ot=nt.getHighWaterMark,ht=te("../errors").codes,ct=ht.ERR_INVALID_ARG_TYPE,ut=ht.ERR_STREAM_PUSH_AFTER_EOF,Re=ht.ERR_METHOD_NOT_IMPLEMENTED,Me=ht.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;te("inherits")(ae,Ie);var qe=Je.errorOrDestroy,Be=["error","close","destroy","pause","resume"];Object.defineProperty(ae.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(Oe){this._readableState&&(this._readableState.destroyed=Oe)}}),ae.prototype.destroy=Je.destroy,ae.prototype._undestroy=Je.undestroy,ae.prototype._destroy=function(Oe,ye){ye(Oe)},ae.prototype.push=function(Oe,ye){var Ce,Ee=this._readableState;return Ee.objectMode?Ce=!0:typeof Oe=="string"&&(ye=ye||Ee.defaultEncoding,ye!==Ee.encoding&&(Oe=Ue.from(Oe,ye),ye=""),Ce=!0),le(this,Oe,ye,!1,Ce)},ae.prototype.unshift=function(Oe){return le(this,Oe,null,!0,!1)},ae.prototype.isPaused=function(){return this._readableState.flowing===!1},ae.prototype.setEncoding=function(Oe){Ye||(Ye=te("string_decoder/").StringDecoder);var ye=new Ye(Oe);this._readableState.decoder=ye,this._readableState.encoding=this._readableState.decoder.encoding;for(var Ce=this._readableState.buffer.head,Ee="";Ce!==null;)Ee+=ye.write(Ce.data),Ce=Ce.next;return this._readableState.buffer.clear(),Ee!==""&&this._readableState.buffer.push(Ee),this._readableState.length=Ee.length,this},ae.prototype.read=function(Oe){je("read",Oe),Oe=parseInt(Oe,10);var ye=this._readableState,Ce=Oe;if(Oe!==0&&(ye.emittedReadable=!1),Oe===0&&ye.needReadable&&((ye.highWaterMark===0?0<ye.length:ye.length>=ye.highWaterMark)||ye.ended))return je("read: emitReadable",ye.length,ye.ended),ye.length===0&&ye.ended?De(this):he(this),null;if(Oe=de(Oe,ye),Oe===0&&ye.ended)return ye.length===0&&De(this),null;var Ee=ye.needReadable;je("need readable",Ee),(ye.length===0||ye.length-Oe<ye.highWaterMark)&&(Ee=!0,je("length less than watermark",Ee)),ye.ended||ye.reading?(Ee=!1,je("reading or ended",Ee)):Ee&&(je("do read"),ye.reading=!0,ye.sync=!0,ye.length===0&&(ye.needReadable=!0),this._read(ye.highWaterMark),ye.sync=!1,!ye.reading&&(Oe=de(Ce,ye)));var Fe;return Fe=0<Oe?Le(Oe,ye):null,Fe===null?(ye.needReadable=ye.length<=ye.highWaterMark,Oe=0):(ye.length-=Oe,ye.awaitDrain=0),ye.length===0&&(!ye.ended&&(ye.needReadable=!0),Ce!==Oe&&ye.ended&&De(this)),Fe!==null&&this.emit("data",Fe),Fe},ae.prototype._read=function(){qe(this,new Re("_read()"))},ae.prototype.pipe=function(Oe,ye){function Ce(Mt,Bt){je("onunpipe"),Mt===ft&&Bt&&Bt.hasUnpiped===!1&&(Bt.hasUnpiped=!0,Fe())}function Ee(){je("onend"),Oe.end()}function Fe(){je("cleanup"),Oe.removeListener("close",st),Oe.removeListener("finish",pt),Oe.removeListener("drain",Ut),Oe.removeListener("error",Ze),Oe.removeListener("unpipe",Ce),ft.removeListener("end",Ee),ft.removeListener("end",dt),ft.removeListener("data",ze),Dt=!0,tt.awaitDrain&&(!Oe._writableState||Oe._writableState.needDrain)&&Ut()}function ze(Mt){je("ondata");var Bt=Oe.write(Mt);je("dest.write",Bt),Bt===!1&&((tt.pipesCount===1&&tt.pipes===Oe||1<tt.pipesCount&&Ve(tt.pipes,Oe)!==-1)&&!Dt&&(je("false write response, pause",tt.awaitDrain),tt.awaitDrain++),ft.pause())}function Ze(Mt){je("onerror",Mt),dt(),Oe.removeListener("error",Ze),He(Oe,"error")===0&&qe(Oe,Mt)}function st(){Oe.removeListener("finish",pt),dt()}function pt(){je("onfinish"),Oe.removeListener("close",st),dt()}function dt(){je("unpipe"),ft.unpipe(Oe)}var ft=this,tt=this._readableState;switch(tt.pipesCount){case 0:tt.pipes=Oe;break;case 1:tt.pipes=[tt.pipes,Oe];break;default:tt.pipes.push(Oe)}tt.pipesCount+=1,je("pipe count=%d opts=%j",tt.pipesCount,ye);var mt=(!ye||ye.end!==!1)&&Oe!==re.stdout&&Oe!==re.stderr,Lt=mt?Ee:dt;tt.endEmitted?re.nextTick(Lt):ft.once("end",Lt),Oe.on("unpipe",Ce);var Ut=Se(ft);Oe.on("drain",Ut);var Dt=!1;return ft.on("data",ze),se(Oe,"error",Ze),Oe.once("close",st),Oe.once("finish",pt),Oe.emit("pipe",ft),tt.flowing||(je("pipe resume"),ft.resume()),Oe},ae.prototype.unpipe=function(Oe){var ye=this._readableState,Ce={hasUnpiped:!1};if(ye.pipesCount===0)return this;if(ye.pipesCount===1)return Oe&&Oe!==ye.pipes?this:(Oe||(Oe=ye.pipes),ye.pipes=null,ye.pipesCount=0,ye.flowing=!1,Oe&&Oe.emit("unpipe",this,Ce),this);if(!Oe){var Ee=ye.pipes,Fe=ye.pipesCount;ye.pipes=null,ye.pipesCount=0,ye.flowing=!1;for(var ze=0;ze<Fe;ze++)Ee[ze].emit("unpipe",this,{hasUnpiped:!1});return this}var Ze=Ve(ye.pipes,Oe);return Ze===-1?this:(ye.pipes.splice(Ze,1),ye.pipesCount-=1,ye.pipesCount===1&&(ye.pipes=ye.pipes[0]),Oe.emit("unpipe",this,Ce),this)},ae.prototype.on=function(Oe,ye){var Ce=Ie.prototype.on.call(this,Oe,ye),Ee=this._readableState;return Oe==="data"?(Ee.readableListening=0<this.listenerCount("readable"),Ee.flowing!==!1&&this.resume()):Oe=="readable"&&!Ee.endEmitted&&!Ee.readableListening&&(Ee.readableListening=Ee.needReadable=!0,Ee.flowing=!1,Ee.emittedReadable=!1,je("on readable",Ee.length,Ee.reading),Ee.length?he(this):!Ee.reading&&re.nextTick(we,this)),Ce},ae.prototype.addListener=ae.prototype.on,ae.prototype.removeListener=function(Oe,ye){var Ce=Ie.prototype.removeListener.call(this,Oe,ye);return Oe==="readable"&&re.nextTick(Te,this),Ce},ae.prototype.removeAllListeners=function(Oe){var ye=Ie.prototype.removeAllListeners.apply(this,arguments);return(Oe==="readable"||Oe===void 0)&&re.nextTick(Te,this),ye},ae.prototype.resume=function(){var Oe=this._readableState;return Oe.flowing||(je("resume"),Oe.flowing=!Oe.readableListening,ke(this,Oe)),Oe.paused=!1,this},ae.prototype.pause=function(){return je("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(je("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},ae.prototype.wrap=function(Oe){var ye=this,Ce=this._readableState,Ee=!1;for(var Fe in Oe.on("end",function(){if(je("wrapped end"),Ce.decoder&&!Ce.ended){var Ze=Ce.decoder.end();Ze&&Ze.length&&ye.push(Ze)}ye.push(null)}),Oe.on("data",function(Ze){if(je("wrapped data"),Ce.decoder&&(Ze=Ce.decoder.write(Ze)),!(Ce.objectMode&&Ze==null)&&(Ce.objectMode||Ze&&Ze.length)){var st=ye.push(Ze);st||(Ee=!0,Oe.pause())}}),Oe)this[Fe]===void 0&&typeof Oe[Fe]=="function"&&(this[Fe]=function(Ze){return function(){return Oe[Ze].apply(Oe,arguments)}}(Fe));for(var ze=0;ze<Be.length;ze++)Oe.on(Be[ze],this.emit.bind(this,Be[ze]));return this._read=function(Ze){je("wrapped _read",Ze),Ee&&(Ee=!1,Oe.resume())},this},typeof Symbol=="function"&&(ae.prototype[Symbol.asyncIterator]=function(){return Ne===void 0&&(Ne=te("./internal/streams/async_iterator")),Ne(this)}),Object.defineProperty(ae.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ae.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ae.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Oe){this._readableState&&(this._readableState.flowing=Oe)}}),ae._fromList=Le,Object.defineProperty(ae.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(ae.from=function(Oe,ye){return Ke===void 0&&(Ke=te("./internal/streams/from")),Ke(ae,Oe,ye)})}).call(this)}).call(this,te("_process"),typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(te,ne){function re(ge,de){var ue=this._transformState;ue.transforming=!1;var he=ue.writecb;if(he===null)return this.emit("error",new ae);ue.writechunk=null,ue.writecb=null,de!=null&&this.push(de),he(ge);var me=this._readableState;me.reading=!1,(me.needReadable||me.length<me.highWaterMark)&&this._read(me.highWaterMark)}function ie(ge){return this instanceof ie?(ve.call(this,ge),this._transformState={afterTransform:re.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,ge&&(typeof ge.transform=="function"&&(this._transform=ge.transform),typeof ge.flush=="function"&&(this._flush=ge.flush)),void this.on("prefinish",fe)):new ie(ge)}function fe(){var ge=this;typeof this._flush!="function"||this._readableState.destroyed?ce(this,null,null):this._flush(function(de,ue){ce(ge,de,ue)})}function ce(ge,de,ue){if(de)return ge.emit("error",de);if(ue!=null&&ge.push(ue),ge._writableState.length)throw new pe;if(ge._transformState.transforming)throw new le;return ge.push(null)}ne.exports=ie;var se=te("../errors").codes,oe=se.ERR_METHOD_NOT_IMPLEMENTED,ae=se.ERR_MULTIPLE_CALLBACK,le=se.ERR_TRANSFORM_ALREADY_TRANSFORMING,pe=se.ERR_TRANSFORM_WITH_LENGTH_0,ve=te("./_stream_duplex");te("inherits")(ie,ve),ie.prototype.push=function(ge,de){return this._transformState.needTransform=!1,ve.prototype.push.call(this,ge,de)},ie.prototype._transform=function(ge,de,ue){ue(new oe("_transform()"))},ie.prototype._write=function(ge,de,ue){var he=this._transformState;if(he.writecb=ue,he.writechunk=ge,he.writeencoding=de,!he.transforming){var me=this._readableState;(he.needTransform||me.needReadable||me.length<me.highWaterMark)&&this._read(me.highWaterMark)}},ie.prototype._read=function(){var ge=this._transformState;ge.writechunk===null||ge.transforming?ge.needTransform=!0:(ge.transforming=!0,this._transform(ge.writechunk,ge.writeencoding,ge.afterTransform))},ie.prototype._destroy=function(ge,de){ve.prototype._destroy.call(this,ge,function(ue){de(ue)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(te,ne){(function(re,ie){(function(){function fe(Re){var Me=this;this.next=null,this.entry=null,this.finish=function(){De(Me,Re)}}function ce(Re){return je.from(Re)}function se(Re){return je.isBuffer(Re)||Re instanceof He}function oe(){}function ae(Re,Me,qe){$e=$e||te("./_stream_duplex"),Re=Re||{},typeof qe!="boolean"&&(qe=Me instanceof $e),this.objectMode=!!Re.objectMode,qe&&(this.objectMode=this.objectMode||!!Re.writableObjectMode),this.highWaterMark=Pe(this,Re,"writableHighWaterMark",qe),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Be=Re.decodeStrings===!1;this.decodeStrings=!Be,this.defaultEncoding=Re.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Oe){_e(Me,Oe)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Re.emitClose!==!1,this.autoDestroy=!!Re.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new fe(this)}function le(Re){$e=$e||te("./_stream_duplex");var Me=this instanceof $e;return Me||ut.call(le,this)?(this._writableState=new ae(Re,this,Me),this.writable=!0,Re&&(typeof Re.write=="function"&&(this._write=Re.write),typeof Re.writev=="function"&&(this._writev=Re.writev),typeof Re.destroy=="function"&&(this._destroy=Re.destroy),typeof Re.final=="function"&&(this._final=Re.final)),void Qe.call(this)):new le(Re)}function pe(Re,Me){var qe=new ot;ct(Re,qe),re.nextTick(Me,qe)}function ve(Re,Me,qe,Be){var Oe;return qe===null?Oe=new nt:typeof qe!="string"&&!Me.objectMode&&(Oe=new Ye("chunk",["string","Buffer"],qe)),!Oe||(ct(Re,Oe),re.nextTick(Be,Oe),!1)}function ge(Re,Me,qe){return Re.objectMode||Re.decodeStrings===!1||typeof Me!="string"||(Me=je.from(Me,qe)),Me}function de(Re,Me,qe,Be,Oe,ye){if(!qe){var Ce=ge(Me,Be,Oe);Be!==Ce&&(qe=!0,Oe="buffer",Be=Ce)}var Ee=Me.objectMode?1:Be.length;Me.length+=Ee;var Fe=Me.length<Me.highWaterMark;if(Fe||(Me.needDrain=!0),Me.writing||Me.corked){var ze=Me.lastBufferedRequest;Me.lastBufferedRequest={chunk:Be,encoding:Oe,isBuf:qe,callback:ye,next:null},ze?ze.next=Me.lastBufferedRequest:Me.bufferedRequest=Me.lastBufferedRequest,Me.bufferedRequestCount+=1}else ue(Re,Me,!1,Ee,Be,Oe,ye);return Fe}function ue(Re,Me,qe,Be,Oe,ye,Ce){Me.writelen=Be,Me.writecb=Ce,Me.writing=!0,Me.sync=!0,Me.destroyed?Me.onwrite(new Je("write")):qe?Re._writev(Oe,Me.onwrite):Re._write(Oe,ye,Me.onwrite),Me.sync=!1}function he(Re,Me,qe,Be,Oe){--Me.pendingcb,qe?(re.nextTick(Oe,Be),re.nextTick(Ae,Re,Me),Re._writableState.errorEmitted=!0,ct(Re,Be)):(Oe(Be),Re._writableState.errorEmitted=!0,ct(Re,Be),Ae(Re,Me))}function me(Re){Re.writing=!1,Re.writecb=null,Re.length-=Re.writelen,Re.writelen=0}function _e(Re,Me){var qe=Re._writableState,Be=qe.sync,Oe=qe.writecb;if(typeof Oe!="function")throw new Ke;if(me(qe),Me)he(Re,qe,Be,Me,Oe);else{var ye=we(qe)||Re.destroyed;ye||qe.corked||qe.bufferProcessing||!qe.bufferedRequest||Te(Re,qe),Be?re.nextTick(be,Re,qe,ye,Oe):be(Re,qe,ye,Oe)}}function be(Re,Me,qe,Be){qe||Se(Re,Me),Me.pendingcb--,Be(),Ae(Re,Me)}function Se(Re,Me){Me.length===0&&Me.needDrain&&(Me.needDrain=!1,Re.emit("drain"))}function Te(Re,Me){Me.bufferProcessing=!0;var qe=Me.bufferedRequest;if(Re._writev&&qe&&qe.next){var Be=Me.bufferedRequestCount,Oe=Array(Be),ye=Me.corkedRequestsFree;ye.entry=qe;for(var Ce=0,Ee=!0;qe;)Oe[Ce]=qe,qe.isBuf||(Ee=!1),qe=qe.next,Ce+=1;Oe.allBuffers=Ee,ue(Re,Me,!0,Me.length,Oe,"",ye.finish),Me.pendingcb++,Me.lastBufferedRequest=null,ye.next?(Me.corkedRequestsFree=ye.next,ye.next=null):Me.corkedRequestsFree=new fe(Me),Me.bufferedRequestCount=0}else{for(;qe;){var Fe=qe.chunk,ze=qe.encoding,Ze=qe.callback,st=Me.objectMode?1:Fe.length;if(ue(Re,Me,!1,st,Fe,ze,Ze),qe=qe.next,Me.bufferedRequestCount--,Me.writing)break}qe===null&&(Me.lastBufferedRequest=null)}Me.bufferedRequest=qe,Me.bufferProcessing=!1}function we(Re){return Re.ending&&Re.length===0&&Re.bufferedRequest===null&&!Re.finished&&!Re.writing}function ke(Re,Me){Re._final(function(qe){Me.pendingcb--,qe&&ct(Re,qe),Me.prefinished=!0,Re.emit("prefinish"),Ae(Re,Me)})}function xe(Re,Me){Me.prefinished||Me.finalCalled||(typeof Re._final!="function"||Me.destroyed?(Me.prefinished=!0,Re.emit("prefinish")):(Me.pendingcb++,Me.finalCalled=!0,re.nextTick(ke,Re,Me)))}function Ae(Re,Me){var qe=we(Me);if(qe&&(xe(Re,Me),Me.pendingcb===0&&(Me.finished=!0,Re.emit("finish"),Me.autoDestroy))){var Be=Re._readableState;(!Be||Be.autoDestroy&&Be.endEmitted)&&Re.destroy()}return qe}function Le(Re,Me,qe){Me.ending=!0,Ae(Re,Me),qe&&(Me.finished?re.nextTick(qe):Re.once("finish",qe)),Me.ended=!0,Re.writable=!1}function De(Re,Me,qe){var Be=Re.entry;for(Re.entry=null;Be;){var Oe=Be.callback;Me.pendingcb--,Oe(qe),Be=Be.next}Me.corkedRequestsFree.next=Re}ne.exports=le;var $e;le.WritableState=ae;var Ve={deprecate:te("util-deprecate")},Qe=te("./internal/streams/stream"),je=te("buffer").Buffer,He=ie.Uint8Array||function(){},Ie=te("./internal/streams/destroy"),Ue=te("./internal/streams/state"),Pe=Ue.getHighWaterMark,We=te("../errors").codes,Ye=We.ERR_INVALID_ARG_TYPE,Ne=We.ERR_METHOD_NOT_IMPLEMENTED,Ke=We.ERR_MULTIPLE_CALLBACK,Xe=We.ERR_STREAM_CANNOT_PIPE,Je=We.ERR_STREAM_DESTROYED,nt=We.ERR_STREAM_NULL_VALUES,ot=We.ERR_STREAM_WRITE_AFTER_END,ht=We.ERR_UNKNOWN_ENCODING,ct=Ie.errorOrDestroy;te("inherits")(le,Qe),ae.prototype.getBuffer=function(){for(var Re=this.bufferedRequest,Me=[];Re;)Me.push(Re),Re=Re.next;return Me},function(){try{Object.defineProperty(ae.prototype,"buffer",{get:Ve.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var ut;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ut=Function.prototype[Symbol.hasInstance],Object.defineProperty(le,Symbol.hasInstance,{value:function(Re){return!!ut.call(this,Re)||this===le&&Re&&Re._writableState instanceof ae}})):ut=function(Re){return Re instanceof this},le.prototype.pipe=function(){ct(this,new Xe)},le.prototype.write=function(Re,Me,qe){var Be=this._writableState,Oe=!1,ye=!Be.objectMode&&se(Re);return ye&&!je.isBuffer(Re)&&(Re=ce(Re)),typeof Me=="function"&&(qe=Me,Me=null),ye?Me="buffer":!Me&&(Me=Be.defaultEncoding),typeof qe!="function"&&(qe=oe),Be.ending?pe(this,qe):(ye||ve(this,Be,Re,qe))&&(Be.pendingcb++,Oe=de(this,Be,ye,Re,Me,qe)),Oe},le.prototype.cork=function(){this._writableState.corked++},le.prototype.uncork=function(){var Re=this._writableState;Re.corked&&(Re.corked--,!Re.writing&&!Re.corked&&!Re.bufferProcessing&&Re.bufferedRequest&&Te(this,Re))},le.prototype.setDefaultEncoding=function(Re){if(typeof Re=="string"&&(Re=Re.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Re+"").toLowerCase())))throw new ht(Re);return this._writableState.defaultEncoding=Re,this},Object.defineProperty(le.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(le.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),le.prototype._write=function(Re,Me,qe){qe(new Ne("_write()"))},le.prototype._writev=null,le.prototype.end=function(Re,Me,qe){var Be=this._writableState;return typeof Re=="function"?(qe=Re,Re=null,Me=null):typeof Me=="function"&&(qe=Me,Me=null),Re!=null&&this.write(Re,Me),Be.corked&&(Be.corked=1,this.uncork()),Be.ending||Le(this,Be,qe),this},Object.defineProperty(le.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(le.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(Re){this._writableState&&(this._writableState.destroyed=Re)}}),le.prototype.destroy=Ie.destroy,le.prototype._undestroy=Ie.undestroy,le.prototype._destroy=function(Re,Me){Me(Re)}}).call(this)}).call(this,te("_process"),typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(te,ne){(function(re){(function(){function ie(Se,Te,we){return Te in Se?Object.defineProperty(Se,Te,{value:we,enumerable:!0,configurable:!0,writable:!0}):Se[Te]=we,Se}function fe(Se,Te){return{value:Se,done:Te}}function ce(Se){var Te=Se[pe];if(Te!==null){var we=Se[me].read();we!==null&&(Se[ue]=null,Se[pe]=null,Se[ve]=null,Te(fe(we,!1)))}}function se(Se){re.nextTick(ce,Se)}function oe(Se,Te){return function(we,ke){Se.then(function(){return Te[de]?void we(fe(void 0,!0)):void Te[he](we,ke)},ke)}}var ae,le=te("./end-of-stream"),pe=Symbol("lastResolve"),ve=Symbol("lastReject"),ge=Symbol("error"),de=Symbol("ended"),ue=Symbol("lastPromise"),he=Symbol("handlePromise"),me=Symbol("stream"),_e=Object.getPrototypeOf(function(){}),be=Object.setPrototypeOf((ae={get stream(){return this[me]},next:function(){var Se=this,Te=this[ge];if(Te!==null)return Promise.reject(Te);if(this[de])return Promise.resolve(fe(void 0,!0));if(this[me].destroyed)return new Promise(function(Ae,Le){re.nextTick(function(){Se[ge]?Le(Se[ge]):Ae(fe(void 0,!0))})});var we,ke=this[ue];if(ke)we=new Promise(oe(ke,this));else{var xe=this[me].read();if(xe!==null)return Promise.resolve(fe(xe,!1));we=new Promise(this[he])}return this[ue]=we,we}},ie(ae,Symbol.asyncIterator,function(){return this}),ie(ae,"return",function(){var Se=this;return new Promise(function(Te,we){Se[me].destroy(null,function(ke){return ke?void we(ke):void Te(fe(void 0,!0))})})}),ae),_e);ne.exports=function(Se){var Te,we=Object.create(be,(Te={},ie(Te,me,{value:Se,writable:!0}),ie(Te,pe,{value:null,writable:!0}),ie(Te,ve,{value:null,writable:!0}),ie(Te,ge,{value:null,writable:!0}),ie(Te,de,{value:Se._readableState.endEmitted,writable:!0}),ie(Te,he,{value:function(ke,xe){var Ae=we[me].read();Ae?(we[ue]=null,we[pe]=null,we[ve]=null,ke(fe(Ae,!1))):(we[pe]=ke,we[ve]=xe)},writable:!0}),Te));return we[ue]=null,le(Se,function(ke){if(ke&&ke.code!=="ERR_STREAM_PREMATURE_CLOSE"){var xe=we[ve];return xe!==null&&(we[ue]=null,we[pe]=null,we[ve]=null,xe(ke)),void(we[ge]=ke)}var Ae=we[pe];Ae!==null&&(we[ue]=null,we[pe]=null,we[ve]=null,Ae(fe(void 0,!0))),we[de]=!0}),Se.on("readable",se.bind(null,we)),we}}).call(this)}).call(this,te("_process"))},{"./end-of-stream":24,_process:12}],22:[function(te,ne){function re(ue,he){var me=Object.keys(ue);if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(ue);he&&(_e=_e.filter(function(be){return Object.getOwnPropertyDescriptor(ue,be).enumerable})),me.push.apply(me,_e)}return me}function ie(ue){for(var he,me=1;me<arguments.length;me++)he=arguments[me]==null?{}:arguments[me],me%2?re(Object(he),!0).forEach(function(_e){fe(ue,_e,he[_e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ue,Object.getOwnPropertyDescriptors(he)):re(Object(he)).forEach(function(_e){Object.defineProperty(ue,_e,Object.getOwnPropertyDescriptor(he,_e))});return ue}function fe(ue,he,me){return he in ue?Object.defineProperty(ue,he,{value:me,enumerable:!0,configurable:!0,writable:!0}):ue[he]=me,ue}function ce(ue,he){if(!(ue instanceof he))throw new TypeError("Cannot call a class as a function")}function se(ue,he){for(var me,_e=0;_e<he.length;_e++)me=he[_e],me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(ue,me.key,me)}function oe(ue,he,me){return he&&se(ue.prototype,he),me&&se(ue,me),ue}function ae(ue,he,me){pe.prototype.copy.call(ue,he,me)}var le=te("buffer"),pe=le.Buffer,ve=te("util"),ge=ve.inspect,de=ge&&ge.custom||"inspect";ne.exports=function(){function ue(){ce(this,ue),this.head=null,this.tail=null,this.length=0}return oe(ue,[{key:"push",value:function(he){var me={data:he,next:null};0<this.length?this.tail.next=me:this.head=me,this.tail=me,++this.length}},{key:"unshift",value:function(he){var me={data:he,next:this.head};this.length===0&&(this.tail=me),this.head=me,++this.length}},{key:"shift",value:function(){if(this.length!==0){var he=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,he}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(he){if(this.length===0)return"";for(var me=this.head,_e=""+me.data;me=me.next;)_e+=he+me.data;return _e}},{key:"concat",value:function(he){if(this.length===0)return pe.alloc(0);for(var me=pe.allocUnsafe(he>>>0),_e=this.head,be=0;_e;)ae(_e.data,me,be),be+=_e.data.length,_e=_e.next;return me}},{key:"consume",value:function(he,me){var _e;return he<this.head.data.length?(_e=this.head.data.slice(0,he),this.head.data=this.head.data.slice(he)):he===this.head.data.length?_e=this.shift():_e=me?this._getString(he):this._getBuffer(he),_e}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(he){var me=this.head,_e=1,be=me.data;for(he-=be.length;me=me.next;){var Se=me.data,Te=he>Se.length?Se.length:he;if(be+=Te===Se.length?Se:Se.slice(0,he),he-=Te,he===0){Te===Se.length?(++_e,this.head=me.next?me.next:this.tail=null):(this.head=me,me.data=Se.slice(Te));break}++_e}return this.length-=_e,be}},{key:"_getBuffer",value:function(he){var me=pe.allocUnsafe(he),_e=this.head,be=1;for(_e.data.copy(me),he-=_e.data.length;_e=_e.next;){var Se=_e.data,Te=he>Se.length?Se.length:he;if(Se.copy(me,me.length-he,0,Te),he-=Te,he===0){Te===Se.length?(++be,this.head=_e.next?_e.next:this.tail=null):(this.head=_e,_e.data=Se.slice(Te));break}++be}return this.length-=be,me}},{key:de,value:function(he,me){return ge(this,ie({},me,{depth:0,customInspect:!1}))}}]),ue}()},{buffer:3,util:2}],23:[function(te,ne){(function(re){(function(){function ie(se,oe){ce(se,oe),fe(se)}function fe(se){se._writableState&&!se._writableState.emitClose||se._readableState&&!se._readableState.emitClose||se.emit("close")}function ce(se,oe){se.emit("error",oe)}ne.exports={destroy:function(se,oe){var ae=this,le=this._readableState&&this._readableState.destroyed,pe=this._writableState&&this._writableState.destroyed;return le||pe?(oe?oe(se):se&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,re.nextTick(ce,this,se)):re.nextTick(ce,this,se)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(se||null,function(ve){!oe&&ve?ae._writableState?ae._writableState.errorEmitted?re.nextTick(fe,ae):(ae._writableState.errorEmitted=!0,re.nextTick(ie,ae,ve)):re.nextTick(ie,ae,ve):oe?(re.nextTick(fe,ae),oe(ve)):re.nextTick(fe,ae)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(se,oe){var ae=se._readableState,le=se._writableState;ae&&ae.autoDestroy||le&&le.autoDestroy?se.destroy(oe):se.emit("error",oe)}}}).call(this)}).call(this,te("_process"))},{_process:12}],24:[function(te,ne){function re(oe){var ae=!1;return function(){if(!ae){ae=!0;for(var le=arguments.length,pe=Array(le),ve=0;ve<le;ve++)pe[ve]=arguments[ve];oe.apply(this,pe)}}}function ie(){}function fe(oe){return oe.setHeader&&typeof oe.abort=="function"}function ce(oe,ae,le){if(typeof ae=="function")return ce(oe,null,ae);ae||(ae={}),le=re(le||ie);var pe=ae.readable||ae.readable!==!1&&oe.readable,ve=ae.writable||ae.writable!==!1&&oe.writable,ge=function(){oe.writable||ue()},de=oe._writableState&&oe._writableState.finished,ue=function(){ve=!1,de=!0,pe||le.call(oe)},he=oe._readableState&&oe._readableState.endEmitted,me=function(){pe=!1,he=!0,ve||le.call(oe)},_e=function(Te){le.call(oe,Te)},be=function(){var Te;return pe&&!he?(oe._readableState&&oe._readableState.ended||(Te=new se),le.call(oe,Te)):ve&&!de?(oe._writableState&&oe._writableState.ended||(Te=new se),le.call(oe,Te)):void 0},Se=function(){oe.req.on("finish",ue)};return fe(oe)?(oe.on("complete",ue),oe.on("abort",be),oe.req?Se():oe.on("request",Se)):ve&&!oe._writableState&&(oe.on("end",ge),oe.on("close",ge)),oe.on("end",me),oe.on("finish",ue),ae.error!==!1&&oe.on("error",_e),oe.on("close",be),function(){oe.removeListener("complete",ue),oe.removeListener("abort",be),oe.removeListener("request",Se),oe.req&&oe.req.removeListener("finish",ue),oe.removeListener("end",ge),oe.removeListener("close",ge),oe.removeListener("finish",ue),oe.removeListener("end",me),oe.removeListener("error",_e),oe.removeListener("close",be)}}var se=te("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;ne.exports=ce},{"../../../errors":15}],25:[function(te,ne){ne.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(te,ne){function re(de){var ue=!1;return function(){ue||(ue=!0,de.apply(void 0,arguments))}}function ie(de){if(de)throw de}function fe(de){return de.setHeader&&typeof de.abort=="function"}function ce(de,ue,he,me){me=re(me);var _e=!1;de.on("close",function(){_e=!0}),le===void 0&&(le=te("./end-of-stream")),le(de,{readable:ue,writable:he},function(Se){return Se?me(Se):(_e=!0,void me())});var be=!1;return function(Se){if(!_e)return be?void 0:(be=!0,fe(de)?de.abort():typeof de.destroy=="function"?de.destroy():void me(Se||new ge("pipe")))}}function se(de){de()}function oe(de,ue){return de.pipe(ue)}function ae(de){return de.length&&typeof de[de.length-1]=="function"?de.pop():ie}var le,pe=te("../../../errors").codes,ve=pe.ERR_MISSING_ARGS,ge=pe.ERR_STREAM_DESTROYED;ne.exports=function(){for(var de=arguments.length,ue=Array(de),he=0;he<de;he++)ue[he]=arguments[he];var me=ae(ue);if(Array.isArray(ue[0])&&(ue=ue[0]),2>ue.length)throw new ve("streams");var _e,be=ue.map(function(Se,Te){var we=Te<ue.length-1;return ce(Se,we,0<Te,function(ke){_e||(_e=ke),ke&&be.forEach(se),we||(be.forEach(se),me(_e))})});return ue.reduce(oe)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(te,ne){function re(fe,ce,se){return fe.highWaterMark==null?ce?fe[se]:null:fe.highWaterMark}var ie=te("../../../errors").codes.ERR_INVALID_OPT_VALUE;ne.exports={getHighWaterMark:function(fe,ce,se,oe){var ae=re(ce,oe,se);if(ae!=null){if(!(isFinite(ae)&&j(ae)===ae)||0>ae){var le=oe?se:"highWaterMark";throw new ie(le,ae)}return j(ae)}return fe.objectMode?16:16384}}},{"../../../errors":15}],28:[function(te,ne){ne.exports=te("events").EventEmitter},{events:7}],29:[function(te,ne,re){re=ne.exports=te("./lib/_stream_readable.js"),re.Stream=re,re.Readable=re,re.Writable=te("./lib/_stream_writable.js"),re.Duplex=te("./lib/_stream_duplex.js"),re.Transform=te("./lib/_stream_transform.js"),re.PassThrough=te("./lib/_stream_passthrough.js"),re.finished=te("./lib/internal/streams/end-of-stream.js"),re.pipeline=te("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(te,ne,re){function ie(oe,ae){for(var le in oe)ae[le]=oe[le]}function fe(oe,ae,le){return se(oe,ae,le)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var ce=te("buffer"),se=ce.Buffer;se.from&&se.alloc&&se.allocUnsafe&&se.allocUnsafeSlow?ne.exports=ce:(ie(ce,re),re.Buffer=fe),fe.prototype=Object.create(se.prototype),ie(se,fe),fe.from=function(oe,ae,le){if(typeof oe=="number")throw new TypeError("Argument must not be a number");return se(oe,ae,le)},fe.alloc=function(oe,ae,le){if(typeof oe!="number")throw new TypeError("Argument must be a number");var pe=se(oe);return ae===void 0?pe.fill(0):typeof le=="string"?pe.fill(ae,le):pe.fill(ae),pe},fe.allocUnsafe=function(oe){if(typeof oe!="number")throw new TypeError("Argument must be a number");return se(oe)},fe.allocUnsafeSlow=function(oe){if(typeof oe!="number")throw new TypeError("Argument must be a number");return ce.SlowBuffer(oe)}},{buffer:3}],31:[function(te,ne,re){function ie(be){if(!be)return"utf8";for(var Se;;)switch(be){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return be;default:if(Se)return;be=(""+be).toLowerCase(),Se=!0}}function fe(be){var Se=ie(be);if(typeof Se!="string"&&(me.isEncoding===_e||!_e(be)))throw new Error("Unknown encoding: "+be);return Se||be}function ce(be){this.encoding=fe(be);var Se;switch(this.encoding){case"utf16le":this.text=pe,this.end=ve,Se=4;break;case"utf8":this.fillLast=le,Se=4;break;case"base64":this.text=ge,this.end=de,Se=3;break;default:return this.write=ue,void(this.end=he)}this.lastNeed=0,this.lastTotal=0,this.lastChar=me.allocUnsafe(Se)}function se(be){return 127>=be?0:be>>5==6?2:be>>4==14?3:be>>3==30?4:be>>6==2?-1:-2}function oe(be,Se,Te){var we=Se.length-1;if(we<Te)return 0;var ke=se(Se[we]);return 0<=ke?(0<ke&&(be.lastNeed=ke-1),ke):--we<Te||ke===-2?0:(ke=se(Se[we]),0<=ke?(0<ke&&(be.lastNeed=ke-2),ke):--we<Te||ke===-2?0:(ke=se(Se[we]),0<=ke?(0<ke&&(ke===2?ke=0:be.lastNeed=ke-3),ke):0))}function ae(be,Se){if((192&Se[0])!=128)return be.lastNeed=0,"\uFFFD";if(1<be.lastNeed&&1<Se.length){if((192&Se[1])!=128)return be.lastNeed=1,"\uFFFD";if(2<be.lastNeed&&2<Se.length&&(192&Se[2])!=128)return be.lastNeed=2,"\uFFFD"}}function le(be){var Se=this.lastTotal-this.lastNeed,Te=ae(this,be);return Te===void 0?this.lastNeed<=be.length?(be.copy(this.lastChar,Se,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(be.copy(this.lastChar,Se,0,be.length),void(this.lastNeed-=be.length)):Te}function pe(be,Se){if((be.length-Se)%2==0){var Te=be.toString("utf16le",Se);if(Te){var we=Te.charCodeAt(Te.length-1);if(55296<=we&&56319>=we)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=be[be.length-2],this.lastChar[1]=be[be.length-1],Te.slice(0,-1)}return Te}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=be[be.length-1],be.toString("utf16le",Se,be.length-1)}function ve(be){var Se=be&&be.length?this.write(be):"";if(this.lastNeed){var Te=this.lastTotal-this.lastNeed;return Se+this.lastChar.toString("utf16le",0,Te)}return Se}function ge(be,Se){var Te=(be.length-Se)%3;return Te==0?be.toString("base64",Se):(this.lastNeed=3-Te,this.lastTotal=3,Te==1?this.lastChar[0]=be[be.length-1]:(this.lastChar[0]=be[be.length-2],this.lastChar[1]=be[be.length-1]),be.toString("base64",Se,be.length-Te))}function de(be){var Se=be&&be.length?this.write(be):"";return this.lastNeed?Se+this.lastChar.toString("base64",0,3-this.lastNeed):Se}function ue(be){return be.toString(this.encoding)}function he(be){return be&&be.length?this.write(be):""}var me=te("safe-buffer").Buffer,_e=me.isEncoding||function(be){switch(be=""+be,be&&be.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};re.StringDecoder=ce,ce.prototype.write=function(be){if(be.length===0)return"";var Se,Te;if(this.lastNeed){if(Se=this.fillLast(be),Se===void 0)return"";Te=this.lastNeed,this.lastNeed=0}else Te=0;return Te<be.length?Se?Se+this.text(be,Te):this.text(be,Te):Se||""},ce.prototype.end=function(be){var Se=be&&be.length?this.write(be):"";return this.lastNeed?Se+"\uFFFD":Se},ce.prototype.text=function(be,Se){var Te=oe(this,be,Se);if(!this.lastNeed)return be.toString("utf8",Se);this.lastTotal=Te;var we=be.length-(Te-this.lastNeed);return be.copy(this.lastChar,0,we),be.toString("utf8",Se,we)},ce.prototype.fillLast=function(be){return this.lastNeed<=be.length?(be.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(be.copy(this.lastChar,this.lastTotal-this.lastNeed,0,be.length),void(this.lastNeed-=be.length))}},{"safe-buffer":30}],32:[function(te,ne){(function(re){(function(){function ie(fe){try{if(!re.localStorage)return!1}catch{return!1}var ce=re.localStorage[fe];return ce!=null&&(ce+"").toLowerCase()==="true"}ne.exports=function(fe,ce){function se(){if(!oe){if(ie("throwDeprecation"))throw new Error(ce);ie("traceDeprecation")?console.trace(ce):console.warn(ce),oe=!0}return fe.apply(this,arguments)}if(ie("noDeprecation"))return fe;var oe=!1;return se}}).call(this)}).call(this,typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{}],"/":[function(te,ne){function re(de){return de.replace(/a=ice-options:trickle\s\n/g,"")}function ie(de){console.warn(de)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const fe=te("debug")("simple-peer"),ce=te("get-browser-rtc"),se=te("randombytes"),oe=te("readable-stream"),ae=te("queue-microtask"),le=te("err-code"),{Buffer:pe}=te("buffer"),ve=65536;class ge extends oe.Duplex{constructor(ue){if(ue=Object.assign({allowHalfOpen:!1},ue),super(ue),this._id=se(4).toString("hex").slice(0,7),this._debug("new peer %o",ue),this.channelName=ue.initiator?ue.channelName||se(20).toString("hex"):null,this.initiator=ue.initiator||!1,this.channelConfig=ue.channelConfig||ge.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},ge.config,ue.config),this.offerOptions=ue.offerOptions||{},this.answerOptions=ue.answerOptions||{},this.sdpTransform=ue.sdpTransform||(he=>he),this.streams=ue.streams||(ue.stream?[ue.stream]:[]),this.trickle=ue.trickle===void 0||ue.trickle,this.allowHalfTrickle=ue.allowHalfTrickle!==void 0&&ue.allowHalfTrickle,this.iceCompleteTimeout=ue.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=ue.wrtc&&typeof ue.wrtc=="object"?ue.wrtc:ce(),!this._wrtc)throw le(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(he){return void this.destroy(le(he,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=he=>{this._onIceCandidate(he)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(he=>{this.destroy(le(he,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=he=>{this._setupData(he)},this.streams&&this.streams.forEach(he=>{this.addStream(he)}),this._pc.ontrack=he=>{this._onTrack(he)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(ue){if(!this.destroying){if(this.destroyed)throw le(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof ue=="string")try{ue=JSON.parse(ue)}catch{ue={}}this._debug("signal()"),ue.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),ue.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(ue.transceiverRequest.kind,ue.transceiverRequest.init)),ue.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(ue.candidate):this._pendingCandidates.push(ue.candidate)),ue.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(ue)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(he=>{this._addIceCandidate(he)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(he=>{this.destroy(le(he,"ERR_SET_REMOTE_DESCRIPTION"))}),ue.sdp||ue.candidate||ue.renegotiate||ue.transceiverRequest||this.destroy(le(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(ue){const he=new this._wrtc.RTCIceCandidate(ue);this._pc.addIceCandidate(he).catch(me=>{!he.address||he.address.endsWith(".local")?ie("Ignoring unsupported ICE candidate."):this.destroy(le(me,"ERR_ADD_ICE_CANDIDATE"))})}send(ue){if(!this.destroying){if(this.destroyed)throw le(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(ue)}}addTransceiver(ue,he){if(!this.destroying){if(this.destroyed)throw le(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(ue,he),this._needsNegotiation()}catch(me){this.destroy(le(me,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:ue,init:he}})}}addStream(ue){if(!this.destroying){if(this.destroyed)throw le(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),ue.getTracks().forEach(he=>{this.addTrack(he,ue)})}}addTrack(ue,he){if(this.destroying)return;if(this.destroyed)throw le(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const me=this._senderMap.get(ue)||new Map;let _e=me.get(he);if(!_e)_e=this._pc.addTrack(ue,he),me.set(he,_e),this._senderMap.set(ue,me),this._needsNegotiation();else throw _e.removed?le(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):le(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(ue,he,me){if(this.destroying)return;if(this.destroyed)throw le(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const _e=this._senderMap.get(ue),be=_e?_e.get(me):null;if(!be)throw le(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");he&&this._senderMap.set(he,_e),be.replaceTrack==null?this.destroy(le(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):be.replaceTrack(he)}removeTrack(ue,he){if(this.destroying)return;if(this.destroyed)throw le(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const me=this._senderMap.get(ue),_e=me?me.get(he):null;if(!_e)throw le(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{_e.removed=!0,this._pc.removeTrack(_e)}catch(be){be.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(_e):this.destroy(le(be,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(ue){if(!this.destroying){if(this.destroyed)throw le(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),ue.getTracks().forEach(he=>{this.removeTrack(he,ue)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,ae(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw le(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(ue){this._destroy(ue,()=>{})}_destroy(ue,he){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",ue&&(ue.message||ue)),ae(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",ue&&(ue.message||ue)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,ue&&this.emit("error",ue),this.emit("close"),he()}))}_setupData(ue){if(!ue.channel)return this.destroy(le(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=ue.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=ve),this.channelName=this._channel.label,this._channel.onmessage=me=>{this._onChannelMessage(me)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=me=>{const _e=me.error instanceof Error?me.error:new Error(`Datachannel error: ${me.message} ${me.filename}:${me.lineno}:${me.colno}`);this.destroy(le(_e,"ERR_DATA_CHANNEL"))};let he=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(he&&this._onChannelClose(),he=!0):he=!1},5e3)}_read(){}_write(ue,he,me){if(this.destroyed)return me(le(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(ue)}catch(_e){return this.destroy(le(_e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>ve?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=me):me(null)}else this._debug("write before connect"),this._chunk=ue,this._cb=me}_onFinish(){if(!this.destroyed){const ue=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?ue():this.once("connect",ue)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(ue=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(ue.sdp=re(ue.sdp)),ue.sdp=this.sdpTransform(ue.sdp);const he=()=>{if(!this.destroyed){const me=this._pc.localDescription||ue;this._debug("signal"),this.emit("signal",{type:me.type,sdp:me.sdp})}};this._pc.setLocalDescription(ue).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?he():this.once("_iceComplete",he))}).catch(me=>{this.destroy(le(me,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(ue=>{this.destroy(le(ue,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(ue=>{ue.mid||!ue.sender.track||ue.requested||(ue.requested=!0,this.addTransceiver(ue.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(ue=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(ue.sdp=re(ue.sdp)),ue.sdp=this.sdpTransform(ue.sdp);const he=()=>{if(!this.destroyed){const me=this._pc.localDescription||ue;this._debug("signal"),this.emit("signal",{type:me.type,sdp:me.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(ue).then(()=>{this.destroyed||(this.trickle||this._iceComplete?he():this.once("_iceComplete",he))}).catch(me=>{this.destroy(le(me,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(ue=>{this.destroy(le(ue,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(le(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const ue=this._pc.iceConnectionState,he=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",ue,he),this.emit("iceStateChange",ue,he),(ue==="connected"||ue==="completed")&&(this._pcReady=!0,this._maybeReady()),ue==="failed"&&this.destroy(le(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),ue==="closed"&&this.destroy(le(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(ue){const he=me=>(Object.prototype.toString.call(me.values)==="[object Array]"&&me.values.forEach(_e=>{Object.assign(me,_e)}),me);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(me=>{const _e=[];me.forEach(be=>{_e.push(he(be))}),ue(null,_e)},me=>ue(me)):0<this._pc.getStats.length?this._pc.getStats(me=>{if(this.destroyed)return;const _e=[];me.result().forEach(be=>{const Se={};be.names().forEach(Te=>{Se[Te]=be.stat(Te)}),Se.id=be.id,Se.type=be.type,Se.timestamp=be.timestamp,_e.push(he(Se))}),ue(null,_e)},me=>ue(me)):ue(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const ue=()=>{this.destroyed||this.getStats((he,me)=>{if(this.destroyed)return;he&&(me=[]);const _e={},be={},Se={};let Te=!1;me.forEach(ke=>{(ke.type==="remotecandidate"||ke.type==="remote-candidate")&&(_e[ke.id]=ke),(ke.type==="localcandidate"||ke.type==="local-candidate")&&(be[ke.id]=ke),(ke.type==="candidatepair"||ke.type==="candidate-pair")&&(Se[ke.id]=ke)});const we=ke=>{Te=!0;let xe=be[ke.localCandidateId];xe&&(xe.ip||xe.address)?(this.localAddress=xe.ip||xe.address,this.localPort=+xe.port):xe&&xe.ipAddress?(this.localAddress=xe.ipAddress,this.localPort=+xe.portNumber):typeof ke.googLocalAddress=="string"&&(xe=ke.googLocalAddress.split(":"),this.localAddress=xe[0],this.localPort=+xe[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let Ae=_e[ke.remoteCandidateId];Ae&&(Ae.ip||Ae.address)?(this.remoteAddress=Ae.ip||Ae.address,this.remotePort=+Ae.port):Ae&&Ae.ipAddress?(this.remoteAddress=Ae.ipAddress,this.remotePort=+Ae.portNumber):typeof ke.googRemoteAddress=="string"&&(Ae=ke.googRemoteAddress.split(":"),this.remoteAddress=Ae[0],this.remotePort=+Ae[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(me.forEach(ke=>{ke.type==="transport"&&ke.selectedCandidatePairId&&we(Se[ke.selectedCandidatePairId]),(ke.type==="googCandidatePair"&&ke.googActiveConnection==="true"||(ke.type==="candidatepair"||ke.type==="candidate-pair")&&ke.selected)&&we(ke)}),!Te&&(!Object.keys(Se).length||Object.keys(be).length))return void setTimeout(ue,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(xe){return this.destroy(le(xe,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const ke=this._cb;this._cb=null,ke(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};ue()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>ve)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(ue=>{this._pc.removeTrack(ue),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(ue){this.destroyed||(ue.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:ue.candidate.candidate,sdpMLineIndex:ue.candidate.sdpMLineIndex,sdpMid:ue.candidate.sdpMid}}):!ue.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),ue.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(ue){if(this.destroyed)return;let he=ue.data;he instanceof ArrayBuffer&&(he=pe.from(he)),this.push(he)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const ue=this._cb;this._cb=null,ue(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(ue){this.destroyed||ue.streams.forEach(he=>{this._debug("on track"),this.emit("track",ue.track,he),this._remoteTracks.push({track:ue.track,stream:he}),this._remoteStreams.some(me=>me.id===he.id)||(this._remoteStreams.push(he),ae(()=>{this._debug("on stream"),this.emit("stream",he)}))})}_debug(){const ue=[].slice.call(arguments);ue[0]="["+this._id+"] "+ue[0],fe.apply(null,ue)}}ge.WEBRTC_SUPPORT=!!ce(),ge.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},ge.channelConfig={},ne.exports=ge},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(simplepeer_min);const Peer=simplepeer_min.exports,messageYjsSyncStep1=0,messageYjsSyncStep2=1,messageYjsUpdate=2,writeSyncStep1=(q,B)=>{writeVarUint(q,messageYjsSyncStep1);const j=encodeStateVector(B);writeVarUint8Array(q,j)},writeSyncStep2=(q,B,j)=>{writeVarUint(q,messageYjsSyncStep2),writeVarUint8Array(q,encodeStateAsUpdate(B,j))},readSyncStep1=(q,B,j)=>writeSyncStep2(B,j,readVarUint8Array(q)),readSyncStep2=(q,B,j)=>{try{applyUpdate(B,readVarUint8Array(q),j)}catch(X){console.error("Caught error while handling a Yjs update",X)}},writeUpdate=(q,B)=>{writeVarUint(q,messageYjsUpdate),writeVarUint8Array(q,B)},readUpdate=readSyncStep2,readSyncMessage=(q,B,j,X)=>{const ee=readVarUint(q);switch(ee){case messageYjsSyncStep1:readSyncStep1(q,B,j);break;case messageYjsSyncStep2:readSyncStep2(q,j,X);break;case messageYjsUpdate:readUpdate(q,j,X);break;default:throw new Error("Unknown message type")}return ee},deriveKey=(q,B)=>{const j=encodeUtf8(q).buffer,X=encodeUtf8(B).buffer;return crypto.subtle.importKey("raw",j,"PBKDF2",!1,["deriveKey"]).then(ee=>crypto.subtle.deriveKey({name:"PBKDF2",salt:X,iterations:1e5,hash:"SHA-256"},ee,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},encrypt=(q,B)=>{if(!B)return resolve(q);const j=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:j},B,q).then(X=>{const ee=createEncoder();return writeVarString(ee,"AES-GCM"),writeVarUint8Array(ee,j),writeVarUint8Array(ee,new Uint8Array(X)),toUint8Array(ee)})},encryptJson=(q,B)=>{const j=createEncoder();return writeAny(j,q),encrypt(toUint8Array(j),B)},decrypt=(q,B)=>{if(!B)return resolve(q);const j=createDecoder(q);readVarString(j)!=="AES-GCM"&&reject(create$2("Unknown encryption algorithm"));const ee=readVarUint8Array(j),te=readVarUint8Array(j);return crypto.subtle.decrypt({name:"AES-GCM",iv:ee},B,te).then(ne=>new Uint8Array(ne))},decryptJson=(q,B)=>decrypt(q,B).then(j=>readAny(createDecoder(new Uint8Array(j)))),log=createModuleLogger("y-webrtc"),messageSync$1=0,messageQueryAwareness$1=3,messageAwareness$1=1,messageBcPeerId=4,signalingConns=new Map,rooms=new Map,checkIsSynced=q=>{let B=!0;q.webrtcConns.forEach(j=>{j.synced||(B=!1)}),(!B&&q.synced||B&&!q.synced)&&(q.synced=B,q.provider.emit("synced",[{synced:B}]),log("synced ",BOLD,q.name,UNBOLD," with all peers"))},readMessage$1=(q,B,j)=>{const X=createDecoder(B),ee=createEncoder(),te=readVarUint(X);if(q===void 0)return null;const ne=q.awareness,re=q.doc;let ie=!1;switch(te){case messageSync$1:{writeVarUint(ee,messageSync$1);const fe=readSyncMessage(X,ee,re,q);fe===messageYjsSyncStep2&&!q.synced&&j(),fe===messageYjsSyncStep1&&(ie=!0);break}case messageQueryAwareness$1:writeVarUint(ee,messageAwareness$1),writeVarUint8Array(ee,encodeAwarenessUpdate(ne,Array.from(ne.getStates().keys()))),ie=!0;break;case messageAwareness$1:applyAwarenessUpdate(ne,readVarUint8Array(X),q);break;case messageBcPeerId:{const fe=readUint8(X)===1,ce=readVarString(X);if(ce!==q.peerId&&(q.bcConns.has(ce)&&!fe||!q.bcConns.has(ce)&&fe)){const se=[],oe=[];fe?(q.bcConns.add(ce),oe.push(ce)):(q.bcConns.delete(ce),se.push(ce)),q.provider.emit("peers",[{added:oe,removed:se,webrtcPeers:Array.from(q.webrtcConns.keys()),bcPeers:Array.from(q.bcConns)}]),broadcastBcPeerId(q)}break}default:return console.error("Unable to compute message"),ee}return ie?ee:null},readPeerMessage=(q,B)=>{const j=q.room;return log("received message from ",BOLD,q.remotePeerId,GREY," (",j.name,")",UNBOLD,UNCOLOR),readMessage$1(j,B,()=>{q.synced=!0,log("synced ",BOLD,j.name,UNBOLD," with ",BOLD,q.remotePeerId),checkIsSynced(j)})},sendWebrtcConn=(q,B)=>{log("send message to ",BOLD,q.remotePeerId,UNBOLD,GREY," (",q.room.name,")",UNCOLOR);try{q.peer.send(toUint8Array(B))}catch{}},broadcastWebrtcConn=(q,B)=>{log("broadcast message in ",BOLD,q.name,UNBOLD),q.webrtcConns.forEach(j=>{try{j.peer.send(B)}catch{}})};class WebrtcConn{constructor(B,j,X,ee){log("establishing connection to ",BOLD,X),this.room=ee,this.remotePeerId=X,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Peer({initiator:j,...ee.provider.peerOpts}),this.peer.on("signal",te=>{publishSignalingMessage(B,ee,{to:X,from:ee.peerId,type:"signal",signal:te})}),this.peer.on("connect",()=>{log("connected to ",BOLD,X),this.connected=!0;const ne=ee.provider.doc,re=ee.awareness,ie=createEncoder();writeVarUint(ie,messageSync$1),writeSyncStep1(ie,ne),sendWebrtcConn(this,ie);const fe=re.getStates();if(fe.size>0){const ce=createEncoder();writeVarUint(ce,messageAwareness$1),writeVarUint8Array(ce,encodeAwarenessUpdate(re,Array.from(fe.keys()))),sendWebrtcConn(this,ce)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,ee.webrtcConns.has(this.remotePeerId)&&(ee.webrtcConns.delete(this.remotePeerId),ee.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(ee.webrtcConns.keys()),bcPeers:Array.from(ee.bcConns)}])),checkIsSynced(ee),this.peer.destroy(),log("closed connection to ",BOLD,X),announceSignalingInfo(ee)}),this.peer.on("error",te=>{log("Error in connection to ",BOLD,X,": ",te),announceSignalingInfo(ee)}),this.peer.on("data",te=>{const ne=readPeerMessage(this,te);ne!==null&&sendWebrtcConn(this,ne)})}destroy(){this.peer.destroy()}}const broadcastBcMessage=(q,B)=>encrypt(B,q.key).then(j=>q.mux(()=>publish(q.name,j))),broadcastRoomMessage=(q,B)=>{q.bcconnected&&broadcastBcMessage(q,B),broadcastWebrtcConn(q,B)},announceSignalingInfo=q=>{signalingConns.forEach(B=>{B.connected&&(B.send({type:"subscribe",topics:[q.name]}),q.webrtcConns.size<q.provider.maxConns&&publishSignalingMessage(B,q,{type:"announce",from:q.peerId}))})},broadcastBcPeerId=q=>{if(q.provider.filterBcConns){const B=createEncoder();writeVarUint(B,messageBcPeerId),writeUint8(B,1),writeVarString(B,q.peerId),broadcastBcMessage(q,toUint8Array(B))}};class Room{constructor(B,j,X,ee){this.peerId=uuidv4$1(),this.doc=B,this.awareness=j.awareness,this.provider=j,this.synced=!1,this.name=X,this.key=ee,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=createMutex(),this.bcconnected=!1,this._bcSubscriber=te=>decrypt(new Uint8Array(te),ee).then(ne=>this.mux(()=>{const re=readMessage$1(this,ne,()=>{});re&&broadcastBcMessage(this,toUint8Array(re))})),this._docUpdateHandler=(te,ne)=>{const re=createEncoder();writeVarUint(re,messageSync$1),writeUpdate(re,te),broadcastRoomMessage(this,toUint8Array(re))},this._awarenessUpdateHandler=({added:te,updated:ne,removed:re},ie)=>{const fe=te.concat(ne).concat(re),ce=createEncoder();writeVarUint(ce,messageAwareness$1),writeVarUint8Array(ce,encodeAwarenessUpdate(this.awareness,fe)),broadcastRoomMessage(this,toUint8Array(ce))},this._beforeUnloadHandler=()=>{removeAwarenessStates(this.awareness,[B.clientID],"window unload"),rooms.forEach(te=>{te.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),announceSignalingInfo(this);const B=this.name;subscribe(B,this._bcSubscriber),this.bcconnected=!0,broadcastBcPeerId(this);const j=createEncoder();writeVarUint(j,messageSync$1),writeSyncStep1(j,this.doc),broadcastBcMessage(this,toUint8Array(j));const X=createEncoder();writeVarUint(X,messageSync$1),writeSyncStep2(X,this.doc),broadcastBcMessage(this,toUint8Array(X));const ee=createEncoder();writeVarUint(ee,messageQueryAwareness$1),broadcastBcMessage(this,toUint8Array(ee));const te=createEncoder();writeVarUint(te,messageAwareness$1),writeVarUint8Array(te,encodeAwarenessUpdate(this.awareness,[this.doc.clientID])),broadcastBcMessage(this,toUint8Array(te))}disconnect(){signalingConns.forEach(j=>{j.connected&&j.send({type:"unsubscribe",topics:[this.name]})}),removeAwarenessStates(this.awareness,[this.doc.clientID],"disconnect");const B=createEncoder();writeVarUint(B,messageBcPeerId),writeUint8(B,0),writeVarString(B,this.peerId),broadcastBcMessage(this,toUint8Array(B)),unsubscribe(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(j=>j.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const openRoom=(q,B,j,X)=>{if(rooms.has(j))throw create$2(`A Yjs Doc connected to room "${j}" already exists!`);const ee=new Room(q,B,j,X);return rooms.set(j,ee),ee},publishSignalingMessage=(q,B,j)=>{B.key?encryptJson(j,B.key).then(X=>{q.send({type:"publish",topic:B.name,data:toBase64(X)})}):q.send({type:"publish",topic:B.name,data:j})};class SignalingConn extends WebsocketClient{constructor(B){super(B),this.providers=new Set,this.on("connect",()=>{log(`connected (${B})`);const j=Array.from(rooms.keys());this.send({type:"subscribe",topics:j}),rooms.forEach(X=>publishSignalingMessage(this,X,{type:"announce",from:X.peerId}))}),this.on("message",j=>{switch(j.type){case"publish":{const X=j.topic,ee=rooms.get(X);if(ee==null||typeof X!="string")return;const te=ne=>{const re=ee.webrtcConns,ie=ee.peerId;if(ne==null||ne.from===ie||ne.to!==void 0&&ne.to!==ie||ee.bcConns.has(ne.from))return;const fe=re.has(ne.from)?()=>{}:()=>ee.provider.emit("peers",[{removed:[],added:[ne.from],webrtcPeers:Array.from(ee.webrtcConns.keys()),bcPeers:Array.from(ee.bcConns)}]);switch(ne.type){case"announce":re.size<ee.provider.maxConns&&(setIfUndefined(re,ne.from,()=>new WebrtcConn(this,!0,ne.from,ee)),fe());break;case"signal":ne.to===ie&&(setIfUndefined(re,ne.from,()=>new WebrtcConn(this,!1,ne.from,ee)).peer.signal(ne.signal),fe());break}};ee.key?typeof j.data=="string"&&decryptJson(fromBase64(j.data),ee.key).then(te):te(j.data)}}}),this.on("disconnect",()=>log(`disconnect (${B})`))}}class WebrtcProvider extends Observable{constructor(B,j,{signaling:X=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:ee=null,awareness:te=new Awareness(j),maxConns:ne=20+floor(rand()*15),filterBcConns:re=!0,peerOpts:ie={}}={}){super(),this.roomName=B,this.doc=j,this.filterBcConns=re,this.awareness=te,this.shouldConnect=!1,this.signalingUrls=X,this.signalingConns=[],this.maxConns=ne,this.peerOpts=ie,this.key=ee?deriveKey(ee,B):resolve(null),this.room=null,this.key.then(fe=>{this.room=openRoom(j,this,B,fe),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),j.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(B=>{const j=setIfUndefined(signalingConns,B,()=>new SignalingConn(B));this.signalingConns.push(j),j.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(B=>{B.providers.delete(this),B.providers.size===0&&(B.destroy(),signalingConns.delete(B.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),rooms.delete(this.roomName)}),super.destroy()}}const rtop=q=>create$3((B,j)=>{q.onerror=X=>j(new Error(X.target.error)),q.onblocked=()=>location.reload(),q.onsuccess=X=>B(X.target.result)}),openDB=(q,B)=>create$3((j,X)=>{const ee=indexedDB.open(q);ee.onupgradeneeded=te=>B(te.target.result),ee.onerror=te=>X(create$2(te.target.error)),ee.onblocked=()=>location.reload(),ee.onsuccess=te=>{const ne=te.target.result;ne.onversionchange=()=>{ne.close()},typeof addEventListener<"u"&&addEventListener("unload",()=>ne.close()),j(ne)}}),deleteDB=q=>rtop(indexedDB.deleteDatabase(q)),createStores=(q,B)=>B.forEach(j=>q.createObjectStore.apply(q,j)),transact=(q,B,j="readwrite")=>{const X=q.transaction(B,j);return B.map(ee=>getStore(X,ee))},count=(q,B)=>rtop(q.count(B)),get=(q,B)=>rtop(q.get(B)),del=(q,B)=>rtop(q.delete(B)),put=(q,B,j)=>rtop(q.put(B,j)),addAutoKey=(q,B)=>rtop(q.add(B)),getAll=(q,B)=>rtop(q.getAll(B)),queryFirst=(q,B,j)=>{let X=null;return iterateKeys(q,B,ee=>(X=ee,!1),j).then(()=>X)},getLastKey=(q,B=null)=>queryFirst(q,B,"prev"),iterateOnRequest=(q,B)=>create$3((j,X)=>{q.onerror=X,q.onsuccess=ee=>{const te=ee.target.result;if(te===null||B(te)===!1)return j();te.continue()}}),iterateKeys=(q,B,j,X="next")=>iterateOnRequest(q.openKeyCursor(B,X),ee=>j(ee.key)),getStore=(q,B)=>q.objectStore(B),createIDBKeyRangeUpperBound=(q,B)=>IDBKeyRange.upperBound(q,B),createIDBKeyRangeLowerBound=(q,B)=>IDBKeyRange.lowerBound(q,B),customStoreName="custom",updatesStoreName="updates",PREFERRED_TRIM_SIZE=500,fetchUpdates=q=>{const[B]=transact(q.db,[updatesStoreName]);return getAll(B,createIDBKeyRangeLowerBound(q._dbref,!1)).then(j=>transact$1(q.doc,()=>{j.forEach(X=>applyUpdate(q.doc,X))},q,!1)).then(()=>getLastKey(B).then(j=>{q._dbref=j+1})).then(()=>count(B).then(j=>{q._dbsize=j})).then(()=>B)},storeState=(q,B=!0)=>fetchUpdates(q).then(j=>{(B||q._dbsize>=PREFERRED_TRIM_SIZE)&&addAutoKey(j,encodeStateAsUpdate(q.doc)).then(()=>del(j,createIDBKeyRangeUpperBound(q._dbref,!0))).then(()=>count(j).then(X=>{q._dbsize=X}))});class IndexeddbPersistence extends Observable{constructor(B,j){super(),this.doc=j,this.name=B,this._mux=createMutex(),this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=openDB(B,X=>createStores(X,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=this._db.then(X=>{this.db=X;const ee=encodeStateAsUpdate(j);return fetchUpdates(this).then(te=>addAutoKey(te,ee)).then(()=>this._destroyed?this:(this.emit("synced",[this]),this.synced=!0,this))}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(X,ee)=>{if(this.db&&ee!==this){const[te]=transact(this.db,[updatesStoreName]);addAutoKey(te,X),++this._dbsize>=PREFERRED_TRIM_SIZE&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{storeState(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},j.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),j.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(B=>{B.close()})}clearData(){return this.destroy().then(()=>{deleteDB(this.name)})}get(B){return this._db.then(j=>{const[X]=transact(j,[customStoreName],"readonly");return get(X,B)})}set(B,j){return this._db.then(X=>{const[ee]=transact(X,[customStoreName]);return put(ee,j,B)})}del(B){return this._db.then(j=>{const[X]=transact(j,[customStoreName]);return del(X,B)})}}const messagePermissionDenied=0,readAuthMessage=(q,B,j)=>{switch(readVarUint(q)){case messagePermissionDenied:j(B,readVarString(q))}},encodeQueryParams=q=>map(q,(B,j)=>`${encodeURIComponent(j)}=${encodeURIComponent(B)}`).join("&"),messageSync=0,messageQueryAwareness=3,messageAwareness=1,messageAuth=2,messageHandlers=[];messageHandlers[messageSync]=(q,B,j,X,ee)=>{writeVarUint(q,messageSync);const te=readSyncMessage(B,q,j.doc,j);X&&te===messageYjsSyncStep2&&!j.synced&&(j.synced=!0)};messageHandlers[messageQueryAwareness]=(q,B,j,X,ee)=>{writeVarUint(q,messageAwareness),writeVarUint8Array(q,encodeAwarenessUpdate(j.awareness,Array.from(j.awareness.getStates().keys())))};messageHandlers[messageAwareness]=(q,B,j,X,ee)=>{applyAwarenessUpdate(j.awareness,readVarUint8Array(B),j)};messageHandlers[messageAuth]=(q,B,j,X,ee)=>{readAuthMessage(B,j.doc,(te,ne)=>permissionDeniedHandler(j,ne))};const messageReconnectTimeout=3e4,permissionDeniedHandler=(q,B)=>console.warn(`Permission denied to access ${q.url}.
${B}`),readMessage=(q,B,j)=>{const X=createDecoder(B),ee=createEncoder(),te=readVarUint(X),ne=q.messageHandlers[te];return ne?ne(ee,X,q,j,te):console.error("Unable to compute message"),ee},setupWS=q=>{if(q.shouldConnect&&q.ws===null){const B=new q._WS(q.url);B.binaryType="arraybuffer",q.ws=B,q.wsconnecting=!0,q.wsconnected=!1,q.synced=!1,B.onmessage=j=>{q.wsLastMessageReceived=getUnixTime();const X=readMessage(q,new Uint8Array(j.data),!0);length$1(X)>1&&B.send(toUint8Array(X))},B.onerror=j=>{q.emit("connection-error",[j,q])},B.onclose=j=>{q.emit("connection-close",[j,q]),q.ws=null,q.wsconnecting=!1,q.wsconnected?(q.wsconnected=!1,q.synced=!1,removeAwarenessStates(q.awareness,Array.from(q.awareness.getStates().keys()).filter(X=>X!==q.doc.clientID),q),q.emit("status",[{status:"disconnected"}])):q.wsUnsuccessfulReconnects++,setTimeout(setupWS,min(pow(2,q.wsUnsuccessfulReconnects)*100,q.maxBackoffTime),q)},B.onopen=()=>{q.wsLastMessageReceived=getUnixTime(),q.wsconnecting=!1,q.wsconnected=!0,q.wsUnsuccessfulReconnects=0,q.emit("status",[{status:"connected"}]);const j=createEncoder();if(writeVarUint(j,messageSync),writeSyncStep1(j,q.doc),B.send(toUint8Array(j)),q.awareness.getLocalState()!==null){const X=createEncoder();writeVarUint(X,messageAwareness),writeVarUint8Array(X,encodeAwarenessUpdate(q.awareness,[q.doc.clientID])),B.send(toUint8Array(X))}},q.emit("status",[{status:"connecting"}])}},broadcastMessage=(q,B)=>{q.wsconnected&&q.ws.send(B),q.bcconnected&&publish(q.bcChannel,B,q)};class WebsocketProvider extends Observable{constructor(B,j,X,{connect:ee=!0,awareness:te=new Awareness(X),params:ne={},WebSocketPolyfill:re=WebSocket,resyncInterval:ie=-1,maxBackoffTime:fe=2500,disableBc:ce=!1}={}){for(super();B[B.length-1]==="/";)B=B.slice(0,B.length-1);const se=encodeQueryParams(ne);this.maxBackoffTime=fe,this.bcChannel=B+"/"+j,this.url=B+"/"+j+(se.length===0?"":"?"+se),this.roomname=j,this.doc=X,this._WS=re,this.awareness=te,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=ce,this.wsUnsuccessfulReconnects=0,this.messageHandlers=messageHandlers.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=ee,this._resyncInterval=0,ie>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const oe=createEncoder();writeVarUint(oe,messageSync),writeSyncStep1(oe,X),this.ws.send(toUint8Array(oe))}},ie)),this._bcSubscriber=(oe,ae)=>{if(ae!==this){const le=readMessage(this,new Uint8Array(oe),!1);length$1(le)>1&&publish(this.bcChannel,toUint8Array(le),this)}},this._updateHandler=(oe,ae)=>{if(ae!==this){const le=createEncoder();writeVarUint(le,messageSync),writeUpdate(le,oe),broadcastMessage(this,toUint8Array(le))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:oe,updated:ae,removed:le},pe)=>{const ve=oe.concat(ae).concat(le),ge=createEncoder();writeVarUint(ge,messageAwareness),writeVarUint8Array(ge,encodeAwarenessUpdate(te,ve)),broadcastMessage(this,toUint8Array(ge))},this._unloadHandler=()=>{removeAwarenessStates(this.awareness,[X.clientID],"window unload")},typeof window<"u"?window.addEventListener("unload",this._unloadHandler):typeof process<"u"&&process.on("exit",this._unloadHandler),te.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&messageReconnectTimeout<getUnixTime()-this.wsLastMessageReceived&&this.ws.close()},messageReconnectTimeout/10),ee&&this.connect()}get synced(){return this._synced}set synced(B){this._synced!==B&&(this._synced=B,this.emit("synced",[B]),this.emit("sync",[B]))}destroy(){this._resyncInterval!==0&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),typeof window<"u"?window.removeEventListener("unload",this._unloadHandler):typeof process<"u"&&process.off("exit",this._unloadHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;this.bcconnected||(subscribe(this.bcChannel,this._bcSubscriber),this.bcconnected=!0);const B=createEncoder();writeVarUint(B,messageSync),writeSyncStep1(B,this.doc),publish(this.bcChannel,toUint8Array(B),this);const j=createEncoder();writeVarUint(j,messageSync),writeSyncStep2(j,this.doc),publish(this.bcChannel,toUint8Array(j),this);const X=createEncoder();writeVarUint(X,messageQueryAwareness),publish(this.bcChannel,toUint8Array(X),this);const ee=createEncoder();writeVarUint(ee,messageAwareness),writeVarUint8Array(ee,encodeAwarenessUpdate(this.awareness,[this.doc.clientID])),publish(this.bcChannel,toUint8Array(ee),this)}disconnectBc(){const B=createEncoder();writeVarUint(B,messageAwareness),writeVarUint8Array(B,encodeAwarenessUpdate(this.awareness,[this.doc.clientID],new Map)),broadcastMessage(this,toUint8Array(B)),this.bcconnected&&(unsubscribe(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.wsconnected&&this.ws===null&&(setupWS(this),this.connectBc())}}class DebugDocProvider extends WebrtcProvider{constructor(B,j,X){var ee;super(B,j,{awareness:(ee=X==null?void 0:X.awareness)!=null?ee:null,signaling:["ws://localhost:4444"]})}clearData(){return Promise.resolve()}}class IndexedDBDocProvider extends IndexeddbPersistence{constructor(B,j){super(B,j)}connect(){}disconnect(){}clearData(){return Promise.resolve()}}function createWebsocketDocProvider(q){return class extends WebsocketProvider{constructor(j,X,ee){super(q,j,X,ee)}clearData(){return Promise.resolve()}}}var flexsearch_bundle={exports:{}};(function(module){(function _f(self){try{module&&(self=module)}catch(q){}self._factory=_f;var t;function u(q){return typeof q<"u"?q:!0}function aa(q){const B=Array(q);for(let j=0;j<q;j++)B[j]=v();return B}function v(){return Object.create(null)}function ba(q,B){return B.length-q.length}function x(q){return typeof q=="string"}function C(q){return typeof q=="object"}function D(q){return typeof q=="function"}function ca(q,B){var j=da;if(q&&(B&&(q=E(q,B)),this.H&&(q=E(q,this.H)),this.J&&1<q.length&&(q=E(q,this.J)),j||j==="")){if(q=q.split(j),this.filter){B=this.filter,j=q.length;const X=[];for(let ee=0,te=0;ee<j;ee++){const ne=q[ee];ne&&!B[ne]&&(X[te++]=ne)}q=X}return q}return q}const da=/[\p{Z}\p{S}\p{P}\p{C}]+/u,ea=/[\u0300-\u036f]/g;function fa(q,B){const j=Object.keys(q),X=j.length,ee=[];let te="",ne=0;for(let re=0,ie,fe;re<X;re++)ie=j[re],(fe=q[ie])?(ee[ne++]=F(B?"(?!\\b)"+ie+"(\\b|_)":ie),ee[ne++]=fe):te+=(te?"|":"")+ie;return te&&(ee[ne++]=F(B?"(?!\\b)("+te+")(\\b|_)":"("+te+")"),ee[ne]=""),ee}function E(q,B){for(let j=0,X=B.length;j<X&&(q=q.replace(B[j],B[j+1]),q);j+=2);return q}function F(q){return new RegExp(q,"g")}function ha(q){let B="",j="";for(let X=0,ee=q.length,te;X<ee;X++)(te=q[X])!==j&&(B+=j=te);return B}var ja={encode:ia,F:!1,G:""};function ia(q){return ca.call(this,(""+q).toLowerCase(),!1)}const ka={},G={};function la(q){I(q,"add"),I(q,"append"),I(q,"search"),I(q,"update"),I(q,"remove")}function I(q,B){q[B+"Async"]=function(){const j=this,X=arguments;var ee=X[X.length-1];let te;return D(ee)&&(te=ee,delete X[X.length-1]),ee=new Promise(function(ne){setTimeout(function(){j.async=!0;const re=j[B].apply(j,X);j.async=!1,ne(re)})}),te?(ee.then(te),this):ee}}function ma(q,B,j,X){const ee=q.length;let te=[],ne,re,ie=0;X&&(X=[]);for(let fe=ee-1;0<=fe;fe--){const ce=q[fe],se=ce.length,oe=v();let ae=!ne;for(let le=0;le<se;le++){const pe=ce[le],ve=pe.length;if(ve)for(let ge=0,de,ue;ge<ve;ge++)if(ue=pe[ge],ne){if(ne[ue]){if(!fe){if(j)j--;else if(te[ie++]=ue,ie===B)return te}(fe||X)&&(oe[ue]=1),ae=!0}if(X&&(re[ue]=(de=re[ue])?++de:de=1,de<ee)){const he=X[de-2]||(X[de-2]=[]);he[he.length]=ue}}else oe[ue]=1}if(X)ne||(re=oe);else if(!ae)return[];ne=oe}if(X)for(let fe=X.length-1,ce,se;0<=fe;fe--){ce=X[fe],se=ce.length;for(let oe=0,ae;oe<se;oe++)if(ae=ce[oe],!ne[ae]){if(j)j--;else if(te[ie++]=ae,ie===B)return te;ne[ae]=1}}return te}function na(q,B){const j=v(),X=v(),ee=[];for(let te=0;te<q.length;te++)j[q[te]]=1;for(let te=0,ne;te<B.length;te++){ne=B[te];for(let re=0,ie;re<ne.length;re++)ie=ne[re],j[ie]&&!X[ie]&&(X[ie]=1,ee[ee.length]=ie)}return ee}function J(q){this.l=q!==!0&&q,this.cache=v(),this.h=[]}function oa(q,B,j){C(q)&&(q=q.query);let X=this.cache.get(q);return X||(X=this.search(q,B,j),this.cache.set(q,X)),X}J.prototype.set=function(q,B){if(!this.cache[q]){var j=this.h.length;for(j===this.l?delete this.cache[this.h[j-1]]:j++,--j;0<j;j--)this.h[j]=this.h[j-1];this.h[0]=q}this.cache[q]=B},J.prototype.get=function(q){const B=this.cache[q];if(this.l&&B&&(q=this.h.indexOf(q))){const j=this.h[q-1];this.h[q-1]=this.h[q],this.h[q]=j}return B};const qa={memory:{charset:"latin:extra",D:3,B:4,m:!1},performance:{D:3,B:3,s:!1,context:{depth:2,D:1}},match:{charset:"latin:extra",G:"reverse"},score:{charset:"latin:advanced",D:20,B:3,context:{depth:3,D:9}},default:{}};function ra(q,B,j,X,ee,te){setTimeout(function(){const ne=q(j,JSON.stringify(te));ne&&ne.then?ne.then(function(){B.export(q,B,j,X,ee+1)}):B.export(q,B,j,X,ee+1)})}function K(q,B){if(!(this instanceof K))return new K(q);var j;if(q){x(q)?q=qa[q]:(j=q.preset)&&(q=Object.assign({},j[j],q)),j=q.charset;var X=q.lang;x(j)&&(j.indexOf(":")===-1&&(j+=":default"),j=G[j]),x(X)&&(X=ka[X])}else q={};let ee,te,ne=q.context||{};if(this.encode=q.encode||j&&j.encode||ia,this.register=B||v(),this.D=ee=q.resolution||9,this.G=B=j&&j.G||q.tokenize||"strict",this.depth=B==="strict"&&ne.depth,this.l=u(ne.bidirectional),this.s=te=u(q.optimize),this.m=u(q.fastupdate),this.B=q.minlength||1,this.C=q.boost,this.map=te?aa(ee):v(),this.A=ee=ne.resolution||1,this.h=te?aa(ee):v(),this.F=j&&j.F||q.rtl,this.H=(B=q.matcher||X&&X.H)&&fa(B,!1),this.J=(B=q.stemmer||X&&X.J)&&fa(B,!0),j=B=q.filter||X&&X.filter){j=B,X=v();for(let re=0,ie=j.length;re<ie;re++)X[j[re]]=1;j=X}this.filter=j,this.cache=(B=q.cache)&&new J(B)}t=K.prototype,t.append=function(q,B){return this.add(q,B,!0)},t.add=function(q,B,j,X){if(B&&(q||q===0)){if(!X&&!j&&this.register[q])return this.update(q,B);if(B=this.encode(B),X=B.length){const fe=v(),ce=v(),se=this.depth,oe=this.D;for(let ae=0;ae<X;ae++){let le=B[this.F?X-1-ae:ae];var ee=le.length;if(le&&ee>=this.B&&(se||!ce[le])){var te=L(oe,X,ae),ne="";switch(this.G){case"full":if(3<ee){for(te=0;te<ee;te++)for(var re=ee;re>te;re--)if(re-te>=this.B){var ie=L(oe,X,ae,ee,te);ne=le.substring(te,re),M(this,ce,ne,ie,q,j)}break}case"reverse":if(2<ee){for(re=ee-1;0<re;re--)ne=le[re]+ne,ne.length>=this.B&&M(this,ce,ne,L(oe,X,ae,ee,re),q,j);ne=""}case"forward":if(1<ee){for(re=0;re<ee;re++)ne+=le[re],ne.length>=this.B&&M(this,ce,ne,te,q,j);break}default:if(this.C&&(te=Math.min(te/this.C(B,le,ae)|0,oe-1)),M(this,ce,le,te,q,j),se&&1<X&&ae<X-1){for(ee=v(),ne=this.A,te=le,re=Math.min(se+1,X-ae),ee[te]=1,ie=1;ie<re;ie++)if((le=B[this.F?X-1-ae-ie:ae+ie])&&le.length>=this.B&&!ee[le]){ee[le]=1;const pe=this.l&&le>te;M(this,fe,pe?te:le,L(ne+(X/2>ne?0:1),X,ae,re-1,ie-1),q,j,pe?le:te)}}}}}this.m||(this.register[q]=1)}}return this};function L(q,B,j,X,ee){return j&&1<q?B+(X||0)<=q?j+(ee||0):(q-1)/(B+(X||0))*(j+(ee||0))+1|0:0}function M(q,B,j,X,ee,te,ne){let re=ne?q.h:q.map;(!B[j]||ne&&!B[j][ne])&&(q.s&&(re=re[X]),ne?(B=B[j]||(B[j]=v()),B[ne]=1,re=re[ne]||(re[ne]=v())):B[j]=1,re=re[j]||(re[j]=[]),q.s||(re=re[X]||(re[X]=[])),te&&re.indexOf(ee)!==-1||(re[re.length]=ee,q.m&&(q=q.register[ee]||(q.register[ee]=[]),q[q.length]=re)))}t.search=function(q,B,j){j||(!B&&C(q)?(j=q,q=j.query):C(B)&&(j=B));let X=[],ee,te,ne=0;if(j){B=j.limit,ne=j.offset||0;var re=j.context;te=j.suggest}if(q&&(q=this.encode(q),ee=q.length,1<ee)){j=v();var ie=[];for(let ce=0,se=0,oe;ce<ee;ce++)if((oe=q[ce])&&oe.length>=this.B&&!j[oe])if(this.s||te||this.map[oe])ie[se++]=oe,j[oe]=1;else return X;q=ie,ee=q.length}if(!ee)return X;B||(B=100),re=this.depth&&1<ee&&re!==!1,j=0;let fe;re?(fe=q[0],j=1):1<ee&&q.sort(ba);for(let ce,se;j<ee;j++){if(se=q[j],re?(ce=sa(this,X,te,B,ne,ee===2,se,fe),te&&ce===!1&&X.length||(fe=se)):ce=sa(this,X,te,B,ne,ee===1,se),ce)return ce;if(te&&j===ee-1){if(ie=X.length,!ie){if(re){re=0,j=-1;continue}return X}if(ie===1)return ta(X[0],B,ne)}}return ma(X,B,ne,te)};function sa(q,B,j,X,ee,te,ne,re){let ie=[],fe=re?q.h:q.map;if(q.s||(fe=ua(fe,ne,re,q.l)),fe){let ce=0;const se=Math.min(fe.length,re?q.A:q.D);for(let oe=0,ae=0,le,pe;oe<se&&!((le=fe[oe])&&(q.s&&(le=ua(le,ne,re,q.l)),ee&&le&&te&&(pe=le.length,pe<=ee?(ee-=pe,le=null):(le=le.slice(ee),ee=0)),le&&(ie[ce++]=le,te&&(ae+=le.length,ae>=X))));oe++);if(ce){if(te)return ta(ie,X,0);B[B.length]=ie;return}}return!j&&ie}function ta(q,B,j){return q=q.length===1?q[0]:[].concat.apply([],q),j||q.length>B?q.slice(j,j+B):q}function ua(q,B,j,X){return j?(X=X&&B>j,q=(q=q[X?B:j])&&q[X?j:B]):q=q[B],q}t.contain=function(q){return!!this.register[q]},t.update=function(q,B){return this.remove(q).add(q,B)},t.remove=function(q,B){const j=this.register[q];if(j){if(this.m)for(let X=0,ee;X<j.length;X++)ee=j[X],ee.splice(ee.indexOf(q),1);else N(this.map,q,this.D,this.s),this.depth&&N(this.h,q,this.A,this.s);if(B||delete this.register[q],this.cache){B=this.cache;for(let X=0,ee,te;X<B.h.length;X++)te=B.h[X],ee=B.cache[te],ee.indexOf(q)!==-1&&(B.h.splice(X--,1),delete B.cache[te])}}return this};function N(q,B,j,X,ee){let te=0;if(q.constructor===Array)if(ee)B=q.indexOf(B),B!==-1?1<q.length&&(q.splice(B,1),te++):te++;else{ee=Math.min(q.length,j);for(let ne=0,re;ne<ee;ne++)(re=q[ne])&&(te=N(re,B,j,X,ee),X||te||delete q[ne])}else for(let ne in q)(te=N(q[ne],B,j,X,ee))||delete q[ne];return te}t.searchCache=oa,t.export=function(q,B,j,X,ee){let te,ne;switch(ee||(ee=0)){case 0:if(te="reg",this.m){ne=v();for(let re in this.register)ne[re]=1}else ne=this.register;break;case 1:te="cfg",ne={doc:0,opt:this.s?1:0};break;case 2:te="map",ne=this.map;break;case 3:te="ctx",ne=this.h;break;default:return}return ra(q,B||this,j?j+"."+te:te,X,ee,ne),!0},t.import=function(q,B){if(B)switch(x(B)&&(B=JSON.parse(B)),q){case"cfg":this.s=!!B.opt;break;case"reg":this.m=!1,this.register=B;break;case"map":this.map=B;break;case"ctx":this.h=B}},la(K.prototype);function va(q){q=q.data;var B=self._index;const j=q.args;var X=q.task;switch(X){case"init":X=q.options||{},q=q.factory,B=X.encode,X.cache=!1,B&&B.indexOf("function")===0&&(X.encode=Function("return "+B)()),q?(Function("return "+q)()(self),self._index=new self.FlexSearch.Index(X),delete self.FlexSearch):self._index=new K(X);break;default:q=q.id,B=B[X].apply(B,j),postMessage(X==="search"?{id:q,msg:B}:{id:q})}}let wa=0;function O(q){if(!(this instanceof O))return new O(q);var B;q?D(B=q.encode)&&(q.encode=B.toString()):q={},(B=(self||window)._factory)&&(B=B.toString());const j=self.exports,X=this;this.o=xa(B,j,q.worker),this.h=v(),this.o&&(j?this.o.on("message",function(ee){X.h[ee.id](ee.msg),delete X.h[ee.id]}):this.o.onmessage=function(ee){ee=ee.data,X.h[ee.id](ee.msg),delete X.h[ee.id]},this.o.postMessage({task:"init",factory:B,options:q}))}P("add"),P("append"),P("search"),P("update"),P("remove");function P(q){O.prototype[q]=O.prototype[q+"Async"]=function(){const B=this,j=[].slice.call(arguments);var X=j[j.length-1];let ee;return D(X)&&(ee=X,j.splice(j.length-1,1)),X=new Promise(function(te){setTimeout(function(){B.h[++wa]=te,B.o.postMessage({task:q,id:wa,args:j})})}),ee?(X.then(ee),this):X}}function xa(a,b,c){let d;try{d=b?eval('new (require("worker_threads")["Worker"])("../dist/node/node.js")'):a?new Worker(URL.createObjectURL(new Blob(["onmessage="+va.toString()],{type:"text/javascript"}))):new Worker(x(c)?c:"worker/worker.js",{type:"module"})}catch(q){}return d}function Q(q){if(!(this instanceof Q))return new Q(q);var B=q.document||q.doc||q,j;this.K=[],this.h=[],this.A=[],this.register=v(),this.key=(j=B.key||B.id)&&S(j,this.A)||"id",this.m=u(q.fastupdate),this.C=(j=B.store)&&j!==!0&&[],this.store=j&&v(),this.I=(j=B.tag)&&S(j,this.A),this.l=j&&v(),this.cache=(j=q.cache)&&new J(j),q.cache=!1,this.o=q.worker,this.async=!1,j=v();let X=B.index||B.field||B;x(X)&&(X=[X]);for(let ee=0,te,ne;ee<X.length;ee++)te=X[ee],x(te)||(ne=te,te=te.field),ne=C(ne)?Object.assign({},q,ne):q,this.o&&(j[te]=new O(ne),j[te].o||(this.o=!1)),this.o||(j[te]=new K(ne,this.register)),this.K[ee]=S(te,this.A),this.h[ee]=te;if(this.C)for(q=B.store,x(q)&&(q=[q]),B=0;B<q.length;B++)this.C[B]=S(q[B],this.A);this.index=j}function S(q,B){const j=q.split(":");let X=0;for(let ee=0;ee<j.length;ee++)q=j[ee],0<=q.indexOf("[]")&&(q=q.substring(0,q.length-2))&&(B[X]=!0),q&&(j[X++]=q);return X<j.length&&(j.length=X),1<X?j:j[0]}function T(q,B){if(x(B))q=q[B];else for(let j=0;q&&j<B.length;j++)q=q[B[j]];return q}function U(q,B,j,X,ee){if(q=q[ee],X===j.length-1)B[ee]=q;else if(q)if(q.constructor===Array)for(B=B[ee]=Array(q.length),ee=0;ee<q.length;ee++)U(q,B,j,X,ee);else B=B[ee]||(B[ee]=v()),ee=j[++X],U(q,B,j,X,ee)}function V(q,B,j,X,ee,te,ne,re){if(q=q[ne])if(X===B.length-1){if(q.constructor===Array){if(j[X]){for(B=0;B<q.length;B++)ee.add(te,q[B],!0,!0);return}q=q.join(" ")}ee.add(te,q,re,!0)}else if(q.constructor===Array)for(ne=0;ne<q.length;ne++)V(q,B,j,X,ee,te,ne,re);else ne=B[++X],V(q,B,j,X,ee,te,ne,re)}t=Q.prototype,t.add=function(q,B,j){if(C(q)&&(B=q,q=T(B,this.key)),B&&(q||q===0)){if(!j&&this.register[q])return this.update(q,B);for(let X=0,ee,te;X<this.h.length;X++)te=this.h[X],ee=this.K[X],x(ee)&&(ee=[ee]),V(B,ee,this.A,0,this.index[te],q,ee[0],j);if(this.I){let X=T(B,this.I),ee=v();x(X)&&(X=[X]);for(let te=0,ne,re;te<X.length;te++)if(ne=X[te],!ee[ne]&&(ee[ne]=1,re=this.l[ne]||(this.l[ne]=[]),!j||re.indexOf(q)===-1)&&(re[re.length]=q,this.m)){const ie=this.register[q]||(this.register[q]=[]);ie[ie.length]=re}}if(this.store&&(!j||!this.store[q])){let X;if(this.C){X=v();for(let ee=0,te;ee<this.C.length;ee++)te=this.C[ee],x(te)?X[te]=B[te]:U(B,X,te,0,te[0])}this.store[q]=X||B}}return this},t.append=function(q,B){return this.add(q,B,!0)},t.update=function(q,B){return this.remove(q).add(q,B)},t.remove=function(q){if(C(q)&&(q=T(q,this.key)),this.register[q]){for(var B=0;B<this.h.length&&(this.index[this.h[B]].remove(q,!this.o),!this.m);B++);if(this.I&&!this.m)for(let j in this.l){B=this.l[j];const X=B.indexOf(q);X!==-1&&(1<B.length?B.splice(X,1):delete this.l[j])}this.store&&delete this.store[q],delete this.register[q]}return this},t.search=function(q,B,j,X){j||(!B&&C(q)?(j=q,q=j.query):C(B)&&(j=B,B=0));let ee=[],te=[],ne,re,ie,fe,ce,se,oe=0;if(j)if(j.constructor===Array)ie=j,j=null;else{if(ie=(ne=j.pluck)||j.index||j.field,fe=j.tag,re=this.store&&j.enrich,ce=j.bool==="and",B=j.limit||100,se=j.offset||0,fe&&(x(fe)&&(fe=[fe]),!q)){for(let le=0,pe;le<fe.length;le++)(pe=ya.call(this,fe[le],B,se,re))&&(ee[ee.length]=pe,oe++);return oe?ee:[]}x(ie)&&(ie=[ie])}ie||(ie=this.h),ce=ce&&(1<ie.length||fe&&1<fe.length);const ae=!X&&(this.o||this.async)&&[];for(let le=0,pe,ve,ge;le<ie.length;le++){let de;if(ve=ie[le],x(ve)||(de=ve,ve=ve.field),ae)ae[le]=this.index[ve].searchAsync(q,B,de||j);else{if(X?pe=X[le]:pe=this.index[ve].search(q,B,de||j),ge=pe&&pe.length,fe&&ge){const ue=[];let he=0;ce&&(ue[0]=[pe]);for(let me=0,_e,be;me<fe.length;me++)_e=fe[me],(ge=(be=this.l[_e])&&be.length)&&(he++,ue[ue.length]=ce?[be]:be);he&&(pe=ce?ma(ue,B||100,se||0):na(pe,ue),ge=pe.length)}if(ge)te[oe]=ve,ee[oe++]=pe;else if(ce)return[]}}if(ae){const le=this;return new Promise(function(pe){Promise.all(ae).then(function(ve){pe(le.search(q,B,j,ve))})})}if(!oe)return[];if(ne&&(!re||!this.store))return ee[0];for(let le=0,pe;le<te.length;le++){if(pe=ee[le],pe.length&&re&&(pe=za.call(this,pe)),ne)return pe;ee[le]={field:te[le],result:pe}}return ee};function ya(q,B,j,X){let ee=this.l[q],te=ee&&ee.length-j;if(te&&0<te)return(te>B||j)&&(ee=ee.slice(j,j+B)),X&&(ee=za.call(this,ee)),{tag:q,result:ee}}function za(q){const B=Array(q.length);for(let j=0,X;j<q.length;j++)X=q[j],B[j]={id:X,doc:this.store[X]};return B}t.contain=function(q){return!!this.register[q]},t.get=function(q){return this.store[q]},t.set=function(q,B){return this.store[q]=B,this},t.searchCache=oa,t.export=function(q,B,j,X,ee){if(ee||(ee=0),X||(X=0),X<this.h.length){const te=this.h[X],ne=this.index[te];B=this,setTimeout(function(){ne.export(q,B,ee?te.replace(":","-"):"",X,ee++)||(X++,ee=1,B.export(q,B,te,X,ee))})}else{let te;switch(ee){case 1:j="tag",te=this.l;break;case 2:j="store",te=this.store;break;default:return}ra(q,this,j,X,ee,te)}},t.import=function(q,B){if(B)switch(x(B)&&(B=JSON.parse(B)),q){case"tag":this.l=B;break;case"reg":this.m=!1,this.register=B;for(let X=0,ee;X<this.h.length;X++)ee=this.index[this.h[X]],ee.register=B,ee.m=!1;break;case"store":this.store=B;break;default:q=q.split(".");const j=q[0];q=q[1],j&&q&&this.index[j].import(q,B)}},la(Q.prototype);var Ba={encode:Aa,F:!1,G:""};const Ca=[F("[\xE0\xE1\xE2\xE3\xE4\xE5]"),"a",F("[\xE8\xE9\xEA\xEB]"),"e",F("[\xEC\xED\xEE\xEF]"),"i",F("[\xF2\xF3\xF4\xF5\xF6\u0151]"),"o",F("[\xF9\xFA\xFB\xFC\u0171]"),"u",F("[\xFD\u0177\xFF]"),"y",F("\xF1"),"n",F("[\xE7c]"),"k",F("\xDF"),"s",F(" & ")," and "];function Aa(q){var B=q;return B.normalize&&(B=B.normalize("NFD").replace(ea,"")),ca.call(this,B.toLowerCase(),!q.normalize&&Ca)}var Ea={encode:Da,F:!1,G:"strict"};const Fa=/[^a-z0-9]+/,Ga={b:"p",v:"f",w:"f",z:"s",x:"s",\u00DF:"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function Da(q){q=Aa.call(this,q).join(" ");const B=[];if(q){const j=q.split(Fa),X=j.length;for(let ee=0,te,ne=0;ee<X;ee++)if((q=j[ee])&&(!this.filter||!this.filter[q])){te=q[0];let re=Ga[te]||te,ie=re;for(let fe=1;fe<q.length;fe++){te=q[fe];const ce=Ga[te]||te;ce&&ce!==ie&&(re+=ce,ie=ce)}B[ne++]=re}}return B}var Ia={encode:Ha,F:!1,G:""};const Ja=[F("ae"),"a",F("oe"),"o",F("sh"),"s",F("th"),"t",F("ph"),"f",F("pf"),"f",F("(?![aeo])h(?![aeo])"),"",F("(?!^[aeo])h(?!^[aeo])"),""];function Ha(q,B){return q&&(q=Da.call(this,q).join(" "),2<q.length&&(q=E(q,Ja)),B||(1<q.length&&(q=ha(q)),q&&(q=q.split(" ")))),q}var La={encode:Ka,F:!1,G:""};const Ma=F("(?!\\b)[aeo]");function Ka(q){return q&&(q=Ha.call(this,q,!0),1<q.length&&(q=q.replace(Ma,"")),1<q.length&&(q=ha(q)),q&&(q=q.split(" "))),q}G["latin:default"]=ja,G["latin:simple"]=Ba,G["latin:balance"]=Ea,G["latin:advanced"]=Ia,G["latin:extra"]=La;const W=self;let Y;const Z={Index:K,Document:Q,Worker:O,registerCharset:function(q,B){G[q]=B},registerLanguage:function(q,B){ka[q]=B}};(Y=W.define)&&Y.amd?Y([],function(){return Z}):W.exports?W.exports=Z:W.FlexSearch=Z})(commonjsGlobal)})(flexsearch_bundle);function tokenize(q){const B=Intl==null?void 0:Intl.Segmenter;if(B){const j=new B([q],{granularity:"word"});return X=>Array.from(j.segment(X)).filter(ee=>ee.isWordLike).map(ee=>ee.segment)}return j=>j.replace(/[\x00-\x7F]/g,"").split("")}class Indexer{constructor(B,j="en-US"){this._doc=B,this._indexer=new flexsearch_bundle.exports.Document({document:{id:"id",index:["content","reference"],tag:"tags"},encode:tokenize(j),tokenize:"forward",context:!0}),Array.from(B.share.keys()).map(X=>[X,this._getSpace(X)]).forEach(([X,ee])=>this._handleSpaceIndexing(X,ee))}onCreateSpace(B){this._handleSpaceIndexing(B,this._getSpace(B))}search(B){return this._indexer.search(B)}_handleSpaceIndexing(B,j){j&&(j.forEach((X,ee)=>{this._refreshIndex(B,ee,"add",j.get(ee))}),j.observeDeep(X=>{const ee=X.flatMap(te=>{var ne;return(((ne=te.path)==null?void 0:ne.length)|0)>0?[[te.path[0],"update"]]:Array.from(te.changes.keys.entries()).map(([re,{action:ie}])=>[re,ie])});ee.length&&ee.forEach(([te,ne])=>{this._refreshIndex(B,te,ne,j.get(te))})}))}_refreshIndex(B,j,X,ee){switch(X){case"add":case"update":{if(ee){const te=this._toContent(ee.get("prop:title")||ee.get("prop:text"));te&&this._indexer.add(j,{content:te,reference:"",tags:[B]})}break}case"delete":{this._indexer.remove(j);break}}}_toContent(B){if(B){if(typeof B=="string")return B;if(B instanceof YText)return B.toJSON()}}_getSpace(B){try{return B.startsWith("space:")?this._doc.getMap(B):void 0}catch{return}}}class Page extends Space{}class Workspace{get providers(){return this._store.providers}get pages(){return this._store.spaces}get doc(){return this._store.doc}constructor(B){this._store=new Store(B),this._indexer=new Indexer(this.doc)}createPage(B){const j=new Page("space:"+B,this.doc,this._store.awareness,this._store.idGenerator);return this._store.addSpace(j),this._indexer.onCreateSpace(j.id),j}serializeDoc(){return this._store.serializeDoc()}search(B){return this._indexer.search(B)}toJSXElement(B="0"){return this._store.toJSXElement(B)}}const env$2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},importIdentifier$2="__ $BLOCKSUITE_STORE$ __";env$2[importIdentifier$2]===!0&&console.error("@blocksuite/store was already imported. This breaks constructor checks and will lead to issues!");env$2[importIdentifier$2]=!0;var quill={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(q,B){(function(X,ee){q.exports=ee()})(typeof self<"u"?self:commonjsGlobal,function(){return function(j){var X={};function ee(te){if(X[te])return X[te].exports;var ne=X[te]={i:te,l:!1,exports:{}};return j[te].call(ne.exports,ne,ne.exports,ee),ne.l=!0,ne.exports}return ee.m=j,ee.c=X,ee.d=function(te,ne,re){ee.o(te,ne)||Object.defineProperty(te,ne,{configurable:!1,enumerable:!0,get:re})},ee.n=function(te){var ne=te&&te.__esModule?function(){return te.default}:function(){return te};return ee.d(ne,"a",ne),ne},ee.o=function(te,ne){return Object.prototype.hasOwnProperty.call(te,ne)},ee.p="",ee(ee.s=109)}([function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(17),ne=ee(18),re=ee(19),ie=ee(45),fe=ee(46),ce=ee(47),se=ee(48),oe=ee(49),ae=ee(12),le=ee(32),pe=ee(33),ve=ee(31),ge=ee(1),de={Scope:ge.Scope,create:ge.create,find:ge.find,query:ge.query,register:ge.register,Container:te.default,Format:ne.default,Leaf:re.default,Embed:se.default,Scroll:ie.default,Block:ce.default,Inline:fe.default,Text:oe.default,Attributor:{Attribute:ae.default,Class:le.default,Style:pe.default,Store:ve.default}};X.default=de},function(j,X,ee){var te=this&&this.__extends||function(){var ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ge,de){ge.__proto__=de}||function(ge,de){for(var ue in de)de.hasOwnProperty(ue)&&(ge[ue]=de[ue])};return function(ge,de){ve(ge,de);function ue(){this.constructor=ge}ge.prototype=de===null?Object.create(de):(ue.prototype=de.prototype,new ue)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=function(ve){te(ge,ve);function ge(de){var ue=this;return de="[Parchment] "+de,ue=ve.call(this,de)||this,ue.message=de,ue.name=ue.constructor.name,ue}return ge}(Error);X.ParchmentError=ne;var re={},ie={},fe={},ce={};X.DATA_KEY="__blot";var se;(function(ve){ve[ve.TYPE=3]="TYPE",ve[ve.LEVEL=12]="LEVEL",ve[ve.ATTRIBUTE=13]="ATTRIBUTE",ve[ve.BLOT=14]="BLOT",ve[ve.INLINE=7]="INLINE",ve[ve.BLOCK=11]="BLOCK",ve[ve.BLOCK_BLOT=10]="BLOCK_BLOT",ve[ve.INLINE_BLOT=6]="INLINE_BLOT",ve[ve.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",ve[ve.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",ve[ve.ANY=15]="ANY"})(se=X.Scope||(X.Scope={}));function oe(ve,ge){var de=le(ve);if(de==null)throw new ne("Unable to create "+ve+" blot");var ue=de,he=ve instanceof Node||ve.nodeType===Node.TEXT_NODE?ve:ue.create(ge);return new ue(he,ge)}X.create=oe;function ae(ve,ge){return ge===void 0&&(ge=!1),ve==null?null:ve[X.DATA_KEY]!=null?ve[X.DATA_KEY].blot:ge?ae(ve.parentNode,ge):null}X.find=ae;function le(ve,ge){ge===void 0&&(ge=se.ANY);var de;if(typeof ve=="string")de=ce[ve]||re[ve];else if(ve instanceof Text||ve.nodeType===Node.TEXT_NODE)de=ce.text;else if(typeof ve=="number")ve&se.LEVEL&se.BLOCK?de=ce.block:ve&se.LEVEL&se.INLINE&&(de=ce.inline);else if(ve instanceof HTMLElement){var ue=(ve.getAttribute("class")||"").split(/\s+/);for(var he in ue)if(de=ie[ue[he]],de)break;de=de||fe[ve.tagName]}return de==null?null:ge&se.LEVEL&de.scope&&ge&se.TYPE&de.scope?de:null}X.query=le;function pe(){for(var ve=[],ge=0;ge<arguments.length;ge++)ve[ge]=arguments[ge];if(ve.length>1)return ve.map(function(he){return pe(he)});var de=ve[0];if(typeof de.blotName!="string"&&typeof de.attrName!="string")throw new ne("Invalid definition");if(de.blotName==="abstract")throw new ne("Cannot register abstract class");if(ce[de.blotName||de.attrName]=de,typeof de.keyName=="string")re[de.keyName]=de;else if(de.className!=null&&(ie[de.className]=de),de.tagName!=null){Array.isArray(de.tagName)?de.tagName=de.tagName.map(function(he){return he.toUpperCase()}):de.tagName=de.tagName.toUpperCase();var ue=Array.isArray(de.tagName)?de.tagName:[de.tagName];ue.forEach(function(he){(fe[he]==null||de.className==null)&&(fe[he]=de)})}return de}X.register=pe},function(j,X,ee){var te=ee(51),ne=ee(11),re=ee(3),ie=ee(20),fe=String.fromCharCode(0),ce=function(se){Array.isArray(se)?this.ops=se:se!=null&&Array.isArray(se.ops)?this.ops=se.ops:this.ops=[]};ce.prototype.insert=function(se,oe){var ae={};return se.length===0?this:(ae.insert=se,oe!=null&&typeof oe=="object"&&Object.keys(oe).length>0&&(ae.attributes=oe),this.push(ae))},ce.prototype.delete=function(se){return se<=0?this:this.push({delete:se})},ce.prototype.retain=function(se,oe){if(se<=0)return this;var ae={retain:se};return oe!=null&&typeof oe=="object"&&Object.keys(oe).length>0&&(ae.attributes=oe),this.push(ae)},ce.prototype.push=function(se){var oe=this.ops.length,ae=this.ops[oe-1];if(se=re(!0,{},se),typeof ae=="object"){if(typeof se.delete=="number"&&typeof ae.delete=="number")return this.ops[oe-1]={delete:ae.delete+se.delete},this;if(typeof ae.delete=="number"&&se.insert!=null&&(oe-=1,ae=this.ops[oe-1],typeof ae!="object"))return this.ops.unshift(se),this;if(ne(se.attributes,ae.attributes)){if(typeof se.insert=="string"&&typeof ae.insert=="string")return this.ops[oe-1]={insert:ae.insert+se.insert},typeof se.attributes=="object"&&(this.ops[oe-1].attributes=se.attributes),this;if(typeof se.retain=="number"&&typeof ae.retain=="number")return this.ops[oe-1]={retain:ae.retain+se.retain},typeof se.attributes=="object"&&(this.ops[oe-1].attributes=se.attributes),this}}return oe===this.ops.length?this.ops.push(se):this.ops.splice(oe,0,se),this},ce.prototype.chop=function(){var se=this.ops[this.ops.length-1];return se&&se.retain&&!se.attributes&&this.ops.pop(),this},ce.prototype.filter=function(se){return this.ops.filter(se)},ce.prototype.forEach=function(se){this.ops.forEach(se)},ce.prototype.map=function(se){return this.ops.map(se)},ce.prototype.partition=function(se){var oe=[],ae=[];return this.forEach(function(le){var pe=se(le)?oe:ae;pe.push(le)}),[oe,ae]},ce.prototype.reduce=function(se,oe){return this.ops.reduce(se,oe)},ce.prototype.changeLength=function(){return this.reduce(function(se,oe){return oe.insert?se+ie.length(oe):oe.delete?se-oe.delete:se},0)},ce.prototype.length=function(){return this.reduce(function(se,oe){return se+ie.length(oe)},0)},ce.prototype.slice=function(se,oe){se=se||0,typeof oe!="number"&&(oe=1/0);for(var ae=[],le=ie.iterator(this.ops),pe=0;pe<oe&&le.hasNext();){var ve;pe<se?ve=le.next(se-pe):(ve=le.next(oe-pe),ae.push(ve)),pe+=ie.length(ve)}return new ce(ae)},ce.prototype.compose=function(se){var oe=ie.iterator(this.ops),ae=ie.iterator(se.ops),le=[],pe=ae.peek();if(pe!=null&&typeof pe.retain=="number"&&pe.attributes==null){for(var ve=pe.retain;oe.peekType()==="insert"&&oe.peekLength()<=ve;)ve-=oe.peekLength(),le.push(oe.next());pe.retain-ve>0&&ae.next(pe.retain-ve)}for(var ge=new ce(le);oe.hasNext()||ae.hasNext();)if(ae.peekType()==="insert")ge.push(ae.next());else if(oe.peekType()==="delete")ge.push(oe.next());else{var de=Math.min(oe.peekLength(),ae.peekLength()),ue=oe.next(de),he=ae.next(de);if(typeof he.retain=="number"){var me={};typeof ue.retain=="number"?me.retain=de:me.insert=ue.insert;var _e=ie.attributes.compose(ue.attributes,he.attributes,typeof ue.retain=="number");if(_e&&(me.attributes=_e),ge.push(me),!ae.hasNext()&&ne(ge.ops[ge.ops.length-1],me)){var be=new ce(oe.rest());return ge.concat(be).chop()}}else typeof he.delete=="number"&&typeof ue.retain=="number"&&ge.push(he)}return ge.chop()},ce.prototype.concat=function(se){var oe=new ce(this.ops.slice());return se.ops.length>0&&(oe.push(se.ops[0]),oe.ops=oe.ops.concat(se.ops.slice(1))),oe},ce.prototype.diff=function(se,oe){if(this.ops===se.ops)return new ce;var ae=[this,se].map(function(de){return de.map(function(ue){if(ue.insert!=null)return typeof ue.insert=="string"?ue.insert:fe;var he=de===se?"on":"with";throw new Error("diff() called "+he+" non-document")}).join("")}),le=new ce,pe=te(ae[0],ae[1],oe),ve=ie.iterator(this.ops),ge=ie.iterator(se.ops);return pe.forEach(function(de){for(var ue=de[1].length;ue>0;){var he=0;switch(de[0]){case te.INSERT:he=Math.min(ge.peekLength(),ue),le.push(ge.next(he));break;case te.DELETE:he=Math.min(ue,ve.peekLength()),ve.next(he),le.delete(he);break;case te.EQUAL:he=Math.min(ve.peekLength(),ge.peekLength(),ue);var me=ve.next(he),_e=ge.next(he);ne(me.insert,_e.insert)?le.retain(he,ie.attributes.diff(me.attributes,_e.attributes)):le.push(_e).delete(he);break}ue-=he}}),le.chop()},ce.prototype.eachLine=function(se,oe){oe=oe||`
`;for(var ae=ie.iterator(this.ops),le=new ce,pe=0;ae.hasNext();){if(ae.peekType()!=="insert")return;var ve=ae.peek(),ge=ie.length(ve)-ae.peekLength(),de=typeof ve.insert=="string"?ve.insert.indexOf(oe,ge)-ge:-1;if(de<0)le.push(ae.next());else if(de>0)le.push(ae.next(de));else{if(se(le,ae.next(1).attributes||{},pe)===!1)return;pe+=1,le=new ce}}le.length()>0&&se(le,{},pe)},ce.prototype.transform=function(se,oe){if(oe=!!oe,typeof se=="number")return this.transformPosition(se,oe);for(var ae=ie.iterator(this.ops),le=ie.iterator(se.ops),pe=new ce;ae.hasNext()||le.hasNext();)if(ae.peekType()==="insert"&&(oe||le.peekType()!=="insert"))pe.retain(ie.length(ae.next()));else if(le.peekType()==="insert")pe.push(le.next());else{var ve=Math.min(ae.peekLength(),le.peekLength()),ge=ae.next(ve),de=le.next(ve);if(ge.delete)continue;de.delete?pe.push(de):pe.retain(ve,ie.attributes.transform(ge.attributes,de.attributes,oe))}return pe.chop()},ce.prototype.transformPosition=function(se,oe){oe=!!oe;for(var ae=ie.iterator(this.ops),le=0;ae.hasNext()&&le<=se;){var pe=ae.peekLength(),ve=ae.peekType();if(ae.next(),ve==="delete"){se-=Math.min(pe,se-le);continue}else ve==="insert"&&(le<se||!oe)&&(se+=pe);le+=pe}return se},j.exports=ce},function(j,X){var ee=Object.prototype.hasOwnProperty,te=Object.prototype.toString,ne=Object.defineProperty,re=Object.getOwnPropertyDescriptor,ie=function(ae){return typeof Array.isArray=="function"?Array.isArray(ae):te.call(ae)==="[object Array]"},fe=function(ae){if(!ae||te.call(ae)!=="[object Object]")return!1;var le=ee.call(ae,"constructor"),pe=ae.constructor&&ae.constructor.prototype&&ee.call(ae.constructor.prototype,"isPrototypeOf");if(ae.constructor&&!le&&!pe)return!1;var ve;for(ve in ae);return typeof ve>"u"||ee.call(ae,ve)},ce=function(ae,le){ne&&le.name==="__proto__"?ne(ae,le.name,{enumerable:!0,configurable:!0,value:le.newValue,writable:!0}):ae[le.name]=le.newValue},se=function(ae,le){if(le==="__proto__")if(ee.call(ae,le)){if(re)return re(ae,le).value}else return;return ae[le]};j.exports=function oe(){var ae,le,pe,ve,ge,de,ue=arguments[0],he=1,me=arguments.length,_e=!1;for(typeof ue=="boolean"&&(_e=ue,ue=arguments[1]||{},he=2),(ue==null||typeof ue!="object"&&typeof ue!="function")&&(ue={});he<me;++he)if(ae=arguments[he],ae!=null)for(le in ae)pe=se(ue,le),ve=se(ae,le),ue!==ve&&(_e&&ve&&(fe(ve)||(ge=ie(ve)))?(ge?(ge=!1,de=pe&&ie(pe)?pe:[]):de=pe&&fe(pe)?pe:{},ce(ue,{name:le,newValue:oe(_e,de,ve)})):typeof ve<"u"&&ce(ue,{name:le,newValue:ve}));return ue}},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.BlockEmbed=X.bubbleFormats=void 0;var te=function(){function ke(xe,Ae){for(var Le=0;Le<Ae.length;Le++){var De=Ae[Le];De.enumerable=De.enumerable||!1,De.configurable=!0,"value"in De&&(De.writable=!0),Object.defineProperty(xe,De.key,De)}}return function(xe,Ae,Le){return Ae&&ke(xe.prototype,Ae),Le&&ke(xe,Le),xe}}(),ne=function ke(xe,Ae,Le){xe===null&&(xe=Function.prototype);var De=Object.getOwnPropertyDescriptor(xe,Ae);if(De===void 0){var $e=Object.getPrototypeOf(xe);return $e===null?void 0:ke($e,Ae,Le)}else{if("value"in De)return De.value;var Ve=De.get;return Ve===void 0?void 0:Ve.call(Le)}},re=ee(3),ie=ue(re),fe=ee(2),ce=ue(fe),se=ee(0),oe=ue(se),ae=ee(16),le=ue(ae),pe=ee(6),ve=ue(pe),ge=ee(7),de=ue(ge);function ue(ke){return ke&&ke.__esModule?ke:{default:ke}}function he(ke,xe){if(!(ke instanceof xe))throw new TypeError("Cannot call a class as a function")}function me(ke,xe){if(!ke)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xe&&(typeof xe=="object"||typeof xe=="function")?xe:ke}function _e(ke,xe){if(typeof xe!="function"&&xe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof xe);ke.prototype=Object.create(xe&&xe.prototype,{constructor:{value:ke,enumerable:!1,writable:!0,configurable:!0}}),xe&&(Object.setPrototypeOf?Object.setPrototypeOf(ke,xe):ke.__proto__=xe)}var be=1,Se=function(ke){_e(xe,ke);function xe(){return he(this,xe),me(this,(xe.__proto__||Object.getPrototypeOf(xe)).apply(this,arguments))}return te(xe,[{key:"attach",value:function(){ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"attach",this).call(this),this.attributes=new oe.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new ce.default().insert(this.value(),(0,ie.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(Le,De){var $e=oe.default.query(Le,oe.default.Scope.BLOCK_ATTRIBUTE);$e!=null&&this.attributes.attribute($e,De)}},{key:"formatAt",value:function(Le,De,$e,Ve){this.format($e,Ve)}},{key:"insertAt",value:function(Le,De,$e){if(typeof De=="string"&&De.endsWith(`
`)){var Ve=oe.default.create(Te.blotName);this.parent.insertBefore(Ve,Le===0?this:this.next),Ve.insertAt(0,De.slice(0,-1))}else ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"insertAt",this).call(this,Le,De,$e)}}]),xe}(oe.default.Embed);Se.scope=oe.default.Scope.BLOCK_BLOT;var Te=function(ke){_e(xe,ke);function xe(Ae){he(this,xe);var Le=me(this,(xe.__proto__||Object.getPrototypeOf(xe)).call(this,Ae));return Le.cache={},Le}return te(xe,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(oe.default.Leaf).reduce(function(Le,De){return De.length()===0?Le:Le.insert(De.value(),we(De))},new ce.default).insert(`
`,we(this))),this.cache.delta}},{key:"deleteAt",value:function(Le,De){ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"deleteAt",this).call(this,Le,De),this.cache={}}},{key:"formatAt",value:function(Le,De,$e,Ve){De<=0||(oe.default.query($e,oe.default.Scope.BLOCK)?Le+De===this.length()&&this.format($e,Ve):ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"formatAt",this).call(this,Le,Math.min(De,this.length()-Le-1),$e,Ve),this.cache={})}},{key:"insertAt",value:function(Le,De,$e){if($e!=null)return ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"insertAt",this).call(this,Le,De,$e);if(De.length!==0){var Ve=De.split(`
`),Qe=Ve.shift();Qe.length>0&&(Le<this.length()-1||this.children.tail==null?ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"insertAt",this).call(this,Math.min(Le,this.length()-1),Qe):this.children.tail.insertAt(this.children.tail.length(),Qe),this.cache={});var je=this;Ve.reduce(function(He,Ie){return je=je.split(He,!0),je.insertAt(0,Ie),Ie.length},Le+Qe.length)}}},{key:"insertBefore",value:function(Le,De){var $e=this.children.head;ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"insertBefore",this).call(this,Le,De),$e instanceof le.default&&$e.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"length",this).call(this)+be),this.cache.length}},{key:"moveChildren",value:function(Le,De){ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"moveChildren",this).call(this,Le,De),this.cache={}}},{key:"optimize",value:function(Le){ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"optimize",this).call(this,Le),this.cache={}}},{key:"path",value:function(Le){return ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"path",this).call(this,Le,!0)}},{key:"removeChild",value:function(Le){ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"removeChild",this).call(this,Le),this.cache={}}},{key:"split",value:function(Le){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(De&&(Le===0||Le>=this.length()-be)){var $e=this.clone();return Le===0?(this.parent.insertBefore($e,this),this):(this.parent.insertBefore($e,this.next),$e)}else{var Ve=ne(xe.prototype.__proto__||Object.getPrototypeOf(xe.prototype),"split",this).call(this,Le,De);return this.cache={},Ve}}}]),xe}(oe.default.Block);Te.blotName="block",Te.tagName="P",Te.defaultChild="break",Te.allowedChildren=[ve.default,oe.default.Embed,de.default];function we(ke){var xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ke==null||(typeof ke.formats=="function"&&(xe=(0,ie.default)(xe,ke.formats())),ke.parent==null||ke.parent.blotName=="scroll"||ke.parent.statics.scope!==ke.statics.scope)?xe:we(ke.parent,xe)}X.bubbleFormats=we,X.BlockEmbed=Se,X.default=Te},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.overload=X.expandConfig=void 0;var te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(je){return typeof je}:function(je){return je&&typeof Symbol=="function"&&je.constructor===Symbol&&je!==Symbol.prototype?"symbol":typeof je},ne=function(){function je(He,Ie){var Ue=[],Pe=!0,We=!1,Ye=void 0;try{for(var Ne=He[Symbol.iterator](),Ke;!(Pe=(Ke=Ne.next()).done)&&(Ue.push(Ke.value),!(Ie&&Ue.length===Ie));Pe=!0);}catch(Xe){We=!0,Ye=Xe}finally{try{!Pe&&Ne.return&&Ne.return()}finally{if(We)throw Ye}}return Ue}return function(He,Ie){if(Array.isArray(He))return He;if(Symbol.iterator in Object(He))return je(He,Ie);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),re=function(){function je(He,Ie){for(var Ue=0;Ue<Ie.length;Ue++){var Pe=Ie[Ue];Pe.enumerable=Pe.enumerable||!1,Pe.configurable=!0,"value"in Pe&&(Pe.writable=!0),Object.defineProperty(He,Pe.key,Pe)}}return function(He,Ie,Ue){return Ie&&je(He.prototype,Ie),Ue&&je(He,Ue),He}}();ee(50);var ie=ee(2),fe=we(ie),ce=ee(14),se=we(ce),oe=ee(8),ae=we(oe),le=ee(9),pe=we(le),ve=ee(0),ge=we(ve),de=ee(15),ue=we(de),he=ee(3),me=we(he),_e=ee(10),be=we(_e),Se=ee(34),Te=we(Se);function we(je){return je&&je.__esModule?je:{default:je}}function ke(je,He,Ie){return He in je?Object.defineProperty(je,He,{value:Ie,enumerable:!0,configurable:!0,writable:!0}):je[He]=Ie,je}function xe(je,He){if(!(je instanceof He))throw new TypeError("Cannot call a class as a function")}var Ae=(0,be.default)("quill"),Le=function(){re(je,null,[{key:"debug",value:function(Ie){Ie===!0&&(Ie="log"),be.default.level(Ie)}},{key:"find",value:function(Ie){return Ie.__quill||ge.default.find(Ie)}},{key:"import",value:function(Ie){return this.imports[Ie]==null&&Ae.error("Cannot import "+Ie+". Are you sure it was registered?"),this.imports[Ie]}},{key:"register",value:function(Ie,Ue){var Pe=this,We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof Ie!="string"){var Ye=Ie.attrName||Ie.blotName;typeof Ye=="string"?this.register("formats/"+Ye,Ie,Ue):Object.keys(Ie).forEach(function(Ne){Pe.register(Ne,Ie[Ne],Ue)})}else this.imports[Ie]!=null&&!We&&Ae.warn("Overwriting "+Ie+" with",Ue),this.imports[Ie]=Ue,(Ie.startsWith("blots/")||Ie.startsWith("formats/"))&&Ue.blotName!=="abstract"?ge.default.register(Ue):Ie.startsWith("modules")&&typeof Ue.register=="function"&&Ue.register()}}]);function je(He){var Ie=this,Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(xe(this,je),this.options=De(He,Ue),this.container=this.options.container,this.container==null)return Ae.error("Invalid Quill container",He);this.options.debug&&je.debug(this.options.debug);var Pe=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new ae.default,this.scroll=ge.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new se.default(this.scroll),this.selection=new ue.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(ae.default.events.EDITOR_CHANGE,function(Ye){Ye===ae.default.events.TEXT_CHANGE&&Ie.root.classList.toggle("ql-blank",Ie.editor.isBlank())}),this.emitter.on(ae.default.events.SCROLL_UPDATE,function(Ye,Ne){var Ke=Ie.selection.lastRange,Xe=Ke&&Ke.length===0?Ke.index:void 0;$e.call(Ie,function(){return Ie.editor.update(null,Ne,Xe)},Ye)});var We=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+Pe+"<p><br></p></div>");this.setContents(We),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return re(je,[{key:"addContainer",value:function(Ie){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof Ie=="string"){var Pe=Ie;Ie=document.createElement("div"),Ie.classList.add(Pe)}return this.container.insertBefore(Ie,Ue),Ie}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(Ie,Ue,Pe){var We=this,Ye=Ve(Ie,Ue,Pe),Ne=ne(Ye,4);return Ie=Ne[0],Ue=Ne[1],Pe=Ne[3],$e.call(this,function(){return We.editor.deleteText(Ie,Ue)},Pe,Ie,-1*Ue)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(Ie),this.container.classList.toggle("ql-disabled",!Ie)}},{key:"focus",value:function(){var Ie=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=Ie,this.scrollIntoView()}},{key:"format",value:function(Ie,Ue){var Pe=this,We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ae.default.sources.API;return $e.call(this,function(){var Ye=Pe.getSelection(!0),Ne=new fe.default;if(Ye==null)return Ne;if(ge.default.query(Ie,ge.default.Scope.BLOCK))Ne=Pe.editor.formatLine(Ye.index,Ye.length,ke({},Ie,Ue));else{if(Ye.length===0)return Pe.selection.format(Ie,Ue),Ne;Ne=Pe.editor.formatText(Ye.index,Ye.length,ke({},Ie,Ue))}return Pe.setSelection(Ye,ae.default.sources.SILENT),Ne},We)}},{key:"formatLine",value:function(Ie,Ue,Pe,We,Ye){var Ne=this,Ke=void 0,Xe=Ve(Ie,Ue,Pe,We,Ye),Je=ne(Xe,4);return Ie=Je[0],Ue=Je[1],Ke=Je[2],Ye=Je[3],$e.call(this,function(){return Ne.editor.formatLine(Ie,Ue,Ke)},Ye,Ie,0)}},{key:"formatText",value:function(Ie,Ue,Pe,We,Ye){var Ne=this,Ke=void 0,Xe=Ve(Ie,Ue,Pe,We,Ye),Je=ne(Xe,4);return Ie=Je[0],Ue=Je[1],Ke=Je[2],Ye=Je[3],$e.call(this,function(){return Ne.editor.formatText(Ie,Ue,Ke)},Ye,Ie,0)}},{key:"getBounds",value:function(Ie){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Pe=void 0;typeof Ie=="number"?Pe=this.selection.getBounds(Ie,Ue):Pe=this.selection.getBounds(Ie.index,Ie.length);var We=this.container.getBoundingClientRect();return{bottom:Pe.bottom-We.top,height:Pe.height,left:Pe.left-We.left,right:Pe.right-We.left,top:Pe.top-We.top,width:Pe.width}}},{key:"getContents",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-Ie,Pe=Ve(Ie,Ue),We=ne(Pe,2);return Ie=We[0],Ue=We[1],this.editor.getContents(Ie,Ue)}},{key:"getFormat",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof Ie=="number"?this.editor.getFormat(Ie,Ue):this.editor.getFormat(Ie.index,Ie.length)}},{key:"getIndex",value:function(Ie){return Ie.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(Ie){return this.scroll.leaf(Ie)}},{key:"getLine",value:function(Ie){return this.scroll.line(Ie)}},{key:"getLines",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof Ie!="number"?this.scroll.lines(Ie.index,Ie.length):this.scroll.lines(Ie,Ue)}},{key:"getModule",value:function(Ie){return this.theme.modules[Ie]}},{key:"getSelection",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Ie&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-Ie,Pe=Ve(Ie,Ue),We=ne(Pe,2);return Ie=We[0],Ue=We[1],this.editor.getText(Ie,Ue)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(Ie,Ue,Pe){var We=this,Ye=arguments.length>3&&arguments[3]!==void 0?arguments[3]:je.sources.API;return $e.call(this,function(){return We.editor.insertEmbed(Ie,Ue,Pe)},Ye,Ie)}},{key:"insertText",value:function(Ie,Ue,Pe,We,Ye){var Ne=this,Ke=void 0,Xe=Ve(Ie,0,Pe,We,Ye),Je=ne(Xe,4);return Ie=Je[0],Ke=Je[2],Ye=Je[3],$e.call(this,function(){return Ne.editor.insertText(Ie,Ue,Ke)},Ye,Ie,Ue.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(Ie,Ue,Pe){this.clipboard.dangerouslyPasteHTML(Ie,Ue,Pe)}},{key:"removeFormat",value:function(Ie,Ue,Pe){var We=this,Ye=Ve(Ie,Ue,Pe),Ne=ne(Ye,4);return Ie=Ne[0],Ue=Ne[1],Pe=Ne[3],$e.call(this,function(){return We.editor.removeFormat(Ie,Ue)},Pe,Ie)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(Ie){var Ue=this,Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ae.default.sources.API;return $e.call(this,function(){Ie=new fe.default(Ie);var We=Ue.getLength(),Ye=Ue.editor.deleteText(0,We),Ne=Ue.editor.applyDelta(Ie),Ke=Ne.ops[Ne.ops.length-1];Ke!=null&&typeof Ke.insert=="string"&&Ke.insert[Ke.insert.length-1]===`
`&&(Ue.editor.deleteText(Ue.getLength()-1,1),Ne.delete(1));var Xe=Ye.compose(Ne);return Xe},Pe)}},{key:"setSelection",value:function(Ie,Ue,Pe){if(Ie==null)this.selection.setRange(null,Ue||je.sources.API);else{var We=Ve(Ie,Ue,Pe),Ye=ne(We,4);Ie=Ye[0],Ue=Ye[1],Pe=Ye[3],this.selection.setRange(new de.Range(Ie,Ue),Pe),Pe!==ae.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(Ie){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ae.default.sources.API,Pe=new fe.default().insert(Ie);return this.setContents(Pe,Ue)}},{key:"update",value:function(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ae.default.sources.USER,Ue=this.scroll.update(Ie);return this.selection.update(Ie),Ue}},{key:"updateContents",value:function(Ie){var Ue=this,Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ae.default.sources.API;return $e.call(this,function(){return Ie=new fe.default(Ie),Ue.editor.applyDelta(Ie,Pe)},Pe,!0)}}]),je}();Le.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},Le.events=ae.default.events,Le.sources=ae.default.sources,Le.version="1.3.7",Le.imports={delta:fe.default,parchment:ge.default,"core/module":pe.default,"core/theme":Te.default};function De(je,He){if(He=(0,me.default)(!0,{container:je,modules:{clipboard:!0,keyboard:!0,history:!0}},He),!He.theme||He.theme===Le.DEFAULTS.theme)He.theme=Te.default;else if(He.theme=Le.import("themes/"+He.theme),He.theme==null)throw new Error("Invalid theme "+He.theme+". Did you register it?");var Ie=(0,me.default)(!0,{},He.theme.DEFAULTS);[Ie,He].forEach(function(We){We.modules=We.modules||{},Object.keys(We.modules).forEach(function(Ye){We.modules[Ye]===!0&&(We.modules[Ye]={})})});var Ue=Object.keys(Ie.modules).concat(Object.keys(He.modules)),Pe=Ue.reduce(function(We,Ye){var Ne=Le.import("modules/"+Ye);return Ne==null?Ae.error("Cannot load "+Ye+" module. Are you sure you registered it?"):We[Ye]=Ne.DEFAULTS||{},We},{});return He.modules!=null&&He.modules.toolbar&&He.modules.toolbar.constructor!==Object&&(He.modules.toolbar={container:He.modules.toolbar}),He=(0,me.default)(!0,{},Le.DEFAULTS,{modules:Pe},Ie,He),["bounds","container","scrollingContainer"].forEach(function(We){typeof He[We]=="string"&&(He[We]=document.querySelector(He[We]))}),He.modules=Object.keys(He.modules).reduce(function(We,Ye){return He.modules[Ye]&&(We[Ye]=He.modules[Ye]),We},{}),He}function $e(je,He,Ie,Ue){if(this.options.strict&&!this.isEnabled()&&He===ae.default.sources.USER)return new fe.default;var Pe=Ie==null?null:this.getSelection(),We=this.editor.delta,Ye=je();if(Pe!=null&&(Ie===!0&&(Ie=Pe.index),Ue==null?Pe=Qe(Pe,Ye,He):Ue!==0&&(Pe=Qe(Pe,Ie,Ue,He)),this.setSelection(Pe,ae.default.sources.SILENT)),Ye.length()>0){var Ne,Ke=[ae.default.events.TEXT_CHANGE,Ye,We,He];if((Ne=this.emitter).emit.apply(Ne,[ae.default.events.EDITOR_CHANGE].concat(Ke)),He!==ae.default.sources.SILENT){var Xe;(Xe=this.emitter).emit.apply(Xe,Ke)}}return Ye}function Ve(je,He,Ie,Ue,Pe){var We={};return typeof je.index=="number"&&typeof je.length=="number"?typeof He!="number"?(Pe=Ue,Ue=Ie,Ie=He,He=je.length,je=je.index):(He=je.length,je=je.index):typeof He!="number"&&(Pe=Ue,Ue=Ie,Ie=He,He=0),(typeof Ie>"u"?"undefined":te(Ie))==="object"?(We=Ie,Pe=Ue):typeof Ie=="string"&&(Ue!=null?We[Ie]=Ue:Pe=Ie),Pe=Pe||ae.default.sources.API,[je,He,We,Pe]}function Qe(je,He,Ie,Ue){if(je==null)return null;var Pe=void 0,We=void 0;if(He instanceof fe.default){var Ye=[je.index,je.index+je.length].map(function(Je){return He.transformPosition(Je,Ue!==ae.default.sources.USER)}),Ne=ne(Ye,2);Pe=Ne[0],We=Ne[1]}else{var Ke=[je.index,je.index+je.length].map(function(Je){return Je<He||Je===He&&Ue===ae.default.sources.USER?Je:Ie>=0?Je+Ie:Math.max(He,Je+Ie)}),Xe=ne(Ke,2);Pe=Xe[0],We=Xe[1]}return new de.Range(Pe,We-Pe)}X.expandConfig=De,X.overload=Ve,X.default=Le},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ve(ge,de){for(var ue=0;ue<de.length;ue++){var he=de[ue];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(ge,he.key,he)}}return function(ge,de,ue){return de&&ve(ge.prototype,de),ue&&ve(ge,ue),ge}}(),ne=function ve(ge,de,ue){ge===null&&(ge=Function.prototype);var he=Object.getOwnPropertyDescriptor(ge,de);if(he===void 0){var me=Object.getPrototypeOf(ge);return me===null?void 0:ve(me,de,ue)}else{if("value"in he)return he.value;var _e=he.get;return _e===void 0?void 0:_e.call(ue)}},re=ee(7),ie=se(re),fe=ee(0),ce=se(fe);function se(ve){return ve&&ve.__esModule?ve:{default:ve}}function oe(ve,ge){if(!(ve instanceof ge))throw new TypeError("Cannot call a class as a function")}function ae(ve,ge){if(!ve)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ge&&(typeof ge=="object"||typeof ge=="function")?ge:ve}function le(ve,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ge);ve.prototype=Object.create(ge&&ge.prototype,{constructor:{value:ve,enumerable:!1,writable:!0,configurable:!0}}),ge&&(Object.setPrototypeOf?Object.setPrototypeOf(ve,ge):ve.__proto__=ge)}var pe=function(ve){le(ge,ve);function ge(){return oe(this,ge),ae(this,(ge.__proto__||Object.getPrototypeOf(ge)).apply(this,arguments))}return te(ge,[{key:"formatAt",value:function(ue,he,me,_e){if(ge.compare(this.statics.blotName,me)<0&&ce.default.query(me,ce.default.Scope.BLOT)){var be=this.isolate(ue,he);_e&&be.wrap(me,_e)}else ne(ge.prototype.__proto__||Object.getPrototypeOf(ge.prototype),"formatAt",this).call(this,ue,he,me,_e)}},{key:"optimize",value:function(ue){if(ne(ge.prototype.__proto__||Object.getPrototypeOf(ge.prototype),"optimize",this).call(this,ue),this.parent instanceof ge&&ge.compare(this.statics.blotName,this.parent.statics.blotName)>0){var he=this.parent.isolate(this.offset(),this.length());this.moveChildren(he),he.wrap(this)}}}],[{key:"compare",value:function(ue,he){var me=ge.order.indexOf(ue),_e=ge.order.indexOf(he);return me>=0||_e>=0?me-_e:ue===he?0:ue<he?-1:1}}]),ge}(ce.default.Inline);pe.allowedChildren=[pe,ce.default.Embed,ie.default],pe.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],X.default=pe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(0),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}function ie(oe,ae){if(!(oe instanceof ae))throw new TypeError("Cannot call a class as a function")}function fe(oe,ae){if(!oe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae&&(typeof ae=="object"||typeof ae=="function")?ae:oe}function ce(oe,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ae);oe.prototype=Object.create(ae&&ae.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),ae&&(Object.setPrototypeOf?Object.setPrototypeOf(oe,ae):oe.__proto__=ae)}var se=function(oe){ce(ae,oe);function ae(){return ie(this,ae),fe(this,(ae.__proto__||Object.getPrototypeOf(ae)).apply(this,arguments))}return ae}(ne.default.Text);X.default=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function de(ue,he){for(var me=0;me<he.length;me++){var _e=he[me];_e.enumerable=_e.enumerable||!1,_e.configurable=!0,"value"in _e&&(_e.writable=!0),Object.defineProperty(ue,_e.key,_e)}}return function(ue,he,me){return he&&de(ue.prototype,he),me&&de(ue,me),ue}}(),ne=function de(ue,he,me){ue===null&&(ue=Function.prototype);var _e=Object.getOwnPropertyDescriptor(ue,he);if(_e===void 0){var be=Object.getPrototypeOf(ue);return be===null?void 0:de(be,he,me)}else{if("value"in _e)return _e.value;var Se=_e.get;return Se===void 0?void 0:Se.call(me)}},re=ee(54),ie=se(re),fe=ee(10),ce=se(fe);function se(de){return de&&de.__esModule?de:{default:de}}function oe(de,ue){if(!(de instanceof ue))throw new TypeError("Cannot call a class as a function")}function ae(de,ue){if(!de)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ue&&(typeof ue=="object"||typeof ue=="function")?ue:de}function le(de,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ue);de.prototype=Object.create(ue&&ue.prototype,{constructor:{value:de,enumerable:!1,writable:!0,configurable:!0}}),ue&&(Object.setPrototypeOf?Object.setPrototypeOf(de,ue):de.__proto__=ue)}var pe=(0,ce.default)("quill:events"),ve=["selectionchange","mousedown","mouseup","click"];ve.forEach(function(de){document.addEventListener(de,function(){for(var ue=arguments.length,he=Array(ue),me=0;me<ue;me++)he[me]=arguments[me];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(_e){if(_e.__quill&&_e.__quill.emitter){var be;(be=_e.__quill.emitter).handleDOM.apply(be,he)}})})});var ge=function(de){le(ue,de);function ue(){oe(this,ue);var he=ae(this,(ue.__proto__||Object.getPrototypeOf(ue)).call(this));return he.listeners={},he.on("error",pe.error),he}return te(ue,[{key:"emit",value:function(){pe.log.apply(pe,arguments),ne(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(me){for(var _e=arguments.length,be=Array(_e>1?_e-1:0),Se=1;Se<_e;Se++)be[Se-1]=arguments[Se];(this.listeners[me.type]||[]).forEach(function(Te){var we=Te.node,ke=Te.handler;(me.target===we||we.contains(me.target))&&ke.apply(void 0,[me].concat(be))})}},{key:"listenDOM",value:function(me,_e,be){this.listeners[me]||(this.listeners[me]=[]),this.listeners[me].push({node:_e,handler:be})}}]),ue}(ie.default);ge.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},ge.sources={API:"api",SILENT:"silent",USER:"user"},X.default=ge},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});function te(re,ie){if(!(re instanceof ie))throw new TypeError("Cannot call a class as a function")}var ne=function re(ie){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};te(this,re),this.quill=ie,this.options=fe};ne.DEFAULTS={},X.default=ne},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=["error","warn","log","info"],ne="warn";function re(fe){if(te.indexOf(fe)<=te.indexOf(ne)){for(var ce,se=arguments.length,oe=Array(se>1?se-1:0),ae=1;ae<se;ae++)oe[ae-1]=arguments[ae];(ce=console)[fe].apply(ce,oe)}}function ie(fe){return te.reduce(function(ce,se){return ce[se]=re.bind(console,se,fe),ce},{})}re.level=ie.level=function(fe){ne=fe},X.default=ie},function(j,X,ee){var te=Array.prototype.slice,ne=ee(52),re=ee(53),ie=j.exports=function(oe,ae,le){return le||(le={}),oe===ae?!0:oe instanceof Date&&ae instanceof Date?oe.getTime()===ae.getTime():!oe||!ae||typeof oe!="object"&&typeof ae!="object"?le.strict?oe===ae:oe==ae:se(oe,ae,le)};function fe(oe){return oe==null}function ce(oe){return!(!oe||typeof oe!="object"||typeof oe.length!="number"||typeof oe.copy!="function"||typeof oe.slice!="function"||oe.length>0&&typeof oe[0]!="number")}function se(oe,ae,le){var pe,ve;if(fe(oe)||fe(ae)||oe.prototype!==ae.prototype)return!1;if(re(oe))return re(ae)?(oe=te.call(oe),ae=te.call(ae),ie(oe,ae,le)):!1;if(ce(oe)){if(!ce(ae)||oe.length!==ae.length)return!1;for(pe=0;pe<oe.length;pe++)if(oe[pe]!==ae[pe])return!1;return!0}try{var ge=ne(oe),de=ne(ae)}catch{return!1}if(ge.length!=de.length)return!1;for(ge.sort(),de.sort(),pe=ge.length-1;pe>=0;pe--)if(ge[pe]!=de[pe])return!1;for(pe=ge.length-1;pe>=0;pe--)if(ve=ge[pe],!ie(oe[ve],ae[ve],le))return!1;return typeof oe==typeof ae}},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(1),ne=function(){function re(ie,fe,ce){ce===void 0&&(ce={}),this.attrName=ie,this.keyName=fe;var se=te.Scope.TYPE&te.Scope.ATTRIBUTE;ce.scope!=null?this.scope=ce.scope&te.Scope.LEVEL|se:this.scope=te.Scope.ATTRIBUTE,ce.whitelist!=null&&(this.whitelist=ce.whitelist)}return re.keys=function(ie){return[].map.call(ie.attributes,function(fe){return fe.name})},re.prototype.add=function(ie,fe){return this.canAdd(ie,fe)?(ie.setAttribute(this.keyName,fe),!0):!1},re.prototype.canAdd=function(ie,fe){var ce=te.query(ie,te.Scope.BLOT&(this.scope|te.Scope.TYPE));return ce==null?!1:this.whitelist==null?!0:typeof fe=="string"?this.whitelist.indexOf(fe.replace(/["']/g,""))>-1:this.whitelist.indexOf(fe)>-1},re.prototype.remove=function(ie){ie.removeAttribute(this.keyName)},re.prototype.value=function(ie){var fe=ie.getAttribute(this.keyName);return this.canAdd(ie,fe)&&fe?fe:""},re}();X.default=ne},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.Code=void 0;var te=function(){function Se(Te,we){var ke=[],xe=!0,Ae=!1,Le=void 0;try{for(var De=Te[Symbol.iterator](),$e;!(xe=($e=De.next()).done)&&(ke.push($e.value),!(we&&ke.length===we));xe=!0);}catch(Ve){Ae=!0,Le=Ve}finally{try{!xe&&De.return&&De.return()}finally{if(Ae)throw Le}}return ke}return function(Te,we){if(Array.isArray(Te))return Te;if(Symbol.iterator in Object(Te))return Se(Te,we);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ne=function(){function Se(Te,we){for(var ke=0;ke<we.length;ke++){var xe=we[ke];xe.enumerable=xe.enumerable||!1,xe.configurable=!0,"value"in xe&&(xe.writable=!0),Object.defineProperty(Te,xe.key,xe)}}return function(Te,we,ke){return we&&Se(Te.prototype,we),ke&&Se(Te,ke),Te}}(),re=function Se(Te,we,ke){Te===null&&(Te=Function.prototype);var xe=Object.getOwnPropertyDescriptor(Te,we);if(xe===void 0){var Ae=Object.getPrototypeOf(Te);return Ae===null?void 0:Se(Ae,we,ke)}else{if("value"in xe)return xe.value;var Le=xe.get;return Le===void 0?void 0:Le.call(ke)}},ie=ee(2),fe=de(ie),ce=ee(0),se=de(ce),oe=ee(4),ae=de(oe),le=ee(6),pe=de(le),ve=ee(7),ge=de(ve);function de(Se){return Se&&Se.__esModule?Se:{default:Se}}function ue(Se,Te){if(!(Se instanceof Te))throw new TypeError("Cannot call a class as a function")}function he(Se,Te){if(!Se)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Te&&(typeof Te=="object"||typeof Te=="function")?Te:Se}function me(Se,Te){if(typeof Te!="function"&&Te!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Te);Se.prototype=Object.create(Te&&Te.prototype,{constructor:{value:Se,enumerable:!1,writable:!0,configurable:!0}}),Te&&(Object.setPrototypeOf?Object.setPrototypeOf(Se,Te):Se.__proto__=Te)}var _e=function(Se){me(Te,Se);function Te(){return ue(this,Te),he(this,(Te.__proto__||Object.getPrototypeOf(Te)).apply(this,arguments))}return Te}(pe.default);_e.blotName="code",_e.tagName="CODE";var be=function(Se){me(Te,Se);function Te(){return ue(this,Te),he(this,(Te.__proto__||Object.getPrototypeOf(Te)).apply(this,arguments))}return ne(Te,[{key:"delta",value:function(){var ke=this,xe=this.domNode.textContent;return xe.endsWith(`
`)&&(xe=xe.slice(0,-1)),xe.split(`
`).reduce(function(Ae,Le){return Ae.insert(Le).insert(`
`,ke.formats())},new fe.default)}},{key:"format",value:function(ke,xe){if(!(ke===this.statics.blotName&&xe)){var Ae=this.descendant(ge.default,this.length()-1),Le=te(Ae,1),De=Le[0];De!=null&&De.deleteAt(De.length()-1,1),re(Te.prototype.__proto__||Object.getPrototypeOf(Te.prototype),"format",this).call(this,ke,xe)}}},{key:"formatAt",value:function(ke,xe,Ae,Le){if(xe!==0&&!(se.default.query(Ae,se.default.Scope.BLOCK)==null||Ae===this.statics.blotName&&Le===this.statics.formats(this.domNode))){var De=this.newlineIndex(ke);if(!(De<0||De>=ke+xe)){var $e=this.newlineIndex(ke,!0)+1,Ve=De-$e+1,Qe=this.isolate($e,Ve),je=Qe.next;Qe.format(Ae,Le),je instanceof Te&&je.formatAt(0,ke-$e+xe-Ve,Ae,Le)}}}},{key:"insertAt",value:function(ke,xe,Ae){if(Ae==null){var Le=this.descendant(ge.default,ke),De=te(Le,2),$e=De[0],Ve=De[1];$e.insertAt(Ve,xe)}}},{key:"length",value:function(){var ke=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?ke:ke+1}},{key:"newlineIndex",value:function(ke){var xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(xe)return this.domNode.textContent.slice(0,ke).lastIndexOf(`
`);var Ae=this.domNode.textContent.slice(ke).indexOf(`
`);return Ae>-1?ke+Ae:-1}},{key:"optimize",value:function(ke){this.domNode.textContent.endsWith(`
`)||this.appendChild(se.default.create("text",`
`)),re(Te.prototype.__proto__||Object.getPrototypeOf(Te.prototype),"optimize",this).call(this,ke);var xe=this.next;xe!=null&&xe.prev===this&&xe.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===xe.statics.formats(xe.domNode)&&(xe.optimize(ke),xe.moveChildren(this),xe.remove())}},{key:"replace",value:function(ke){re(Te.prototype.__proto__||Object.getPrototypeOf(Te.prototype),"replace",this).call(this,ke),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(xe){var Ae=se.default.find(xe);Ae==null?xe.parentNode.removeChild(xe):Ae instanceof se.default.Embed?Ae.remove():Ae.unwrap()})}}],[{key:"create",value:function(ke){var xe=re(Te.__proto__||Object.getPrototypeOf(Te),"create",this).call(this,ke);return xe.setAttribute("spellcheck",!1),xe}},{key:"formats",value:function(){return!0}}]),Te}(ae.default);be.blotName="code-block",be.tagName="PRE",be.TAB="  ",X.Code=_e,X.default=be},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(je){return typeof je}:function(je){return je&&typeof Symbol=="function"&&je.constructor===Symbol&&je!==Symbol.prototype?"symbol":typeof je},ne=function(){function je(He,Ie){var Ue=[],Pe=!0,We=!1,Ye=void 0;try{for(var Ne=He[Symbol.iterator](),Ke;!(Pe=(Ke=Ne.next()).done)&&(Ue.push(Ke.value),!(Ie&&Ue.length===Ie));Pe=!0);}catch(Xe){We=!0,Ye=Xe}finally{try{!Pe&&Ne.return&&Ne.return()}finally{if(We)throw Ye}}return Ue}return function(He,Ie){if(Array.isArray(He))return He;if(Symbol.iterator in Object(He))return je(He,Ie);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),re=function(){function je(He,Ie){for(var Ue=0;Ue<Ie.length;Ue++){var Pe=Ie[Ue];Pe.enumerable=Pe.enumerable||!1,Pe.configurable=!0,"value"in Pe&&(Pe.writable=!0),Object.defineProperty(He,Pe.key,Pe)}}return function(He,Ie,Ue){return Ie&&je(He.prototype,Ie),Ue&&je(He,Ue),He}}(),ie=ee(2),fe=xe(ie),ce=ee(20),se=xe(ce),oe=ee(0),ae=xe(oe),le=ee(13),pe=xe(le),ve=ee(24),ge=xe(ve),de=ee(4),ue=xe(de),he=ee(16),me=xe(he),_e=ee(21),be=xe(_e),Se=ee(11),Te=xe(Se),we=ee(3),ke=xe(we);function xe(je){return je&&je.__esModule?je:{default:je}}function Ae(je,He,Ie){return He in je?Object.defineProperty(je,He,{value:Ie,enumerable:!0,configurable:!0,writable:!0}):je[He]=Ie,je}function Le(je,He){if(!(je instanceof He))throw new TypeError("Cannot call a class as a function")}var De=/^[ -~]*$/,$e=function(){function je(He){Le(this,je),this.scroll=He,this.delta=this.getDelta()}return re(je,[{key:"applyDelta",value:function(Ie){var Ue=this,Pe=!1;this.scroll.update();var We=this.scroll.length();return this.scroll.batchStart(),Ie=Qe(Ie),Ie.reduce(function(Ye,Ne){var Ke=Ne.retain||Ne.delete||Ne.insert.length||1,Xe=Ne.attributes||{};if(Ne.insert!=null){if(typeof Ne.insert=="string"){var Je=Ne.insert;Je.endsWith(`
`)&&Pe&&(Pe=!1,Je=Je.slice(0,-1)),Ye>=We&&!Je.endsWith(`
`)&&(Pe=!0),Ue.scroll.insertAt(Ye,Je);var nt=Ue.scroll.line(Ye),ot=ne(nt,2),ht=ot[0],ct=ot[1],ut=(0,ke.default)({},(0,de.bubbleFormats)(ht));if(ht instanceof ue.default){var Re=ht.descendant(ae.default.Leaf,ct),Me=ne(Re,1),qe=Me[0];ut=(0,ke.default)(ut,(0,de.bubbleFormats)(qe))}Xe=se.default.attributes.diff(ut,Xe)||{}}else if(te(Ne.insert)==="object"){var Be=Object.keys(Ne.insert)[0];if(Be==null)return Ye;Ue.scroll.insertAt(Ye,Be,Ne.insert[Be])}We+=Ke}return Object.keys(Xe).forEach(function(Oe){Ue.scroll.formatAt(Ye,Ke,Oe,Xe[Oe])}),Ye+Ke},0),Ie.reduce(function(Ye,Ne){return typeof Ne.delete=="number"?(Ue.scroll.deleteAt(Ye,Ne.delete),Ye):Ye+(Ne.retain||Ne.insert.length||1)},0),this.scroll.batchEnd(),this.update(Ie)}},{key:"deleteText",value:function(Ie,Ue){return this.scroll.deleteAt(Ie,Ue),this.update(new fe.default().retain(Ie).delete(Ue))}},{key:"formatLine",value:function(Ie,Ue){var Pe=this,We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(We).forEach(function(Ye){if(!(Pe.scroll.whitelist!=null&&!Pe.scroll.whitelist[Ye])){var Ne=Pe.scroll.lines(Ie,Math.max(Ue,1)),Ke=Ue;Ne.forEach(function(Xe){var Je=Xe.length();if(!(Xe instanceof pe.default))Xe.format(Ye,We[Ye]);else{var nt=Ie-Xe.offset(Pe.scroll),ot=Xe.newlineIndex(nt+Ke)-nt+1;Xe.formatAt(nt,ot,Ye,We[Ye])}Ke-=Je})}}),this.scroll.optimize(),this.update(new fe.default().retain(Ie).retain(Ue,(0,be.default)(We)))}},{key:"formatText",value:function(Ie,Ue){var Pe=this,We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(We).forEach(function(Ye){Pe.scroll.formatAt(Ie,Ue,Ye,We[Ye])}),this.update(new fe.default().retain(Ie).retain(Ue,(0,be.default)(We)))}},{key:"getContents",value:function(Ie,Ue){return this.delta.slice(Ie,Ie+Ue)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(Ie,Ue){return Ie.concat(Ue.delta())},new fe.default)}},{key:"getFormat",value:function(Ie){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Pe=[],We=[];Ue===0?this.scroll.path(Ie).forEach(function(Ne){var Ke=ne(Ne,1),Xe=Ke[0];Xe instanceof ue.default?Pe.push(Xe):Xe instanceof ae.default.Leaf&&We.push(Xe)}):(Pe=this.scroll.lines(Ie,Ue),We=this.scroll.descendants(ae.default.Leaf,Ie,Ue));var Ye=[Pe,We].map(function(Ne){if(Ne.length===0)return{};for(var Ke=(0,de.bubbleFormats)(Ne.shift());Object.keys(Ke).length>0;){var Xe=Ne.shift();if(Xe==null)return Ke;Ke=Ve((0,de.bubbleFormats)(Xe),Ke)}return Ke});return ke.default.apply(ke.default,Ye)}},{key:"getText",value:function(Ie,Ue){return this.getContents(Ie,Ue).filter(function(Pe){return typeof Pe.insert=="string"}).map(function(Pe){return Pe.insert}).join("")}},{key:"insertEmbed",value:function(Ie,Ue,Pe){return this.scroll.insertAt(Ie,Ue,Pe),this.update(new fe.default().retain(Ie).insert(Ae({},Ue,Pe)))}},{key:"insertText",value:function(Ie,Ue){var Pe=this,We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Ue=Ue.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(Ie,Ue),Object.keys(We).forEach(function(Ye){Pe.scroll.formatAt(Ie,Ue.length,Ye,We[Ye])}),this.update(new fe.default().retain(Ie).insert(Ue,(0,be.default)(We)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var Ie=this.scroll.children.head;return Ie.statics.blotName!==ue.default.blotName||Ie.children.length>1?!1:Ie.children.head instanceof me.default}},{key:"removeFormat",value:function(Ie,Ue){var Pe=this.getText(Ie,Ue),We=this.scroll.line(Ie+Ue),Ye=ne(We,2),Ne=Ye[0],Ke=Ye[1],Xe=0,Je=new fe.default;Ne!=null&&(Ne instanceof pe.default?Xe=Ne.newlineIndex(Ke)-Ke+1:Xe=Ne.length()-Ke,Je=Ne.delta().slice(Ke,Ke+Xe-1).insert(`
`));var nt=this.getContents(Ie,Ue+Xe),ot=nt.diff(new fe.default().insert(Pe).concat(Je)),ht=new fe.default().retain(Ie).concat(ot);return this.applyDelta(ht)}},{key:"update",value:function(Ie){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,We=this.delta;if(Ue.length===1&&Ue[0].type==="characterData"&&Ue[0].target.data.match(De)&&ae.default.find(Ue[0].target)){var Ye=ae.default.find(Ue[0].target),Ne=(0,de.bubbleFormats)(Ye),Ke=Ye.offset(this.scroll),Xe=Ue[0].oldValue.replace(ge.default.CONTENTS,""),Je=new fe.default().insert(Xe),nt=new fe.default().insert(Ye.value()),ot=new fe.default().retain(Ke).concat(Je.diff(nt,Pe));Ie=ot.reduce(function(ht,ct){return ct.insert?ht.insert(ct.insert,Ne):ht.push(ct)},new fe.default),this.delta=We.compose(Ie)}else this.delta=this.getDelta(),(!Ie||!(0,Te.default)(We.compose(Ie),this.delta))&&(Ie=We.diff(this.delta,Pe));return Ie}}]),je}();function Ve(je,He){return Object.keys(He).reduce(function(Ie,Ue){return je[Ue]==null||(He[Ue]===je[Ue]?Ie[Ue]=He[Ue]:Array.isArray(He[Ue])?He[Ue].indexOf(je[Ue])<0&&(Ie[Ue]=He[Ue].concat([je[Ue]])):Ie[Ue]=[He[Ue],je[Ue]]),Ie},{})}function Qe(je){return je.reduce(function(He,Ie){if(Ie.insert===1){var Ue=(0,be.default)(Ie.attributes);return delete Ue.image,He.insert({image:Ie.attributes.image},Ue)}if(Ie.attributes!=null&&(Ie.attributes.list===!0||Ie.attributes.bullet===!0)&&(Ie=(0,be.default)(Ie),Ie.attributes.list?Ie.attributes.list="ordered":(Ie.attributes.list="bullet",delete Ie.attributes.bullet)),typeof Ie.insert=="string"){var Pe=Ie.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return He.insert(Pe,Ie.attributes)}return He.push(Ie)},new fe.default)}X.default=$e},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.Range=void 0;var te=function(){function Se(Te,we){var ke=[],xe=!0,Ae=!1,Le=void 0;try{for(var De=Te[Symbol.iterator](),$e;!(xe=($e=De.next()).done)&&(ke.push($e.value),!(we&&ke.length===we));xe=!0);}catch(Ve){Ae=!0,Le=Ve}finally{try{!xe&&De.return&&De.return()}finally{if(Ae)throw Le}}return ke}return function(Te,we){if(Array.isArray(Te))return Te;if(Symbol.iterator in Object(Te))return Se(Te,we);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ne=function(){function Se(Te,we){for(var ke=0;ke<we.length;ke++){var xe=we[ke];xe.enumerable=xe.enumerable||!1,xe.configurable=!0,"value"in xe&&(xe.writable=!0),Object.defineProperty(Te,xe.key,xe)}}return function(Te,we,ke){return we&&Se(Te.prototype,we),ke&&Se(Te,ke),Te}}(),re=ee(0),ie=ge(re),fe=ee(21),ce=ge(fe),se=ee(11),oe=ge(se),ae=ee(8),le=ge(ae),pe=ee(10),ve=ge(pe);function ge(Se){return Se&&Se.__esModule?Se:{default:Se}}function de(Se){if(Array.isArray(Se)){for(var Te=0,we=Array(Se.length);Te<Se.length;Te++)we[Te]=Se[Te];return we}else return Array.from(Se)}function ue(Se,Te){if(!(Se instanceof Te))throw new TypeError("Cannot call a class as a function")}var he=(0,ve.default)("quill:selection"),me=function Se(Te){var we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;ue(this,Se),this.index=Te,this.length=we},_e=function(){function Se(Te,we){var ke=this;ue(this,Se),this.emitter=we,this.scroll=Te,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=ie.default.create("cursor",this),this.lastRange=this.savedRange=new me(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){ke.mouseDown||setTimeout(ke.update.bind(ke,le.default.sources.USER),1)}),this.emitter.on(le.default.events.EDITOR_CHANGE,function(xe,Ae){xe===le.default.events.TEXT_CHANGE&&Ae.length()>0&&ke.update(le.default.sources.SILENT)}),this.emitter.on(le.default.events.SCROLL_BEFORE_UPDATE,function(){if(!!ke.hasFocus()){var xe=ke.getNativeRange();xe!=null&&xe.start.node!==ke.cursor.textNode&&ke.emitter.once(le.default.events.SCROLL_UPDATE,function(){try{ke.setNativeRange(xe.start.node,xe.start.offset,xe.end.node,xe.end.offset)}catch{}})}}),this.emitter.on(le.default.events.SCROLL_OPTIMIZE,function(xe,Ae){if(Ae.range){var Le=Ae.range,De=Le.startNode,$e=Le.startOffset,Ve=Le.endNode,Qe=Le.endOffset;ke.setNativeRange(De,$e,Ve,Qe)}}),this.update(le.default.sources.SILENT)}return ne(Se,[{key:"handleComposition",value:function(){var we=this;this.root.addEventListener("compositionstart",function(){we.composing=!0}),this.root.addEventListener("compositionend",function(){if(we.composing=!1,we.cursor.parent){var ke=we.cursor.restore();if(!ke)return;setTimeout(function(){we.setNativeRange(ke.startNode,ke.startOffset,ke.endNode,ke.endOffset)},1)}})}},{key:"handleDragging",value:function(){var we=this;this.emitter.listenDOM("mousedown",document.body,function(){we.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){we.mouseDown=!1,we.update(le.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(we,ke){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[we])){this.scroll.update();var xe=this.getNativeRange();if(!(xe==null||!xe.native.collapsed||ie.default.query(we,ie.default.Scope.BLOCK))){if(xe.start.node!==this.cursor.textNode){var Ae=ie.default.find(xe.start.node,!1);if(Ae==null)return;if(Ae instanceof ie.default.Leaf){var Le=Ae.split(xe.start.offset);Ae.parent.insertBefore(this.cursor,Le)}else Ae.insertBefore(this.cursor,xe.start.node);this.cursor.attach()}this.cursor.format(we,ke),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(we){var ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,xe=this.scroll.length();we=Math.min(we,xe-1),ke=Math.min(we+ke,xe-1)-we;var Ae=void 0,Le=this.scroll.leaf(we),De=te(Le,2),$e=De[0],Ve=De[1];if($e==null)return null;var Qe=$e.position(Ve,!0),je=te(Qe,2);Ae=je[0],Ve=je[1];var He=document.createRange();if(ke>0){He.setStart(Ae,Ve);var Ie=this.scroll.leaf(we+ke),Ue=te(Ie,2);if($e=Ue[0],Ve=Ue[1],$e==null)return null;var Pe=$e.position(Ve,!0),We=te(Pe,2);return Ae=We[0],Ve=We[1],He.setEnd(Ae,Ve),He.getBoundingClientRect()}else{var Ye="left",Ne=void 0;return Ae instanceof Text?(Ve<Ae.data.length?(He.setStart(Ae,Ve),He.setEnd(Ae,Ve+1)):(He.setStart(Ae,Ve-1),He.setEnd(Ae,Ve),Ye="right"),Ne=He.getBoundingClientRect()):(Ne=$e.domNode.getBoundingClientRect(),Ve>0&&(Ye="right")),{bottom:Ne.top+Ne.height,height:Ne.height,left:Ne[Ye],right:Ne[Ye],top:Ne.top,width:0}}}},{key:"getNativeRange",value:function(){var we=document.getSelection();if(we==null||we.rangeCount<=0)return null;var ke=we.getRangeAt(0);if(ke==null)return null;var xe=this.normalizeNative(ke);return he.info("getNativeRange",xe),xe}},{key:"getRange",value:function(){var we=this.getNativeRange();if(we==null)return[null,null];var ke=this.normalizedToRange(we);return[ke,we]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(we){var ke=this,xe=[[we.start.node,we.start.offset]];we.native.collapsed||xe.push([we.end.node,we.end.offset]);var Ae=xe.map(function($e){var Ve=te($e,2),Qe=Ve[0],je=Ve[1],He=ie.default.find(Qe,!0),Ie=He.offset(ke.scroll);return je===0?Ie:He instanceof ie.default.Container?Ie+He.length():Ie+He.index(Qe,je)}),Le=Math.min(Math.max.apply(Math,de(Ae)),this.scroll.length()-1),De=Math.min.apply(Math,[Le].concat(de(Ae)));return new me(De,Le-De)}},{key:"normalizeNative",value:function(we){if(!be(this.root,we.startContainer)||!we.collapsed&&!be(this.root,we.endContainer))return null;var ke={start:{node:we.startContainer,offset:we.startOffset},end:{node:we.endContainer,offset:we.endOffset},native:we};return[ke.start,ke.end].forEach(function(xe){for(var Ae=xe.node,Le=xe.offset;!(Ae instanceof Text)&&Ae.childNodes.length>0;)if(Ae.childNodes.length>Le)Ae=Ae.childNodes[Le],Le=0;else if(Ae.childNodes.length===Le)Ae=Ae.lastChild,Le=Ae instanceof Text?Ae.data.length:Ae.childNodes.length+1;else break;xe.node=Ae,xe.offset=Le}),ke}},{key:"rangeToNative",value:function(we){var ke=this,xe=we.collapsed?[we.index]:[we.index,we.index+we.length],Ae=[],Le=this.scroll.length();return xe.forEach(function(De,$e){De=Math.min(Le-1,De);var Ve=void 0,Qe=ke.scroll.leaf(De),je=te(Qe,2),He=je[0],Ie=je[1],Ue=He.position(Ie,$e!==0),Pe=te(Ue,2);Ve=Pe[0],Ie=Pe[1],Ae.push(Ve,Ie)}),Ae.length<2&&(Ae=Ae.concat(Ae)),Ae}},{key:"scrollIntoView",value:function(we){var ke=this.lastRange;if(ke!=null){var xe=this.getBounds(ke.index,ke.length);if(xe!=null){var Ae=this.scroll.length()-1,Le=this.scroll.line(Math.min(ke.index,Ae)),De=te(Le,1),$e=De[0],Ve=$e;if(ke.length>0){var Qe=this.scroll.line(Math.min(ke.index+ke.length,Ae)),je=te(Qe,1);Ve=je[0]}if(!($e==null||Ve==null)){var He=we.getBoundingClientRect();xe.top<He.top?we.scrollTop-=He.top-xe.top:xe.bottom>He.bottom&&(we.scrollTop+=xe.bottom-He.bottom)}}}}},{key:"setNativeRange",value:function(we,ke){var xe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:we,Ae=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ke,Le=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(he.info("setNativeRange",we,ke,xe,Ae),!(we!=null&&(this.root.parentNode==null||we.parentNode==null||xe.parentNode==null))){var De=document.getSelection();if(De!=null)if(we!=null){this.hasFocus()||this.root.focus();var $e=(this.getNativeRange()||{}).native;if($e==null||Le||we!==$e.startContainer||ke!==$e.startOffset||xe!==$e.endContainer||Ae!==$e.endOffset){we.tagName=="BR"&&(ke=[].indexOf.call(we.parentNode.childNodes,we),we=we.parentNode),xe.tagName=="BR"&&(Ae=[].indexOf.call(xe.parentNode.childNodes,xe),xe=xe.parentNode);var Ve=document.createRange();Ve.setStart(we,ke),Ve.setEnd(xe,Ae),De.removeAllRanges(),De.addRange(Ve)}}else De.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(we){var ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,xe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:le.default.sources.API;if(typeof ke=="string"&&(xe=ke,ke=!1),he.info("setRange",we),we!=null){var Ae=this.rangeToNative(we);this.setNativeRange.apply(this,de(Ae).concat([ke]))}else this.setNativeRange(null);this.update(xe)}},{key:"update",value:function(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:le.default.sources.USER,ke=this.lastRange,xe=this.getRange(),Ae=te(xe,2),Le=Ae[0],De=Ae[1];if(this.lastRange=Le,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,oe.default)(ke,this.lastRange)){var $e;!this.composing&&De!=null&&De.native.collapsed&&De.start.node!==this.cursor.textNode&&this.cursor.restore();var Ve=[le.default.events.SELECTION_CHANGE,(0,ce.default)(this.lastRange),(0,ce.default)(ke),we];if(($e=this.emitter).emit.apply($e,[le.default.events.EDITOR_CHANGE].concat(Ve)),we!==le.default.sources.SILENT){var Qe;(Qe=this.emitter).emit.apply(Qe,Ve)}}}}]),Se}();function be(Se,Te){try{Te.parentNode}catch{return!1}return Te instanceof Text&&(Te=Te.parentNode),Se.contains(Te)}X.Range=me,X.default=_e},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function le(pe,ve){for(var ge=0;ge<ve.length;ge++){var de=ve[ge];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(pe,de.key,de)}}return function(pe,ve,ge){return ve&&le(pe.prototype,ve),ge&&le(pe,ge),pe}}(),ne=function le(pe,ve,ge){pe===null&&(pe=Function.prototype);var de=Object.getOwnPropertyDescriptor(pe,ve);if(de===void 0){var ue=Object.getPrototypeOf(pe);return ue===null?void 0:le(ue,ve,ge)}else{if("value"in de)return de.value;var he=de.get;return he===void 0?void 0:he.call(ge)}},re=ee(0),ie=fe(re);function fe(le){return le&&le.__esModule?le:{default:le}}function ce(le,pe){if(!(le instanceof pe))throw new TypeError("Cannot call a class as a function")}function se(le,pe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pe&&(typeof pe=="object"||typeof pe=="function")?pe:le}function oe(le,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pe);le.prototype=Object.create(pe&&pe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),pe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,pe):le.__proto__=pe)}var ae=function(le){oe(pe,le);function pe(){return ce(this,pe),se(this,(pe.__proto__||Object.getPrototypeOf(pe)).apply(this,arguments))}return te(pe,[{key:"insertInto",value:function(ge,de){ge.children.length===0?ne(pe.prototype.__proto__||Object.getPrototypeOf(pe.prototype),"insertInto",this).call(this,ge,de):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),pe}(ie.default.Embed);ae.blotName="break",ae.tagName="BR",X.default=ae},function(j,X,ee){var te=this&&this.__extends||function(){var se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(oe,ae){oe.__proto__=ae}||function(oe,ae){for(var le in ae)ae.hasOwnProperty(le)&&(oe[le]=ae[le])};return function(oe,ae){se(oe,ae);function le(){this.constructor=oe}oe.prototype=ae===null?Object.create(ae):(le.prototype=ae.prototype,new le)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(44),re=ee(30),ie=ee(1),fe=function(se){te(oe,se);function oe(ae){var le=se.call(this,ae)||this;return le.build(),le}return oe.prototype.appendChild=function(ae){this.insertBefore(ae)},oe.prototype.attach=function(){se.prototype.attach.call(this),this.children.forEach(function(ae){ae.attach()})},oe.prototype.build=function(){var ae=this;this.children=new ne.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(le){try{var pe=ce(le);ae.insertBefore(pe,ae.children.head||void 0)}catch(ve){if(ve instanceof ie.ParchmentError)return;throw ve}})},oe.prototype.deleteAt=function(ae,le){if(ae===0&&le===this.length())return this.remove();this.children.forEachAt(ae,le,function(pe,ve,ge){pe.deleteAt(ve,ge)})},oe.prototype.descendant=function(ae,le){var pe=this.children.find(le),ve=pe[0],ge=pe[1];return ae.blotName==null&&ae(ve)||ae.blotName!=null&&ve instanceof ae?[ve,ge]:ve instanceof oe?ve.descendant(ae,ge):[null,-1]},oe.prototype.descendants=function(ae,le,pe){le===void 0&&(le=0),pe===void 0&&(pe=Number.MAX_VALUE);var ve=[],ge=pe;return this.children.forEachAt(le,pe,function(de,ue,he){(ae.blotName==null&&ae(de)||ae.blotName!=null&&de instanceof ae)&&ve.push(de),de instanceof oe&&(ve=ve.concat(de.descendants(ae,ue,ge))),ge-=he}),ve},oe.prototype.detach=function(){this.children.forEach(function(ae){ae.detach()}),se.prototype.detach.call(this)},oe.prototype.formatAt=function(ae,le,pe,ve){this.children.forEachAt(ae,le,function(ge,de,ue){ge.formatAt(de,ue,pe,ve)})},oe.prototype.insertAt=function(ae,le,pe){var ve=this.children.find(ae),ge=ve[0],de=ve[1];if(ge)ge.insertAt(de,le,pe);else{var ue=pe==null?ie.create("text",le):ie.create(le,pe);this.appendChild(ue)}},oe.prototype.insertBefore=function(ae,le){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(pe){return ae instanceof pe}))throw new ie.ParchmentError("Cannot insert "+ae.statics.blotName+" into "+this.statics.blotName);ae.insertInto(this,le)},oe.prototype.length=function(){return this.children.reduce(function(ae,le){return ae+le.length()},0)},oe.prototype.moveChildren=function(ae,le){this.children.forEach(function(pe){ae.insertBefore(pe,le)})},oe.prototype.optimize=function(ae){if(se.prototype.optimize.call(this,ae),this.children.length===0)if(this.statics.defaultChild!=null){var le=ie.create(this.statics.defaultChild);this.appendChild(le),le.optimize(ae)}else this.remove()},oe.prototype.path=function(ae,le){le===void 0&&(le=!1);var pe=this.children.find(ae,le),ve=pe[0],ge=pe[1],de=[[this,ae]];return ve instanceof oe?de.concat(ve.path(ge,le)):(ve!=null&&de.push([ve,ge]),de)},oe.prototype.removeChild=function(ae){this.children.remove(ae)},oe.prototype.replace=function(ae){ae instanceof oe&&ae.moveChildren(this),se.prototype.replace.call(this,ae)},oe.prototype.split=function(ae,le){if(le===void 0&&(le=!1),!le){if(ae===0)return this;if(ae===this.length())return this.next}var pe=this.clone();return this.parent.insertBefore(pe,this.next),this.children.forEachAt(ae,this.length(),function(ve,ge,de){ve=ve.split(ge,le),pe.appendChild(ve)}),pe},oe.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},oe.prototype.update=function(ae,le){var pe=this,ve=[],ge=[];ae.forEach(function(de){de.target===pe.domNode&&de.type==="childList"&&(ve.push.apply(ve,de.addedNodes),ge.push.apply(ge,de.removedNodes))}),ge.forEach(function(de){if(!(de.parentNode!=null&&de.tagName!=="IFRAME"&&document.body.compareDocumentPosition(de)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var ue=ie.find(de);ue!=null&&(ue.domNode.parentNode==null||ue.domNode.parentNode===pe.domNode)&&ue.detach()}}),ve.filter(function(de){return de.parentNode==pe.domNode}).sort(function(de,ue){return de===ue?0:de.compareDocumentPosition(ue)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(de){var ue=null;de.nextSibling!=null&&(ue=ie.find(de.nextSibling));var he=ce(de);(he.next!=ue||he.next==null)&&(he.parent!=null&&he.parent.removeChild(pe),pe.insertBefore(he,ue||void 0))})},oe}(re.default);function ce(se){var oe=ie.find(se);if(oe==null)try{oe=ie.create(se)}catch{oe=ie.create(ie.Scope.INLINE),[].slice.call(se.childNodes).forEach(function(le){oe.domNode.appendChild(le)}),se.parentNode&&se.parentNode.replaceChild(oe.domNode,se),oe.attach()}return oe}X.default=fe},function(j,X,ee){var te=this&&this.__extends||function(){var se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(oe,ae){oe.__proto__=ae}||function(oe,ae){for(var le in ae)ae.hasOwnProperty(le)&&(oe[le]=ae[le])};return function(oe,ae){se(oe,ae);function le(){this.constructor=oe}oe.prototype=ae===null?Object.create(ae):(le.prototype=ae.prototype,new le)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(12),re=ee(31),ie=ee(17),fe=ee(1),ce=function(se){te(oe,se);function oe(ae){var le=se.call(this,ae)||this;return le.attributes=new re.default(le.domNode),le}return oe.formats=function(ae){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return ae.tagName.toLowerCase()},oe.prototype.format=function(ae,le){var pe=fe.query(ae);pe instanceof ne.default?this.attributes.attribute(pe,le):le&&pe!=null&&(ae!==this.statics.blotName||this.formats()[ae]!==le)&&this.replaceWith(ae,le)},oe.prototype.formats=function(){var ae=this.attributes.values(),le=this.statics.formats(this.domNode);return le!=null&&(ae[this.statics.blotName]=le),ae},oe.prototype.replaceWith=function(ae,le){var pe=se.prototype.replaceWith.call(this,ae,le);return this.attributes.copy(pe),pe},oe.prototype.update=function(ae,le){var pe=this;se.prototype.update.call(this,ae,le),ae.some(function(ve){return ve.target===pe.domNode&&ve.type==="attributes"})&&this.attributes.build()},oe.prototype.wrap=function(ae,le){var pe=se.prototype.wrap.call(this,ae,le);return pe instanceof oe&&pe.statics.scope===this.statics.scope&&this.attributes.move(pe),pe},oe}(ie.default);X.default=ce},function(j,X,ee){var te=this&&this.__extends||function(){var fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,se){ce.__proto__=se}||function(ce,se){for(var oe in se)se.hasOwnProperty(oe)&&(ce[oe]=se[oe])};return function(ce,se){fe(ce,se);function oe(){this.constructor=ce}ce.prototype=se===null?Object.create(se):(oe.prototype=se.prototype,new oe)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(30),re=ee(1),ie=function(fe){te(ce,fe);function ce(){return fe!==null&&fe.apply(this,arguments)||this}return ce.value=function(se){return!0},ce.prototype.index=function(se,oe){return this.domNode===se||this.domNode.compareDocumentPosition(se)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(oe,1):-1},ce.prototype.position=function(se,oe){var ae=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return se>0&&(ae+=1),[this.parent.domNode,ae]},ce.prototype.value=function(){var se;return se={},se[this.statics.blotName]=this.statics.value(this.domNode)||!0,se},ce.scope=re.Scope.INLINE_BLOT,ce}(ne.default);X.default=ie},function(j,X,ee){var te=ee(11),ne=ee(3),re={attributes:{compose:function(fe,ce,se){typeof fe!="object"&&(fe={}),typeof ce!="object"&&(ce={});var oe=ne(!0,{},ce);se||(oe=Object.keys(oe).reduce(function(le,pe){return oe[pe]!=null&&(le[pe]=oe[pe]),le},{}));for(var ae in fe)fe[ae]!==void 0&&ce[ae]===void 0&&(oe[ae]=fe[ae]);return Object.keys(oe).length>0?oe:void 0},diff:function(fe,ce){typeof fe!="object"&&(fe={}),typeof ce!="object"&&(ce={});var se=Object.keys(fe).concat(Object.keys(ce)).reduce(function(oe,ae){return te(fe[ae],ce[ae])||(oe[ae]=ce[ae]===void 0?null:ce[ae]),oe},{});return Object.keys(se).length>0?se:void 0},transform:function(fe,ce,se){if(typeof fe!="object")return ce;if(typeof ce=="object"){if(!se)return ce;var oe=Object.keys(ce).reduce(function(ae,le){return fe[le]===void 0&&(ae[le]=ce[le]),ae},{});return Object.keys(oe).length>0?oe:void 0}}},iterator:function(fe){return new ie(fe)},length:function(fe){return typeof fe.delete=="number"?fe.delete:typeof fe.retain=="number"?fe.retain:typeof fe.insert=="string"?fe.insert.length:1}};function ie(fe){this.ops=fe,this.index=0,this.offset=0}ie.prototype.hasNext=function(){return this.peekLength()<1/0},ie.prototype.next=function(fe){fe||(fe=1/0);var ce=this.ops[this.index];if(ce){var se=this.offset,oe=re.length(ce);if(fe>=oe-se?(fe=oe-se,this.index+=1,this.offset=0):this.offset+=fe,typeof ce.delete=="number")return{delete:fe};var ae={};return ce.attributes&&(ae.attributes=ce.attributes),typeof ce.retain=="number"?ae.retain=fe:typeof ce.insert=="string"?ae.insert=ce.insert.substr(se,fe):ae.insert=ce.insert,ae}else return{retain:1/0}},ie.prototype.peek=function(){return this.ops[this.index]},ie.prototype.peekLength=function(){return this.ops[this.index]?re.length(this.ops[this.index])-this.offset:1/0},ie.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},ie.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var fe=this.offset,ce=this.index,se=this.next(),oe=this.ops.slice(this.index);return this.offset=fe,this.index=ce,[se].concat(oe)}else return[]},j.exports=re},function(j,X){var ee=function(){function te(pe,ve){return ve!=null&&pe instanceof ve}var ne;try{ne=Map}catch{ne=function(){}}var re;try{re=Set}catch{re=function(){}}var ie;try{ie=Promise}catch{ie=function(){}}function fe(pe,ve,ge,de,ue){typeof ve=="object"&&(ge=ve.depth,de=ve.prototype,ue=ve.includeNonEnumerable,ve=ve.circular);var he=[],me=[],_e=typeof Buffer<"u";typeof ve>"u"&&(ve=!0),typeof ge>"u"&&(ge=1/0);function be(Se,Te){if(Se===null)return null;if(Te===0)return Se;var we,ke;if(typeof Se!="object")return Se;if(te(Se,ne))we=new ne;else if(te(Se,re))we=new re;else if(te(Se,ie))we=new ie(function(He,Ie){Se.then(function(Ue){He(be(Ue,Te-1))},function(Ue){Ie(be(Ue,Te-1))})});else if(fe.__isArray(Se))we=[];else if(fe.__isRegExp(Se))we=new RegExp(Se.source,le(Se)),Se.lastIndex&&(we.lastIndex=Se.lastIndex);else if(fe.__isDate(Se))we=new Date(Se.getTime());else{if(_e&&Buffer.isBuffer(Se))return Buffer.allocUnsafe?we=Buffer.allocUnsafe(Se.length):we=new Buffer(Se.length),Se.copy(we),we;te(Se,Error)?we=Object.create(Se):typeof de>"u"?(ke=Object.getPrototypeOf(Se),we=Object.create(ke)):(we=Object.create(de),ke=de)}if(ve){var xe=he.indexOf(Se);if(xe!=-1)return me[xe];he.push(Se),me.push(we)}te(Se,ne)&&Se.forEach(function(He,Ie){var Ue=be(Ie,Te-1),Pe=be(He,Te-1);we.set(Ue,Pe)}),te(Se,re)&&Se.forEach(function(He){var Ie=be(He,Te-1);we.add(Ie)});for(var Ae in Se){var Le;ke&&(Le=Object.getOwnPropertyDescriptor(ke,Ae)),!(Le&&Le.set==null)&&(we[Ae]=be(Se[Ae],Te-1))}if(Object.getOwnPropertySymbols)for(var De=Object.getOwnPropertySymbols(Se),Ae=0;Ae<De.length;Ae++){var $e=De[Ae],Ve=Object.getOwnPropertyDescriptor(Se,$e);Ve&&!Ve.enumerable&&!ue||(we[$e]=be(Se[$e],Te-1),Ve.enumerable||Object.defineProperty(we,$e,{enumerable:!1}))}if(ue)for(var Qe=Object.getOwnPropertyNames(Se),Ae=0;Ae<Qe.length;Ae++){var je=Qe[Ae],Ve=Object.getOwnPropertyDescriptor(Se,je);Ve&&Ve.enumerable||(we[je]=be(Se[je],Te-1),Object.defineProperty(we,je,{enumerable:!1}))}return we}return be(pe,ge)}fe.clonePrototype=function(ve){if(ve===null)return null;var ge=function(){};return ge.prototype=ve,new ge};function ce(pe){return Object.prototype.toString.call(pe)}fe.__objToStr=ce;function se(pe){return typeof pe=="object"&&ce(pe)==="[object Date]"}fe.__isDate=se;function oe(pe){return typeof pe=="object"&&ce(pe)==="[object Array]"}fe.__isArray=oe;function ae(pe){return typeof pe=="object"&&ce(pe)==="[object RegExp]"}fe.__isRegExp=ae;function le(pe){var ve="";return pe.global&&(ve+="g"),pe.ignoreCase&&(ve+="i"),pe.multiline&&(ve+="m"),ve}return fe.__getRegExpFlags=le,fe}();typeof j=="object"&&j.exports&&(j.exports=ee)},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function we(ke,xe){var Ae=[],Le=!0,De=!1,$e=void 0;try{for(var Ve=ke[Symbol.iterator](),Qe;!(Le=(Qe=Ve.next()).done)&&(Ae.push(Qe.value),!(xe&&Ae.length===xe));Le=!0);}catch(je){De=!0,$e=je}finally{try{!Le&&Ve.return&&Ve.return()}finally{if(De)throw $e}}return Ae}return function(ke,xe){if(Array.isArray(ke))return ke;if(Symbol.iterator in Object(ke))return we(ke,xe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ne=function(){function we(ke,xe){for(var Ae=0;Ae<xe.length;Ae++){var Le=xe[Ae];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(ke,Le.key,Le)}}return function(ke,xe,Ae){return xe&&we(ke.prototype,xe),Ae&&we(ke,Ae),ke}}(),re=function we(ke,xe,Ae){ke===null&&(ke=Function.prototype);var Le=Object.getOwnPropertyDescriptor(ke,xe);if(Le===void 0){var De=Object.getPrototypeOf(ke);return De===null?void 0:we(De,xe,Ae)}else{if("value"in Le)return Le.value;var $e=Le.get;return $e===void 0?void 0:$e.call(Ae)}},ie=ee(0),fe=he(ie),ce=ee(8),se=he(ce),oe=ee(4),ae=he(oe),le=ee(16),pe=he(le),ve=ee(13),ge=he(ve),de=ee(25),ue=he(de);function he(we){return we&&we.__esModule?we:{default:we}}function me(we,ke){if(!(we instanceof ke))throw new TypeError("Cannot call a class as a function")}function _e(we,ke){if(!we)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ke&&(typeof ke=="object"||typeof ke=="function")?ke:we}function be(we,ke){if(typeof ke!="function"&&ke!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ke);we.prototype=Object.create(ke&&ke.prototype,{constructor:{value:we,enumerable:!1,writable:!0,configurable:!0}}),ke&&(Object.setPrototypeOf?Object.setPrototypeOf(we,ke):we.__proto__=ke)}function Se(we){return we instanceof ae.default||we instanceof oe.BlockEmbed}var Te=function(we){be(ke,we);function ke(xe,Ae){me(this,ke);var Le=_e(this,(ke.__proto__||Object.getPrototypeOf(ke)).call(this,xe));return Le.emitter=Ae.emitter,Array.isArray(Ae.whitelist)&&(Le.whitelist=Ae.whitelist.reduce(function(De,$e){return De[$e]=!0,De},{})),Le.domNode.addEventListener("DOMNodeInserted",function(){}),Le.optimize(),Le.enable(),Le}return ne(ke,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(Ae,Le){var De=this.line(Ae),$e=te(De,2),Ve=$e[0],Qe=$e[1],je=this.line(Ae+Le),He=te(je,1),Ie=He[0];if(re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"deleteAt",this).call(this,Ae,Le),Ie!=null&&Ve!==Ie&&Qe>0){if(Ve instanceof oe.BlockEmbed||Ie instanceof oe.BlockEmbed){this.optimize();return}if(Ve instanceof ge.default){var Ue=Ve.newlineIndex(Ve.length(),!0);if(Ue>-1&&(Ve=Ve.split(Ue+1),Ve===Ie)){this.optimize();return}}else if(Ie instanceof ge.default){var Pe=Ie.newlineIndex(0);Pe>-1&&Ie.split(Pe+1)}var We=Ie.children.head instanceof pe.default?null:Ie.children.head;Ve.moveChildren(Ie,We),Ve.remove()}this.optimize()}},{key:"enable",value:function(){var Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",Ae)}},{key:"formatAt",value:function(Ae,Le,De,$e){this.whitelist!=null&&!this.whitelist[De]||(re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"formatAt",this).call(this,Ae,Le,De,$e),this.optimize())}},{key:"insertAt",value:function(Ae,Le,De){if(!(De!=null&&this.whitelist!=null&&!this.whitelist[Le])){if(Ae>=this.length())if(De==null||fe.default.query(Le,fe.default.Scope.BLOCK)==null){var $e=fe.default.create(this.statics.defaultChild);this.appendChild($e),De==null&&Le.endsWith(`
`)&&(Le=Le.slice(0,-1)),$e.insertAt(0,Le,De)}else{var Ve=fe.default.create(Le,De);this.appendChild(Ve)}else re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"insertAt",this).call(this,Ae,Le,De);this.optimize()}}},{key:"insertBefore",value:function(Ae,Le){if(Ae.statics.scope===fe.default.Scope.INLINE_BLOT){var De=fe.default.create(this.statics.defaultChild);De.appendChild(Ae),Ae=De}re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"insertBefore",this).call(this,Ae,Le)}},{key:"leaf",value:function(Ae){return this.path(Ae).pop()||[null,-1]}},{key:"line",value:function(Ae){return Ae===this.length()?this.line(Ae-1):this.descendant(Se,Ae)}},{key:"lines",value:function(){var Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,De=function $e(Ve,Qe,je){var He=[],Ie=je;return Ve.children.forEachAt(Qe,je,function(Ue,Pe,We){Se(Ue)?He.push(Ue):Ue instanceof fe.default.Container&&(He=He.concat($e(Ue,Pe,Ie))),Ie-=We}),He};return De(this,Ae,Le)}},{key:"optimize",value:function(){var Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"optimize",this).call(this,Ae,Le),Ae.length>0&&this.emitter.emit(se.default.events.SCROLL_OPTIMIZE,Ae,Le))}},{key:"path",value:function(Ae){return re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"path",this).call(this,Ae).slice(1)}},{key:"update",value:function(Ae){if(this.batch!==!0){var Le=se.default.sources.USER;typeof Ae=="string"&&(Le=Ae),Array.isArray(Ae)||(Ae=this.observer.takeRecords()),Ae.length>0&&this.emitter.emit(se.default.events.SCROLL_BEFORE_UPDATE,Le,Ae),re(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"update",this).call(this,Ae.concat([])),Ae.length>0&&this.emitter.emit(se.default.events.SCROLL_UPDATE,Le,Ae)}}}]),ke}(fe.default.Scroll);Te.blotName="scroll",Te.className="ql-editor",Te.tagName="DIV",Te.defaultChild="block",Te.allowedChildren=[ae.default,oe.BlockEmbed,ue.default],X.default=Te},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.SHORTKEY=X.default=void 0;var te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ne){return typeof Ne}:function(Ne){return Ne&&typeof Symbol=="function"&&Ne.constructor===Symbol&&Ne!==Symbol.prototype?"symbol":typeof Ne},ne=function(){function Ne(Ke,Xe){var Je=[],nt=!0,ot=!1,ht=void 0;try{for(var ct=Ke[Symbol.iterator](),ut;!(nt=(ut=ct.next()).done)&&(Je.push(ut.value),!(Xe&&Je.length===Xe));nt=!0);}catch(Re){ot=!0,ht=Re}finally{try{!nt&&ct.return&&ct.return()}finally{if(ot)throw ht}}return Je}return function(Ke,Xe){if(Array.isArray(Ke))return Ke;if(Symbol.iterator in Object(Ke))return Ne(Ke,Xe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),re=function(){function Ne(Ke,Xe){for(var Je=0;Je<Xe.length;Je++){var nt=Xe[Je];nt.enumerable=nt.enumerable||!1,nt.configurable=!0,"value"in nt&&(nt.writable=!0),Object.defineProperty(Ke,nt.key,nt)}}return function(Ke,Xe,Je){return Xe&&Ne(Ke.prototype,Xe),Je&&Ne(Ke,Je),Ke}}(),ie=ee(21),fe=we(ie),ce=ee(11),se=we(ce),oe=ee(3),ae=we(oe),le=ee(2),pe=we(le),ve=ee(20),ge=we(ve),de=ee(0),ue=we(de),he=ee(5),me=we(he),_e=ee(10),be=we(_e),Se=ee(9),Te=we(Se);function we(Ne){return Ne&&Ne.__esModule?Ne:{default:Ne}}function ke(Ne,Ke,Xe){return Ke in Ne?Object.defineProperty(Ne,Ke,{value:Xe,enumerable:!0,configurable:!0,writable:!0}):Ne[Ke]=Xe,Ne}function xe(Ne,Ke){if(!(Ne instanceof Ke))throw new TypeError("Cannot call a class as a function")}function Ae(Ne,Ke){if(!Ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ke&&(typeof Ke=="object"||typeof Ke=="function")?Ke:Ne}function Le(Ne,Ke){if(typeof Ke!="function"&&Ke!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ke);Ne.prototype=Object.create(Ke&&Ke.prototype,{constructor:{value:Ne,enumerable:!1,writable:!0,configurable:!0}}),Ke&&(Object.setPrototypeOf?Object.setPrototypeOf(Ne,Ke):Ne.__proto__=Ke)}var De=(0,be.default)("quill:keyboard"),$e=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",Ve=function(Ne){Le(Ke,Ne),re(Ke,null,[{key:"match",value:function(Je,nt){return nt=Ye(nt),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ot){return!!nt[ot]!==Je[ot]&&nt[ot]!==null})?!1:nt.key===(Je.which||Je.keyCode)}}]);function Ke(Xe,Je){xe(this,Ke);var nt=Ae(this,(Ke.__proto__||Object.getPrototypeOf(Ke)).call(this,Xe,Je));return nt.bindings={},Object.keys(nt.options.bindings).forEach(function(ot){ot==="list autofill"&&Xe.scroll.whitelist!=null&&!Xe.scroll.whitelist.list||nt.options.bindings[ot]&&nt.addBinding(nt.options.bindings[ot])}),nt.addBinding({key:Ke.keys.ENTER,shiftKey:null},Ue),nt.addBinding({key:Ke.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(nt.addBinding({key:Ke.keys.BACKSPACE},{collapsed:!0},je),nt.addBinding({key:Ke.keys.DELETE},{collapsed:!0},He)):(nt.addBinding({key:Ke.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},je),nt.addBinding({key:Ke.keys.DELETE},{collapsed:!0,suffix:/^.?$/},He)),nt.addBinding({key:Ke.keys.BACKSPACE},{collapsed:!1},Ie),nt.addBinding({key:Ke.keys.DELETE},{collapsed:!1},Ie),nt.addBinding({key:Ke.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},je),nt.listen(),nt}return re(Ke,[{key:"addBinding",value:function(Je){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ot=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ht=Ye(Je);if(ht==null||ht.key==null)return De.warn("Attempted to add invalid keyboard binding",ht);typeof nt=="function"&&(nt={handler:nt}),typeof ot=="function"&&(ot={handler:ot}),ht=(0,ae.default)(ht,nt,ot),this.bindings[ht.key]=this.bindings[ht.key]||[],this.bindings[ht.key].push(ht)}},{key:"listen",value:function(){var Je=this;this.quill.root.addEventListener("keydown",function(nt){if(!nt.defaultPrevented){var ot=nt.which||nt.keyCode,ht=(Je.bindings[ot]||[]).filter(function(tt){return Ke.match(nt,tt)});if(ht.length!==0){var ct=Je.quill.getSelection();if(!(ct==null||!Je.quill.hasFocus())){var ut=Je.quill.getLine(ct.index),Re=ne(ut,2),Me=Re[0],qe=Re[1],Be=Je.quill.getLeaf(ct.index),Oe=ne(Be,2),ye=Oe[0],Ce=Oe[1],Ee=ct.length===0?[ye,Ce]:Je.quill.getLeaf(ct.index+ct.length),Fe=ne(Ee,2),ze=Fe[0],Ze=Fe[1],st=ye instanceof ue.default.Text?ye.value().slice(0,Ce):"",pt=ze instanceof ue.default.Text?ze.value().slice(Ze):"",dt={collapsed:ct.length===0,empty:ct.length===0&&Me.length()<=1,format:Je.quill.getFormat(ct),offset:qe,prefix:st,suffix:pt},ft=ht.some(function(tt){if(tt.collapsed!=null&&tt.collapsed!==dt.collapsed||tt.empty!=null&&tt.empty!==dt.empty||tt.offset!=null&&tt.offset!==dt.offset)return!1;if(Array.isArray(tt.format)){if(tt.format.every(function(mt){return dt.format[mt]==null}))return!1}else if(te(tt.format)==="object"&&!Object.keys(tt.format).every(function(mt){return tt.format[mt]===!0?dt.format[mt]!=null:tt.format[mt]===!1?dt.format[mt]==null:(0,se.default)(tt.format[mt],dt.format[mt])}))return!1;return tt.prefix!=null&&!tt.prefix.test(dt.prefix)||tt.suffix!=null&&!tt.suffix.test(dt.suffix)?!1:tt.handler.call(Je,ct,dt)!==!0});ft&&nt.preventDefault()}}}})}}]),Ke}(Te.default);Ve.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},Ve.DEFAULTS={bindings:{bold:We("bold"),italic:We("italic"),underline:We("underline"),indent:{key:Ve.keys.TAB,format:["blockquote","indent","list"],handler:function(Ke,Xe){if(Xe.collapsed&&Xe.offset!==0)return!0;this.quill.format("indent","+1",me.default.sources.USER)}},outdent:{key:Ve.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(Ke,Xe){if(Xe.collapsed&&Xe.offset!==0)return!0;this.quill.format("indent","-1",me.default.sources.USER)}},"outdent backspace":{key:Ve.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(Ke,Xe){Xe.format.indent!=null?this.quill.format("indent","-1",me.default.sources.USER):Xe.format.list!=null&&this.quill.format("list",!1,me.default.sources.USER)}},"indent code-block":Pe(!0),"outdent code-block":Pe(!1),"remove tab":{key:Ve.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(Ke){this.quill.deleteText(Ke.index-1,1,me.default.sources.USER)}},tab:{key:Ve.keys.TAB,handler:function(Ke){this.quill.history.cutoff();var Xe=new pe.default().retain(Ke.index).delete(Ke.length).insert("	");this.quill.updateContents(Xe,me.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Ke.index+1,me.default.sources.SILENT)}},"list empty enter":{key:Ve.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(Ke,Xe){this.quill.format("list",!1,me.default.sources.USER),Xe.format.indent&&this.quill.format("indent",!1,me.default.sources.USER)}},"checklist enter":{key:Ve.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(Ke){var Xe=this.quill.getLine(Ke.index),Je=ne(Xe,2),nt=Je[0],ot=Je[1],ht=(0,ae.default)({},nt.formats(),{list:"checked"}),ct=new pe.default().retain(Ke.index).insert(`
`,ht).retain(nt.length()-ot-1).retain(1,{list:"unchecked"});this.quill.updateContents(ct,me.default.sources.USER),this.quill.setSelection(Ke.index+1,me.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:Ve.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(Ke,Xe){var Je=this.quill.getLine(Ke.index),nt=ne(Je,2),ot=nt[0],ht=nt[1],ct=new pe.default().retain(Ke.index).insert(`
`,Xe.format).retain(ot.length()-ht-1).retain(1,{header:null});this.quill.updateContents(ct,me.default.sources.USER),this.quill.setSelection(Ke.index+1,me.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(Ke,Xe){var Je=Xe.prefix.length,nt=this.quill.getLine(Ke.index),ot=ne(nt,2),ht=ot[0],ct=ot[1];if(ct>Je)return!0;var ut=void 0;switch(Xe.prefix.trim()){case"[]":case"[ ]":ut="unchecked";break;case"[x]":ut="checked";break;case"-":case"*":ut="bullet";break;default:ut="ordered"}this.quill.insertText(Ke.index," ",me.default.sources.USER),this.quill.history.cutoff();var Re=new pe.default().retain(Ke.index-ct).delete(Je+1).retain(ht.length()-2-ct).retain(1,{list:ut});this.quill.updateContents(Re,me.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Ke.index-Je,me.default.sources.SILENT)}},"code exit":{key:Ve.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(Ke){var Xe=this.quill.getLine(Ke.index),Je=ne(Xe,2),nt=Je[0],ot=Je[1],ht=new pe.default().retain(Ke.index+nt.length()-ot-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(ht,me.default.sources.USER)}},"embed left":Qe(Ve.keys.LEFT,!1),"embed left shift":Qe(Ve.keys.LEFT,!0),"embed right":Qe(Ve.keys.RIGHT,!1),"embed right shift":Qe(Ve.keys.RIGHT,!0)}};function Qe(Ne,Ke){var Xe,Je=Ne===Ve.keys.LEFT?"prefix":"suffix";return Xe={key:Ne,shiftKey:Ke,altKey:null},ke(Xe,Je,/^$/),ke(Xe,"handler",function(ot){var ht=ot.index;Ne===Ve.keys.RIGHT&&(ht+=ot.length+1);var ct=this.quill.getLeaf(ht),ut=ne(ct,1),Re=ut[0];return Re instanceof ue.default.Embed?(Ne===Ve.keys.LEFT?Ke?this.quill.setSelection(ot.index-1,ot.length+1,me.default.sources.USER):this.quill.setSelection(ot.index-1,me.default.sources.USER):Ke?this.quill.setSelection(ot.index,ot.length+1,me.default.sources.USER):this.quill.setSelection(ot.index+ot.length+1,me.default.sources.USER),!1):!0}),Xe}function je(Ne,Ke){if(!(Ne.index===0||this.quill.getLength()<=1)){var Xe=this.quill.getLine(Ne.index),Je=ne(Xe,1),nt=Je[0],ot={};if(Ke.offset===0){var ht=this.quill.getLine(Ne.index-1),ct=ne(ht,1),ut=ct[0];if(ut!=null&&ut.length()>1){var Re=nt.formats(),Me=this.quill.getFormat(Ne.index-1,1);ot=ge.default.attributes.diff(Re,Me)||{}}}var qe=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(Ke.prefix)?2:1;this.quill.deleteText(Ne.index-qe,qe,me.default.sources.USER),Object.keys(ot).length>0&&this.quill.formatLine(Ne.index-qe,qe,ot,me.default.sources.USER),this.quill.focus()}}function He(Ne,Ke){var Xe=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(Ke.suffix)?2:1;if(!(Ne.index>=this.quill.getLength()-Xe)){var Je={},nt=0,ot=this.quill.getLine(Ne.index),ht=ne(ot,1),ct=ht[0];if(Ke.offset>=ct.length()-1){var ut=this.quill.getLine(Ne.index+1),Re=ne(ut,1),Me=Re[0];if(Me){var qe=ct.formats(),Be=this.quill.getFormat(Ne.index,1);Je=ge.default.attributes.diff(qe,Be)||{},nt=Me.length()}}this.quill.deleteText(Ne.index,Xe,me.default.sources.USER),Object.keys(Je).length>0&&this.quill.formatLine(Ne.index+nt-1,Xe,Je,me.default.sources.USER)}}function Ie(Ne){var Ke=this.quill.getLines(Ne),Xe={};if(Ke.length>1){var Je=Ke[0].formats(),nt=Ke[Ke.length-1].formats();Xe=ge.default.attributes.diff(nt,Je)||{}}this.quill.deleteText(Ne,me.default.sources.USER),Object.keys(Xe).length>0&&this.quill.formatLine(Ne.index,1,Xe,me.default.sources.USER),this.quill.setSelection(Ne.index,me.default.sources.SILENT),this.quill.focus()}function Ue(Ne,Ke){var Xe=this;Ne.length>0&&this.quill.scroll.deleteAt(Ne.index,Ne.length);var Je=Object.keys(Ke.format).reduce(function(nt,ot){return ue.default.query(ot,ue.default.Scope.BLOCK)&&!Array.isArray(Ke.format[ot])&&(nt[ot]=Ke.format[ot]),nt},{});this.quill.insertText(Ne.index,`
`,Je,me.default.sources.USER),this.quill.setSelection(Ne.index+1,me.default.sources.SILENT),this.quill.focus(),Object.keys(Ke.format).forEach(function(nt){Je[nt]==null&&(Array.isArray(Ke.format[nt])||nt!=="link"&&Xe.quill.format(nt,Ke.format[nt],me.default.sources.USER))})}function Pe(Ne){return{key:Ve.keys.TAB,shiftKey:!Ne,format:{"code-block":!0},handler:function(Xe){var Je=ue.default.query("code-block"),nt=Xe.index,ot=Xe.length,ht=this.quill.scroll.descendant(Je,nt),ct=ne(ht,2),ut=ct[0],Re=ct[1];if(ut!=null){var Me=this.quill.getIndex(ut),qe=ut.newlineIndex(Re,!0)+1,Be=ut.newlineIndex(Me+Re+ot),Oe=ut.domNode.textContent.slice(qe,Be).split(`
`);Re=0,Oe.forEach(function(ye,Ce){Ne?(ut.insertAt(qe+Re,Je.TAB),Re+=Je.TAB.length,Ce===0?nt+=Je.TAB.length:ot+=Je.TAB.length):ye.startsWith(Je.TAB)&&(ut.deleteAt(qe+Re,Je.TAB.length),Re-=Je.TAB.length,Ce===0?nt-=Je.TAB.length:ot-=Je.TAB.length),Re+=ye.length+1}),this.quill.update(me.default.sources.USER),this.quill.setSelection(nt,ot,me.default.sources.SILENT)}}}}function We(Ne){return{key:Ne[0].toUpperCase(),shortKey:!0,handler:function(Xe,Je){this.quill.format(Ne,!Je.format[Ne],me.default.sources.USER)}}}function Ye(Ne){if(typeof Ne=="string"||typeof Ne=="number")return Ye({key:Ne});if((typeof Ne>"u"?"undefined":te(Ne))==="object"&&(Ne=(0,fe.default)(Ne,!1)),typeof Ne.key=="string")if(Ve.keys[Ne.key.toUpperCase()]!=null)Ne.key=Ve.keys[Ne.key.toUpperCase()];else if(Ne.key.length===1)Ne.key=Ne.key.toUpperCase().charCodeAt(0);else return null;return Ne.shortKey&&(Ne[$e]=Ne.shortKey,delete Ne.shortKey),Ne}X.default=Ve,X.SHORTKEY=$e},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ge(de,ue){var he=[],me=!0,_e=!1,be=void 0;try{for(var Se=de[Symbol.iterator](),Te;!(me=(Te=Se.next()).done)&&(he.push(Te.value),!(ue&&he.length===ue));me=!0);}catch(we){_e=!0,be=we}finally{try{!me&&Se.return&&Se.return()}finally{if(_e)throw be}}return he}return function(de,ue){if(Array.isArray(de))return de;if(Symbol.iterator in Object(de))return ge(de,ue);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ne=function ge(de,ue,he){de===null&&(de=Function.prototype);var me=Object.getOwnPropertyDescriptor(de,ue);if(me===void 0){var _e=Object.getPrototypeOf(de);return _e===null?void 0:ge(_e,ue,he)}else{if("value"in me)return me.value;var be=me.get;return be===void 0?void 0:be.call(he)}},re=function(){function ge(de,ue){for(var he=0;he<ue.length;he++){var me=ue[he];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(de,me.key,me)}}return function(de,ue,he){return ue&&ge(de.prototype,ue),he&&ge(de,he),de}}(),ie=ee(0),fe=oe(ie),ce=ee(7),se=oe(ce);function oe(ge){return ge&&ge.__esModule?ge:{default:ge}}function ae(ge,de){if(!(ge instanceof de))throw new TypeError("Cannot call a class as a function")}function le(ge,de){if(!ge)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return de&&(typeof de=="object"||typeof de=="function")?de:ge}function pe(ge,de){if(typeof de!="function"&&de!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof de);ge.prototype=Object.create(de&&de.prototype,{constructor:{value:ge,enumerable:!1,writable:!0,configurable:!0}}),de&&(Object.setPrototypeOf?Object.setPrototypeOf(ge,de):ge.__proto__=de)}var ve=function(ge){pe(de,ge),re(de,null,[{key:"value",value:function(){}}]);function de(ue,he){ae(this,de);var me=le(this,(de.__proto__||Object.getPrototypeOf(de)).call(this,ue));return me.selection=he,me.textNode=document.createTextNode(de.CONTENTS),me.domNode.appendChild(me.textNode),me._length=0,me}return re(de,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(he,me){if(this._length!==0)return ne(de.prototype.__proto__||Object.getPrototypeOf(de.prototype),"format",this).call(this,he,me);for(var _e=this,be=0;_e!=null&&_e.statics.scope!==fe.default.Scope.BLOCK_BLOT;)be+=_e.offset(_e.parent),_e=_e.parent;_e!=null&&(this._length=de.CONTENTS.length,_e.optimize(),_e.formatAt(be,de.CONTENTS.length,he,me),this._length=0)}},{key:"index",value:function(he,me){return he===this.textNode?0:ne(de.prototype.__proto__||Object.getPrototypeOf(de.prototype),"index",this).call(this,he,me)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){ne(de.prototype.__proto__||Object.getPrototypeOf(de.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var he=this.textNode,me=this.selection.getNativeRange(),_e=void 0,be=void 0,Se=void 0;if(me!=null&&me.start.node===he&&me.end.node===he){var Te=[he,me.start.offset,me.end.offset];_e=Te[0],be=Te[1],Se=Te[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==de.CONTENTS){var we=this.textNode.data.split(de.CONTENTS).join("");this.next instanceof se.default?(_e=this.next.domNode,this.next.insertAt(0,we),this.textNode.data=de.CONTENTS):(this.textNode.data=we,this.parent.insertBefore(fe.default.create(this.textNode),this),this.textNode=document.createTextNode(de.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),be!=null){var ke=[be,Se].map(function(Ae){return Math.max(0,Math.min(_e.data.length,Ae-1))}),xe=te(ke,2);return be=xe[0],Se=xe[1],{startNode:_e,startOffset:be,endNode:_e,endOffset:Se}}}}},{key:"update",value:function(he,me){var _e=this;if(he.some(function(Se){return Se.type==="characterData"&&Se.target===_e.textNode})){var be=this.restore();be&&(me.range=be)}}},{key:"value",value:function(){return""}}]),de}(fe.default.Embed);ve.blotName="cursor",ve.className="ql-cursor",ve.tagName="span",ve.CONTENTS="\uFEFF",X.default=ve},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(0),ne=fe(te),re=ee(4),ie=fe(re);function fe(le){return le&&le.__esModule?le:{default:le}}function ce(le,pe){if(!(le instanceof pe))throw new TypeError("Cannot call a class as a function")}function se(le,pe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pe&&(typeof pe=="object"||typeof pe=="function")?pe:le}function oe(le,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pe);le.prototype=Object.create(pe&&pe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),pe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,pe):le.__proto__=pe)}var ae=function(le){oe(pe,le);function pe(){return ce(this,pe),se(this,(pe.__proto__||Object.getPrototypeOf(pe)).apply(this,arguments))}return pe}(ne.default.Container);ae.allowedChildren=[ie.default,re.BlockEmbed,ae],X.default=ae},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.ColorStyle=X.ColorClass=X.ColorAttributor=void 0;var te=function(){function ve(ge,de){for(var ue=0;ue<de.length;ue++){var he=de[ue];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(ge,he.key,he)}}return function(ge,de,ue){return de&&ve(ge.prototype,de),ue&&ve(ge,ue),ge}}(),ne=function ve(ge,de,ue){ge===null&&(ge=Function.prototype);var he=Object.getOwnPropertyDescriptor(ge,de);if(he===void 0){var me=Object.getPrototypeOf(ge);return me===null?void 0:ve(me,de,ue)}else{if("value"in he)return he.value;var _e=he.get;return _e===void 0?void 0:_e.call(ue)}},re=ee(0),ie=fe(re);function fe(ve){return ve&&ve.__esModule?ve:{default:ve}}function ce(ve,ge){if(!(ve instanceof ge))throw new TypeError("Cannot call a class as a function")}function se(ve,ge){if(!ve)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ge&&(typeof ge=="object"||typeof ge=="function")?ge:ve}function oe(ve,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ge);ve.prototype=Object.create(ge&&ge.prototype,{constructor:{value:ve,enumerable:!1,writable:!0,configurable:!0}}),ge&&(Object.setPrototypeOf?Object.setPrototypeOf(ve,ge):ve.__proto__=ge)}var ae=function(ve){oe(ge,ve);function ge(){return ce(this,ge),se(this,(ge.__proto__||Object.getPrototypeOf(ge)).apply(this,arguments))}return te(ge,[{key:"value",value:function(ue){var he=ne(ge.prototype.__proto__||Object.getPrototypeOf(ge.prototype),"value",this).call(this,ue);return he.startsWith("rgb(")?(he=he.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+he.split(",").map(function(me){return("00"+parseInt(me).toString(16)).slice(-2)}).join("")):he}}]),ge}(ie.default.Attributor.Style),le=new ie.default.Attributor.Class("color","ql-color",{scope:ie.default.Scope.INLINE}),pe=new ae("color","color",{scope:ie.default.Scope.INLINE});X.ColorAttributor=ae,X.ColorClass=le,X.ColorStyle=pe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.sanitize=X.default=void 0;var te=function(){function pe(ve,ge){for(var de=0;de<ge.length;de++){var ue=ge[de];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(ve,ue.key,ue)}}return function(ve,ge,de){return ge&&pe(ve.prototype,ge),de&&pe(ve,de),ve}}(),ne=function pe(ve,ge,de){ve===null&&(ve=Function.prototype);var ue=Object.getOwnPropertyDescriptor(ve,ge);if(ue===void 0){var he=Object.getPrototypeOf(ve);return he===null?void 0:pe(he,ge,de)}else{if("value"in ue)return ue.value;var me=ue.get;return me===void 0?void 0:me.call(de)}},re=ee(6),ie=fe(re);function fe(pe){return pe&&pe.__esModule?pe:{default:pe}}function ce(pe,ve){if(!(pe instanceof ve))throw new TypeError("Cannot call a class as a function")}function se(pe,ve){if(!pe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ve&&(typeof ve=="object"||typeof ve=="function")?ve:pe}function oe(pe,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ve);pe.prototype=Object.create(ve&&ve.prototype,{constructor:{value:pe,enumerable:!1,writable:!0,configurable:!0}}),ve&&(Object.setPrototypeOf?Object.setPrototypeOf(pe,ve):pe.__proto__=ve)}var ae=function(pe){oe(ve,pe);function ve(){return ce(this,ve),se(this,(ve.__proto__||Object.getPrototypeOf(ve)).apply(this,arguments))}return te(ve,[{key:"format",value:function(de,ue){if(de!==this.statics.blotName||!ue)return ne(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"format",this).call(this,de,ue);ue=this.constructor.sanitize(ue),this.domNode.setAttribute("href",ue)}}],[{key:"create",value:function(de){var ue=ne(ve.__proto__||Object.getPrototypeOf(ve),"create",this).call(this,de);return de=this.sanitize(de),ue.setAttribute("href",de),ue.setAttribute("rel","noopener noreferrer"),ue.setAttribute("target","_blank"),ue}},{key:"formats",value:function(de){return de.getAttribute("href")}},{key:"sanitize",value:function(de){return le(de,this.PROTOCOL_WHITELIST)?de:this.SANITIZED_URL}}]),ve}(ie.default);ae.blotName="link",ae.tagName="A",ae.SANITIZED_URL="about:blank",ae.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function le(pe,ve){var ge=document.createElement("a");ge.href=pe;var de=ge.href.slice(0,ge.href.indexOf(":"));return ve.indexOf(de)>-1}X.default=ae,X.sanitize=le},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},ne=function(){function ve(ge,de){for(var ue=0;ue<de.length;ue++){var he=de[ue];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(ge,he.key,he)}}return function(ge,de,ue){return de&&ve(ge.prototype,de),ue&&ve(ge,ue),ge}}(),re=ee(23),ie=se(re),fe=ee(107),ce=se(fe);function se(ve){return ve&&ve.__esModule?ve:{default:ve}}function oe(ve,ge){if(!(ve instanceof ge))throw new TypeError("Cannot call a class as a function")}var ae=0;function le(ve,ge){ve.setAttribute(ge,ve.getAttribute(ge)!=="true")}var pe=function(){function ve(ge){var de=this;oe(this,ve),this.select=ge,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){de.togglePicker()}),this.label.addEventListener("keydown",function(ue){switch(ue.keyCode){case ie.default.keys.ENTER:de.togglePicker();break;case ie.default.keys.ESCAPE:de.escape(),ue.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return ne(ve,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),le(this.label,"aria-expanded"),le(this.options,"aria-hidden")}},{key:"buildItem",value:function(de){var ue=this,he=document.createElement("span");return he.tabIndex="0",he.setAttribute("role","button"),he.classList.add("ql-picker-item"),de.hasAttribute("value")&&he.setAttribute("data-value",de.getAttribute("value")),de.textContent&&he.setAttribute("data-label",de.textContent),he.addEventListener("click",function(){ue.selectItem(he,!0)}),he.addEventListener("keydown",function(me){switch(me.keyCode){case ie.default.keys.ENTER:ue.selectItem(he,!0),me.preventDefault();break;case ie.default.keys.ESCAPE:ue.escape(),me.preventDefault();break}}),he}},{key:"buildLabel",value:function(){var de=document.createElement("span");return de.classList.add("ql-picker-label"),de.innerHTML=ce.default,de.tabIndex="0",de.setAttribute("role","button"),de.setAttribute("aria-expanded","false"),this.container.appendChild(de),de}},{key:"buildOptions",value:function(){var de=this,ue=document.createElement("span");ue.classList.add("ql-picker-options"),ue.setAttribute("aria-hidden","true"),ue.tabIndex="-1",ue.id="ql-picker-options-"+ae,ae+=1,this.label.setAttribute("aria-controls",ue.id),this.options=ue,[].slice.call(this.select.options).forEach(function(he){var me=de.buildItem(he);ue.appendChild(me),he.selected===!0&&de.selectItem(me)}),this.container.appendChild(ue)}},{key:"buildPicker",value:function(){var de=this;[].slice.call(this.select.attributes).forEach(function(ue){de.container.setAttribute(ue.name,ue.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var de=this;this.close(),setTimeout(function(){return de.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(de){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,he=this.container.querySelector(".ql-selected");if(de!==he&&(he!=null&&he.classList.remove("ql-selected"),de!=null&&(de.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(de.parentNode.children,de),de.hasAttribute("data-value")?this.label.setAttribute("data-value",de.getAttribute("data-value")):this.label.removeAttribute("data-value"),de.hasAttribute("data-label")?this.label.setAttribute("data-label",de.getAttribute("data-label")):this.label.removeAttribute("data-label"),ue))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":te(Event))==="object"){var me=document.createEvent("Event");me.initEvent("change",!0,!0),this.select.dispatchEvent(me)}this.close()}}},{key:"update",value:function(){var de=void 0;if(this.select.selectedIndex>-1){var ue=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];de=this.select.options[this.select.selectedIndex],this.selectItem(ue)}else this.selectItem(null);var he=de!=null&&de!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",he)}}]),ve}();X.default=pe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(0),ne=De(te),re=ee(5),ie=De(re),fe=ee(4),ce=De(fe),se=ee(16),oe=De(se),ae=ee(25),le=De(ae),pe=ee(24),ve=De(pe),ge=ee(35),de=De(ge),ue=ee(6),he=De(ue),me=ee(22),_e=De(me),be=ee(7),Se=De(be),Te=ee(55),we=De(Te),ke=ee(42),xe=De(ke),Ae=ee(23),Le=De(Ae);function De($e){return $e&&$e.__esModule?$e:{default:$e}}ie.default.register({"blots/block":ce.default,"blots/block/embed":fe.BlockEmbed,"blots/break":oe.default,"blots/container":le.default,"blots/cursor":ve.default,"blots/embed":de.default,"blots/inline":he.default,"blots/scroll":_e.default,"blots/text":Se.default,"modules/clipboard":we.default,"modules/history":xe.default,"modules/keyboard":Le.default}),ne.default.register(ce.default,oe.default,ve.default,he.default,_e.default,Se.default),X.default=ie.default},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(1),ne=function(){function re(ie){this.domNode=ie,this.domNode[te.DATA_KEY]={blot:this}}return Object.defineProperty(re.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),re.create=function(ie){if(this.tagName==null)throw new te.ParchmentError("Blot definition missing tagName");var fe;return Array.isArray(this.tagName)?(typeof ie=="string"&&(ie=ie.toUpperCase(),parseInt(ie).toString()===ie&&(ie=parseInt(ie))),typeof ie=="number"?fe=document.createElement(this.tagName[ie-1]):this.tagName.indexOf(ie)>-1?fe=document.createElement(ie):fe=document.createElement(this.tagName[0])):fe=document.createElement(this.tagName),this.className&&fe.classList.add(this.className),fe},re.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},re.prototype.clone=function(){var ie=this.domNode.cloneNode(!1);return te.create(ie)},re.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[te.DATA_KEY]},re.prototype.deleteAt=function(ie,fe){var ce=this.isolate(ie,fe);ce.remove()},re.prototype.formatAt=function(ie,fe,ce,se){var oe=this.isolate(ie,fe);if(te.query(ce,te.Scope.BLOT)!=null&&se)oe.wrap(ce,se);else if(te.query(ce,te.Scope.ATTRIBUTE)!=null){var ae=te.create(this.statics.scope);oe.wrap(ae),ae.format(ce,se)}},re.prototype.insertAt=function(ie,fe,ce){var se=ce==null?te.create("text",fe):te.create(fe,ce),oe=this.split(ie);this.parent.insertBefore(se,oe)},re.prototype.insertInto=function(ie,fe){fe===void 0&&(fe=null),this.parent!=null&&this.parent.children.remove(this);var ce=null;ie.children.insertBefore(this,fe),fe!=null&&(ce=fe.domNode),(this.domNode.parentNode!=ie.domNode||this.domNode.nextSibling!=ce)&&ie.domNode.insertBefore(this.domNode,ce),this.parent=ie,this.attach()},re.prototype.isolate=function(ie,fe){var ce=this.split(ie);return ce.split(fe),ce},re.prototype.length=function(){return 1},re.prototype.offset=function(ie){return ie===void 0&&(ie=this.parent),this.parent==null||this==ie?0:this.parent.children.offset(this)+this.parent.offset(ie)},re.prototype.optimize=function(ie){this.domNode[te.DATA_KEY]!=null&&delete this.domNode[te.DATA_KEY].mutations},re.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},re.prototype.replace=function(ie){ie.parent!=null&&(ie.parent.insertBefore(this,ie.next),ie.remove())},re.prototype.replaceWith=function(ie,fe){var ce=typeof ie=="string"?te.create(ie,fe):ie;return ce.replace(this),ce},re.prototype.split=function(ie,fe){return ie===0?this:this.next},re.prototype.update=function(ie,fe){},re.prototype.wrap=function(ie,fe){var ce=typeof ie=="string"?te.create(ie,fe):ie;return this.parent!=null&&this.parent.insertBefore(ce,this.next),ce.appendChild(this),ce},re.blotName="abstract",re}();X.default=ne},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(12),ne=ee(32),re=ee(33),ie=ee(1),fe=function(){function ce(se){this.attributes={},this.domNode=se,this.build()}return ce.prototype.attribute=function(se,oe){oe?se.add(this.domNode,oe)&&(se.value(this.domNode)!=null?this.attributes[se.attrName]=se:delete this.attributes[se.attrName]):(se.remove(this.domNode),delete this.attributes[se.attrName])},ce.prototype.build=function(){var se=this;this.attributes={};var oe=te.default.keys(this.domNode),ae=ne.default.keys(this.domNode),le=re.default.keys(this.domNode);oe.concat(ae).concat(le).forEach(function(pe){var ve=ie.query(pe,ie.Scope.ATTRIBUTE);ve instanceof te.default&&(se.attributes[ve.attrName]=ve)})},ce.prototype.copy=function(se){var oe=this;Object.keys(this.attributes).forEach(function(ae){var le=oe.attributes[ae].value(oe.domNode);se.format(ae,le)})},ce.prototype.move=function(se){var oe=this;this.copy(se),Object.keys(this.attributes).forEach(function(ae){oe.attributes[ae].remove(oe.domNode)}),this.attributes={}},ce.prototype.values=function(){var se=this;return Object.keys(this.attributes).reduce(function(oe,ae){return oe[ae]=se.attributes[ae].value(se.domNode),oe},{})},ce}();X.default=fe},function(j,X,ee){var te=this&&this.__extends||function(){var fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,se){ce.__proto__=se}||function(ce,se){for(var oe in se)se.hasOwnProperty(oe)&&(ce[oe]=se[oe])};return function(ce,se){fe(ce,se);function oe(){this.constructor=ce}ce.prototype=se===null?Object.create(se):(oe.prototype=se.prototype,new oe)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(12);function re(fe,ce){var se=fe.getAttribute("class")||"";return se.split(/\s+/).filter(function(oe){return oe.indexOf(ce+"-")===0})}var ie=function(fe){te(ce,fe);function ce(){return fe!==null&&fe.apply(this,arguments)||this}return ce.keys=function(se){return(se.getAttribute("class")||"").split(/\s+/).map(function(oe){return oe.split("-").slice(0,-1).join("-")})},ce.prototype.add=function(se,oe){return this.canAdd(se,oe)?(this.remove(se),se.classList.add(this.keyName+"-"+oe),!0):!1},ce.prototype.remove=function(se){var oe=re(se,this.keyName);oe.forEach(function(ae){se.classList.remove(ae)}),se.classList.length===0&&se.removeAttribute("class")},ce.prototype.value=function(se){var oe=re(se,this.keyName)[0]||"",ae=oe.slice(this.keyName.length+1);return this.canAdd(se,ae)?ae:""},ce}(ne.default);X.default=ie},function(j,X,ee){var te=this&&this.__extends||function(){var fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,se){ce.__proto__=se}||function(ce,se){for(var oe in se)se.hasOwnProperty(oe)&&(ce[oe]=se[oe])};return function(ce,se){fe(ce,se);function oe(){this.constructor=ce}ce.prototype=se===null?Object.create(se):(oe.prototype=se.prototype,new oe)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(12);function re(fe){var ce=fe.split("-"),se=ce.slice(1).map(function(oe){return oe[0].toUpperCase()+oe.slice(1)}).join("");return ce[0]+se}var ie=function(fe){te(ce,fe);function ce(){return fe!==null&&fe.apply(this,arguments)||this}return ce.keys=function(se){return(se.getAttribute("style")||"").split(";").map(function(oe){var ae=oe.split(":");return ae[0].trim()})},ce.prototype.add=function(se,oe){return this.canAdd(se,oe)?(se.style[re(this.keyName)]=oe,!0):!1},ce.prototype.remove=function(se){se.style[re(this.keyName)]="",se.getAttribute("style")||se.removeAttribute("style")},ce.prototype.value=function(se){var oe=se.style[re(this.keyName)];return this.canAdd(se,oe)?oe:""},ce}(ne.default);X.default=ie},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ie(fe,ce){for(var se=0;se<ce.length;se++){var oe=ce[se];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(fe,oe.key,oe)}}return function(fe,ce,se){return ce&&ie(fe.prototype,ce),se&&ie(fe,se),fe}}();function ne(ie,fe){if(!(ie instanceof fe))throw new TypeError("Cannot call a class as a function")}var re=function(){function ie(fe,ce){ne(this,ie),this.quill=fe,this.options=ce,this.modules={}}return te(ie,[{key:"init",value:function(){var ce=this;Object.keys(this.options.modules).forEach(function(se){ce.modules[se]==null&&ce.addModule(se)})}},{key:"addModule",value:function(ce){var se=this.quill.constructor.import("modules/"+ce);return this.modules[ce]=new se(this.quill,this.options.modules[ce]||{}),this.modules[ce]}}]),ie}();re.DEFAULTS={modules:{}},re.themes={default:re},X.default=re},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ge(de,ue){for(var he=0;he<ue.length;he++){var me=ue[he];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(de,me.key,me)}}return function(de,ue,he){return ue&&ge(de.prototype,ue),he&&ge(de,he),de}}(),ne=function ge(de,ue,he){de===null&&(de=Function.prototype);var me=Object.getOwnPropertyDescriptor(de,ue);if(me===void 0){var _e=Object.getPrototypeOf(de);return _e===null?void 0:ge(_e,ue,he)}else{if("value"in me)return me.value;var be=me.get;return be===void 0?void 0:be.call(he)}},re=ee(0),ie=se(re),fe=ee(7),ce=se(fe);function se(ge){return ge&&ge.__esModule?ge:{default:ge}}function oe(ge,de){if(!(ge instanceof de))throw new TypeError("Cannot call a class as a function")}function ae(ge,de){if(!ge)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return de&&(typeof de=="object"||typeof de=="function")?de:ge}function le(ge,de){if(typeof de!="function"&&de!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof de);ge.prototype=Object.create(de&&de.prototype,{constructor:{value:ge,enumerable:!1,writable:!0,configurable:!0}}),de&&(Object.setPrototypeOf?Object.setPrototypeOf(ge,de):ge.__proto__=de)}var pe="\uFEFF",ve=function(ge){le(de,ge);function de(ue){oe(this,de);var he=ae(this,(de.__proto__||Object.getPrototypeOf(de)).call(this,ue));return he.contentNode=document.createElement("span"),he.contentNode.setAttribute("contenteditable",!1),[].slice.call(he.domNode.childNodes).forEach(function(me){he.contentNode.appendChild(me)}),he.leftGuard=document.createTextNode(pe),he.rightGuard=document.createTextNode(pe),he.domNode.appendChild(he.leftGuard),he.domNode.appendChild(he.contentNode),he.domNode.appendChild(he.rightGuard),he}return te(de,[{key:"index",value:function(he,me){return he===this.leftGuard?0:he===this.rightGuard?1:ne(de.prototype.__proto__||Object.getPrototypeOf(de.prototype),"index",this).call(this,he,me)}},{key:"restore",value:function(he){var me=void 0,_e=void 0,be=he.data.split(pe).join("");if(he===this.leftGuard)if(this.prev instanceof ce.default){var Se=this.prev.length();this.prev.insertAt(Se,be),me={startNode:this.prev.domNode,startOffset:Se+be.length}}else _e=document.createTextNode(be),this.parent.insertBefore(ie.default.create(_e),this),me={startNode:_e,startOffset:be.length};else he===this.rightGuard&&(this.next instanceof ce.default?(this.next.insertAt(0,be),me={startNode:this.next.domNode,startOffset:be.length}):(_e=document.createTextNode(be),this.parent.insertBefore(ie.default.create(_e),this.next),me={startNode:_e,startOffset:be.length}));return he.data=pe,me}},{key:"update",value:function(he,me){var _e=this;he.forEach(function(be){if(be.type==="characterData"&&(be.target===_e.leftGuard||be.target===_e.rightGuard)){var Se=_e.restore(be.target);Se&&(me.range=Se)}})}}]),de}(ie.default.Embed);X.default=ve},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.AlignStyle=X.AlignClass=X.AlignAttribute=void 0;var te=ee(0),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}var ie={scope:ne.default.Scope.BLOCK,whitelist:["right","center","justify"]},fe=new ne.default.Attributor.Attribute("align","align",ie),ce=new ne.default.Attributor.Class("align","ql-align",ie),se=new ne.default.Attributor.Style("align","text-align",ie);X.AlignAttribute=fe,X.AlignClass=ce,X.AlignStyle=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.BackgroundStyle=X.BackgroundClass=void 0;var te=ee(0),ne=ie(te),re=ee(26);function ie(se){return se&&se.__esModule?se:{default:se}}var fe=new ne.default.Attributor.Class("background","ql-bg",{scope:ne.default.Scope.INLINE}),ce=new re.ColorAttributor("background","background-color",{scope:ne.default.Scope.INLINE});X.BackgroundClass=fe,X.BackgroundStyle=ce},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.DirectionStyle=X.DirectionClass=X.DirectionAttribute=void 0;var te=ee(0),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}var ie={scope:ne.default.Scope.BLOCK,whitelist:["rtl"]},fe=new ne.default.Attributor.Attribute("direction","dir",ie),ce=new ne.default.Attributor.Class("direction","ql-direction",ie),se=new ne.default.Attributor.Style("direction","direction",ie);X.DirectionAttribute=fe,X.DirectionClass=ce,X.DirectionStyle=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.FontClass=X.FontStyle=void 0;var te=function(){function ge(de,ue){for(var he=0;he<ue.length;he++){var me=ue[he];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(de,me.key,me)}}return function(de,ue,he){return ue&&ge(de.prototype,ue),he&&ge(de,he),de}}(),ne=function ge(de,ue,he){de===null&&(de=Function.prototype);var me=Object.getOwnPropertyDescriptor(de,ue);if(me===void 0){var _e=Object.getPrototypeOf(de);return _e===null?void 0:ge(_e,ue,he)}else{if("value"in me)return me.value;var be=me.get;return be===void 0?void 0:be.call(he)}},re=ee(0),ie=fe(re);function fe(ge){return ge&&ge.__esModule?ge:{default:ge}}function ce(ge,de){if(!(ge instanceof de))throw new TypeError("Cannot call a class as a function")}function se(ge,de){if(!ge)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return de&&(typeof de=="object"||typeof de=="function")?de:ge}function oe(ge,de){if(typeof de!="function"&&de!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof de);ge.prototype=Object.create(de&&de.prototype,{constructor:{value:ge,enumerable:!1,writable:!0,configurable:!0}}),de&&(Object.setPrototypeOf?Object.setPrototypeOf(ge,de):ge.__proto__=de)}var ae={scope:ie.default.Scope.INLINE,whitelist:["serif","monospace"]},le=new ie.default.Attributor.Class("font","ql-font",ae),pe=function(ge){oe(de,ge);function de(){return ce(this,de),se(this,(de.__proto__||Object.getPrototypeOf(de)).apply(this,arguments))}return te(de,[{key:"value",value:function(he){return ne(de.prototype.__proto__||Object.getPrototypeOf(de.prototype),"value",this).call(this,he).replace(/["']/g,"")}}]),de}(ie.default.Attributor.Style),ve=new pe("font","font-family",ae);X.FontStyle=ve,X.FontClass=le},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.SizeStyle=X.SizeClass=void 0;var te=ee(0),ne=re(te);function re(ce){return ce&&ce.__esModule?ce:{default:ce}}var ie=new ne.default.Attributor.Class("size","ql-size",{scope:ne.default.Scope.INLINE,whitelist:["small","large","huge"]}),fe=new ne.default.Attributor.Style("size","font-size",{scope:ne.default.Scope.INLINE,whitelist:["10px","18px","32px"]});X.SizeClass=ie,X.SizeStyle=fe},function(j,X,ee){j.exports={align:{"":ee(76),center:ee(77),right:ee(78),justify:ee(79)},background:ee(80),blockquote:ee(81),bold:ee(82),clean:ee(83),code:ee(58),"code-block":ee(58),color:ee(84),direction:{"":ee(85),rtl:ee(86)},float:{center:ee(87),full:ee(88),left:ee(89),right:ee(90)},formula:ee(91),header:{1:ee(92),2:ee(93)},italic:ee(94),image:ee(95),indent:{"+1":ee(96),"-1":ee(97)},link:ee(98),list:{ordered:ee(99),bullet:ee(100),check:ee(101)},script:{sub:ee(102),super:ee(103)},strike:ee(104),underline:ee(105),video:ee(106)}},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.getLastChangeIndex=X.default=void 0;var te=function(){function ue(he,me){for(var _e=0;_e<me.length;_e++){var be=me[_e];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(he,be.key,be)}}return function(he,me,_e){return me&&ue(he.prototype,me),_e&&ue(he,_e),he}}(),ne=ee(0),re=oe(ne),ie=ee(5),fe=oe(ie),ce=ee(9),se=oe(ce);function oe(ue){return ue&&ue.__esModule?ue:{default:ue}}function ae(ue,he){if(!(ue instanceof he))throw new TypeError("Cannot call a class as a function")}function le(ue,he){if(!ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return he&&(typeof he=="object"||typeof he=="function")?he:ue}function pe(ue,he){if(typeof he!="function"&&he!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof he);ue.prototype=Object.create(he&&he.prototype,{constructor:{value:ue,enumerable:!1,writable:!0,configurable:!0}}),he&&(Object.setPrototypeOf?Object.setPrototypeOf(ue,he):ue.__proto__=he)}var ve=function(ue){pe(he,ue);function he(me,_e){ae(this,he);var be=le(this,(he.__proto__||Object.getPrototypeOf(he)).call(this,me,_e));return be.lastRecorded=0,be.ignoreChange=!1,be.clear(),be.quill.on(fe.default.events.EDITOR_CHANGE,function(Se,Te,we,ke){Se!==fe.default.events.TEXT_CHANGE||be.ignoreChange||(!be.options.userOnly||ke===fe.default.sources.USER?be.record(Te,we):be.transform(Te))}),be.quill.keyboard.addBinding({key:"Z",shortKey:!0},be.undo.bind(be)),be.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},be.redo.bind(be)),/Win/i.test(navigator.platform)&&be.quill.keyboard.addBinding({key:"Y",shortKey:!0},be.redo.bind(be)),be}return te(he,[{key:"change",value:function(_e,be){if(this.stack[_e].length!==0){var Se=this.stack[_e].pop();this.stack[be].push(Se),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(Se[_e],fe.default.sources.USER),this.ignoreChange=!1;var Te=de(Se[_e]);this.quill.setSelection(Te)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(_e,be){if(_e.ops.length!==0){this.stack.redo=[];var Se=this.quill.getContents().diff(be),Te=Date.now();if(this.lastRecorded+this.options.delay>Te&&this.stack.undo.length>0){var we=this.stack.undo.pop();Se=Se.compose(we.undo),_e=we.redo.compose(_e)}else this.lastRecorded=Te;this.stack.undo.push({redo:_e,undo:Se}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(_e){this.stack.undo.forEach(function(be){be.undo=_e.transform(be.undo,!0),be.redo=_e.transform(be.redo,!0)}),this.stack.redo.forEach(function(be){be.undo=_e.transform(be.undo,!0),be.redo=_e.transform(be.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),he}(se.default);ve.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function ge(ue){var he=ue.ops[ue.ops.length-1];return he==null?!1:he.insert!=null?typeof he.insert=="string"&&he.insert.endsWith(`
`):he.attributes!=null?Object.keys(he.attributes).some(function(me){return re.default.query(me,re.default.Scope.BLOCK)!=null}):!1}function de(ue){var he=ue.reduce(function(_e,be){return _e+=be.delete||0,_e},0),me=ue.length()-he;return ge(ue)&&(me-=1),me}X.default=ve,X.getLastChangeIndex=de},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.BaseTooltip=void 0;var te=function(){function Ue(Pe,We){for(var Ye=0;Ye<We.length;Ye++){var Ne=We[Ye];Ne.enumerable=Ne.enumerable||!1,Ne.configurable=!0,"value"in Ne&&(Ne.writable=!0),Object.defineProperty(Pe,Ne.key,Ne)}}return function(Pe,We,Ye){return We&&Ue(Pe.prototype,We),Ye&&Ue(Pe,Ye),Pe}}(),ne=function Ue(Pe,We,Ye){Pe===null&&(Pe=Function.prototype);var Ne=Object.getOwnPropertyDescriptor(Pe,We);if(Ne===void 0){var Ke=Object.getPrototypeOf(Pe);return Ke===null?void 0:Ue(Ke,We,Ye)}else{if("value"in Ne)return Ne.value;var Xe=Ne.get;return Xe===void 0?void 0:Xe.call(Ye)}},re=ee(3),ie=Te(re),fe=ee(2),ce=Te(fe),se=ee(8),oe=Te(se),ae=ee(23),le=Te(ae),pe=ee(34),ve=Te(pe),ge=ee(59),de=Te(ge),ue=ee(60),he=Te(ue),me=ee(28),_e=Te(me),be=ee(61),Se=Te(be);function Te(Ue){return Ue&&Ue.__esModule?Ue:{default:Ue}}function we(Ue,Pe){if(!(Ue instanceof Pe))throw new TypeError("Cannot call a class as a function")}function ke(Ue,Pe){if(!Ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pe&&(typeof Pe=="object"||typeof Pe=="function")?Pe:Ue}function xe(Ue,Pe){if(typeof Pe!="function"&&Pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Pe);Ue.prototype=Object.create(Pe&&Pe.prototype,{constructor:{value:Ue,enumerable:!1,writable:!0,configurable:!0}}),Pe&&(Object.setPrototypeOf?Object.setPrototypeOf(Ue,Pe):Ue.__proto__=Pe)}var Ae=[!1,"center","right","justify"],Le=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],De=[!1,"serif","monospace"],$e=["1","2","3",!1],Ve=["small",!1,"large","huge"],Qe=function(Ue){xe(Pe,Ue);function Pe(We,Ye){we(this,Pe);var Ne=ke(this,(Pe.__proto__||Object.getPrototypeOf(Pe)).call(this,We,Ye)),Ke=function Xe(Je){if(!document.body.contains(We.root))return document.body.removeEventListener("click",Xe);Ne.tooltip!=null&&!Ne.tooltip.root.contains(Je.target)&&document.activeElement!==Ne.tooltip.textbox&&!Ne.quill.hasFocus()&&Ne.tooltip.hide(),Ne.pickers!=null&&Ne.pickers.forEach(function(nt){nt.container.contains(Je.target)||nt.close()})};return We.emitter.listenDOM("click",document.body,Ke),Ne}return te(Pe,[{key:"addModule",value:function(Ye){var Ne=ne(Pe.prototype.__proto__||Object.getPrototypeOf(Pe.prototype),"addModule",this).call(this,Ye);return Ye==="toolbar"&&this.extendToolbar(Ne),Ne}},{key:"buildButtons",value:function(Ye,Ne){Ye.forEach(function(Ke){var Xe=Ke.getAttribute("class")||"";Xe.split(/\s+/).forEach(function(Je){if(!!Je.startsWith("ql-")&&(Je=Je.slice(3),Ne[Je]!=null))if(Je==="direction")Ke.innerHTML=Ne[Je][""]+Ne[Je].rtl;else if(typeof Ne[Je]=="string")Ke.innerHTML=Ne[Je];else{var nt=Ke.value||"";nt!=null&&Ne[Je][nt]&&(Ke.innerHTML=Ne[Je][nt])}})})}},{key:"buildPickers",value:function(Ye,Ne){var Ke=this;this.pickers=Ye.map(function(Je){if(Je.classList.contains("ql-align"))return Je.querySelector("option")==null&&Ie(Je,Ae),new he.default(Je,Ne.align);if(Je.classList.contains("ql-background")||Je.classList.contains("ql-color")){var nt=Je.classList.contains("ql-background")?"background":"color";return Je.querySelector("option")==null&&Ie(Je,Le,nt==="background"?"#ffffff":"#000000"),new de.default(Je,Ne[nt])}else return Je.querySelector("option")==null&&(Je.classList.contains("ql-font")?Ie(Je,De):Je.classList.contains("ql-header")?Ie(Je,$e):Je.classList.contains("ql-size")&&Ie(Je,Ve)),new _e.default(Je)});var Xe=function(){Ke.pickers.forEach(function(nt){nt.update()})};this.quill.on(oe.default.events.EDITOR_CHANGE,Xe)}}]),Pe}(ve.default);Qe.DEFAULTS=(0,ie.default)(!0,{},ve.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var Pe=this,We=this.container.querySelector("input.ql-image[type=file]");We==null&&(We=document.createElement("input"),We.setAttribute("type","file"),We.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),We.classList.add("ql-image"),We.addEventListener("change",function(){if(We.files!=null&&We.files[0]!=null){var Ye=new FileReader;Ye.onload=function(Ne){var Ke=Pe.quill.getSelection(!0);Pe.quill.updateContents(new ce.default().retain(Ke.index).delete(Ke.length).insert({image:Ne.target.result}),oe.default.sources.USER),Pe.quill.setSelection(Ke.index+1,oe.default.sources.SILENT),We.value=""},Ye.readAsDataURL(We.files[0])}}),this.container.appendChild(We)),We.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var je=function(Ue){xe(Pe,Ue);function Pe(We,Ye){we(this,Pe);var Ne=ke(this,(Pe.__proto__||Object.getPrototypeOf(Pe)).call(this,We,Ye));return Ne.textbox=Ne.root.querySelector('input[type="text"]'),Ne.listen(),Ne}return te(Pe,[{key:"listen",value:function(){var Ye=this;this.textbox.addEventListener("keydown",function(Ne){le.default.match(Ne,"enter")?(Ye.save(),Ne.preventDefault()):le.default.match(Ne,"escape")&&(Ye.cancel(),Ne.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Ne!=null?this.textbox.value=Ne:Ye!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+Ye)||""),this.root.setAttribute("data-mode",Ye)}},{key:"restoreFocus",value:function(){var Ye=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=Ye}},{key:"save",value:function(){var Ye=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Ne=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",Ye,oe.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",Ye,oe.default.sources.USER)),this.quill.root.scrollTop=Ne;break}case"video":Ye=He(Ye);case"formula":{if(!Ye)break;var Ke=this.quill.getSelection(!0);if(Ke!=null){var Xe=Ke.index+Ke.length;this.quill.insertEmbed(Xe,this.root.getAttribute("data-mode"),Ye,oe.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(Xe+1," ",oe.default.sources.USER),this.quill.setSelection(Xe+2,oe.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),Pe}(Se.default);function He(Ue){var Pe=Ue.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||Ue.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return Pe?(Pe[1]||"https")+"://www.youtube.com/embed/"+Pe[2]+"?showinfo=0":(Pe=Ue.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(Pe[1]||"https")+"://player.vimeo.com/video/"+Pe[2]+"/":Ue}function Ie(Ue,Pe){var We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Pe.forEach(function(Ye){var Ne=document.createElement("option");Ye===We?Ne.setAttribute("selected","selected"):Ne.setAttribute("value",Ye),Ue.appendChild(Ne)})}X.BaseTooltip=je,X.default=Qe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ne(){this.head=this.tail=null,this.length=0}return ne.prototype.append=function(){for(var re=[],ie=0;ie<arguments.length;ie++)re[ie]=arguments[ie];this.insertBefore(re[0],null),re.length>1&&this.append.apply(this,re.slice(1))},ne.prototype.contains=function(re){for(var ie,fe=this.iterator();ie=fe();)if(ie===re)return!0;return!1},ne.prototype.insertBefore=function(re,ie){!re||(re.next=ie,ie!=null?(re.prev=ie.prev,ie.prev!=null&&(ie.prev.next=re),ie.prev=re,ie===this.head&&(this.head=re)):this.tail!=null?(this.tail.next=re,re.prev=this.tail,this.tail=re):(re.prev=null,this.head=this.tail=re),this.length+=1)},ne.prototype.offset=function(re){for(var ie=0,fe=this.head;fe!=null;){if(fe===re)return ie;ie+=fe.length(),fe=fe.next}return-1},ne.prototype.remove=function(re){!this.contains(re)||(re.prev!=null&&(re.prev.next=re.next),re.next!=null&&(re.next.prev=re.prev),re===this.head&&(this.head=re.next),re===this.tail&&(this.tail=re.prev),this.length-=1)},ne.prototype.iterator=function(re){return re===void 0&&(re=this.head),function(){var ie=re;return re!=null&&(re=re.next),ie}},ne.prototype.find=function(re,ie){ie===void 0&&(ie=!1);for(var fe,ce=this.iterator();fe=ce();){var se=fe.length();if(re<se||ie&&re===se&&(fe.next==null||fe.next.length()!==0))return[fe,re];re-=se}return[null,0]},ne.prototype.forEach=function(re){for(var ie,fe=this.iterator();ie=fe();)re(ie)},ne.prototype.forEachAt=function(re,ie,fe){if(!(ie<=0))for(var ce=this.find(re),se=ce[0],oe=ce[1],ae,le=re-oe,pe=this.iterator(se);(ae=pe())&&le<re+ie;){var ve=ae.length();re>le?fe(ae,re-le,Math.min(ie,le+ve-re)):fe(ae,0,Math.min(ve,re+ie-le)),le+=ve}},ne.prototype.map=function(re){return this.reduce(function(ie,fe){return ie.push(re(fe)),ie},[])},ne.prototype.reduce=function(re,ie){for(var fe,ce=this.iterator();fe=ce();)ie=re(ie,fe);return ie},ne}();X.default=te},function(j,X,ee){var te=this&&this.__extends||function(){var se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(oe,ae){oe.__proto__=ae}||function(oe,ae){for(var le in ae)ae.hasOwnProperty(le)&&(oe[le]=ae[le])};return function(oe,ae){se(oe,ae);function le(){this.constructor=oe}oe.prototype=ae===null?Object.create(ae):(le.prototype=ae.prototype,new le)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(17),re=ee(1),ie={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},fe=100,ce=function(se){te(oe,se);function oe(ae){var le=se.call(this,ae)||this;return le.scroll=le,le.observer=new MutationObserver(function(pe){le.update(pe)}),le.observer.observe(le.domNode,ie),le.attach(),le}return oe.prototype.detach=function(){se.prototype.detach.call(this),this.observer.disconnect()},oe.prototype.deleteAt=function(ae,le){this.update(),ae===0&&le===this.length()?this.children.forEach(function(pe){pe.remove()}):se.prototype.deleteAt.call(this,ae,le)},oe.prototype.formatAt=function(ae,le,pe,ve){this.update(),se.prototype.formatAt.call(this,ae,le,pe,ve)},oe.prototype.insertAt=function(ae,le,pe){this.update(),se.prototype.insertAt.call(this,ae,le,pe)},oe.prototype.optimize=function(ae,le){var pe=this;ae===void 0&&(ae=[]),le===void 0&&(le={}),se.prototype.optimize.call(this,le);for(var ve=[].slice.call(this.observer.takeRecords());ve.length>0;)ae.push(ve.pop());for(var ge=function(me,_e){_e===void 0&&(_e=!0),!(me==null||me===pe)&&me.domNode.parentNode!=null&&(me.domNode[re.DATA_KEY].mutations==null&&(me.domNode[re.DATA_KEY].mutations=[]),_e&&ge(me.parent))},de=function(me){me.domNode[re.DATA_KEY]==null||me.domNode[re.DATA_KEY].mutations==null||(me instanceof ne.default&&me.children.forEach(de),me.optimize(le))},ue=ae,he=0;ue.length>0;he+=1){if(he>=fe)throw new Error("[Parchment] Maximum optimize iterations reached");for(ue.forEach(function(me){var _e=re.find(me.target,!0);_e!=null&&(_e.domNode===me.target&&(me.type==="childList"?(ge(re.find(me.previousSibling,!1)),[].forEach.call(me.addedNodes,function(be){var Se=re.find(be,!1);ge(Se,!1),Se instanceof ne.default&&Se.children.forEach(function(Te){ge(Te,!1)})})):me.type==="attributes"&&ge(_e.prev)),ge(_e))}),this.children.forEach(de),ue=[].slice.call(this.observer.takeRecords()),ve=ue.slice();ve.length>0;)ae.push(ve.pop())}},oe.prototype.update=function(ae,le){var pe=this;le===void 0&&(le={}),ae=ae||this.observer.takeRecords(),ae.map(function(ve){var ge=re.find(ve.target,!0);return ge==null?null:ge.domNode[re.DATA_KEY].mutations==null?(ge.domNode[re.DATA_KEY].mutations=[ve],ge):(ge.domNode[re.DATA_KEY].mutations.push(ve),null)}).forEach(function(ve){ve==null||ve===pe||ve.domNode[re.DATA_KEY]==null||ve.update(ve.domNode[re.DATA_KEY].mutations||[],le)}),this.domNode[re.DATA_KEY].mutations!=null&&se.prototype.update.call(this,this.domNode[re.DATA_KEY].mutations,le),this.optimize(ae,le)},oe.blotName="scroll",oe.defaultChild="block",oe.scope=re.Scope.BLOCK_BLOT,oe.tagName="DIV",oe}(ne.default);X.default=ce},function(j,X,ee){var te=this&&this.__extends||function(){var ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(se,oe){se.__proto__=oe}||function(se,oe){for(var ae in oe)oe.hasOwnProperty(ae)&&(se[ae]=oe[ae])};return function(se,oe){ce(se,oe);function ae(){this.constructor=se}se.prototype=oe===null?Object.create(oe):(ae.prototype=oe.prototype,new ae)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(18),re=ee(1);function ie(ce,se){if(Object.keys(ce).length!==Object.keys(se).length)return!1;for(var oe in ce)if(ce[oe]!==se[oe])return!1;return!0}var fe=function(ce){te(se,ce);function se(){return ce!==null&&ce.apply(this,arguments)||this}return se.formats=function(oe){if(oe.tagName!==se.tagName)return ce.formats.call(this,oe)},se.prototype.format=function(oe,ae){var le=this;oe===this.statics.blotName&&!ae?(this.children.forEach(function(pe){pe instanceof ne.default||(pe=pe.wrap(se.blotName,!0)),le.attributes.copy(pe)}),this.unwrap()):ce.prototype.format.call(this,oe,ae)},se.prototype.formatAt=function(oe,ae,le,pe){if(this.formats()[le]!=null||re.query(le,re.Scope.ATTRIBUTE)){var ve=this.isolate(oe,ae);ve.format(le,pe)}else ce.prototype.formatAt.call(this,oe,ae,le,pe)},se.prototype.optimize=function(oe){ce.prototype.optimize.call(this,oe);var ae=this.formats();if(Object.keys(ae).length===0)return this.unwrap();var le=this.next;le instanceof se&&le.prev===this&&ie(ae,le.formats())&&(le.moveChildren(this),le.remove())},se.blotName="inline",se.scope=re.Scope.INLINE_BLOT,se.tagName="SPAN",se}(ne.default);X.default=fe},function(j,X,ee){var te=this&&this.__extends||function(){var fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,se){ce.__proto__=se}||function(ce,se){for(var oe in se)se.hasOwnProperty(oe)&&(ce[oe]=se[oe])};return function(ce,se){fe(ce,se);function oe(){this.constructor=ce}ce.prototype=se===null?Object.create(se):(oe.prototype=se.prototype,new oe)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(18),re=ee(1),ie=function(fe){te(ce,fe);function ce(){return fe!==null&&fe.apply(this,arguments)||this}return ce.formats=function(se){var oe=re.query(ce.blotName).tagName;if(se.tagName!==oe)return fe.formats.call(this,se)},ce.prototype.format=function(se,oe){re.query(se,re.Scope.BLOCK)!=null&&(se===this.statics.blotName&&!oe?this.replaceWith(ce.blotName):fe.prototype.format.call(this,se,oe))},ce.prototype.formatAt=function(se,oe,ae,le){re.query(ae,re.Scope.BLOCK)!=null?this.format(ae,le):fe.prototype.formatAt.call(this,se,oe,ae,le)},ce.prototype.insertAt=function(se,oe,ae){if(ae==null||re.query(oe,re.Scope.INLINE)!=null)fe.prototype.insertAt.call(this,se,oe,ae);else{var le=this.split(se),pe=re.create(oe,ae);le.parent.insertBefore(pe,le)}},ce.prototype.update=function(se,oe){navigator.userAgent.match(/Trident/)?this.build():fe.prototype.update.call(this,se,oe)},ce.blotName="block",ce.scope=re.Scope.BLOCK_BLOT,ce.tagName="P",ce}(ne.default);X.default=ie},function(j,X,ee){var te=this&&this.__extends||function(){var ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(fe,ce){fe.__proto__=ce}||function(fe,ce){for(var se in ce)ce.hasOwnProperty(se)&&(fe[se]=ce[se])};return function(fe,ce){ie(fe,ce);function se(){this.constructor=fe}fe.prototype=ce===null?Object.create(ce):(se.prototype=ce.prototype,new se)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(19),re=function(ie){te(fe,ie);function fe(){return ie!==null&&ie.apply(this,arguments)||this}return fe.formats=function(ce){},fe.prototype.format=function(ce,se){ie.prototype.formatAt.call(this,0,this.length(),ce,se)},fe.prototype.formatAt=function(ce,se,oe,ae){ce===0&&se===this.length()?this.format(oe,ae):ie.prototype.formatAt.call(this,ce,se,oe,ae)},fe.prototype.formats=function(){return this.statics.formats(this.domNode)},fe}(ne.default);X.default=re},function(j,X,ee){var te=this&&this.__extends||function(){var fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,se){ce.__proto__=se}||function(ce,se){for(var oe in se)se.hasOwnProperty(oe)&&(ce[oe]=se[oe])};return function(ce,se){fe(ce,se);function oe(){this.constructor=ce}ce.prototype=se===null?Object.create(se):(oe.prototype=se.prototype,new oe)}}();Object.defineProperty(X,"__esModule",{value:!0});var ne=ee(19),re=ee(1),ie=function(fe){te(ce,fe);function ce(se){var oe=fe.call(this,se)||this;return oe.text=oe.statics.value(oe.domNode),oe}return ce.create=function(se){return document.createTextNode(se)},ce.value=function(se){var oe=se.data;return oe.normalize&&(oe=oe.normalize()),oe},ce.prototype.deleteAt=function(se,oe){this.domNode.data=this.text=this.text.slice(0,se)+this.text.slice(se+oe)},ce.prototype.index=function(se,oe){return this.domNode===se?oe:-1},ce.prototype.insertAt=function(se,oe,ae){ae==null?(this.text=this.text.slice(0,se)+oe+this.text.slice(se),this.domNode.data=this.text):fe.prototype.insertAt.call(this,se,oe,ae)},ce.prototype.length=function(){return this.text.length},ce.prototype.optimize=function(se){fe.prototype.optimize.call(this,se),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof ce&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},ce.prototype.position=function(se,oe){return[this.domNode,se]},ce.prototype.split=function(se,oe){if(oe===void 0&&(oe=!1),!oe){if(se===0)return this;if(se===this.length())return this.next}var ae=re.create(this.domNode.splitText(se));return this.parent.insertBefore(ae,this.next),this.text=this.statics.value(this.domNode),ae},ce.prototype.update=function(se,oe){var ae=this;se.some(function(le){return le.type==="characterData"&&le.target===ae.domNode})&&(this.text=this.statics.value(this.domNode))},ce.prototype.value=function(){return this.text},ce.blotName="text",ce.scope=re.Scope.INLINE_BLOT,ce}(ne.default);X.default=ie},function(j,X,ee){var te=document.createElement("div");if(te.classList.toggle("test-class",!1),te.classList.contains("test-class")){var ne=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(re,ie){return arguments.length>1&&!this.contains(re)==!ie?ie:ne.call(this,re)}}String.prototype.startsWith||(String.prototype.startsWith=function(re,ie){return ie=ie||0,this.substr(ie,re.length)===re}),String.prototype.endsWith||(String.prototype.endsWith=function(re,ie){var fe=this.toString();(typeof ie!="number"||!isFinite(ie)||Math.floor(ie)!==ie||ie>fe.length)&&(ie=fe.length),ie-=re.length;var ce=fe.indexOf(re,ie);return ce!==-1&&ce===ie}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(ie){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof ie!="function")throw new TypeError("predicate must be a function");for(var fe=Object(this),ce=fe.length>>>0,se=arguments[1],oe,ae=0;ae<ce;ae++)if(oe=fe[ae],ie.call(se,oe,ae,fe))return oe}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(j,X){var ee=-1,te=1,ne=0;function re(he,me,_e){if(he==me)return he?[[ne,he]]:[];(_e<0||he.length<_e)&&(_e=null);var be=se(he,me),Se=he.substring(0,be);he=he.substring(be),me=me.substring(be),be=oe(he,me);var Te=he.substring(he.length-be);he=he.substring(0,he.length-be),me=me.substring(0,me.length-be);var we=ie(he,me);return Se&&we.unshift([ne,Se]),Te&&we.push([ne,Te]),le(we),_e!=null&&(we=ge(we,_e)),we=de(we),we}function ie(he,me){var _e;if(!he)return[[te,me]];if(!me)return[[ee,he]];var be=he.length>me.length?he:me,Se=he.length>me.length?me:he,Te=be.indexOf(Se);if(Te!=-1)return _e=[[te,be.substring(0,Te)],[ne,Se],[te,be.substring(Te+Se.length)]],he.length>me.length&&(_e[0][0]=_e[2][0]=ee),_e;if(Se.length==1)return[[ee,he],[te,me]];var we=ae(he,me);if(we){var ke=we[0],xe=we[1],Ae=we[2],Le=we[3],De=we[4],$e=re(ke,Ae),Ve=re(xe,Le);return $e.concat([[ne,De]],Ve)}return fe(he,me)}function fe(he,me){for(var _e=he.length,be=me.length,Se=Math.ceil((_e+be)/2),Te=Se,we=2*Se,ke=new Array(we),xe=new Array(we),Ae=0;Ae<we;Ae++)ke[Ae]=-1,xe[Ae]=-1;ke[Te+1]=0,xe[Te+1]=0;for(var Le=_e-be,De=Le%2!=0,$e=0,Ve=0,Qe=0,je=0,He=0;He<Se;He++){for(var Ie=-He+$e;Ie<=He-Ve;Ie+=2){var Ue=Te+Ie,Pe;Ie==-He||Ie!=He&&ke[Ue-1]<ke[Ue+1]?Pe=ke[Ue+1]:Pe=ke[Ue-1]+1;for(var We=Pe-Ie;Pe<_e&&We<be&&he.charAt(Pe)==me.charAt(We);)Pe++,We++;if(ke[Ue]=Pe,Pe>_e)Ve+=2;else if(We>be)$e+=2;else if(De){var Ye=Te+Le-Ie;if(Ye>=0&&Ye<we&&xe[Ye]!=-1){var Ne=_e-xe[Ye];if(Pe>=Ne)return ce(he,me,Pe,We)}}}for(var Ke=-He+Qe;Ke<=He-je;Ke+=2){var Ye=Te+Ke,Ne;Ke==-He||Ke!=He&&xe[Ye-1]<xe[Ye+1]?Ne=xe[Ye+1]:Ne=xe[Ye-1]+1;for(var Xe=Ne-Ke;Ne<_e&&Xe<be&&he.charAt(_e-Ne-1)==me.charAt(be-Xe-1);)Ne++,Xe++;if(xe[Ye]=Ne,Ne>_e)je+=2;else if(Xe>be)Qe+=2;else if(!De){var Ue=Te+Le-Ke;if(Ue>=0&&Ue<we&&ke[Ue]!=-1){var Pe=ke[Ue],We=Te+Pe-Ue;if(Ne=_e-Ne,Pe>=Ne)return ce(he,me,Pe,We)}}}}return[[ee,he],[te,me]]}function ce(he,me,_e,be){var Se=he.substring(0,_e),Te=me.substring(0,be),we=he.substring(_e),ke=me.substring(be),xe=re(Se,Te),Ae=re(we,ke);return xe.concat(Ae)}function se(he,me){if(!he||!me||he.charAt(0)!=me.charAt(0))return 0;for(var _e=0,be=Math.min(he.length,me.length),Se=be,Te=0;_e<Se;)he.substring(Te,Se)==me.substring(Te,Se)?(_e=Se,Te=_e):be=Se,Se=Math.floor((be-_e)/2+_e);return Se}function oe(he,me){if(!he||!me||he.charAt(he.length-1)!=me.charAt(me.length-1))return 0;for(var _e=0,be=Math.min(he.length,me.length),Se=be,Te=0;_e<Se;)he.substring(he.length-Se,he.length-Te)==me.substring(me.length-Se,me.length-Te)?(_e=Se,Te=_e):be=Se,Se=Math.floor((be-_e)/2+_e);return Se}function ae(he,me){var _e=he.length>me.length?he:me,be=he.length>me.length?me:he;if(_e.length<4||be.length*2<_e.length)return null;function Se(Ve,Qe,je){for(var He=Ve.substring(je,je+Math.floor(Ve.length/4)),Ie=-1,Ue="",Pe,We,Ye,Ne;(Ie=Qe.indexOf(He,Ie+1))!=-1;){var Ke=se(Ve.substring(je),Qe.substring(Ie)),Xe=oe(Ve.substring(0,je),Qe.substring(0,Ie));Ue.length<Xe+Ke&&(Ue=Qe.substring(Ie-Xe,Ie)+Qe.substring(Ie,Ie+Ke),Pe=Ve.substring(0,je-Xe),We=Ve.substring(je+Ke),Ye=Qe.substring(0,Ie-Xe),Ne=Qe.substring(Ie+Ke))}return Ue.length*2>=Ve.length?[Pe,We,Ye,Ne,Ue]:null}var Te=Se(_e,be,Math.ceil(_e.length/4)),we=Se(_e,be,Math.ceil(_e.length/2)),ke;if(!Te&&!we)return null;we?Te?ke=Te[4].length>we[4].length?Te:we:ke=we:ke=Te;var xe,Ae,Le,De;he.length>me.length?(xe=ke[0],Ae=ke[1],Le=ke[2],De=ke[3]):(Le=ke[0],De=ke[1],xe=ke[2],Ae=ke[3]);var $e=ke[4];return[xe,Ae,Le,De,$e]}function le(he){he.push([ne,""]);for(var me=0,_e=0,be=0,Se="",Te="",we;me<he.length;)switch(he[me][0]){case te:be++,Te+=he[me][1],me++;break;case ee:_e++,Se+=he[me][1],me++;break;case ne:_e+be>1?(_e!==0&&be!==0&&(we=se(Te,Se),we!==0&&(me-_e-be>0&&he[me-_e-be-1][0]==ne?he[me-_e-be-1][1]+=Te.substring(0,we):(he.splice(0,0,[ne,Te.substring(0,we)]),me++),Te=Te.substring(we),Se=Se.substring(we)),we=oe(Te,Se),we!==0&&(he[me][1]=Te.substring(Te.length-we)+he[me][1],Te=Te.substring(0,Te.length-we),Se=Se.substring(0,Se.length-we))),_e===0?he.splice(me-be,_e+be,[te,Te]):be===0?he.splice(me-_e,_e+be,[ee,Se]):he.splice(me-_e-be,_e+be,[ee,Se],[te,Te]),me=me-_e-be+(_e?1:0)+(be?1:0)+1):me!==0&&he[me-1][0]==ne?(he[me-1][1]+=he[me][1],he.splice(me,1)):me++,be=0,_e=0,Se="",Te="";break}he[he.length-1][1]===""&&he.pop();var ke=!1;for(me=1;me<he.length-1;)he[me-1][0]==ne&&he[me+1][0]==ne&&(he[me][1].substring(he[me][1].length-he[me-1][1].length)==he[me-1][1]?(he[me][1]=he[me-1][1]+he[me][1].substring(0,he[me][1].length-he[me-1][1].length),he[me+1][1]=he[me-1][1]+he[me+1][1],he.splice(me-1,1),ke=!0):he[me][1].substring(0,he[me+1][1].length)==he[me+1][1]&&(he[me-1][1]+=he[me+1][1],he[me][1]=he[me][1].substring(he[me+1][1].length)+he[me+1][1],he.splice(me+1,1),ke=!0)),me++;ke&&le(he)}var pe=re;pe.INSERT=te,pe.DELETE=ee,pe.EQUAL=ne,j.exports=pe;function ve(he,me){if(me===0)return[ne,he];for(var _e=0,be=0;be<he.length;be++){var Se=he[be];if(Se[0]===ee||Se[0]===ne){var Te=_e+Se[1].length;if(me===Te)return[be+1,he];if(me<Te){he=he.slice();var we=me-_e,ke=[Se[0],Se[1].slice(0,we)],xe=[Se[0],Se[1].slice(we)];return he.splice(be,1,ke,xe),[be+1,he]}else _e=Te}}throw new Error("cursor_pos is out of bounds!")}function ge(he,me){var _e=ve(he,me),be=_e[1],Se=_e[0],Te=be[Se],we=be[Se+1];if(Te==null)return he;if(Te[0]!==ne)return he;if(we!=null&&Te[1]+we[1]===we[1]+Te[1])return be.splice(Se,2,we,Te),ue(be,Se,2);if(we!=null&&we[1].indexOf(Te[1])===0){be.splice(Se,2,[we[0],Te[1]],[0,Te[1]]);var ke=we[1].slice(Te[1].length);return ke.length>0&&be.splice(Se+2,0,[we[0],ke]),ue(be,Se,3)}else return he}function de(he){for(var me=!1,_e=function(we){return we.charCodeAt(0)>=56320&&we.charCodeAt(0)<=57343},be=function(we){return we.charCodeAt(we.length-1)>=55296&&we.charCodeAt(we.length-1)<=56319},Se=2;Se<he.length;Se+=1)he[Se-2][0]===ne&&be(he[Se-2][1])&&he[Se-1][0]===ee&&_e(he[Se-1][1])&&he[Se][0]===te&&_e(he[Se][1])&&(me=!0,he[Se-1][1]=he[Se-2][1].slice(-1)+he[Se-1][1],he[Se][1]=he[Se-2][1].slice(-1)+he[Se][1],he[Se-2][1]=he[Se-2][1].slice(0,-1));if(!me)return he;for(var Te=[],Se=0;Se<he.length;Se+=1)he[Se][1].length>0&&Te.push(he[Se]);return Te}function ue(he,me,_e){for(var be=me+_e-1;be>=0&&be>=me-1;be--)if(be+1<he.length){var Se=he[be],Te=he[be+1];Se[0]===Te[1]&&he.splice(be,2,[Se[0],Se[1]+Te[1]])}return he}},function(j,X){X=j.exports=typeof Object.keys=="function"?Object.keys:ee,X.shim=ee;function ee(te){var ne=[];for(var re in te)ne.push(re);return ne}},function(j,X){var ee=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";X=j.exports=ee?te:ne,X.supported=te;function te(re){return Object.prototype.toString.call(re)=="[object Arguments]"}X.unsupported=ne;function ne(re){return re&&typeof re=="object"&&typeof re.length=="number"&&Object.prototype.hasOwnProperty.call(re,"callee")&&!Object.prototype.propertyIsEnumerable.call(re,"callee")||!1}},function(j,X){var ee=Object.prototype.hasOwnProperty,te="~";function ne(){}Object.create&&(ne.prototype=Object.create(null),new ne().__proto__||(te=!1));function re(fe,ce,se){this.fn=fe,this.context=ce,this.once=se||!1}function ie(){this._events=new ne,this._eventsCount=0}ie.prototype.eventNames=function(){var ce=[],se,oe;if(this._eventsCount===0)return ce;for(oe in se=this._events)ee.call(se,oe)&&ce.push(te?oe.slice(1):oe);return Object.getOwnPropertySymbols?ce.concat(Object.getOwnPropertySymbols(se)):ce},ie.prototype.listeners=function(ce,se){var oe=te?te+ce:ce,ae=this._events[oe];if(se)return!!ae;if(!ae)return[];if(ae.fn)return[ae.fn];for(var le=0,pe=ae.length,ve=new Array(pe);le<pe;le++)ve[le]=ae[le].fn;return ve},ie.prototype.emit=function(ce,se,oe,ae,le,pe){var ve=te?te+ce:ce;if(!this._events[ve])return!1;var ge=this._events[ve],de=arguments.length,ue,he;if(ge.fn){switch(ge.once&&this.removeListener(ce,ge.fn,void 0,!0),de){case 1:return ge.fn.call(ge.context),!0;case 2:return ge.fn.call(ge.context,se),!0;case 3:return ge.fn.call(ge.context,se,oe),!0;case 4:return ge.fn.call(ge.context,se,oe,ae),!0;case 5:return ge.fn.call(ge.context,se,oe,ae,le),!0;case 6:return ge.fn.call(ge.context,se,oe,ae,le,pe),!0}for(he=1,ue=new Array(de-1);he<de;he++)ue[he-1]=arguments[he];ge.fn.apply(ge.context,ue)}else{var me=ge.length,_e;for(he=0;he<me;he++)switch(ge[he].once&&this.removeListener(ce,ge[he].fn,void 0,!0),de){case 1:ge[he].fn.call(ge[he].context);break;case 2:ge[he].fn.call(ge[he].context,se);break;case 3:ge[he].fn.call(ge[he].context,se,oe);break;case 4:ge[he].fn.call(ge[he].context,se,oe,ae);break;default:if(!ue)for(_e=1,ue=new Array(de-1);_e<de;_e++)ue[_e-1]=arguments[_e];ge[he].fn.apply(ge[he].context,ue)}}return!0},ie.prototype.on=function(ce,se,oe){var ae=new re(se,oe||this),le=te?te+ce:ce;return this._events[le]?this._events[le].fn?this._events[le]=[this._events[le],ae]:this._events[le].push(ae):(this._events[le]=ae,this._eventsCount++),this},ie.prototype.once=function(ce,se,oe){var ae=new re(se,oe||this,!0),le=te?te+ce:ce;return this._events[le]?this._events[le].fn?this._events[le]=[this._events[le],ae]:this._events[le].push(ae):(this._events[le]=ae,this._eventsCount++),this},ie.prototype.removeListener=function(ce,se,oe,ae){var le=te?te+ce:ce;if(!this._events[le])return this;if(!se)return--this._eventsCount===0?this._events=new ne:delete this._events[le],this;var pe=this._events[le];if(pe.fn)pe.fn===se&&(!ae||pe.once)&&(!oe||pe.context===oe)&&(--this._eventsCount===0?this._events=new ne:delete this._events[le]);else{for(var ve=0,ge=[],de=pe.length;ve<de;ve++)(pe[ve].fn!==se||ae&&!pe[ve].once||oe&&pe[ve].context!==oe)&&ge.push(pe[ve]);ge.length?this._events[le]=ge.length===1?ge[0]:ge:--this._eventsCount===0?this._events=new ne:delete this._events[le]}return this},ie.prototype.removeAllListeners=function(ce){var se;return ce?(se=te?te+ce:ce,this._events[se]&&(--this._eventsCount===0?this._events=new ne:delete this._events[se])):(this._events=new ne,this._eventsCount=0),this},ie.prototype.off=ie.prototype.removeListener,ie.prototype.addListener=ie.prototype.on,ie.prototype.setMaxListeners=function(){return this},ie.prefixed=te,ie.EventEmitter=ie,typeof j<"u"&&(j.exports=ie)},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.matchText=X.matchSpacing=X.matchNewline=X.matchBlot=X.matchAttributor=X.default=void 0;var te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Be){return typeof Be}:function(Be){return Be&&typeof Symbol=="function"&&Be.constructor===Symbol&&Be!==Symbol.prototype?"symbol":typeof Be},ne=function(){function Be(Oe,ye){var Ce=[],Ee=!0,Fe=!1,ze=void 0;try{for(var Ze=Oe[Symbol.iterator](),st;!(Ee=(st=Ze.next()).done)&&(Ce.push(st.value),!(ye&&Ce.length===ye));Ee=!0);}catch(pt){Fe=!0,ze=pt}finally{try{!Ee&&Ze.return&&Ze.return()}finally{if(Fe)throw ze}}return Ce}return function(Oe,ye){if(Array.isArray(Oe))return Oe;if(Symbol.iterator in Object(Oe))return Be(Oe,ye);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),re=function(){function Be(Oe,ye){for(var Ce=0;Ce<ye.length;Ce++){var Ee=ye[Ce];Ee.enumerable=Ee.enumerable||!1,Ee.configurable=!0,"value"in Ee&&(Ee.writable=!0),Object.defineProperty(Oe,Ee.key,Ee)}}return function(Oe,ye,Ce){return ye&&Be(Oe.prototype,ye),Ce&&Be(Oe,Ce),Oe}}(),ie=ee(3),fe=xe(ie),ce=ee(2),se=xe(ce),oe=ee(0),ae=xe(oe),le=ee(5),pe=xe(le),ve=ee(10),ge=xe(ve),de=ee(9),ue=xe(de),he=ee(36),me=ee(37),_e=ee(13),be=xe(_e),Se=ee(26),Te=ee(38),we=ee(39),ke=ee(40);function xe(Be){return Be&&Be.__esModule?Be:{default:Be}}function Ae(Be,Oe,ye){return Oe in Be?Object.defineProperty(Be,Oe,{value:ye,enumerable:!0,configurable:!0,writable:!0}):Be[Oe]=ye,Be}function Le(Be,Oe){if(!(Be instanceof Oe))throw new TypeError("Cannot call a class as a function")}function De(Be,Oe){if(!Be)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Oe&&(typeof Oe=="object"||typeof Oe=="function")?Oe:Be}function $e(Be,Oe){if(typeof Oe!="function"&&Oe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Oe);Be.prototype=Object.create(Oe&&Oe.prototype,{constructor:{value:Be,enumerable:!1,writable:!0,configurable:!0}}),Oe&&(Object.setPrototypeOf?Object.setPrototypeOf(Be,Oe):Be.__proto__=Oe)}var Ve=(0,ge.default)("quill:clipboard"),Qe="__ql-matcher",je=[[Node.TEXT_NODE,qe],[Node.TEXT_NODE,ut],["br",ot],[Node.ELEMENT_NODE,ut],[Node.ELEMENT_NODE,nt],[Node.ELEMENT_NODE,Re],[Node.ELEMENT_NODE,Je],[Node.ELEMENT_NODE,Me],["li",ct],["b",Xe.bind(Xe,"bold")],["i",Xe.bind(Xe,"italic")],["style",ht]],He=[he.AlignAttribute,Te.DirectionAttribute].reduce(function(Be,Oe){return Be[Oe.keyName]=Oe,Be},{}),Ie=[he.AlignStyle,me.BackgroundStyle,Se.ColorStyle,Te.DirectionStyle,we.FontStyle,ke.SizeStyle].reduce(function(Be,Oe){return Be[Oe.keyName]=Oe,Be},{}),Ue=function(Be){$e(Oe,Be);function Oe(ye,Ce){Le(this,Oe);var Ee=De(this,(Oe.__proto__||Object.getPrototypeOf(Oe)).call(this,ye,Ce));return Ee.quill.root.addEventListener("paste",Ee.onPaste.bind(Ee)),Ee.container=Ee.quill.addContainer("ql-clipboard"),Ee.container.setAttribute("contenteditable",!0),Ee.container.setAttribute("tabindex",-1),Ee.matchers=[],je.concat(Ee.options.matchers).forEach(function(Fe){var ze=ne(Fe,2),Ze=ze[0],st=ze[1];!Ce.matchVisual&&st===Re||Ee.addMatcher(Ze,st)}),Ee}return re(Oe,[{key:"addMatcher",value:function(Ce,Ee){this.matchers.push([Ce,Ee])}},{key:"convert",value:function(Ce){if(typeof Ce=="string")return this.container.innerHTML=Ce.replace(/\>\r?\n +\</g,"><"),this.convert();var Ee=this.quill.getFormat(this.quill.selection.savedRange.index);if(Ee[be.default.blotName]){var Fe=this.container.innerText;return this.container.innerHTML="",new se.default().insert(Fe,Ae({},be.default.blotName,Ee[be.default.blotName]))}var ze=this.prepareMatching(),Ze=ne(ze,2),st=Ze[0],pt=Ze[1],dt=Ke(this.container,st,pt);return Ye(dt,`
`)&&dt.ops[dt.ops.length-1].attributes==null&&(dt=dt.compose(new se.default().retain(dt.length()-1).delete(1))),Ve.log("convert",this.container.innerHTML,dt),this.container.innerHTML="",dt}},{key:"dangerouslyPasteHTML",value:function(Ce,Ee){var Fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pe.default.sources.API;if(typeof Ce=="string")this.quill.setContents(this.convert(Ce),Ee),this.quill.setSelection(0,pe.default.sources.SILENT);else{var ze=this.convert(Ee);this.quill.updateContents(new se.default().retain(Ce).concat(ze),Fe),this.quill.setSelection(Ce+ze.length(),pe.default.sources.SILENT)}}},{key:"onPaste",value:function(Ce){var Ee=this;if(!(Ce.defaultPrevented||!this.quill.isEnabled())){var Fe=this.quill.getSelection(),ze=new se.default().retain(Fe.index),Ze=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(pe.default.sources.SILENT),setTimeout(function(){ze=ze.concat(Ee.convert()).delete(Fe.length),Ee.quill.updateContents(ze,pe.default.sources.USER),Ee.quill.setSelection(ze.length()-Fe.length,pe.default.sources.SILENT),Ee.quill.scrollingContainer.scrollTop=Ze,Ee.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Ce=this,Ee=[],Fe=[];return this.matchers.forEach(function(ze){var Ze=ne(ze,2),st=Ze[0],pt=Ze[1];switch(st){case Node.TEXT_NODE:Fe.push(pt);break;case Node.ELEMENT_NODE:Ee.push(pt);break;default:[].forEach.call(Ce.container.querySelectorAll(st),function(dt){dt[Qe]=dt[Qe]||[],dt[Qe].push(pt)});break}}),[Ee,Fe]}}]),Oe}(ue.default);Ue.DEFAULTS={matchers:[],matchVisual:!0};function Pe(Be,Oe,ye){return(typeof Oe>"u"?"undefined":te(Oe))==="object"?Object.keys(Oe).reduce(function(Ce,Ee){return Pe(Ce,Ee,Oe[Ee])},Be):Be.reduce(function(Ce,Ee){return Ee.attributes&&Ee.attributes[Oe]?Ce.push(Ee):Ce.insert(Ee.insert,(0,fe.default)({},Ae({},Oe,ye),Ee.attributes))},new se.default)}function We(Be){if(Be.nodeType!==Node.ELEMENT_NODE)return{};var Oe="__ql-computed-style";return Be[Oe]||(Be[Oe]=window.getComputedStyle(Be))}function Ye(Be,Oe){for(var ye="",Ce=Be.ops.length-1;Ce>=0&&ye.length<Oe.length;--Ce){var Ee=Be.ops[Ce];if(typeof Ee.insert!="string")break;ye=Ee.insert+ye}return ye.slice(-1*Oe.length)===Oe}function Ne(Be){if(Be.childNodes.length===0)return!1;var Oe=We(Be);return["block","list-item"].indexOf(Oe.display)>-1}function Ke(Be,Oe,ye){return Be.nodeType===Be.TEXT_NODE?ye.reduce(function(Ce,Ee){return Ee(Be,Ce)},new se.default):Be.nodeType===Be.ELEMENT_NODE?[].reduce.call(Be.childNodes||[],function(Ce,Ee){var Fe=Ke(Ee,Oe,ye);return Ee.nodeType===Be.ELEMENT_NODE&&(Fe=Oe.reduce(function(ze,Ze){return Ze(Ee,ze)},Fe),Fe=(Ee[Qe]||[]).reduce(function(ze,Ze){return Ze(Ee,ze)},Fe)),Ce.concat(Fe)},new se.default):new se.default}function Xe(Be,Oe,ye){return Pe(ye,Be,!0)}function Je(Be,Oe){var ye=ae.default.Attributor.Attribute.keys(Be),Ce=ae.default.Attributor.Class.keys(Be),Ee=ae.default.Attributor.Style.keys(Be),Fe={};return ye.concat(Ce).concat(Ee).forEach(function(ze){var Ze=ae.default.query(ze,ae.default.Scope.ATTRIBUTE);Ze!=null&&(Fe[Ze.attrName]=Ze.value(Be),Fe[Ze.attrName])||(Ze=He[ze],Ze!=null&&(Ze.attrName===ze||Ze.keyName===ze)&&(Fe[Ze.attrName]=Ze.value(Be)||void 0),Ze=Ie[ze],Ze!=null&&(Ze.attrName===ze||Ze.keyName===ze)&&(Ze=Ie[ze],Fe[Ze.attrName]=Ze.value(Be)||void 0))}),Object.keys(Fe).length>0&&(Oe=Pe(Oe,Fe)),Oe}function nt(Be,Oe){var ye=ae.default.query(Be);if(ye==null)return Oe;if(ye.prototype instanceof ae.default.Embed){var Ce={},Ee=ye.value(Be);Ee!=null&&(Ce[ye.blotName]=Ee,Oe=new se.default().insert(Ce,ye.formats(Be)))}else typeof ye.formats=="function"&&(Oe=Pe(Oe,ye.blotName,ye.formats(Be)));return Oe}function ot(Be,Oe){return Ye(Oe,`
`)||Oe.insert(`
`),Oe}function ht(){return new se.default}function ct(Be,Oe){var ye=ae.default.query(Be);if(ye==null||ye.blotName!=="list-item"||!Ye(Oe,`
`))return Oe;for(var Ce=-1,Ee=Be.parentNode;!Ee.classList.contains("ql-clipboard");)(ae.default.query(Ee)||{}).blotName==="list"&&(Ce+=1),Ee=Ee.parentNode;return Ce<=0?Oe:Oe.compose(new se.default().retain(Oe.length()-1).retain(1,{indent:Ce}))}function ut(Be,Oe){return Ye(Oe,`
`)||(Ne(Be)||Oe.length()>0&&Be.nextSibling&&Ne(Be.nextSibling))&&Oe.insert(`
`),Oe}function Re(Be,Oe){if(Ne(Be)&&Be.nextElementSibling!=null&&!Ye(Oe,`

`)){var ye=Be.offsetHeight+parseFloat(We(Be).marginTop)+parseFloat(We(Be).marginBottom);Be.nextElementSibling.offsetTop>Be.offsetTop+ye*1.5&&Oe.insert(`
`)}return Oe}function Me(Be,Oe){var ye={},Ce=Be.style||{};return Ce.fontStyle&&We(Be).fontStyle==="italic"&&(ye.italic=!0),Ce.fontWeight&&(We(Be).fontWeight.startsWith("bold")||parseInt(We(Be).fontWeight)>=700)&&(ye.bold=!0),Object.keys(ye).length>0&&(Oe=Pe(Oe,ye)),parseFloat(Ce.textIndent||0)>0&&(Oe=new se.default().insert("	").concat(Oe)),Oe}function qe(Be,Oe){var ye=Be.data;if(Be.parentNode.tagName==="O:P")return Oe.insert(ye.trim());if(ye.trim().length===0&&Be.parentNode.classList.contains("ql-clipboard"))return Oe;if(!We(Be.parentNode).whiteSpace.startsWith("pre")){var Ce=function(Fe,ze){return ze=ze.replace(/[^\u00a0]/g,""),ze.length<1&&Fe?" ":ze};ye=ye.replace(/\r\n/g," ").replace(/\n/g," "),ye=ye.replace(/\s\s+/g,Ce.bind(Ce,!0)),(Be.previousSibling==null&&Ne(Be.parentNode)||Be.previousSibling!=null&&Ne(Be.previousSibling))&&(ye=ye.replace(/^\s+/,Ce.bind(Ce,!1))),(Be.nextSibling==null&&Ne(Be.parentNode)||Be.nextSibling!=null&&Ne(Be.nextSibling))&&(ye=ye.replace(/\s+$/,Ce.bind(Ce,!1)))}return Oe.insert(ye)}X.default=Ue,X.matchAttributor=Je,X.matchBlot=nt,X.matchNewline=ut,X.matchSpacing=Re,X.matchText=qe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function le(pe,ve){for(var ge=0;ge<ve.length;ge++){var de=ve[ge];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(pe,de.key,de)}}return function(pe,ve,ge){return ve&&le(pe.prototype,ve),ge&&le(pe,ge),pe}}(),ne=function le(pe,ve,ge){pe===null&&(pe=Function.prototype);var de=Object.getOwnPropertyDescriptor(pe,ve);if(de===void 0){var ue=Object.getPrototypeOf(pe);return ue===null?void 0:le(ue,ve,ge)}else{if("value"in de)return de.value;var he=de.get;return he===void 0?void 0:he.call(ge)}},re=ee(6),ie=fe(re);function fe(le){return le&&le.__esModule?le:{default:le}}function ce(le,pe){if(!(le instanceof pe))throw new TypeError("Cannot call a class as a function")}function se(le,pe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pe&&(typeof pe=="object"||typeof pe=="function")?pe:le}function oe(le,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pe);le.prototype=Object.create(pe&&pe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),pe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,pe):le.__proto__=pe)}var ae=function(le){oe(pe,le);function pe(){return ce(this,pe),se(this,(pe.__proto__||Object.getPrototypeOf(pe)).apply(this,arguments))}return te(pe,[{key:"optimize",value:function(ge){ne(pe.prototype.__proto__||Object.getPrototypeOf(pe.prototype),"optimize",this).call(this,ge),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return ne(pe.__proto__||Object.getPrototypeOf(pe),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),pe}(ie.default);ae.blotName="bold",ae.tagName=["STRONG","B"],X.default=ae},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.addControls=X.default=void 0;var te=function(){function ke(xe,Ae){var Le=[],De=!0,$e=!1,Ve=void 0;try{for(var Qe=xe[Symbol.iterator](),je;!(De=(je=Qe.next()).done)&&(Le.push(je.value),!(Ae&&Le.length===Ae));De=!0);}catch(He){$e=!0,Ve=He}finally{try{!De&&Qe.return&&Qe.return()}finally{if($e)throw Ve}}return Le}return function(xe,Ae){if(Array.isArray(xe))return xe;if(Symbol.iterator in Object(xe))return ke(xe,Ae);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ne=function(){function ke(xe,Ae){for(var Le=0;Le<Ae.length;Le++){var De=Ae[Le];De.enumerable=De.enumerable||!1,De.configurable=!0,"value"in De&&(De.writable=!0),Object.defineProperty(xe,De.key,De)}}return function(xe,Ae,Le){return Ae&&ke(xe.prototype,Ae),Le&&ke(xe,Le),xe}}(),re=ee(2),ie=ge(re),fe=ee(0),ce=ge(fe),se=ee(5),oe=ge(se),ae=ee(10),le=ge(ae),pe=ee(9),ve=ge(pe);function ge(ke){return ke&&ke.__esModule?ke:{default:ke}}function de(ke,xe,Ae){return xe in ke?Object.defineProperty(ke,xe,{value:Ae,enumerable:!0,configurable:!0,writable:!0}):ke[xe]=Ae,ke}function ue(ke,xe){if(!(ke instanceof xe))throw new TypeError("Cannot call a class as a function")}function he(ke,xe){if(!ke)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xe&&(typeof xe=="object"||typeof xe=="function")?xe:ke}function me(ke,xe){if(typeof xe!="function"&&xe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof xe);ke.prototype=Object.create(xe&&xe.prototype,{constructor:{value:ke,enumerable:!1,writable:!0,configurable:!0}}),xe&&(Object.setPrototypeOf?Object.setPrototypeOf(ke,xe):ke.__proto__=xe)}var _e=(0,le.default)("quill:toolbar"),be=function(ke){me(xe,ke);function xe(Ae,Le){ue(this,xe);var De=he(this,(xe.__proto__||Object.getPrototypeOf(xe)).call(this,Ae,Le));if(Array.isArray(De.options.container)){var $e=document.createElement("div");Te($e,De.options.container),Ae.container.parentNode.insertBefore($e,Ae.container),De.container=$e}else typeof De.options.container=="string"?De.container=document.querySelector(De.options.container):De.container=De.options.container;if(!(De.container instanceof HTMLElement)){var Ve;return Ve=_e.error("Container required for toolbar",De.options),he(De,Ve)}return De.container.classList.add("ql-toolbar"),De.controls=[],De.handlers={},Object.keys(De.options.handlers).forEach(function(Qe){De.addHandler(Qe,De.options.handlers[Qe])}),[].forEach.call(De.container.querySelectorAll("button, select"),function(Qe){De.attach(Qe)}),De.quill.on(oe.default.events.EDITOR_CHANGE,function(Qe,je){Qe===oe.default.events.SELECTION_CHANGE&&De.update(je)}),De.quill.on(oe.default.events.SCROLL_OPTIMIZE,function(){var Qe=De.quill.selection.getRange(),je=te(Qe,1),He=je[0];De.update(He)}),De}return ne(xe,[{key:"addHandler",value:function(Le,De){this.handlers[Le]=De}},{key:"attach",value:function(Le){var De=this,$e=[].find.call(Le.classList,function(Qe){return Qe.indexOf("ql-")===0});if(!!$e){if($e=$e.slice(3),Le.tagName==="BUTTON"&&Le.setAttribute("type","button"),this.handlers[$e]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[$e]==null){_e.warn("ignoring attaching to disabled format",$e,Le);return}if(ce.default.query($e)==null){_e.warn("ignoring attaching to nonexistent format",$e,Le);return}}var Ve=Le.tagName==="SELECT"?"change":"click";Le.addEventListener(Ve,function(Qe){var je=void 0;if(Le.tagName==="SELECT"){if(Le.selectedIndex<0)return;var He=Le.options[Le.selectedIndex];He.hasAttribute("selected")?je=!1:je=He.value||!1}else Le.classList.contains("ql-active")?je=!1:je=Le.value||!Le.hasAttribute("value"),Qe.preventDefault();De.quill.focus();var Ie=De.quill.selection.getRange(),Ue=te(Ie,1),Pe=Ue[0];if(De.handlers[$e]!=null)De.handlers[$e].call(De,je);else if(ce.default.query($e).prototype instanceof ce.default.Embed){if(je=prompt("Enter "+$e),!je)return;De.quill.updateContents(new ie.default().retain(Pe.index).delete(Pe.length).insert(de({},$e,je)),oe.default.sources.USER)}else De.quill.format($e,je,oe.default.sources.USER);De.update(Pe)}),this.controls.push([$e,Le])}}},{key:"update",value:function(Le){var De=Le==null?{}:this.quill.getFormat(Le);this.controls.forEach(function($e){var Ve=te($e,2),Qe=Ve[0],je=Ve[1];if(je.tagName==="SELECT"){var He=void 0;if(Le==null)He=null;else if(De[Qe]==null)He=je.querySelector("option[selected]");else if(!Array.isArray(De[Qe])){var Ie=De[Qe];typeof Ie=="string"&&(Ie=Ie.replace(/\"/g,'\\"')),He=je.querySelector('option[value="'+Ie+'"]')}He==null?(je.value="",je.selectedIndex=-1):He.selected=!0}else if(Le==null)je.classList.remove("ql-active");else if(je.hasAttribute("value")){var Ue=De[Qe]===je.getAttribute("value")||De[Qe]!=null&&De[Qe].toString()===je.getAttribute("value")||De[Qe]==null&&!je.getAttribute("value");je.classList.toggle("ql-active",Ue)}else je.classList.toggle("ql-active",De[Qe]!=null)})}}]),xe}(ve.default);be.DEFAULTS={};function Se(ke,xe,Ae){var Le=document.createElement("button");Le.setAttribute("type","button"),Le.classList.add("ql-"+xe),Ae!=null&&(Le.value=Ae),ke.appendChild(Le)}function Te(ke,xe){Array.isArray(xe[0])||(xe=[xe]),xe.forEach(function(Ae){var Le=document.createElement("span");Le.classList.add("ql-formats"),Ae.forEach(function(De){if(typeof De=="string")Se(Le,De);else{var $e=Object.keys(De)[0],Ve=De[$e];Array.isArray(Ve)?we(Le,$e,Ve):Se(Le,$e,Ve)}}),ke.appendChild(Le)})}function we(ke,xe,Ae){var Le=document.createElement("select");Le.classList.add("ql-"+xe),Ae.forEach(function(De){var $e=document.createElement("option");De!==!1?$e.setAttribute("value",De):$e.setAttribute("selected","selected"),Le.appendChild($e)}),ke.appendChild(Le)}be.DEFAULTS={container:null,handlers:{clean:function(){var xe=this,Ae=this.quill.getSelection();if(Ae!=null)if(Ae.length==0){var Le=this.quill.getFormat();Object.keys(Le).forEach(function(De){ce.default.query(De,ce.default.Scope.INLINE)!=null&&xe.quill.format(De,!1)})}else this.quill.removeFormat(Ae,oe.default.sources.USER)},direction:function(xe){var Ae=this.quill.getFormat().align;xe==="rtl"&&Ae==null?this.quill.format("align","right",oe.default.sources.USER):!xe&&Ae==="right"&&this.quill.format("align",!1,oe.default.sources.USER),this.quill.format("direction",xe,oe.default.sources.USER)},indent:function(xe){var Ae=this.quill.getSelection(),Le=this.quill.getFormat(Ae),De=parseInt(Le.indent||0);if(xe==="+1"||xe==="-1"){var $e=xe==="+1"?1:-1;Le.direction==="rtl"&&($e*=-1),this.quill.format("indent",De+$e,oe.default.sources.USER)}},link:function(xe){xe===!0&&(xe=prompt("Enter link URL:")),this.quill.format("link",xe,oe.default.sources.USER)},list:function(xe){var Ae=this.quill.getSelection(),Le=this.quill.getFormat(Ae);xe==="check"?Le.list==="checked"||Le.list==="unchecked"?this.quill.format("list",!1,oe.default.sources.USER):this.quill.format("list","unchecked",oe.default.sources.USER):this.quill.format("list",xe,oe.default.sources.USER)}}},X.default=be,X.addControls=Te},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function le(pe,ve){for(var ge=0;ge<ve.length;ge++){var de=ve[ge];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(pe,de.key,de)}}return function(pe,ve,ge){return ve&&le(pe.prototype,ve),ge&&le(pe,ge),pe}}(),ne=function le(pe,ve,ge){pe===null&&(pe=Function.prototype);var de=Object.getOwnPropertyDescriptor(pe,ve);if(de===void 0){var ue=Object.getPrototypeOf(pe);return ue===null?void 0:le(ue,ve,ge)}else{if("value"in de)return de.value;var he=de.get;return he===void 0?void 0:he.call(ge)}},re=ee(28),ie=fe(re);function fe(le){return le&&le.__esModule?le:{default:le}}function ce(le,pe){if(!(le instanceof pe))throw new TypeError("Cannot call a class as a function")}function se(le,pe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pe&&(typeof pe=="object"||typeof pe=="function")?pe:le}function oe(le,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pe);le.prototype=Object.create(pe&&pe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),pe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,pe):le.__proto__=pe)}var ae=function(le){oe(pe,le);function pe(ve,ge){ce(this,pe);var de=se(this,(pe.__proto__||Object.getPrototypeOf(pe)).call(this,ve));return de.label.innerHTML=ge,de.container.classList.add("ql-color-picker"),[].slice.call(de.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(ue){ue.classList.add("ql-primary")}),de}return te(pe,[{key:"buildItem",value:function(ge){var de=ne(pe.prototype.__proto__||Object.getPrototypeOf(pe.prototype),"buildItem",this).call(this,ge);return de.style.backgroundColor=ge.getAttribute("value")||"",de}},{key:"selectItem",value:function(ge,de){ne(pe.prototype.__proto__||Object.getPrototypeOf(pe.prototype),"selectItem",this).call(this,ge,de);var ue=this.label.querySelector(".ql-color-label"),he=ge&&ge.getAttribute("data-value")||"";ue&&(ue.tagName==="line"?ue.style.stroke=he:ue.style.fill=he)}}]),pe}(ie.default);X.default=ae},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function le(pe,ve){for(var ge=0;ge<ve.length;ge++){var de=ve[ge];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(pe,de.key,de)}}return function(pe,ve,ge){return ve&&le(pe.prototype,ve),ge&&le(pe,ge),pe}}(),ne=function le(pe,ve,ge){pe===null&&(pe=Function.prototype);var de=Object.getOwnPropertyDescriptor(pe,ve);if(de===void 0){var ue=Object.getPrototypeOf(pe);return ue===null?void 0:le(ue,ve,ge)}else{if("value"in de)return de.value;var he=de.get;return he===void 0?void 0:he.call(ge)}},re=ee(28),ie=fe(re);function fe(le){return le&&le.__esModule?le:{default:le}}function ce(le,pe){if(!(le instanceof pe))throw new TypeError("Cannot call a class as a function")}function se(le,pe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pe&&(typeof pe=="object"||typeof pe=="function")?pe:le}function oe(le,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pe);le.prototype=Object.create(pe&&pe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),pe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,pe):le.__proto__=pe)}var ae=function(le){oe(pe,le);function pe(ve,ge){ce(this,pe);var de=se(this,(pe.__proto__||Object.getPrototypeOf(pe)).call(this,ve));return de.container.classList.add("ql-icon-picker"),[].forEach.call(de.container.querySelectorAll(".ql-picker-item"),function(ue){ue.innerHTML=ge[ue.getAttribute("data-value")||""]}),de.defaultItem=de.container.querySelector(".ql-selected"),de.selectItem(de.defaultItem),de}return te(pe,[{key:"selectItem",value:function(ge,de){ne(pe.prototype.__proto__||Object.getPrototypeOf(pe.prototype),"selectItem",this).call(this,ge,de),ge=ge||this.defaultItem,this.label.innerHTML=ge.innerHTML}}]),pe}(ie.default);X.default=ae},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ie(fe,ce){for(var se=0;se<ce.length;se++){var oe=ce[se];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(fe,oe.key,oe)}}return function(fe,ce,se){return ce&&ie(fe.prototype,ce),se&&ie(fe,se),fe}}();function ne(ie,fe){if(!(ie instanceof fe))throw new TypeError("Cannot call a class as a function")}var re=function(){function ie(fe,ce){var se=this;ne(this,ie),this.quill=fe,this.boundsContainer=ce||document.body,this.root=fe.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){se.root.style.marginTop=-1*se.quill.root.scrollTop+"px"}),this.hide()}return te(ie,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(ce){var se=ce.left+ce.width/2-this.root.offsetWidth/2,oe=ce.bottom+this.quill.root.scrollTop;this.root.style.left=se+"px",this.root.style.top=oe+"px",this.root.classList.remove("ql-flip");var ae=this.boundsContainer.getBoundingClientRect(),le=this.root.getBoundingClientRect(),pe=0;if(le.right>ae.right&&(pe=ae.right-le.right,this.root.style.left=se+pe+"px"),le.left<ae.left&&(pe=ae.left-le.left,this.root.style.left=se+pe+"px"),le.bottom>ae.bottom){var ve=le.bottom-le.top,ge=ce.bottom-ce.top+ve;this.root.style.top=oe-ge+"px",this.root.classList.add("ql-flip")}return pe}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),ie}();X.default=re},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function we(ke,xe){var Ae=[],Le=!0,De=!1,$e=void 0;try{for(var Ve=ke[Symbol.iterator](),Qe;!(Le=(Qe=Ve.next()).done)&&(Ae.push(Qe.value),!(xe&&Ae.length===xe));Le=!0);}catch(je){De=!0,$e=je}finally{try{!Le&&Ve.return&&Ve.return()}finally{if(De)throw $e}}return Ae}return function(ke,xe){if(Array.isArray(ke))return ke;if(Symbol.iterator in Object(ke))return we(ke,xe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ne=function we(ke,xe,Ae){ke===null&&(ke=Function.prototype);var Le=Object.getOwnPropertyDescriptor(ke,xe);if(Le===void 0){var De=Object.getPrototypeOf(ke);return De===null?void 0:we(De,xe,Ae)}else{if("value"in Le)return Le.value;var $e=Le.get;return $e===void 0?void 0:$e.call(Ae)}},re=function(){function we(ke,xe){for(var Ae=0;Ae<xe.length;Ae++){var Le=xe[Ae];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(ke,Le.key,Le)}}return function(ke,xe,Ae){return xe&&we(ke.prototype,xe),Ae&&we(ke,Ae),ke}}(),ie=ee(3),fe=ue(ie),ce=ee(8),se=ue(ce),oe=ee(43),ae=ue(oe),le=ee(27),pe=ue(le),ve=ee(15),ge=ee(41),de=ue(ge);function ue(we){return we&&we.__esModule?we:{default:we}}function he(we,ke){if(!(we instanceof ke))throw new TypeError("Cannot call a class as a function")}function me(we,ke){if(!we)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ke&&(typeof ke=="object"||typeof ke=="function")?ke:we}function _e(we,ke){if(typeof ke!="function"&&ke!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ke);we.prototype=Object.create(ke&&ke.prototype,{constructor:{value:we,enumerable:!1,writable:!0,configurable:!0}}),ke&&(Object.setPrototypeOf?Object.setPrototypeOf(we,ke):we.__proto__=ke)}var be=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],Se=function(we){_e(ke,we);function ke(xe,Ae){he(this,ke),Ae.modules.toolbar!=null&&Ae.modules.toolbar.container==null&&(Ae.modules.toolbar.container=be);var Le=me(this,(ke.__proto__||Object.getPrototypeOf(ke)).call(this,xe,Ae));return Le.quill.container.classList.add("ql-snow"),Le}return re(ke,[{key:"extendToolbar",value:function(Ae){Ae.container.classList.add("ql-snow"),this.buildButtons([].slice.call(Ae.container.querySelectorAll("button")),de.default),this.buildPickers([].slice.call(Ae.container.querySelectorAll("select")),de.default),this.tooltip=new Te(this.quill,this.options.bounds),Ae.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(Le,De){Ae.handlers.link.call(Ae,!De.format.link)})}}]),ke}(ae.default);Se.DEFAULTS=(0,fe.default)(!0,{},ae.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(ke){if(ke){var xe=this.quill.getSelection();if(xe==null||xe.length==0)return;var Ae=this.quill.getText(xe);/^\S+@\S+\.\S+$/.test(Ae)&&Ae.indexOf("mailto:")!==0&&(Ae="mailto:"+Ae);var Le=this.quill.theme.tooltip;Le.edit("link",Ae)}else this.quill.format("link",!1)}}}}});var Te=function(we){_e(ke,we);function ke(xe,Ae){he(this,ke);var Le=me(this,(ke.__proto__||Object.getPrototypeOf(ke)).call(this,xe,Ae));return Le.preview=Le.root.querySelector("a.ql-preview"),Le}return re(ke,[{key:"listen",value:function(){var Ae=this;ne(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(Le){Ae.root.classList.contains("ql-editing")?Ae.save():Ae.edit("link",Ae.preview.textContent),Le.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(Le){if(Ae.linkRange!=null){var De=Ae.linkRange;Ae.restoreFocus(),Ae.quill.formatText(De,"link",!1,se.default.sources.USER),delete Ae.linkRange}Le.preventDefault(),Ae.hide()}),this.quill.on(se.default.events.SELECTION_CHANGE,function(Le,De,$e){if(Le!=null){if(Le.length===0&&$e===se.default.sources.USER){var Ve=Ae.quill.scroll.descendant(pe.default,Le.index),Qe=te(Ve,2),je=Qe[0],He=Qe[1];if(je!=null){Ae.linkRange=new ve.Range(Le.index-He,je.length());var Ie=pe.default.formats(je.domNode);Ae.preview.textContent=Ie,Ae.preview.setAttribute("href",Ie),Ae.show(),Ae.position(Ae.quill.getBounds(Ae.linkRange));return}}else delete Ae.linkRange;Ae.hide()}})}},{key:"show",value:function(){ne(ke.prototype.__proto__||Object.getPrototypeOf(ke.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),ke}(oe.BaseTooltip);Te.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),X.default=Se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(29),ne=Ee(te),re=ee(36),ie=ee(38),fe=ee(64),ce=ee(65),se=Ee(ce),oe=ee(66),ae=Ee(oe),le=ee(67),pe=Ee(le),ve=ee(37),ge=ee(26),de=ee(39),ue=ee(40),he=ee(56),me=Ee(he),_e=ee(68),be=Ee(_e),Se=ee(27),Te=Ee(Se),we=ee(69),ke=Ee(we),xe=ee(70),Ae=Ee(xe),Le=ee(71),De=Ee(Le),$e=ee(72),Ve=Ee($e),Qe=ee(73),je=Ee(Qe),He=ee(13),Ie=Ee(He),Ue=ee(74),Pe=Ee(Ue),We=ee(75),Ye=Ee(We),Ne=ee(57),Ke=Ee(Ne),Xe=ee(41),Je=Ee(Xe),nt=ee(28),ot=Ee(nt),ht=ee(59),ct=Ee(ht),ut=ee(60),Re=Ee(ut),Me=ee(61),qe=Ee(Me),Be=ee(108),Oe=Ee(Be),ye=ee(62),Ce=Ee(ye);function Ee(Fe){return Fe&&Fe.__esModule?Fe:{default:Fe}}ne.default.register({"attributors/attribute/direction":ie.DirectionAttribute,"attributors/class/align":re.AlignClass,"attributors/class/background":ve.BackgroundClass,"attributors/class/color":ge.ColorClass,"attributors/class/direction":ie.DirectionClass,"attributors/class/font":de.FontClass,"attributors/class/size":ue.SizeClass,"attributors/style/align":re.AlignStyle,"attributors/style/background":ve.BackgroundStyle,"attributors/style/color":ge.ColorStyle,"attributors/style/direction":ie.DirectionStyle,"attributors/style/font":de.FontStyle,"attributors/style/size":ue.SizeStyle},!0),ne.default.register({"formats/align":re.AlignClass,"formats/direction":ie.DirectionClass,"formats/indent":fe.IndentClass,"formats/background":ve.BackgroundStyle,"formats/color":ge.ColorStyle,"formats/font":de.FontClass,"formats/size":ue.SizeClass,"formats/blockquote":se.default,"formats/code-block":Ie.default,"formats/header":ae.default,"formats/list":pe.default,"formats/bold":me.default,"formats/code":He.Code,"formats/italic":be.default,"formats/link":Te.default,"formats/script":ke.default,"formats/strike":Ae.default,"formats/underline":De.default,"formats/image":Ve.default,"formats/video":je.default,"formats/list/item":le.ListItem,"modules/formula":Pe.default,"modules/syntax":Ye.default,"modules/toolbar":Ke.default,"themes/bubble":Oe.default,"themes/snow":Ce.default,"ui/icons":Je.default,"ui/picker":ot.default,"ui/icon-picker":Re.default,"ui/color-picker":ct.default,"ui/tooltip":qe.default},!0),X.default=ne.default},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.IndentClass=void 0;var te=function(){function pe(ve,ge){for(var de=0;de<ge.length;de++){var ue=ge[de];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(ve,ue.key,ue)}}return function(ve,ge,de){return ge&&pe(ve.prototype,ge),de&&pe(ve,de),ve}}(),ne=function pe(ve,ge,de){ve===null&&(ve=Function.prototype);var ue=Object.getOwnPropertyDescriptor(ve,ge);if(ue===void 0){var he=Object.getPrototypeOf(ve);return he===null?void 0:pe(he,ge,de)}else{if("value"in ue)return ue.value;var me=ue.get;return me===void 0?void 0:me.call(de)}},re=ee(0),ie=fe(re);function fe(pe){return pe&&pe.__esModule?pe:{default:pe}}function ce(pe,ve){if(!(pe instanceof ve))throw new TypeError("Cannot call a class as a function")}function se(pe,ve){if(!pe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ve&&(typeof ve=="object"||typeof ve=="function")?ve:pe}function oe(pe,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ve);pe.prototype=Object.create(ve&&ve.prototype,{constructor:{value:pe,enumerable:!1,writable:!0,configurable:!0}}),ve&&(Object.setPrototypeOf?Object.setPrototypeOf(pe,ve):pe.__proto__=ve)}var ae=function(pe){oe(ve,pe);function ve(){return ce(this,ve),se(this,(ve.__proto__||Object.getPrototypeOf(ve)).apply(this,arguments))}return te(ve,[{key:"add",value:function(de,ue){if(ue==="+1"||ue==="-1"){var he=this.value(de)||0;ue=ue==="+1"?he+1:he-1}return ue===0?(this.remove(de),!0):ne(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"add",this).call(this,de,ue)}},{key:"canAdd",value:function(de,ue){return ne(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"canAdd",this).call(this,de,ue)||ne(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"canAdd",this).call(this,de,parseInt(ue))}},{key:"value",value:function(de){return parseInt(ne(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"value",this).call(this,de))||void 0}}]),ve}(ie.default.Attributor.Class),le=new ae("indent","ql-indent",{scope:ie.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});X.IndentClass=le},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(4),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}function ie(oe,ae){if(!(oe instanceof ae))throw new TypeError("Cannot call a class as a function")}function fe(oe,ae){if(!oe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae&&(typeof ae=="object"||typeof ae=="function")?ae:oe}function ce(oe,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ae);oe.prototype=Object.create(ae&&ae.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),ae&&(Object.setPrototypeOf?Object.setPrototypeOf(oe,ae):oe.__proto__=ae)}var se=function(oe){ce(ae,oe);function ae(){return ie(this,ae),fe(this,(ae.__proto__||Object.getPrototypeOf(ae)).apply(this,arguments))}return ae}(ne.default);se.blotName="blockquote",se.tagName="blockquote",X.default=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ae(le,pe){for(var ve=0;ve<pe.length;ve++){var ge=pe[ve];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(le,ge.key,ge)}}return function(le,pe,ve){return pe&&ae(le.prototype,pe),ve&&ae(le,ve),le}}(),ne=ee(4),re=ie(ne);function ie(ae){return ae&&ae.__esModule?ae:{default:ae}}function fe(ae,le){if(!(ae instanceof le))throw new TypeError("Cannot call a class as a function")}function ce(ae,le){if(!ae)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le&&(typeof le=="object"||typeof le=="function")?le:ae}function se(ae,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof le);ae.prototype=Object.create(le&&le.prototype,{constructor:{value:ae,enumerable:!1,writable:!0,configurable:!0}}),le&&(Object.setPrototypeOf?Object.setPrototypeOf(ae,le):ae.__proto__=le)}var oe=function(ae){se(le,ae);function le(){return fe(this,le),ce(this,(le.__proto__||Object.getPrototypeOf(le)).apply(this,arguments))}return te(le,null,[{key:"formats",value:function(ve){return this.tagName.indexOf(ve.tagName)+1}}]),le}(re.default);oe.blotName="header",oe.tagName=["H1","H2","H3","H4","H5","H6"],X.default=oe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.ListItem=void 0;var te=function(){function he(me,_e){for(var be=0;be<_e.length;be++){var Se=_e[be];Se.enumerable=Se.enumerable||!1,Se.configurable=!0,"value"in Se&&(Se.writable=!0),Object.defineProperty(me,Se.key,Se)}}return function(me,_e,be){return _e&&he(me.prototype,_e),be&&he(me,be),me}}(),ne=function he(me,_e,be){me===null&&(me=Function.prototype);var Se=Object.getOwnPropertyDescriptor(me,_e);if(Se===void 0){var Te=Object.getPrototypeOf(me);return Te===null?void 0:he(Te,_e,be)}else{if("value"in Se)return Se.value;var we=Se.get;return we===void 0?void 0:we.call(be)}},re=ee(0),ie=ae(re),fe=ee(4),ce=ae(fe),se=ee(25),oe=ae(se);function ae(he){return he&&he.__esModule?he:{default:he}}function le(he,me,_e){return me in he?Object.defineProperty(he,me,{value:_e,enumerable:!0,configurable:!0,writable:!0}):he[me]=_e,he}function pe(he,me){if(!(he instanceof me))throw new TypeError("Cannot call a class as a function")}function ve(he,me){if(!he)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return me&&(typeof me=="object"||typeof me=="function")?me:he}function ge(he,me){if(typeof me!="function"&&me!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof me);he.prototype=Object.create(me&&me.prototype,{constructor:{value:he,enumerable:!1,writable:!0,configurable:!0}}),me&&(Object.setPrototypeOf?Object.setPrototypeOf(he,me):he.__proto__=me)}var de=function(he){ge(me,he);function me(){return pe(this,me),ve(this,(me.__proto__||Object.getPrototypeOf(me)).apply(this,arguments))}return te(me,[{key:"format",value:function(be,Se){be===ue.blotName&&!Se?this.replaceWith(ie.default.create(this.statics.scope)):ne(me.prototype.__proto__||Object.getPrototypeOf(me.prototype),"format",this).call(this,be,Se)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():ne(me.prototype.__proto__||Object.getPrototypeOf(me.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(be,Se){return this.parent.isolate(this.offset(this.parent),this.length()),be===this.parent.statics.blotName?(this.parent.replaceWith(be,Se),this):(this.parent.unwrap(),ne(me.prototype.__proto__||Object.getPrototypeOf(me.prototype),"replaceWith",this).call(this,be,Se))}}],[{key:"formats",value:function(be){return be.tagName===this.tagName?void 0:ne(me.__proto__||Object.getPrototypeOf(me),"formats",this).call(this,be)}}]),me}(ce.default);de.blotName="list-item",de.tagName="LI";var ue=function(he){ge(me,he),te(me,null,[{key:"create",value:function(be){var Se=be==="ordered"?"OL":"UL",Te=ne(me.__proto__||Object.getPrototypeOf(me),"create",this).call(this,Se);return(be==="checked"||be==="unchecked")&&Te.setAttribute("data-checked",be==="checked"),Te}},{key:"formats",value:function(be){if(be.tagName==="OL")return"ordered";if(be.tagName==="UL")return be.hasAttribute("data-checked")?be.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function me(_e){pe(this,me);var be=ve(this,(me.__proto__||Object.getPrototypeOf(me)).call(this,_e)),Se=function(we){if(we.target.parentNode===_e){var ke=be.statics.formats(_e),xe=ie.default.find(we.target);ke==="checked"?xe.format("list","unchecked"):ke==="unchecked"&&xe.format("list","checked")}};return _e.addEventListener("touchstart",Se),_e.addEventListener("mousedown",Se),be}return te(me,[{key:"format",value:function(be,Se){this.children.length>0&&this.children.tail.format(be,Se)}},{key:"formats",value:function(){return le({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(be,Se){if(be instanceof de)ne(me.prototype.__proto__||Object.getPrototypeOf(me.prototype),"insertBefore",this).call(this,be,Se);else{var Te=Se==null?this.length():Se.offset(this),we=this.split(Te);we.parent.insertBefore(be,we)}}},{key:"optimize",value:function(be){ne(me.prototype.__proto__||Object.getPrototypeOf(me.prototype),"optimize",this).call(this,be);var Se=this.next;Se!=null&&Se.prev===this&&Se.statics.blotName===this.statics.blotName&&Se.domNode.tagName===this.domNode.tagName&&Se.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(Se.moveChildren(this),Se.remove())}},{key:"replace",value:function(be){if(be.statics.blotName!==this.statics.blotName){var Se=ie.default.create(this.statics.defaultChild);be.moveChildren(Se),this.appendChild(Se)}ne(me.prototype.__proto__||Object.getPrototypeOf(me.prototype),"replace",this).call(this,be)}}]),me}(oe.default);ue.blotName="list",ue.scope=ie.default.Scope.BLOCK_BLOT,ue.tagName=["OL","UL"],ue.defaultChild="list-item",ue.allowedChildren=[de],X.ListItem=de,X.default=ue},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(56),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}function ie(oe,ae){if(!(oe instanceof ae))throw new TypeError("Cannot call a class as a function")}function fe(oe,ae){if(!oe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae&&(typeof ae=="object"||typeof ae=="function")?ae:oe}function ce(oe,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ae);oe.prototype=Object.create(ae&&ae.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),ae&&(Object.setPrototypeOf?Object.setPrototypeOf(oe,ae):oe.__proto__=ae)}var se=function(oe){ce(ae,oe);function ae(){return ie(this,ae),fe(this,(ae.__proto__||Object.getPrototypeOf(ae)).apply(this,arguments))}return ae}(ne.default);se.blotName="italic",se.tagName=["EM","I"],X.default=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function le(pe,ve){for(var ge=0;ge<ve.length;ge++){var de=ve[ge];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(pe,de.key,de)}}return function(pe,ve,ge){return ve&&le(pe.prototype,ve),ge&&le(pe,ge),pe}}(),ne=function le(pe,ve,ge){pe===null&&(pe=Function.prototype);var de=Object.getOwnPropertyDescriptor(pe,ve);if(de===void 0){var ue=Object.getPrototypeOf(pe);return ue===null?void 0:le(ue,ve,ge)}else{if("value"in de)return de.value;var he=de.get;return he===void 0?void 0:he.call(ge)}},re=ee(6),ie=fe(re);function fe(le){return le&&le.__esModule?le:{default:le}}function ce(le,pe){if(!(le instanceof pe))throw new TypeError("Cannot call a class as a function")}function se(le,pe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pe&&(typeof pe=="object"||typeof pe=="function")?pe:le}function oe(le,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pe);le.prototype=Object.create(pe&&pe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),pe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,pe):le.__proto__=pe)}var ae=function(le){oe(pe,le);function pe(){return ce(this,pe),se(this,(pe.__proto__||Object.getPrototypeOf(pe)).apply(this,arguments))}return te(pe,null,[{key:"create",value:function(ge){return ge==="super"?document.createElement("sup"):ge==="sub"?document.createElement("sub"):ne(pe.__proto__||Object.getPrototypeOf(pe),"create",this).call(this,ge)}},{key:"formats",value:function(ge){if(ge.tagName==="SUB")return"sub";if(ge.tagName==="SUP")return"super"}}]),pe}(ie.default);ae.blotName="script",ae.tagName=["SUB","SUP"],X.default=ae},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(6),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}function ie(oe,ae){if(!(oe instanceof ae))throw new TypeError("Cannot call a class as a function")}function fe(oe,ae){if(!oe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae&&(typeof ae=="object"||typeof ae=="function")?ae:oe}function ce(oe,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ae);oe.prototype=Object.create(ae&&ae.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),ae&&(Object.setPrototypeOf?Object.setPrototypeOf(oe,ae):oe.__proto__=ae)}var se=function(oe){ce(ae,oe);function ae(){return ie(this,ae),fe(this,(ae.__proto__||Object.getPrototypeOf(ae)).apply(this,arguments))}return ae}(ne.default);se.blotName="strike",se.tagName="S",X.default=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=ee(6),ne=re(te);function re(oe){return oe&&oe.__esModule?oe:{default:oe}}function ie(oe,ae){if(!(oe instanceof ae))throw new TypeError("Cannot call a class as a function")}function fe(oe,ae){if(!oe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae&&(typeof ae=="object"||typeof ae=="function")?ae:oe}function ce(oe,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ae);oe.prototype=Object.create(ae&&ae.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),ae&&(Object.setPrototypeOf?Object.setPrototypeOf(oe,ae):oe.__proto__=ae)}var se=function(oe){ce(ae,oe);function ae(){return ie(this,ae),fe(this,(ae.__proto__||Object.getPrototypeOf(ae)).apply(this,arguments))}return ae}(ne.default);se.blotName="underline",se.tagName="U",X.default=se},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ve(ge,de){for(var ue=0;ue<de.length;ue++){var he=de[ue];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(ge,he.key,he)}}return function(ge,de,ue){return de&&ve(ge.prototype,de),ue&&ve(ge,ue),ge}}(),ne=function ve(ge,de,ue){ge===null&&(ge=Function.prototype);var he=Object.getOwnPropertyDescriptor(ge,de);if(he===void 0){var me=Object.getPrototypeOf(ge);return me===null?void 0:ve(me,de,ue)}else{if("value"in he)return he.value;var _e=he.get;return _e===void 0?void 0:_e.call(ue)}},re=ee(0),ie=ce(re),fe=ee(27);function ce(ve){return ve&&ve.__esModule?ve:{default:ve}}function se(ve,ge){if(!(ve instanceof ge))throw new TypeError("Cannot call a class as a function")}function oe(ve,ge){if(!ve)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ge&&(typeof ge=="object"||typeof ge=="function")?ge:ve}function ae(ve,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ge);ve.prototype=Object.create(ge&&ge.prototype,{constructor:{value:ve,enumerable:!1,writable:!0,configurable:!0}}),ge&&(Object.setPrototypeOf?Object.setPrototypeOf(ve,ge):ve.__proto__=ge)}var le=["alt","height","width"],pe=function(ve){ae(ge,ve);function ge(){return se(this,ge),oe(this,(ge.__proto__||Object.getPrototypeOf(ge)).apply(this,arguments))}return te(ge,[{key:"format",value:function(ue,he){le.indexOf(ue)>-1?he?this.domNode.setAttribute(ue,he):this.domNode.removeAttribute(ue):ne(ge.prototype.__proto__||Object.getPrototypeOf(ge.prototype),"format",this).call(this,ue,he)}}],[{key:"create",value:function(ue){var he=ne(ge.__proto__||Object.getPrototypeOf(ge),"create",this).call(this,ue);return typeof ue=="string"&&he.setAttribute("src",this.sanitize(ue)),he}},{key:"formats",value:function(ue){return le.reduce(function(he,me){return ue.hasAttribute(me)&&(he[me]=ue.getAttribute(me)),he},{})}},{key:"match",value:function(ue){return/\.(jpe?g|gif|png)$/.test(ue)||/^data:image\/.+;base64/.test(ue)}},{key:"sanitize",value:function(ue){return(0,fe.sanitize)(ue,["http","https","data"])?ue:"//:0"}},{key:"value",value:function(ue){return ue.getAttribute("src")}}]),ge}(ie.default.Embed);pe.blotName="image",pe.tagName="IMG",X.default=pe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0});var te=function(){function ve(ge,de){for(var ue=0;ue<de.length;ue++){var he=de[ue];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(ge,he.key,he)}}return function(ge,de,ue){return de&&ve(ge.prototype,de),ue&&ve(ge,ue),ge}}(),ne=function ve(ge,de,ue){ge===null&&(ge=Function.prototype);var he=Object.getOwnPropertyDescriptor(ge,de);if(he===void 0){var me=Object.getPrototypeOf(ge);return me===null?void 0:ve(me,de,ue)}else{if("value"in he)return he.value;var _e=he.get;return _e===void 0?void 0:_e.call(ue)}},re=ee(4),ie=ee(27),fe=ce(ie);function ce(ve){return ve&&ve.__esModule?ve:{default:ve}}function se(ve,ge){if(!(ve instanceof ge))throw new TypeError("Cannot call a class as a function")}function oe(ve,ge){if(!ve)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ge&&(typeof ge=="object"||typeof ge=="function")?ge:ve}function ae(ve,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ge);ve.prototype=Object.create(ge&&ge.prototype,{constructor:{value:ve,enumerable:!1,writable:!0,configurable:!0}}),ge&&(Object.setPrototypeOf?Object.setPrototypeOf(ve,ge):ve.__proto__=ge)}var le=["height","width"],pe=function(ve){ae(ge,ve);function ge(){return se(this,ge),oe(this,(ge.__proto__||Object.getPrototypeOf(ge)).apply(this,arguments))}return te(ge,[{key:"format",value:function(ue,he){le.indexOf(ue)>-1?he?this.domNode.setAttribute(ue,he):this.domNode.removeAttribute(ue):ne(ge.prototype.__proto__||Object.getPrototypeOf(ge.prototype),"format",this).call(this,ue,he)}}],[{key:"create",value:function(ue){var he=ne(ge.__proto__||Object.getPrototypeOf(ge),"create",this).call(this,ue);return he.setAttribute("frameborder","0"),he.setAttribute("allowfullscreen",!0),he.setAttribute("src",this.sanitize(ue)),he}},{key:"formats",value:function(ue){return le.reduce(function(he,me){return ue.hasAttribute(me)&&(he[me]=ue.getAttribute(me)),he},{})}},{key:"sanitize",value:function(ue){return fe.default.sanitize(ue)}},{key:"value",value:function(ue){return ue.getAttribute("src")}}]),ge}(re.BlockEmbed);pe.blotName="video",pe.className="ql-video",pe.tagName="IFRAME",X.default=pe},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.FormulaBlot=void 0;var te=function(){function ue(he,me){for(var _e=0;_e<me.length;_e++){var be=me[_e];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(he,be.key,be)}}return function(he,me,_e){return me&&ue(he.prototype,me),_e&&ue(he,_e),he}}(),ne=function ue(he,me,_e){he===null&&(he=Function.prototype);var be=Object.getOwnPropertyDescriptor(he,me);if(be===void 0){var Se=Object.getPrototypeOf(he);return Se===null?void 0:ue(Se,me,_e)}else{if("value"in be)return be.value;var Te=be.get;return Te===void 0?void 0:Te.call(_e)}},re=ee(35),ie=ae(re),fe=ee(5),ce=ae(fe),se=ee(9),oe=ae(se);function ae(ue){return ue&&ue.__esModule?ue:{default:ue}}function le(ue,he){if(!(ue instanceof he))throw new TypeError("Cannot call a class as a function")}function pe(ue,he){if(!ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return he&&(typeof he=="object"||typeof he=="function")?he:ue}function ve(ue,he){if(typeof he!="function"&&he!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof he);ue.prototype=Object.create(he&&he.prototype,{constructor:{value:ue,enumerable:!1,writable:!0,configurable:!0}}),he&&(Object.setPrototypeOf?Object.setPrototypeOf(ue,he):ue.__proto__=he)}var ge=function(ue){ve(he,ue);function he(){return le(this,he),pe(this,(he.__proto__||Object.getPrototypeOf(he)).apply(this,arguments))}return te(he,null,[{key:"create",value:function(_e){var be=ne(he.__proto__||Object.getPrototypeOf(he),"create",this).call(this,_e);return typeof _e=="string"&&(window.katex.render(_e,be,{throwOnError:!1,errorColor:"#f00"}),be.setAttribute("data-value",_e)),be}},{key:"value",value:function(_e){return _e.getAttribute("data-value")}}]),he}(ie.default);ge.blotName="formula",ge.className="ql-formula",ge.tagName="SPAN";var de=function(ue){ve(he,ue),te(he,null,[{key:"register",value:function(){ce.default.register(ge,!0)}}]);function he(){le(this,he);var me=pe(this,(he.__proto__||Object.getPrototypeOf(he)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return me}return he}(oe.default);X.FormulaBlot=ge,X.default=de},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.CodeToken=X.CodeBlock=void 0;var te=function(){function _e(be,Se){for(var Te=0;Te<Se.length;Te++){var we=Se[Te];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(be,we.key,we)}}return function(be,Se,Te){return Se&&_e(be.prototype,Se),Te&&_e(be,Te),be}}(),ne=function _e(be,Se,Te){be===null&&(be=Function.prototype);var we=Object.getOwnPropertyDescriptor(be,Se);if(we===void 0){var ke=Object.getPrototypeOf(be);return ke===null?void 0:_e(ke,Se,Te)}else{if("value"in we)return we.value;var xe=we.get;return xe===void 0?void 0:xe.call(Te)}},re=ee(0),ie=pe(re),fe=ee(5),ce=pe(fe),se=ee(9),oe=pe(se),ae=ee(13),le=pe(ae);function pe(_e){return _e&&_e.__esModule?_e:{default:_e}}function ve(_e,be){if(!(_e instanceof be))throw new TypeError("Cannot call a class as a function")}function ge(_e,be){if(!_e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return be&&(typeof be=="object"||typeof be=="function")?be:_e}function de(_e,be){if(typeof be!="function"&&be!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof be);_e.prototype=Object.create(be&&be.prototype,{constructor:{value:_e,enumerable:!1,writable:!0,configurable:!0}}),be&&(Object.setPrototypeOf?Object.setPrototypeOf(_e,be):_e.__proto__=be)}var ue=function(_e){de(be,_e);function be(){return ve(this,be),ge(this,(be.__proto__||Object.getPrototypeOf(be)).apply(this,arguments))}return te(be,[{key:"replaceWith",value:function(Te){this.domNode.textContent=this.domNode.textContent,this.attach(),ne(be.prototype.__proto__||Object.getPrototypeOf(be.prototype),"replaceWith",this).call(this,Te)}},{key:"highlight",value:function(Te){var we=this.domNode.textContent;this.cachedText!==we&&((we.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=Te(we),this.domNode.normalize(),this.attach()),this.cachedText=we)}}]),be}(le.default);ue.className="ql-syntax";var he=new ie.default.Attributor.Class("token","hljs",{scope:ie.default.Scope.INLINE}),me=function(_e){de(be,_e),te(be,null,[{key:"register",value:function(){ce.default.register(he,!0),ce.default.register(ue,!0)}}]);function be(Se,Te){ve(this,be);var we=ge(this,(be.__proto__||Object.getPrototypeOf(be)).call(this,Se,Te));if(typeof we.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var ke=null;return we.quill.on(ce.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(ke),ke=setTimeout(function(){we.highlight(),ke=null},we.options.interval)}),we.highlight(),we}return te(be,[{key:"highlight",value:function(){var Te=this;if(!this.quill.selection.composing){this.quill.update(ce.default.sources.USER);var we=this.quill.getSelection();this.quill.scroll.descendants(ue).forEach(function(ke){ke.highlight(Te.options.highlight)}),this.quill.update(ce.default.sources.SILENT),we!=null&&this.quill.setSelection(we,ce.default.sources.SILENT)}}}]),be}(oe.default);me.DEFAULTS={highlight:function(){return window.hljs==null?null:function(_e){var be=window.hljs.highlightAuto(_e);return be.value}}(),interval:1e3},X.CodeBlock=ue,X.CodeToken=he,X.default=me},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(j,X){j.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(j,X){j.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(j,X){j.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(j,X){j.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(j,X){j.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(j,X,ee){Object.defineProperty(X,"__esModule",{value:!0}),X.default=X.BubbleTooltip=void 0;var te=function be(Se,Te,we){Se===null&&(Se=Function.prototype);var ke=Object.getOwnPropertyDescriptor(Se,Te);if(ke===void 0){var xe=Object.getPrototypeOf(Se);return xe===null?void 0:be(xe,Te,we)}else{if("value"in ke)return ke.value;var Ae=ke.get;return Ae===void 0?void 0:Ae.call(we)}},ne=function(){function be(Se,Te){for(var we=0;we<Te.length;we++){var ke=Te[we];ke.enumerable=ke.enumerable||!1,ke.configurable=!0,"value"in ke&&(ke.writable=!0),Object.defineProperty(Se,ke.key,ke)}}return function(Se,Te,we){return Te&&be(Se.prototype,Te),we&&be(Se,we),Se}}(),re=ee(3),ie=ve(re),fe=ee(8),ce=ve(fe),se=ee(43),oe=ve(se),ae=ee(15),le=ee(41),pe=ve(le);function ve(be){return be&&be.__esModule?be:{default:be}}function ge(be,Se){if(!(be instanceof Se))throw new TypeError("Cannot call a class as a function")}function de(be,Se){if(!be)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Se&&(typeof Se=="object"||typeof Se=="function")?Se:be}function ue(be,Se){if(typeof Se!="function"&&Se!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Se);be.prototype=Object.create(Se&&Se.prototype,{constructor:{value:be,enumerable:!1,writable:!0,configurable:!0}}),Se&&(Object.setPrototypeOf?Object.setPrototypeOf(be,Se):be.__proto__=Se)}var he=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],me=function(be){ue(Se,be);function Se(Te,we){ge(this,Se),we.modules.toolbar!=null&&we.modules.toolbar.container==null&&(we.modules.toolbar.container=he);var ke=de(this,(Se.__proto__||Object.getPrototypeOf(Se)).call(this,Te,we));return ke.quill.container.classList.add("ql-bubble"),ke}return ne(Se,[{key:"extendToolbar",value:function(we){this.tooltip=new _e(this.quill,this.options.bounds),this.tooltip.root.appendChild(we.container),this.buildButtons([].slice.call(we.container.querySelectorAll("button")),pe.default),this.buildPickers([].slice.call(we.container.querySelectorAll("select")),pe.default)}}]),Se}(oe.default);me.DEFAULTS=(0,ie.default)(!0,{},oe.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(Se){Se?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var _e=function(be){ue(Se,be);function Se(Te,we){ge(this,Se);var ke=de(this,(Se.__proto__||Object.getPrototypeOf(Se)).call(this,Te,we));return ke.quill.on(ce.default.events.EDITOR_CHANGE,function(xe,Ae,Le,De){if(xe===ce.default.events.SELECTION_CHANGE)if(Ae!=null&&Ae.length>0&&De===ce.default.sources.USER){ke.show(),ke.root.style.left="0px",ke.root.style.width="",ke.root.style.width=ke.root.offsetWidth+"px";var $e=ke.quill.getLines(Ae.index,Ae.length);if($e.length===1)ke.position(ke.quill.getBounds(Ae));else{var Ve=$e[$e.length-1],Qe=ke.quill.getIndex(Ve),je=Math.min(Ve.length()-1,Ae.index+Ae.length-Qe),He=ke.quill.getBounds(new ae.Range(Qe,je));ke.position(He)}}else document.activeElement!==ke.textbox&&ke.quill.hasFocus()&&ke.hide()}),ke}return ne(Se,[{key:"listen",value:function(){var we=this;te(Se.prototype.__proto__||Object.getPrototypeOf(Se.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){we.root.classList.remove("ql-editing")}),this.quill.on(ce.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!we.root.classList.contains("ql-hidden")){var ke=we.quill.getSelection();ke!=null&&we.position(we.quill.getBounds(ke))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(we){var ke=te(Se.prototype.__proto__||Object.getPrototypeOf(Se.prototype),"position",this).call(this,we),xe=this.root.querySelector(".ql-tooltip-arrow");if(xe.style.marginLeft="",ke===0)return ke;xe.style.marginLeft=-1*ke-xe.offsetWidth/2+"px"}}]),Se}(se.BaseTooltip);_e.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),X.BubbleTooltip=_e,X.default=me},function(j,X,ee){j.exports=ee(63)}]).default})})(quill);const Quill=getDefaultExportFromCjs(quill.exports);var quillCursors={exports:{}};/*! For license information please see quill-cursors.js.LICENSE.txt */(function(q,B){(function(j,X){q.exports=X()})(self,()=>(()=>{var j={582:(ne,re,ie)=>{ie.d(re,{Z:()=>ae});var fe=ie(81),ce=ie.n(fe),se=ie(645),oe=ie.n(se)()(ce());oe.push([ne.id,".ql-container{position:relative;overflow:hidden}@media(pointer: coarse){.ql-cursor-caret-container{z-index:-1}}.ql-cursor.hidden{display:none}.ql-cursor .ql-cursor-caret-container,.ql-cursor .ql-cursor-flag{position:absolute}.ql-cursor .ql-cursor-flag{z-index:1;transform:translate3d(-1px, -100%, 0);opacity:0;visibility:hidden;color:#fff;padding-bottom:2px;border-radius:0 3px 3px 0}.ql-cursor .ql-cursor-flag.flag-flipped{border-radius:3px 0 0 3px;transform:translate3d(calc(-100% + 1px ), -100%, 0)}@media screen{.ql-cursor .ql-cursor-flag{transition:opacity 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms,visibility 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms}}.ql-cursor .ql-cursor-flag .ql-cursor-name{margin-left:5px;margin-right:5px;display:inline-block;margin-top:-2px;white-space:nowrap}.ql-cursor .ql-cursor-flag.no-delay[style]{transition-delay:unset !important}.ql-cursor .ql-cursor-caret-container{cursor:text;margin-left:-9px;padding:0 9px}.ql-cursor .ql-cursor-caret-container.hover+.ql-cursor-flag{opacity:1;visibility:visible;transition:none}.ql-cursor .ql-cursor-caret-container.no-pointer{pointer-events:none}.ql-cursor .ql-cursor-caret-container .ql-cursor-caret{position:absolute;top:0;bottom:0;width:2px;margin-left:-1px;background-color:attr(data-color)}.ql-cursor .ql-cursor-selection-block{position:absolute;pointer-events:none}",""]);const ae=oe},645:ne=>{ne.exports=function(re){var ie=[];return ie.toString=function(){return this.map(function(fe){var ce="",se=fe[5]!==void 0;return fe[4]&&(ce+="@supports (".concat(fe[4],") {")),fe[2]&&(ce+="@media ".concat(fe[2]," {")),se&&(ce+="@layer".concat(fe[5].length>0?" ".concat(fe[5]):""," {")),ce+=re(fe),se&&(ce+="}"),fe[2]&&(ce+="}"),fe[4]&&(ce+="}"),ce}).join("")},ie.i=function(fe,ce,se,oe,ae){typeof fe=="string"&&(fe=[[null,fe,void 0]]);var le={};if(se)for(var pe=0;pe<this.length;pe++){var ve=this[pe][0];ve!=null&&(le[ve]=!0)}for(var ge=0;ge<fe.length;ge++){var de=[].concat(fe[ge]);se&&le[de[0]]||(ae!==void 0&&(de[5]===void 0||(de[1]="@layer".concat(de[5].length>0?" ".concat(de[5]):""," {").concat(de[1],"}")),de[5]=ae),ce&&(de[2]&&(de[1]="@media ".concat(de[2]," {").concat(de[1],"}")),de[2]=ce),oe&&(de[4]?(de[1]="@supports (".concat(de[4],") {").concat(de[1],"}"),de[4]=oe):de[4]="".concat(oe)),ie.push(de))}},ie}},81:ne=>{ne.exports=function(re){return re[1]}},465:(ne,re,ie)=>{ne=ie.nmd(ne);var fe="__lodash_hash_undefined__",ce=9007199254740991,se="[object Arguments]",oe="[object Boolean]",ae="[object Date]",le="[object Function]",pe="[object GeneratorFunction]",ve="[object Map]",ge="[object Number]",de="[object Object]",ue="[object Promise]",he="[object RegExp]",me="[object Set]",_e="[object String]",be="[object Symbol]",Se="[object WeakMap]",Te="[object ArrayBuffer]",we="[object DataView]",ke="[object Float32Array]",xe="[object Float64Array]",Ae="[object Int8Array]",Le="[object Int16Array]",De="[object Int32Array]",$e="[object Uint8Array]",Ve="[object Uint8ClampedArray]",Qe="[object Uint16Array]",je="[object Uint32Array]",He=/\w*$/,Ie=/^\[object .+?Constructor\]$/,Ue=/^(?:0|[1-9]\d*)$/,Pe={};Pe[se]=Pe["[object Array]"]=Pe[Te]=Pe[we]=Pe[oe]=Pe[ae]=Pe[ke]=Pe[xe]=Pe[Ae]=Pe[Le]=Pe[De]=Pe[ve]=Pe[ge]=Pe[de]=Pe[he]=Pe[me]=Pe[_e]=Pe[be]=Pe[$e]=Pe[Ve]=Pe[Qe]=Pe[je]=!0,Pe["[object Error]"]=Pe[le]=Pe[Se]=!1;var We=typeof ie.g=="object"&&ie.g&&ie.g.Object===Object&&ie.g,Ye=typeof self=="object"&&self&&self.Object===Object&&self,Ne=We||Ye||Function("return this")(),Ke=re&&!re.nodeType&&re,Xe=Ke&&ne&&!ne.nodeType&&ne,Je=Xe&&Xe.exports===Ke;function nt(Ge,rt){return Ge.set(rt[0],rt[1]),Ge}function ot(Ge,rt){return Ge.add(rt),Ge}function ht(Ge,rt,lt,gt){var bt=-1,Et=Ge?Ge.length:0;for(gt&&Et&&(lt=Ge[++bt]);++bt<Et;)lt=rt(lt,Ge[bt],bt,Ge);return lt}function ct(Ge){var rt=!1;if(Ge!=null&&typeof Ge.toString!="function")try{rt=!!(Ge+"")}catch{}return rt}function ut(Ge){var rt=-1,lt=Array(Ge.size);return Ge.forEach(function(gt,bt){lt[++rt]=[bt,gt]}),lt}function Re(Ge,rt){return function(lt){return Ge(rt(lt))}}function Me(Ge){var rt=-1,lt=Array(Ge.size);return Ge.forEach(function(gt){lt[++rt]=gt}),lt}var qe,Be=Array.prototype,Oe=Function.prototype,ye=Object.prototype,Ce=Ne["__core-js_shared__"],Ee=(qe=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||""))?"Symbol(src)_1."+qe:"",Fe=Oe.toString,ze=ye.hasOwnProperty,Ze=ye.toString,st=RegExp("^"+Fe.call(ze).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pt=Je?Ne.Buffer:void 0,dt=Ne.Symbol,ft=Ne.Uint8Array,tt=Re(Object.getPrototypeOf,Object),mt=Object.create,Lt=ye.propertyIsEnumerable,Ut=Be.splice,Dt=Object.getOwnPropertySymbols,Mt=pt?pt.isBuffer:void 0,Bt=Re(Object.keys,Object),jt=Jt(Ne,"DataView"),Ft=Jt(Ne,"Map"),Kt=Jt(Ne,"Promise"),It=Jt(Ne,"Set"),qt=Jt(Ne,"WeakMap"),Vt=Jt(Object,"create"),dn=tn(jt),Xt=tn(Ft),pn=tn(Kt),fn=tn(It),wn=tn(qt),mn=dt?dt.prototype:void 0,vn=mn?mn.valueOf:void 0;function Qt(Ge){var rt=-1,lt=Ge?Ge.length:0;for(this.clear();++rt<lt;){var gt=Ge[rt];this.set(gt[0],gt[1])}}function Ht(Ge){var rt=-1,lt=Ge?Ge.length:0;for(this.clear();++rt<lt;){var gt=Ge[rt];this.set(gt[0],gt[1])}}function zt(Ge){var rt=-1,lt=Ge?Ge.length:0;for(this.clear();++rt<lt;){var gt=Ge[rt];this.set(gt[0],gt[1])}}function an(Ge){this.__data__=new Ht(Ge)}function Yt(Ge,rt,lt){var gt=Ge[rt];ze.call(Ge,rt)&&Sn(gt,lt)&&(lt!==void 0||rt in Ge)||(Ge[rt]=lt)}function gn(Ge,rt){for(var lt=Ge.length;lt--;)if(Sn(Ge[lt][0],rt))return lt;return-1}function Wt(Ge,rt,lt,gt,bt,Et,At){var kt;if(gt&&(kt=Et?gt(Ge,bt,Et,At):gt(Ge)),kt!==void 0)return kt;if(!xt(Ge))return Ge;var Pt=et(Ge);if(Pt){if(kt=function(vt){var Tt=vt.length,Nt=vt.constructor(Tt);return Tt&&typeof vt[0]=="string"&&ze.call(vt,"index")&&(Nt.index=vt.index,Nt.input=vt.input),Nt}(Ge),!rt)return function(vt,Tt){var Nt=-1,wt=vt.length;for(Tt||(Tt=Array(wt));++Nt<wt;)Tt[Nt]=vt[Nt];return Tt}(Ge,kt)}else{var Ot=en(Ge),nn=Ot==le||Ot==pe;if(at(Ge))return function(vt,Tt){if(Tt)return vt.slice();var Nt=new vt.constructor(vt.length);return vt.copy(Nt),Nt}(Ge,rt);if(Ot==de||Ot==se||nn&&!Et){if(ct(Ge))return Et?Ge:{};if(kt=function(vt){return typeof vt.constructor!="function"||ln(vt)?{}:xt(Tt=tt(vt))?mt(Tt):{};var Tt}(nn?{}:Ge),!rt)return function(vt,Tt){return kn(vt,bn(vt),Tt)}(Ge,function(vt,Tt){return vt&&kn(Tt,_t(Tt),vt)}(kt,Ge))}else{if(!Pe[Ot])return Et?Ge:{};kt=function(vt,Tt,Nt,wt){var St,Gt=vt.constructor;switch(Tt){case Te:return yn(vt);case oe:case ae:return new Gt(+vt);case we:return function(Ct,$t){var Rt=$t?yn(Ct.buffer):Ct.buffer;return new Ct.constructor(Rt,Ct.byteOffset,Ct.byteLength)}(vt,wt);case ke:case xe:case Ae:case Le:case De:case $e:case Ve:case Qe:case je:return function(Ct,$t){var Rt=$t?yn(Ct.buffer):Ct.buffer;return new Ct.constructor(Rt,Ct.byteOffset,Ct.length)}(vt,wt);case ve:return function(Ct,$t,Rt){return ht($t?Rt(ut(Ct),!0):ut(Ct),nt,new Ct.constructor)}(vt,wt,Nt);case ge:case _e:return new Gt(vt);case he:return function(Ct){var $t=new Ct.constructor(Ct.source,He.exec(Ct));return $t.lastIndex=Ct.lastIndex,$t}(vt);case me:return function(Ct,$t,Rt){return ht($t?Rt(Me(Ct),!0):Me(Ct),ot,new Ct.constructor)}(vt,wt,Nt);case be:return St=vt,vn?Object(vn.call(St)):{}}}(Ge,Ot,Wt,rt)}}At||(At=new an);var on=At.get(Ge);if(on)return on;if(At.set(Ge,kt),!Pt)var cn=lt?function(vt){return function(Tt,Nt,wt){var St=Nt(Tt);return et(Tt)?St:function(Gt,Ct){for(var $t=-1,Rt=Ct.length,Zt=Gt.length;++$t<Rt;)Gt[Zt+$t]=Ct[$t];return Gt}(St,wt(Tt))}(vt,_t,bn)}(Ge):_t(Ge);return function(vt,Tt){for(var Nt=-1,wt=vt?vt.length:0;++Nt<wt&&Tt(vt[Nt],Nt)!==!1;);}(cn||Ge,function(vt,Tt){cn&&(vt=Ge[Tt=vt]),Yt(kt,Tt,Wt(vt,rt,lt,gt,Tt,Ge,At))}),kt}function yn(Ge){var rt=new Ge.constructor(Ge.byteLength);return new ft(rt).set(new ft(Ge)),rt}function kn(Ge,rt,lt,gt){lt||(lt={});for(var bt=-1,Et=rt.length;++bt<Et;){var At=rt[bt],kt=gt?gt(lt[At],Ge[At],At,lt,Ge):void 0;Yt(lt,At,kt===void 0?Ge[At]:kt)}return lt}function rn(Ge,rt){var lt,gt,bt=Ge.__data__;return((gt=typeof(lt=rt))=="string"||gt=="number"||gt=="symbol"||gt=="boolean"?lt!=="__proto__":lt===null)?bt[typeof rt=="string"?"string":"hash"]:bt.map}function Jt(Ge,rt){var lt=function(gt,bt){return gt==null?void 0:gt[bt]}(Ge,rt);return function(gt){return!(!xt(gt)||(bt=gt,Ee&&Ee in bt))&&(yt(gt)||ct(gt)?st:Ie).test(tn(gt));var bt}(lt)?lt:void 0}Qt.prototype.clear=function(){this.__data__=Vt?Vt(null):{}},Qt.prototype.delete=function(Ge){return this.has(Ge)&&delete this.__data__[Ge]},Qt.prototype.get=function(Ge){var rt=this.__data__;if(Vt){var lt=rt[Ge];return lt===fe?void 0:lt}return ze.call(rt,Ge)?rt[Ge]:void 0},Qt.prototype.has=function(Ge){var rt=this.__data__;return Vt?rt[Ge]!==void 0:ze.call(rt,Ge)},Qt.prototype.set=function(Ge,rt){return this.__data__[Ge]=Vt&&rt===void 0?fe:rt,this},Ht.prototype.clear=function(){this.__data__=[]},Ht.prototype.delete=function(Ge){var rt=this.__data__,lt=gn(rt,Ge);return!(lt<0||(lt==rt.length-1?rt.pop():Ut.call(rt,lt,1),0))},Ht.prototype.get=function(Ge){var rt=this.__data__,lt=gn(rt,Ge);return lt<0?void 0:rt[lt][1]},Ht.prototype.has=function(Ge){return gn(this.__data__,Ge)>-1},Ht.prototype.set=function(Ge,rt){var lt=this.__data__,gt=gn(lt,Ge);return gt<0?lt.push([Ge,rt]):lt[gt][1]=rt,this},zt.prototype.clear=function(){this.__data__={hash:new Qt,map:new(Ft||Ht),string:new Qt}},zt.prototype.delete=function(Ge){return rn(this,Ge).delete(Ge)},zt.prototype.get=function(Ge){return rn(this,Ge).get(Ge)},zt.prototype.has=function(Ge){return rn(this,Ge).has(Ge)},zt.prototype.set=function(Ge,rt){return rn(this,Ge).set(Ge,rt),this},an.prototype.clear=function(){this.__data__=new Ht},an.prototype.delete=function(Ge){return this.__data__.delete(Ge)},an.prototype.get=function(Ge){return this.__data__.get(Ge)},an.prototype.has=function(Ge){return this.__data__.has(Ge)},an.prototype.set=function(Ge,rt){var lt=this.__data__;if(lt instanceof Ht){var gt=lt.__data__;if(!Ft||gt.length<199)return gt.push([Ge,rt]),this;lt=this.__data__=new zt(gt)}return lt.set(Ge,rt),this};var bn=Dt?Re(Dt,Object):function(){return[]},en=function(Ge){return Ze.call(Ge)};function Cn(Ge,rt){return!!(rt=rt==null?ce:rt)&&(typeof Ge=="number"||Ue.test(Ge))&&Ge>-1&&Ge%1==0&&Ge<rt}function ln(Ge){var rt=Ge&&Ge.constructor;return Ge===(typeof rt=="function"&&rt.prototype||ye)}function tn(Ge){if(Ge!=null){try{return Fe.call(Ge)}catch{}try{return Ge+""}catch{}}return""}function Sn(Ge,rt){return Ge===rt||Ge!=Ge&&rt!=rt}(jt&&en(new jt(new ArrayBuffer(1)))!=we||Ft&&en(new Ft)!=ve||Kt&&en(Kt.resolve())!=ue||It&&en(new It)!=me||qt&&en(new qt)!=Se)&&(en=function(Ge){var rt=Ze.call(Ge),lt=rt==de?Ge.constructor:void 0,gt=lt?tn(lt):void 0;if(gt)switch(gt){case dn:return we;case Xt:return ve;case pn:return ue;case fn:return me;case wn:return Se}return rt});var et=Array.isArray;function it(Ge){return Ge!=null&&function(rt){return typeof rt=="number"&&rt>-1&&rt%1==0&&rt<=ce}(Ge.length)&&!yt(Ge)}var at=Mt||function(){return!1};function yt(Ge){var rt=xt(Ge)?Ze.call(Ge):"";return rt==le||rt==pe}function xt(Ge){var rt=typeof Ge;return!!Ge&&(rt=="object"||rt=="function")}function _t(Ge){return it(Ge)?function(rt,lt){var gt=et(rt)||function(kt){return function(Pt){return function(Ot){return!!Ot&&typeof Ot=="object"}(Pt)&&it(Pt)}(kt)&&ze.call(kt,"callee")&&(!Lt.call(kt,"callee")||Ze.call(kt)==se)}(rt)?function(kt,Pt){for(var Ot=-1,nn=Array(kt);++Ot<kt;)nn[Ot]=Pt(Ot);return nn}(rt.length,String):[],bt=gt.length,Et=!!bt;for(var At in rt)!lt&&!ze.call(rt,At)||Et&&(At=="length"||Cn(At,bt))||gt.push(At);return gt}(Ge):function(rt){if(!ln(rt))return Bt(rt);var lt=[];for(var gt in Object(rt))ze.call(rt,gt)&&gt!="constructor"&&lt.push(gt);return lt}(Ge)}ne.exports=function(Ge){return Wt(Ge,!0,!0)}},307:(ne,re,ie)=>{ne=ie.nmd(ne);var fe="__lodash_hash_undefined__",ce=9007199254740991,se="[object Arguments]",oe="[object Array]",ae="[object Boolean]",le="[object Date]",pe="[object Error]",ve="[object Function]",ge="[object Map]",de="[object Number]",ue="[object Object]",he="[object Promise]",me="[object RegExp]",_e="[object Set]",be="[object String]",Se="[object WeakMap]",Te="[object ArrayBuffer]",we="[object DataView]",ke=/^\[object .+?Constructor\]$/,xe=/^(?:0|[1-9]\d*)$/,Ae={};Ae["[object Float32Array]"]=Ae["[object Float64Array]"]=Ae["[object Int8Array]"]=Ae["[object Int16Array]"]=Ae["[object Int32Array]"]=Ae["[object Uint8Array]"]=Ae["[object Uint8ClampedArray]"]=Ae["[object Uint16Array]"]=Ae["[object Uint32Array]"]=!0,Ae[se]=Ae[oe]=Ae[Te]=Ae[ae]=Ae[we]=Ae[le]=Ae[pe]=Ae[ve]=Ae[ge]=Ae[de]=Ae[ue]=Ae[me]=Ae[_e]=Ae[be]=Ae[Se]=!1;var Le=typeof ie.g=="object"&&ie.g&&ie.g.Object===Object&&ie.g,De=typeof self=="object"&&self&&self.Object===Object&&self,$e=Le||De||Function("return this")(),Ve=re&&!re.nodeType&&re,Qe=Ve&&ne&&!ne.nodeType&&ne,je=Qe&&Qe.exports===Ve,He=je&&Le.process,Ie=function(){try{return He&&He.binding&&He.binding("util")}catch{}}(),Ue=Ie&&Ie.isTypedArray;function Pe(et,it){for(var at=-1,yt=et==null?0:et.length;++at<yt;)if(it(et[at],at,et))return!0;return!1}function We(et){var it=-1,at=Array(et.size);return et.forEach(function(yt,xt){at[++it]=[xt,yt]}),at}function Ye(et){var it=-1,at=Array(et.size);return et.forEach(function(yt){at[++it]=yt}),at}var Ne,Ke,Xe,Je=Array.prototype,nt=Function.prototype,ot=Object.prototype,ht=$e["__core-js_shared__"],ct=nt.toString,ut=ot.hasOwnProperty,Re=(Ne=/[^.]+$/.exec(ht&&ht.keys&&ht.keys.IE_PROTO||""))?"Symbol(src)_1."+Ne:"",Me=ot.toString,qe=RegExp("^"+ct.call(ut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=je?$e.Buffer:void 0,Oe=$e.Symbol,ye=$e.Uint8Array,Ce=ot.propertyIsEnumerable,Ee=Je.splice,Fe=Oe?Oe.toStringTag:void 0,ze=Object.getOwnPropertySymbols,Ze=Be?Be.isBuffer:void 0,st=(Ke=Object.keys,Xe=Object,function(et){return Ke(Xe(et))}),pt=zt($e,"DataView"),dt=zt($e,"Map"),ft=zt($e,"Promise"),tt=zt($e,"Set"),mt=zt($e,"WeakMap"),Lt=zt(Object,"create"),Ut=Wt(pt),Dt=Wt(dt),Mt=Wt(ft),Bt=Wt(tt),jt=Wt(mt),Ft=Oe?Oe.prototype:void 0,Kt=Ft?Ft.valueOf:void 0;function It(et){var it=-1,at=et==null?0:et.length;for(this.clear();++it<at;){var yt=et[it];this.set(yt[0],yt[1])}}function qt(et){var it=-1,at=et==null?0:et.length;for(this.clear();++it<at;){var yt=et[it];this.set(yt[0],yt[1])}}function Vt(et){var it=-1,at=et==null?0:et.length;for(this.clear();++it<at;){var yt=et[it];this.set(yt[0],yt[1])}}function dn(et){var it=-1,at=et==null?0:et.length;for(this.__data__=new Vt;++it<at;)this.add(et[it])}function Xt(et){var it=this.__data__=new qt(et);this.size=it.size}function pn(et,it){for(var at=et.length;at--;)if(yn(et[at][0],it))return at;return-1}function fn(et){return et==null?et===void 0?"[object Undefined]":"[object Null]":Fe&&Fe in Object(et)?function(it){var at=ut.call(it,Fe),yt=it[Fe];try{it[Fe]=void 0;var xt=!0}catch{}var _t=Me.call(it);return xt&&(at?it[Fe]=yt:delete it[Fe]),_t}(et):function(it){return Me.call(it)}(et)}function wn(et){return ln(et)&&fn(et)==se}function mn(et,it,at,yt,xt){return et===it||(et==null||it==null||!ln(et)&&!ln(it)?et!=et&&it!=it:function(_t,Ge,rt,lt,gt,bt){var Et=rn(_t),At=rn(Ge),kt=Et?oe:Yt(_t),Pt=At?oe:Yt(Ge),Ot=(kt=kt==se?ue:kt)==ue,nn=(Pt=Pt==se?ue:Pt)==ue,on=kt==Pt;if(on&&Jt(_t)){if(!Jt(Ge))return!1;Et=!0,Ot=!1}if(on&&!Ot)return bt||(bt=new Xt),Et||tn(_t)?vn(_t,Ge,rt,lt,gt,bt):function(wt,St,Gt,Ct,$t,Rt,Zt){switch(Gt){case we:if(wt.byteLength!=St.byteLength||wt.byteOffset!=St.byteOffset)return!1;wt=wt.buffer,St=St.buffer;case Te:return!(wt.byteLength!=St.byteLength||!Rt(new ye(wt),new ye(St)));case ae:case le:case de:return yn(+wt,+St);case pe:return wt.name==St.name&&wt.message==St.message;case me:case be:return wt==St+"";case ge:var un=We;case _e:var _n=1&Ct;if(un||(un=Ye),wt.size!=St.size&&!_n)return!1;var hn=Zt.get(wt);if(hn)return hn==St;Ct|=2,Zt.set(wt,St);var sn=vn(un(wt),un(St),Ct,$t,Rt,Zt);return Zt.delete(wt),sn;case"[object Symbol]":if(Kt)return Kt.call(wt)==Kt.call(St)}return!1}(_t,Ge,kt,rt,lt,gt,bt);if(!(1&rt)){var cn=Ot&&ut.call(_t,"__wrapped__"),vt=nn&&ut.call(Ge,"__wrapped__");if(cn||vt){var Tt=cn?_t.value():_t,Nt=vt?Ge.value():Ge;return bt||(bt=new Xt),gt(Tt,Nt,rt,lt,bt)}}return!!on&&(bt||(bt=new Xt),function(wt,St,Gt,Ct,$t,Rt){var Zt=1&Gt,un=Qt(wt),_n=un.length;if(_n!=Qt(St).length&&!Zt)return!1;for(var hn=_n;hn--;){var sn=un[hn];if(!(Zt?sn in St:ut.call(St,sn)))return!1}var Rn=Rt.get(wt);if(Rn&&Rt.get(St))return Rn==St;var xn=!0;Rt.set(wt,St),Rt.set(St,wt);for(var Ln=Zt;++hn<_n;){var En=wt[sn=un[hn]],Tn=St[sn];if(Ct)var Dn=Zt?Ct(Tn,En,sn,St,wt,Rt):Ct(En,Tn,sn,wt,St,Rt);if(!(Dn===void 0?En===Tn||$t(En,Tn,Gt,Ct,Rt):Dn)){xn=!1;break}Ln||(Ln=sn=="constructor")}if(xn&&!Ln){var An=wt.constructor,On=St.constructor;An==On||!("constructor"in wt)||!("constructor"in St)||typeof An=="function"&&An instanceof An&&typeof On=="function"&&On instanceof On||(xn=!1)}return Rt.delete(wt),Rt.delete(St),xn}(_t,Ge,rt,lt,gt,bt))}(et,it,at,yt,mn,xt))}function vn(et,it,at,yt,xt,_t){var Ge=1&at,rt=et.length,lt=it.length;if(rt!=lt&&!(Ge&&lt>rt))return!1;var gt=_t.get(et);if(gt&&_t.get(it))return gt==it;var bt=-1,Et=!0,At=2&at?new dn:void 0;for(_t.set(et,it),_t.set(it,et);++bt<rt;){var kt=et[bt],Pt=it[bt];if(yt)var Ot=Ge?yt(Pt,kt,bt,it,et,_t):yt(kt,Pt,bt,et,it,_t);if(Ot!==void 0){if(Ot)continue;Et=!1;break}if(At){if(!Pe(it,function(nn,on){if(cn=on,!At.has(cn)&&(kt===nn||xt(kt,nn,at,yt,_t)))return At.push(on);var cn})){Et=!1;break}}else if(kt!==Pt&&!xt(kt,Pt,at,yt,_t)){Et=!1;break}}return _t.delete(et),_t.delete(it),Et}function Qt(et){return function(it,at,yt){var xt=at(it);return rn(it)?xt:function(_t,Ge){for(var rt=-1,lt=Ge.length,gt=_t.length;++rt<lt;)_t[gt+rt]=Ge[rt];return _t}(xt,yt(it))}(et,Sn,an)}function Ht(et,it){var at,yt,xt=et.__data__;return((yt=typeof(at=it))=="string"||yt=="number"||yt=="symbol"||yt=="boolean"?at!=="__proto__":at===null)?xt[typeof it=="string"?"string":"hash"]:xt.map}function zt(et,it){var at=function(yt,xt){return yt==null?void 0:yt[xt]}(et,it);return function(yt){return!(!Cn(yt)||function(xt){return!!Re&&Re in xt}(yt))&&(bn(yt)?qe:ke).test(Wt(yt))}(at)?at:void 0}It.prototype.clear=function(){this.__data__=Lt?Lt(null):{},this.size=0},It.prototype.delete=function(et){var it=this.has(et)&&delete this.__data__[et];return this.size-=it?1:0,it},It.prototype.get=function(et){var it=this.__data__;if(Lt){var at=it[et];return at===fe?void 0:at}return ut.call(it,et)?it[et]:void 0},It.prototype.has=function(et){var it=this.__data__;return Lt?it[et]!==void 0:ut.call(it,et)},It.prototype.set=function(et,it){var at=this.__data__;return this.size+=this.has(et)?0:1,at[et]=Lt&&it===void 0?fe:it,this},qt.prototype.clear=function(){this.__data__=[],this.size=0},qt.prototype.delete=function(et){var it=this.__data__,at=pn(it,et);return!(at<0||(at==it.length-1?it.pop():Ee.call(it,at,1),--this.size,0))},qt.prototype.get=function(et){var it=this.__data__,at=pn(it,et);return at<0?void 0:it[at][1]},qt.prototype.has=function(et){return pn(this.__data__,et)>-1},qt.prototype.set=function(et,it){var at=this.__data__,yt=pn(at,et);return yt<0?(++this.size,at.push([et,it])):at[yt][1]=it,this},Vt.prototype.clear=function(){this.size=0,this.__data__={hash:new It,map:new(dt||qt),string:new It}},Vt.prototype.delete=function(et){var it=Ht(this,et).delete(et);return this.size-=it?1:0,it},Vt.prototype.get=function(et){return Ht(this,et).get(et)},Vt.prototype.has=function(et){return Ht(this,et).has(et)},Vt.prototype.set=function(et,it){var at=Ht(this,et),yt=at.size;return at.set(et,it),this.size+=at.size==yt?0:1,this},dn.prototype.add=dn.prototype.push=function(et){return this.__data__.set(et,fe),this},dn.prototype.has=function(et){return this.__data__.has(et)},Xt.prototype.clear=function(){this.__data__=new qt,this.size=0},Xt.prototype.delete=function(et){var it=this.__data__,at=it.delete(et);return this.size=it.size,at},Xt.prototype.get=function(et){return this.__data__.get(et)},Xt.prototype.has=function(et){return this.__data__.has(et)},Xt.prototype.set=function(et,it){var at=this.__data__;if(at instanceof qt){var yt=at.__data__;if(!dt||yt.length<199)return yt.push([et,it]),this.size=++at.size,this;at=this.__data__=new Vt(yt)}return at.set(et,it),this.size=at.size,this};var an=ze?function(et){return et==null?[]:(et=Object(et),function(it,at){for(var yt=-1,xt=it==null?0:it.length,_t=0,Ge=[];++yt<xt;){var rt=it[yt];lt=rt,Ce.call(et,lt)&&(Ge[_t++]=rt)}var lt;return Ge}(ze(et)))}:function(){return[]},Yt=fn;function gn(et,it){return!!(it=it==null?ce:it)&&(typeof et=="number"||xe.test(et))&&et>-1&&et%1==0&&et<it}function Wt(et){if(et!=null){try{return ct.call(et)}catch{}try{return et+""}catch{}}return""}function yn(et,it){return et===it||et!=et&&it!=it}(pt&&Yt(new pt(new ArrayBuffer(1)))!=we||dt&&Yt(new dt)!=ge||ft&&Yt(ft.resolve())!=he||tt&&Yt(new tt)!=_e||mt&&Yt(new mt)!=Se)&&(Yt=function(et){var it=fn(et),at=it==ue?et.constructor:void 0,yt=at?Wt(at):"";if(yt)switch(yt){case Ut:return we;case Dt:return ge;case Mt:return he;case Bt:return _e;case jt:return Se}return it});var kn=wn(function(){return arguments}())?wn:function(et){return ln(et)&&ut.call(et,"callee")&&!Ce.call(et,"callee")},rn=Array.isArray,Jt=Ze||function(){return!1};function bn(et){if(!Cn(et))return!1;var it=fn(et);return it==ve||it=="[object GeneratorFunction]"||it=="[object AsyncFunction]"||it=="[object Proxy]"}function en(et){return typeof et=="number"&&et>-1&&et%1==0&&et<=ce}function Cn(et){var it=typeof et;return et!=null&&(it=="object"||it=="function")}function ln(et){return et!=null&&typeof et=="object"}var tn=Ue?function(et){return function(it){return et(it)}}(Ue):function(et){return ln(et)&&en(et.length)&&!!Ae[fn(et)]};function Sn(et){return(it=et)!=null&&en(it.length)&&!bn(it)?function(at,yt){var xt=rn(at),_t=!xt&&kn(at),Ge=!xt&&!_t&&Jt(at),rt=!xt&&!_t&&!Ge&&tn(at),lt=xt||_t||Ge||rt,gt=lt?function(At,kt){for(var Pt=-1,Ot=Array(At);++Pt<At;)Ot[Pt]=kt(Pt);return Ot}(at.length,String):[],bt=gt.length;for(var Et in at)!yt&&!ut.call(at,Et)||lt&&(Et=="length"||Ge&&(Et=="offset"||Et=="parent")||rt&&(Et=="buffer"||Et=="byteLength"||Et=="byteOffset")||gn(Et,bt))||gt.push(Et);return gt}(et):function(at){if(xt=(yt=at)&&yt.constructor,yt!==(typeof xt=="function"&&xt.prototype||ot))return st(at);var yt,xt,_t=[];for(var Ge in Object(at))ut.call(at,Ge)&&Ge!="constructor"&&_t.push(Ge);return _t}(et);var it}ne.exports=function(et,it){return mn(et,it)}},210:function(ne,re,ie){var fe=this&&this.__importDefault||function(ae){return ae&&ae.__esModule?ae:{default:ae}};Object.defineProperty(re,"__esModule",{value:!0});var ce,se=fe(ie(465)),oe=fe(ie(307));(function(ae){ae.compose=function(le,pe,ve){le===void 0&&(le={}),pe===void 0&&(pe={}),typeof le!="object"&&(le={}),typeof pe!="object"&&(pe={});var ge=se.default(pe);for(var de in ve||(ge=Object.keys(ge).reduce(function(ue,he){return ge[he]!=null&&(ue[he]=ge[he]),ue},{})),le)le[de]!==void 0&&pe[de]===void 0&&(ge[de]=le[de]);return Object.keys(ge).length>0?ge:void 0},ae.diff=function(le,pe){le===void 0&&(le={}),pe===void 0&&(pe={}),typeof le!="object"&&(le={}),typeof pe!="object"&&(pe={});var ve=Object.keys(le).concat(Object.keys(pe)).reduce(function(ge,de){return oe.default(le[de],pe[de])||(ge[de]=pe[de]===void 0?null:pe[de]),ge},{});return Object.keys(ve).length>0?ve:void 0},ae.invert=function(le,pe){le===void 0&&(le={}),pe===void 0&&(pe={}),le=le||{};var ve=Object.keys(pe).reduce(function(ge,de){return pe[de]!==le[de]&&le[de]!==void 0&&(ge[de]=pe[de]),ge},{});return Object.keys(le).reduce(function(ge,de){return le[de]!==pe[de]&&pe[de]===void 0&&(ge[de]=null),ge},ve)},ae.transform=function(le,pe,ve){if(ve===void 0&&(ve=!1),typeof le!="object")return pe;if(typeof pe=="object"){if(!ve)return pe;var ge=Object.keys(pe).reduce(function(de,ue){return le[ue]===void 0&&(de[ue]=pe[ue]),de},{});return Object.keys(ge).length>0?ge:void 0}}})(ce||(ce={})),re.default=ce},895:function(ne,re,ie){var fe=this&&this.__importDefault||function(ge){return ge&&ge.__esModule?ge:{default:ge}},ce=fe(ie(103)),se=fe(ie(465)),oe=fe(ie(307)),ae=fe(ie(210)),le=fe(ie(430)),pe=String.fromCharCode(0),ve=function(){function ge(de){Array.isArray(de)?this.ops=de:de!=null&&Array.isArray(de.ops)?this.ops=de.ops:this.ops=[]}return ge.prototype.insert=function(de,ue){var he={};return typeof de=="string"&&de.length===0?this:(he.insert=de,ue!=null&&typeof ue=="object"&&Object.keys(ue).length>0&&(he.attributes=ue),this.push(he))},ge.prototype.delete=function(de){return de<=0?this:this.push({delete:de})},ge.prototype.retain=function(de,ue){if(de<=0)return this;var he={retain:de};return ue!=null&&typeof ue=="object"&&Object.keys(ue).length>0&&(he.attributes=ue),this.push(he)},ge.prototype.push=function(de){var ue=this.ops.length,he=this.ops[ue-1];if(de=se.default(de),typeof he=="object"){if(typeof de.delete=="number"&&typeof he.delete=="number")return this.ops[ue-1]={delete:he.delete+de.delete},this;if(typeof he.delete=="number"&&de.insert!=null&&(ue-=1,typeof(he=this.ops[ue-1])!="object"))return this.ops.unshift(de),this;if(oe.default(de.attributes,he.attributes)){if(typeof de.insert=="string"&&typeof he.insert=="string")return this.ops[ue-1]={insert:he.insert+de.insert},typeof de.attributes=="object"&&(this.ops[ue-1].attributes=de.attributes),this;if(typeof de.retain=="number"&&typeof he.retain=="number")return this.ops[ue-1]={retain:he.retain+de.retain},typeof de.attributes=="object"&&(this.ops[ue-1].attributes=de.attributes),this}}return ue===this.ops.length?this.ops.push(de):this.ops.splice(ue,0,de),this},ge.prototype.chop=function(){var de=this.ops[this.ops.length-1];return de&&de.retain&&!de.attributes&&this.ops.pop(),this},ge.prototype.filter=function(de){return this.ops.filter(de)},ge.prototype.forEach=function(de){this.ops.forEach(de)},ge.prototype.map=function(de){return this.ops.map(de)},ge.prototype.partition=function(de){var ue=[],he=[];return this.forEach(function(me){(de(me)?ue:he).push(me)}),[ue,he]},ge.prototype.reduce=function(de,ue){return this.ops.reduce(de,ue)},ge.prototype.changeLength=function(){return this.reduce(function(de,ue){return ue.insert?de+le.default.length(ue):ue.delete?de-ue.delete:de},0)},ge.prototype.length=function(){return this.reduce(function(de,ue){return de+le.default.length(ue)},0)},ge.prototype.slice=function(de,ue){de===void 0&&(de=0),ue===void 0&&(ue=1/0);for(var he=[],me=le.default.iterator(this.ops),_e=0;_e<ue&&me.hasNext();){var be=void 0;_e<de?be=me.next(de-_e):(be=me.next(ue-_e),he.push(be)),_e+=le.default.length(be)}return new ge(he)},ge.prototype.compose=function(de){var ue=le.default.iterator(this.ops),he=le.default.iterator(de.ops),me=[],_e=he.peek();if(_e!=null&&typeof _e.retain=="number"&&_e.attributes==null){for(var be=_e.retain;ue.peekType()==="insert"&&ue.peekLength()<=be;)be-=ue.peekLength(),me.push(ue.next());_e.retain-be>0&&he.next(_e.retain-be)}for(var Se=new ge(me);ue.hasNext()||he.hasNext();)if(he.peekType()==="insert")Se.push(he.next());else if(ue.peekType()==="delete")Se.push(ue.next());else{var Te=Math.min(ue.peekLength(),he.peekLength()),we=ue.next(Te),ke=he.next(Te);if(typeof ke.retain=="number"){var xe={};typeof we.retain=="number"?xe.retain=Te:xe.insert=we.insert;var Ae=ae.default.compose(we.attributes,ke.attributes,typeof we.retain=="number");if(Ae&&(xe.attributes=Ae),Se.push(xe),!he.hasNext()&&oe.default(Se.ops[Se.ops.length-1],xe)){var Le=new ge(ue.rest());return Se.concat(Le).chop()}}else typeof ke.delete=="number"&&typeof we.retain=="number"&&Se.push(ke)}return Se.chop()},ge.prototype.concat=function(de){var ue=new ge(this.ops.slice());return de.ops.length>0&&(ue.push(de.ops[0]),ue.ops=ue.ops.concat(de.ops.slice(1))),ue},ge.prototype.diff=function(de,ue){if(this.ops===de.ops)return new ge;var he=[this,de].map(function(Te){return Te.map(function(we){if(we.insert!=null)return typeof we.insert=="string"?we.insert:pe;throw new Error("diff() called "+(Te===de?"on":"with")+" non-document")}).join("")}),me=new ge,_e=ce.default(he[0],he[1],ue),be=le.default.iterator(this.ops),Se=le.default.iterator(de.ops);return _e.forEach(function(Te){for(var we=Te[1].length;we>0;){var ke=0;switch(Te[0]){case ce.default.INSERT:ke=Math.min(Se.peekLength(),we),me.push(Se.next(ke));break;case ce.default.DELETE:ke=Math.min(we,be.peekLength()),be.next(ke),me.delete(ke);break;case ce.default.EQUAL:ke=Math.min(be.peekLength(),Se.peekLength(),we);var xe=be.next(ke),Ae=Se.next(ke);oe.default(xe.insert,Ae.insert)?me.retain(ke,ae.default.diff(xe.attributes,Ae.attributes)):me.push(Ae).delete(ke)}we-=ke}}),me.chop()},ge.prototype.eachLine=function(de,ue){ue===void 0&&(ue=`
`);for(var he=le.default.iterator(this.ops),me=new ge,_e=0;he.hasNext();){if(he.peekType()!=="insert")return;var be=he.peek(),Se=le.default.length(be)-he.peekLength(),Te=typeof be.insert=="string"?be.insert.indexOf(ue,Se)-Se:-1;if(Te<0)me.push(he.next());else if(Te>0)me.push(he.next(Te));else{if(de(me,he.next(1).attributes||{},_e)===!1)return;_e+=1,me=new ge}}me.length()>0&&de(me,{},_e)},ge.prototype.invert=function(de){var ue=new ge;return this.reduce(function(he,me){if(me.insert)ue.delete(le.default.length(me));else{if(me.retain&&me.attributes==null)return ue.retain(me.retain),he+me.retain;if(me.delete||me.retain&&me.attributes){var _e=me.delete||me.retain;return de.slice(he,he+_e).forEach(function(be){me.delete?ue.push(be):me.retain&&me.attributes&&ue.retain(le.default.length(be),ae.default.invert(me.attributes,be.attributes))}),he+_e}}return he},0),ue.chop()},ge.prototype.transform=function(de,ue){if(ue===void 0&&(ue=!1),ue=!!ue,typeof de=="number")return this.transformPosition(de,ue);for(var he=de,me=le.default.iterator(this.ops),_e=le.default.iterator(he.ops),be=new ge;me.hasNext()||_e.hasNext();)if(me.peekType()!=="insert"||!ue&&_e.peekType()==="insert")if(_e.peekType()==="insert")be.push(_e.next());else{var Se=Math.min(me.peekLength(),_e.peekLength()),Te=me.next(Se),we=_e.next(Se);if(Te.delete)continue;we.delete?be.push(we):be.retain(Se,ae.default.transform(Te.attributes,we.attributes,ue))}else be.retain(le.default.length(me.next()));return be.chop()},ge.prototype.transformPosition=function(de,ue){ue===void 0&&(ue=!1),ue=!!ue;for(var he=le.default.iterator(this.ops),me=0;he.hasNext()&&me<=de;){var _e=he.peekLength(),be=he.peekType();he.next(),be!=="delete"?(be==="insert"&&(me<de||!ue)&&(de+=_e),me+=_e):de-=Math.min(_e,de-me)}return de},ge.Op=le.default,ge.AttributeMap=ae.default,ge}();ne.exports=ve},977:function(ne,re,ie){var fe=this&&this.__importDefault||function(oe){return oe&&oe.__esModule?oe:{default:oe}};Object.defineProperty(re,"__esModule",{value:!0});var ce=fe(ie(430)),se=function(){function oe(ae){this.ops=ae,this.index=0,this.offset=0}return oe.prototype.hasNext=function(){return this.peekLength()<1/0},oe.prototype.next=function(ae){ae||(ae=1/0);var le=this.ops[this.index];if(le){var pe=this.offset,ve=ce.default.length(le);if(ae>=ve-pe?(ae=ve-pe,this.index+=1,this.offset=0):this.offset+=ae,typeof le.delete=="number")return{delete:ae};var ge={};return le.attributes&&(ge.attributes=le.attributes),typeof le.retain=="number"?ge.retain=ae:typeof le.insert=="string"?ge.insert=le.insert.substr(pe,ae):ge.insert=le.insert,ge}return{retain:1/0}},oe.prototype.peek=function(){return this.ops[this.index]},oe.prototype.peekLength=function(){return this.ops[this.index]?ce.default.length(this.ops[this.index])-this.offset:1/0},oe.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},oe.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var ae=this.offset,le=this.index,pe=this.next(),ve=this.ops.slice(this.index);return this.offset=ae,this.index=le,[pe].concat(ve)}return[]},oe}();re.default=se},430:function(ne,re,ie){var fe=this&&this.__importDefault||function(oe){return oe&&oe.__esModule?oe:{default:oe}};Object.defineProperty(re,"__esModule",{value:!0});var ce,se=fe(ie(977));(function(oe){oe.iterator=function(ae){return new se.default(ae)},oe.length=function(ae){return typeof ae.delete=="number"?ae.delete:typeof ae.retain=="number"?ae.retain:typeof ae.insert=="string"?ae.insert.length:1}})(ce||(ce={})),re.default=ce},103:ne=>{var re=-1;function ie(ue,he,me,_e){if(ue===he)return ue?[[0,ue]]:[];if(me!=null){var be=function(xe,Ae,Le){var De=typeof Le=="number"?{index:Le,length:0}:Le.oldRange,$e=typeof Le=="number"?null:Le.newRange,Ve=xe.length,Qe=Ae.length;if(De.length===0&&($e===null||$e.length===0)){var je=De.index,He=xe.slice(0,je),Ie=xe.slice(je),Ue=$e?$e.index:null,Pe=je+Qe-Ve;if((Ue===null||Ue===Pe)&&!(Pe<0||Pe>Qe)){var We=Ae.slice(0,Pe);if((Ke=Ae.slice(Pe))===Ie){var Ye=Math.min(je,Pe);if((Je=He.slice(0,Ye))===(ot=We.slice(0,Ye)))return ge(Je,He.slice(Ye),We.slice(Ye),Ie)}}if(Ue===null||Ue===je){var Ne=je,Ke=(We=Ae.slice(0,Ne),Ae.slice(Ne));if(We===He){var Xe=Math.min(Ve-Ne,Qe-Ne);if((nt=Ie.slice(Ie.length-Xe))===(ht=Ke.slice(Ke.length-Xe)))return ge(He,Ie.slice(0,Ie.length-Xe),Ke.slice(0,Ke.length-Xe),nt)}}}if(De.length>0&&$e&&$e.length===0){var Je=xe.slice(0,De.index),nt=xe.slice(De.index+De.length);if(!(Qe<(Ye=Je.length)+(Xe=nt.length))){var ot=Ae.slice(0,Ye),ht=Ae.slice(Qe-Xe);if(Je===ot&&nt===ht)return ge(Je,xe.slice(Ye,Ve-Xe),Ae.slice(Ye,Qe-Xe),nt)}}return null}(ue,he,me);if(be)return be}var Se=ce(ue,he),Te=ue.substring(0,Se);Se=se(ue=ue.substring(Se),he=he.substring(Se));var we=ue.substring(ue.length-Se),ke=function(xe,Ae){var Le;if(!xe)return[[1,Ae]];if(!Ae)return[[re,xe]];var De=xe.length>Ae.length?xe:Ae,$e=xe.length>Ae.length?Ae:xe,Ve=De.indexOf($e);if(Ve!==-1)return Le=[[1,De.substring(0,Ve)],[0,$e],[1,De.substring(Ve+$e.length)]],xe.length>Ae.length&&(Le[0][0]=Le[2][0]=re),Le;if($e.length===1)return[[re,xe],[1,Ae]];var Qe=function(Ne,Ke){var Xe=Ne.length>Ke.length?Ne:Ke,Je=Ne.length>Ke.length?Ke:Ne;if(Xe.length<4||2*Je.length<Xe.length)return null;function nt(Be,Oe,ye){for(var Ce,Ee,Fe,ze,Ze=Be.substring(ye,ye+Math.floor(Be.length/4)),st=-1,pt="";(st=Oe.indexOf(Ze,st+1))!==-1;){var dt=ce(Be.substring(ye),Oe.substring(st)),ft=se(Be.substring(0,ye),Oe.substring(0,st));pt.length<ft+dt&&(pt=Oe.substring(st-ft,st)+Oe.substring(st,st+dt),Ce=Be.substring(0,ye-ft),Ee=Be.substring(ye+dt),Fe=Oe.substring(0,st-ft),ze=Oe.substring(st+dt))}return 2*pt.length>=Be.length?[Ce,Ee,Fe,ze,pt]:null}var ot,ht,ct,ut,Re,Me=nt(Xe,Je,Math.ceil(Xe.length/4)),qe=nt(Xe,Je,Math.ceil(Xe.length/2));return Me||qe?(ot=qe?Me&&Me[4].length>qe[4].length?Me:qe:Me,Ne.length>Ke.length?(ht=ot[0],ct=ot[1],ut=ot[2],Re=ot[3]):(ut=ot[0],Re=ot[1],ht=ot[2],ct=ot[3]),[ht,ct,ut,Re,ot[4]]):null}(xe,Ae);if(Qe){var je=Qe[0],He=Qe[1],Ie=Qe[2],Ue=Qe[3],Pe=Qe[4],We=ie(je,Ie),Ye=ie(He,Ue);return We.concat([[0,Pe]],Ye)}return function(Ne,Ke){for(var Xe=Ne.length,Je=Ke.length,nt=Math.ceil((Xe+Je)/2),ot=nt,ht=2*nt,ct=new Array(ht),ut=new Array(ht),Re=0;Re<ht;Re++)ct[Re]=-1,ut[Re]=-1;ct[ot+1]=0,ut[ot+1]=0;for(var Me=Xe-Je,qe=Me%2!=0,Be=0,Oe=0,ye=0,Ce=0,Ee=0;Ee<nt;Ee++){for(var Fe=-Ee+Be;Fe<=Ee-Oe;Fe+=2){for(var ze=ot+Fe,Ze=(tt=Fe===-Ee||Fe!==Ee&&ct[ze-1]<ct[ze+1]?ct[ze+1]:ct[ze-1]+1)-Fe;tt<Xe&&Ze<Je&&Ne.charAt(tt)===Ke.charAt(Ze);)tt++,Ze++;if(ct[ze]=tt,tt>Xe)Oe+=2;else if(Ze>Je)Be+=2;else if(qe&&(dt=ot+Me-Fe)>=0&&dt<ht&&ut[dt]!==-1&&tt>=(pt=Xe-ut[dt]))return fe(Ne,Ke,tt,Ze)}for(var st=-Ee+ye;st<=Ee-Ce;st+=2){for(var pt,dt=ot+st,ft=(pt=st===-Ee||st!==Ee&&ut[dt-1]<ut[dt+1]?ut[dt+1]:ut[dt-1]+1)-st;pt<Xe&&ft<Je&&Ne.charAt(Xe-pt-1)===Ke.charAt(Je-ft-1);)pt++,ft++;if(ut[dt]=pt,pt>Xe)Ce+=2;else if(ft>Je)ye+=2;else if(!qe){var tt;if((ze=ot+Me-st)>=0&&ze<ht&&ct[ze]!==-1&&(Ze=ot+(tt=ct[ze])-ze,tt>=(pt=Xe-pt)))return fe(Ne,Ke,tt,Ze)}}}return[[re,Ne],[1,Ke]]}(xe,Ae)}(ue=ue.substring(0,ue.length-Se),he=he.substring(0,he.length-Se));return Te&&ke.unshift([0,Te]),we&&ke.push([0,we]),oe(ke,_e),ke}function fe(ue,he,me,_e){var be=ue.substring(0,me),Se=he.substring(0,_e),Te=ue.substring(me),we=he.substring(_e),ke=ie(be,Se),xe=ie(Te,we);return ke.concat(xe)}function ce(ue,he){if(!ue||!he||ue.charAt(0)!==he.charAt(0))return 0;for(var me=0,_e=Math.min(ue.length,he.length),be=_e,Se=0;me<be;)ue.substring(Se,be)==he.substring(Se,be)?Se=me=be:_e=be,be=Math.floor((_e-me)/2+me);return ae(ue.charCodeAt(be-1))&&be--,be}function se(ue,he){if(!ue||!he||ue.slice(-1)!==he.slice(-1))return 0;for(var me=0,_e=Math.min(ue.length,he.length),be=_e,Se=0;me<be;)ue.substring(ue.length-be,ue.length-Se)==he.substring(he.length-be,he.length-Se)?Se=me=be:_e=be,be=Math.floor((_e-me)/2+me);return le(ue.charCodeAt(ue.length-be))&&be--,be}function oe(ue,he){ue.push([0,""]);for(var me,_e=0,be=0,Se=0,Te="",we="";_e<ue.length;)if(_e<ue.length-1&&!ue[_e][1])ue.splice(_e,1);else switch(ue[_e][0]){case 1:Se++,we+=ue[_e][1],_e++;break;case re:be++,Te+=ue[_e][1],_e++;break;case 0:var ke=_e-Se-be-1;if(he){if(ke>=0&&ve(ue[ke][1])){var xe=ue[ke][1].slice(-1);if(ue[ke][1]=ue[ke][1].slice(0,-1),Te=xe+Te,we=xe+we,!ue[ke][1]){ue.splice(ke,1),_e--;var Ae=ke-1;ue[Ae]&&ue[Ae][0]===1&&(Se++,we=ue[Ae][1]+we,Ae--),ue[Ae]&&ue[Ae][0]===re&&(be++,Te=ue[Ae][1]+Te,Ae--),ke=Ae}}pe(ue[_e][1])&&(xe=ue[_e][1].charAt(0),ue[_e][1]=ue[_e][1].slice(1),Te+=xe,we+=xe)}if(_e<ue.length-1&&!ue[_e][1]){ue.splice(_e,1);break}if(Te.length>0||we.length>0){Te.length>0&&we.length>0&&((me=ce(we,Te))!==0&&(ke>=0?ue[ke][1]+=we.substring(0,me):(ue.splice(0,0,[0,we.substring(0,me)]),_e++),we=we.substring(me),Te=Te.substring(me)),(me=se(we,Te))!==0&&(ue[_e][1]=we.substring(we.length-me)+ue[_e][1],we=we.substring(0,we.length-me),Te=Te.substring(0,Te.length-me)));var Le=Se+be;Te.length===0&&we.length===0?(ue.splice(_e-Le,Le),_e-=Le):Te.length===0?(ue.splice(_e-Le,Le,[1,we]),_e=_e-Le+1):we.length===0?(ue.splice(_e-Le,Le,[re,Te]),_e=_e-Le+1):(ue.splice(_e-Le,Le,[re,Te],[1,we]),_e=_e-Le+2)}_e!==0&&ue[_e-1][0]===0?(ue[_e-1][1]+=ue[_e][1],ue.splice(_e,1)):_e++,Se=0,be=0,Te="",we=""}ue[ue.length-1][1]===""&&ue.pop();var De=!1;for(_e=1;_e<ue.length-1;)ue[_e-1][0]===0&&ue[_e+1][0]===0&&(ue[_e][1].substring(ue[_e][1].length-ue[_e-1][1].length)===ue[_e-1][1]?(ue[_e][1]=ue[_e-1][1]+ue[_e][1].substring(0,ue[_e][1].length-ue[_e-1][1].length),ue[_e+1][1]=ue[_e-1][1]+ue[_e+1][1],ue.splice(_e-1,1),De=!0):ue[_e][1].substring(0,ue[_e+1][1].length)==ue[_e+1][1]&&(ue[_e-1][1]+=ue[_e+1][1],ue[_e][1]=ue[_e][1].substring(ue[_e+1][1].length)+ue[_e+1][1],ue.splice(_e+1,1),De=!0)),_e++;De&&oe(ue,he)}function ae(ue){return ue>=55296&&ue<=56319}function le(ue){return ue>=56320&&ue<=57343}function pe(ue){return le(ue.charCodeAt(0))}function ve(ue){return ae(ue.charCodeAt(ue.length-1))}function ge(ue,he,me,_e){return ve(ue)||pe(_e)?null:function(be){for(var Se=[],Te=0;Te<be.length;Te++)be[Te][1].length>0&&Se.push(be[Te]);return Se}([[0,ue],[re,he],[1,me],[0,_e]])}function de(ue,he,me){return ie(ue,he,me,!0)}de.INSERT=1,de.DELETE=re,de.EQUAL=0,ne.exports=de},165:function(ne,re,ie){var fe,ce;(ce=typeof(fe=function(){var se,oe={};function ae(ve,ge,de){var ue=ve.getClientRects();if(ue.length===2){var he=ve.getBoundingClientRect();return ue[ge][de]<he[de]}return!1}function le(ve){if(!ve||screen.deviceXDPI===screen.logicalXDPI)return ve;if("length"in ve)return Array.prototype.map.call(ve,le);var ge=screen.deviceXDPI/screen.logicalXDPI;return{top:ve.top/ge,bottom:ve.bottom/ge,left:ve.left/ge,right:ve.right/ge,width:ve.width/ge,height:ve.height/ge}}function pe(ve,ge){var de,ue=0,he=1024;if(he>=ge.length)return Array.prototype.push.apply(ve,ge);for(;ue<ge.length;)de=Array.prototype.push.apply(ve,Array.prototype.slice.call(ge,ue,ue+he)),ue+=he;return de}return oe.isBroken=function(){if(se===void 0){var ve=document.createElement("p"),ge=document.createElement("span"),de=document.createTextNode("aa"),ue=document.createTextNode("aa"),he=document.createElement("img");he.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");var me=document.createRange();if(se={},ve.appendChild(de),ve.appendChild(ge),ge.appendChild(he),ge.appendChild(ue),document.body.appendChild(ve),me.setStart(de,1),me.setEnd(ge,0),se.getClientRects=se.getBoundingClientRect=me.getClientRects().length>1,se.getClientRects||(me.setEnd(ue,1),se.getClientRects=se.getBoundingClientRect=me.getClientRects().length===2),!se.getBoundingClientRect){me.setEnd(me.startContainer,me.startOffset);var _e=me.getBoundingClientRect();se.getBoundingClientRect=_e.top===0&&_e.left===0}if(document.body.removeChild(ve),!se.getBoundingClientRect){var be=document.createElement("p");be.style.width="0px",be.style.fontSize="20px",be.style.whiteSpace="normal",be.style.wordBreak="normal";var Se=document.createTextNode("m mm");be.appendChild(Se),document.body.appendChild(be),me.setStart(Se,1),me.setEnd(Se,2),ae(me,1,"left")?se.getBoundingClientRect=!0:(me.setStart(Se,1),me.setEnd(Se,3),ae(me,0,"top")&&(se.getBoundingClientRect=!0)),document.body.removeChild(be)}var Te=window.ActiveXObject&&new Function("/*@cc_on return @_jscript_version; @*/")();se.ieZoom=!!Te&&Te<=10}return se},oe.getClientRects=function(ve){var ge=this.isBroken();if(ge.ieZoom)return le(ve.getClientRects());if(!ge.getClientRects)return ve.getClientRects();var de=[],ue=[],he=ve.endContainer,me=ve.endOffset,_e=document.createRange();function be(Se){for(var Te=0;Se=Se.previousSibling;)Te++;return Te}for(;he!==ve.commonAncestorContainer;)_e.setStart(he,0),_e.setEnd(he,me),pe(ue,_e.getClientRects()),me=be(he),he=he.parentNode;return(_e=ve.cloneRange()).setEnd(he,me),pe(de,_e.getClientRects()),pe(de,ue),de},oe.getBoundingClientRect=function(ve){var ge=this.getClientRects(ve);if(ge.length===0)return null;var de,ue=ve.getBoundingClientRect(),he=this.isBroken();if(he.ieZoom)return le(ue);if(!he.getBoundingClientRect)return ue;if(ue.width===0&&ue.height===0)return ge[0];for(var me=0,_e=ge.length;me<_e;me++){var be=ge[me];de?(de.left=Math.min(de.left,be.left),de.top=Math.min(de.top,be.top),de.right=Math.max(de.right,be.right),de.bottom=Math.max(de.bottom,be.bottom)):de={left:be.left,top:be.top,right:be.right,bottom:be.bottom}}return de&&(de.width=de.right-de.left,de.height=de.bottom-de.top),de},oe})=="function"?fe.call(re,ie,re,ne):fe)===void 0||(ne.exports=ce)},33:(ne,re,ie)=>{ie.r(re),ie.d(re,{default:()=>Ae});var fe=function(){if(typeof Map<"u")return Map;function Le(De,$e){var Ve=-1;return De.some(function(Qe,je){return Qe[0]===$e&&(Ve=je,!0)}),Ve}return function(){function De(){this.__entries__=[]}return Object.defineProperty(De.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),De.prototype.get=function($e){var Ve=Le(this.__entries__,$e),Qe=this.__entries__[Ve];return Qe&&Qe[1]},De.prototype.set=function($e,Ve){var Qe=Le(this.__entries__,$e);~Qe?this.__entries__[Qe][1]=Ve:this.__entries__.push([$e,Ve])},De.prototype.delete=function($e){var Ve=this.__entries__,Qe=Le(Ve,$e);~Qe&&Ve.splice(Qe,1)},De.prototype.has=function($e){return!!~Le(this.__entries__,$e)},De.prototype.clear=function(){this.__entries__.splice(0)},De.prototype.forEach=function($e,Ve){Ve===void 0&&(Ve=null);for(var Qe=0,je=this.__entries__;Qe<je.length;Qe++){var He=je[Qe];$e.call(Ve,He[1],He[0])}},De}()}(),ce=typeof window<"u"&&typeof document<"u"&&window.document===document,se=ie.g!==void 0&&ie.g.Math===Math?ie.g:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),oe=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(se):function(Le){return setTimeout(function(){return Le(Date.now())},1e3/60)},ae=["top","right","bottom","left","width","height","size","weight"],le=typeof MutationObserver<"u",pe=function(){function Le(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(De,$e){var Ve=!1,Qe=!1,je=0;function He(){Ve&&(Ve=!1,De()),Qe&&Ue()}function Ie(){oe(He)}function Ue(){var Pe=Date.now();if(Ve){if(Pe-je<2)return;Qe=!0}else Ve=!0,Qe=!1,setTimeout(Ie,20);je=Pe}return Ue}(this.refresh.bind(this))}return Le.prototype.addObserver=function(De){~this.observers_.indexOf(De)||this.observers_.push(De),this.connected_||this.connect_()},Le.prototype.removeObserver=function(De){var $e=this.observers_,Ve=$e.indexOf(De);~Ve&&$e.splice(Ve,1),!$e.length&&this.connected_&&this.disconnect_()},Le.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},Le.prototype.updateObservers_=function(){var De=this.observers_.filter(function($e){return $e.gatherActive(),$e.hasActive()});return De.forEach(function($e){return $e.broadcastActive()}),De.length>0},Le.prototype.connect_=function(){ce&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),le?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},Le.prototype.disconnect_=function(){ce&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},Le.prototype.onTransitionEnd_=function(De){var $e=De.propertyName,Ve=$e===void 0?"":$e;ae.some(function(Qe){return!!~Ve.indexOf(Qe)})&&this.refresh()},Le.getInstance=function(){return this.instance_||(this.instance_=new Le),this.instance_},Le.instance_=null,Le}(),ve=function(Le,De){for(var $e=0,Ve=Object.keys(De);$e<Ve.length;$e++){var Qe=Ve[$e];Object.defineProperty(Le,Qe,{value:De[Qe],enumerable:!1,writable:!1,configurable:!0})}return Le},ge=function(Le){return Le&&Le.ownerDocument&&Le.ownerDocument.defaultView||se},de=be(0,0,0,0);function ue(Le){return parseFloat(Le)||0}function he(Le){for(var De=[],$e=1;$e<arguments.length;$e++)De[$e-1]=arguments[$e];return De.reduce(function(Ve,Qe){return Ve+ue(Le["border-"+Qe+"-width"])},0)}var me=typeof SVGGraphicsElement<"u"?function(Le){return Le instanceof ge(Le).SVGGraphicsElement}:function(Le){return Le instanceof ge(Le).SVGElement&&typeof Le.getBBox=="function"};function _e(Le){return ce?me(Le)?function(De){var $e=De.getBBox();return be(0,0,$e.width,$e.height)}(Le):function(De){var $e=De.clientWidth,Ve=De.clientHeight;if(!$e&&!Ve)return de;var Qe=ge(De).getComputedStyle(De),je=function(Ne){for(var Ke={},Xe=0,Je=["top","right","bottom","left"];Xe<Je.length;Xe++){var nt=Je[Xe],ot=Ne["padding-"+nt];Ke[nt]=ue(ot)}return Ke}(Qe),He=je.left+je.right,Ie=je.top+je.bottom,Ue=ue(Qe.width),Pe=ue(Qe.height);if(Qe.boxSizing==="border-box"&&(Math.round(Ue+He)!==$e&&(Ue-=he(Qe,"left","right")+He),Math.round(Pe+Ie)!==Ve&&(Pe-=he(Qe,"top","bottom")+Ie)),!function(Ne){return Ne===ge(Ne).document.documentElement}(De)){var We=Math.round(Ue+He)-$e,Ye=Math.round(Pe+Ie)-Ve;Math.abs(We)!==1&&(Ue-=We),Math.abs(Ye)!==1&&(Pe-=Ye)}return be(je.left,je.top,Ue,Pe)}(Le):de}function be(Le,De,$e,Ve){return{x:Le,y:De,width:$e,height:Ve}}var Se=function(){function Le(De){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=be(0,0,0,0),this.target=De}return Le.prototype.isActive=function(){var De=_e(this.target);return this.contentRect_=De,De.width!==this.broadcastWidth||De.height!==this.broadcastHeight},Le.prototype.broadcastRect=function(){var De=this.contentRect_;return this.broadcastWidth=De.width,this.broadcastHeight=De.height,De},Le}(),Te=function(Le,De){var $e,Ve,Qe,je,He,Ie,Ue,Pe=(Ve=($e=De).x,Qe=$e.y,je=$e.width,He=$e.height,Ie=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,Ue=Object.create(Ie.prototype),ve(Ue,{x:Ve,y:Qe,width:je,height:He,top:Qe,right:Ve+je,bottom:He+Qe,left:Ve}),Ue);ve(this,{target:Le,contentRect:Pe})},we=function(){function Le(De,$e,Ve){if(this.activeObservations_=[],this.observations_=new fe,typeof De!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=De,this.controller_=$e,this.callbackCtx_=Ve}return Le.prototype.observe=function(De){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(De instanceof ge(De).Element))throw new TypeError('parameter 1 is not of type "Element".');var $e=this.observations_;$e.has(De)||($e.set(De,new Se(De)),this.controller_.addObserver(this),this.controller_.refresh())}},Le.prototype.unobserve=function(De){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(De instanceof ge(De).Element))throw new TypeError('parameter 1 is not of type "Element".');var $e=this.observations_;$e.has(De)&&($e.delete(De),$e.size||this.controller_.removeObserver(this))}},Le.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},Le.prototype.gatherActive=function(){var De=this;this.clearActive(),this.observations_.forEach(function($e){$e.isActive()&&De.activeObservations_.push($e)})},Le.prototype.broadcastActive=function(){if(this.hasActive()){var De=this.callbackCtx_,$e=this.activeObservations_.map(function(Ve){return new Te(Ve.target,Ve.broadcastRect())});this.callback_.call(De,$e,De),this.clearActive()}},Le.prototype.clearActive=function(){this.activeObservations_.splice(0)},Le.prototype.hasActive=function(){return this.activeObservations_.length>0},Le}(),ke=typeof WeakMap<"u"?new WeakMap:new fe,xe=function Le(De){if(!(this instanceof Le))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var $e=pe.getInstance(),Ve=new we(De,$e,this);ke.set(this,Ve)};["observe","unobserve","disconnect"].forEach(function(Le){xe.prototype[Le]=function(){var De;return(De=ke.get(this))[Le].apply(De,arguments)}});const Ae=se.ResizeObserver!==void 0?se.ResizeObserver:xe},413:(ne,re,ie)=>{ie.r(re),ie.d(re,{default:()=>be});var fe=ie(379),ce=ie.n(fe),se=ie(795),oe=ie.n(se),ae=ie(569),le=ie.n(ae),pe=ie(565),ve=ie.n(pe),ge=ie(216),de=ie.n(ge),ue=ie(589),he=ie.n(ue),me=ie(582),_e={};_e.styleTagTransform=he(),_e.setAttributes=ve(),_e.insert=le().bind(null,"head"),_e.domAPI=oe(),_e.insertStyleElement=de(),ce()(me.Z,_e);const be=me.Z&&me.Z.locals?me.Z.locals:void 0},379:ne=>{var re=[];function ie(se){for(var oe=-1,ae=0;ae<re.length;ae++)if(re[ae].identifier===se){oe=ae;break}return oe}function fe(se,oe){for(var ae={},le=[],pe=0;pe<se.length;pe++){var ve=se[pe],ge=oe.base?ve[0]+oe.base:ve[0],de=ae[ge]||0,ue="".concat(ge," ").concat(de);ae[ge]=de+1;var he=ie(ue),me={css:ve[1],media:ve[2],sourceMap:ve[3],supports:ve[4],layer:ve[5]};if(he!==-1)re[he].references++,re[he].updater(me);else{var _e=ce(me,oe);oe.byIndex=pe,re.splice(pe,0,{identifier:ue,updater:_e,references:1})}le.push(ue)}return le}function ce(se,oe){var ae=oe.domAPI(oe);return ae.update(se),function(le){if(le){if(le.css===se.css&&le.media===se.media&&le.sourceMap===se.sourceMap&&le.supports===se.supports&&le.layer===se.layer)return;ae.update(se=le)}else ae.remove()}}ne.exports=function(se,oe){var ae=fe(se=se||[],oe=oe||{});return function(le){le=le||[];for(var pe=0;pe<ae.length;pe++){var ve=ie(ae[pe]);re[ve].references--}for(var ge=fe(le,oe),de=0;de<ae.length;de++){var ue=ie(ae[de]);re[ue].references===0&&(re[ue].updater(),re.splice(ue,1))}ae=ge}}},569:ne=>{var re={};ne.exports=function(ie,fe){var ce=function(se){if(re[se]===void 0){var oe=document.querySelector(se);if(window.HTMLIFrameElement&&oe instanceof window.HTMLIFrameElement)try{oe=oe.contentDocument.head}catch{oe=null}re[se]=oe}return re[se]}(ie);if(!ce)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");ce.appendChild(fe)}},216:ne=>{ne.exports=function(re){var ie=document.createElement("style");return re.setAttributes(ie,re.attributes),re.insert(ie,re.options),ie}},565:(ne,re,ie)=>{ne.exports=function(fe){var ce=ie.nc;ce&&fe.setAttribute("nonce",ce)}},795:ne=>{ne.exports=function(re){var ie=re.insertStyleElement(re);return{update:function(fe){(function(ce,se,oe){var ae="";oe.supports&&(ae+="@supports (".concat(oe.supports,") {")),oe.media&&(ae+="@media ".concat(oe.media," {"));var le=oe.layer!==void 0;le&&(ae+="@layer".concat(oe.layer.length>0?" ".concat(oe.layer):""," {")),ae+=oe.css,le&&(ae+="}"),oe.media&&(ae+="}"),oe.supports&&(ae+="}");var pe=oe.sourceMap;pe&&typeof btoa<"u"&&(ae+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(pe))))," */")),se.styleTagTransform(ae,ce,se.options)})(ie,re,fe)},remove:function(){(function(fe){if(fe.parentNode===null)return!1;fe.parentNode.removeChild(fe)})(ie)}}}},589:ne=>{ne.exports=function(re,ie){if(ie.styleSheet)ie.styleSheet.cssText=re;else{for(;ie.firstChild;)ie.removeChild(ie.firstChild);ie.appendChild(document.createTextNode(re))}}},621:(ne,re,ie)=>{var fe;(function(ce){var se=/^\s+/,oe=/\s+$/,ae=0,le=ce.round,pe=ce.min,ve=ce.max,ge=ce.random;function de(Re,Me){if(Me=Me||{},(Re=Re||"")instanceof de)return Re;if(!(this instanceof de))return new de(Re,Me);var qe=function(Be){var Oe,ye,Ce,Ee={r:0,g:0,b:0},Fe=1,ze=null,Ze=null,st=null,pt=!1,dt=!1;return typeof Be=="string"&&(Be=function(ft){ft=ft.replace(se,"").replace(oe,"").toLowerCase();var tt,mt=!1;if(He[ft])ft=He[ft],mt=!0;else if(ft=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(tt=ct.rgb.exec(ft))?{r:tt[1],g:tt[2],b:tt[3]}:(tt=ct.rgba.exec(ft))?{r:tt[1],g:tt[2],b:tt[3],a:tt[4]}:(tt=ct.hsl.exec(ft))?{h:tt[1],s:tt[2],l:tt[3]}:(tt=ct.hsla.exec(ft))?{h:tt[1],s:tt[2],l:tt[3],a:tt[4]}:(tt=ct.hsv.exec(ft))?{h:tt[1],s:tt[2],v:tt[3]}:(tt=ct.hsva.exec(ft))?{h:tt[1],s:tt[2],v:tt[3],a:tt[4]}:(tt=ct.hex8.exec(ft))?{r:Ye(tt[1]),g:Ye(tt[2]),b:Ye(tt[3]),a:Je(tt[4]),format:mt?"name":"hex8"}:(tt=ct.hex6.exec(ft))?{r:Ye(tt[1]),g:Ye(tt[2]),b:Ye(tt[3]),format:mt?"name":"hex"}:(tt=ct.hex4.exec(ft))?{r:Ye(tt[1]+""+tt[1]),g:Ye(tt[2]+""+tt[2]),b:Ye(tt[3]+""+tt[3]),a:Je(tt[4]+""+tt[4]),format:mt?"name":"hex8"}:!!(tt=ct.hex3.exec(ft))&&{r:Ye(tt[1]+""+tt[1]),g:Ye(tt[2]+""+tt[2]),b:Ye(tt[3]+""+tt[3]),format:mt?"name":"hex"}}(Be)),typeof Be=="object"&&(ut(Be.r)&&ut(Be.g)&&ut(Be.b)?(Oe=Be.r,ye=Be.g,Ce=Be.b,Ee={r:255*Pe(Oe,255),g:255*Pe(ye,255),b:255*Pe(Ce,255)},pt=!0,dt=String(Be.r).substr(-1)==="%"?"prgb":"rgb"):ut(Be.h)&&ut(Be.s)&&ut(Be.v)?(ze=Ke(Be.s),Ze=Ke(Be.v),Ee=function(ft,tt,mt){ft=6*Pe(ft,360),tt=Pe(tt,100),mt=Pe(mt,100);var Lt=ce.floor(ft),Ut=ft-Lt,Dt=mt*(1-tt),Mt=mt*(1-Ut*tt),Bt=mt*(1-(1-Ut)*tt),jt=Lt%6;return{r:255*[mt,Mt,Dt,Dt,Bt,mt][jt],g:255*[Bt,mt,mt,Mt,Dt,Dt][jt],b:255*[Dt,Dt,Bt,mt,mt,Mt][jt]}}(Be.h,ze,Ze),pt=!0,dt="hsv"):ut(Be.h)&&ut(Be.s)&&ut(Be.l)&&(ze=Ke(Be.s),st=Ke(Be.l),Ee=function(ft,tt,mt){var Lt,Ut,Dt;function Mt(Ft,Kt,It){return It<0&&(It+=1),It>1&&(It-=1),It<1/6?Ft+6*(Kt-Ft)*It:It<.5?Kt:It<2/3?Ft+(Kt-Ft)*(2/3-It)*6:Ft}if(ft=Pe(ft,360),tt=Pe(tt,100),mt=Pe(mt,100),tt===0)Lt=Ut=Dt=mt;else{var Bt=mt<.5?mt*(1+tt):mt+tt-mt*tt,jt=2*mt-Bt;Lt=Mt(jt,Bt,ft+1/3),Ut=Mt(jt,Bt,ft),Dt=Mt(jt,Bt,ft-1/3)}return{r:255*Lt,g:255*Ut,b:255*Dt}}(Be.h,ze,st),pt=!0,dt="hsl"),Be.hasOwnProperty("a")&&(Fe=Be.a)),Fe=Ue(Fe),{ok:pt,format:Be.format||dt,r:pe(255,ve(Ee.r,0)),g:pe(255,ve(Ee.g,0)),b:pe(255,ve(Ee.b,0)),a:Fe}}(Re);this._originalInput=Re,this._r=qe.r,this._g=qe.g,this._b=qe.b,this._a=qe.a,this._roundA=le(100*this._a)/100,this._format=Me.format||qe.format,this._gradientType=Me.gradientType,this._r<1&&(this._r=le(this._r)),this._g<1&&(this._g=le(this._g)),this._b<1&&(this._b=le(this._b)),this._ok=qe.ok,this._tc_id=ae++}function ue(Re,Me,qe){Re=Pe(Re,255),Me=Pe(Me,255),qe=Pe(qe,255);var Be,Oe,ye=ve(Re,Me,qe),Ce=pe(Re,Me,qe),Ee=(ye+Ce)/2;if(ye==Ce)Be=Oe=0;else{var Fe=ye-Ce;switch(Oe=Ee>.5?Fe/(2-ye-Ce):Fe/(ye+Ce),ye){case Re:Be=(Me-qe)/Fe+(Me<qe?6:0);break;case Me:Be=(qe-Re)/Fe+2;break;case qe:Be=(Re-Me)/Fe+4}Be/=6}return{h:Be,s:Oe,l:Ee}}function he(Re,Me,qe){Re=Pe(Re,255),Me=Pe(Me,255),qe=Pe(qe,255);var Be,Oe,ye=ve(Re,Me,qe),Ce=pe(Re,Me,qe),Ee=ye,Fe=ye-Ce;if(Oe=ye===0?0:Fe/ye,ye==Ce)Be=0;else{switch(ye){case Re:Be=(Me-qe)/Fe+(Me<qe?6:0);break;case Me:Be=(qe-Re)/Fe+2;break;case qe:Be=(Re-Me)/Fe+4}Be/=6}return{h:Be,s:Oe,v:Ee}}function me(Re,Me,qe,Be){var Oe=[Ne(le(Re).toString(16)),Ne(le(Me).toString(16)),Ne(le(qe).toString(16))];return Be&&Oe[0].charAt(0)==Oe[0].charAt(1)&&Oe[1].charAt(0)==Oe[1].charAt(1)&&Oe[2].charAt(0)==Oe[2].charAt(1)?Oe[0].charAt(0)+Oe[1].charAt(0)+Oe[2].charAt(0):Oe.join("")}function _e(Re,Me,qe,Be){return[Ne(Xe(Be)),Ne(le(Re).toString(16)),Ne(le(Me).toString(16)),Ne(le(qe).toString(16))].join("")}function be(Re,Me){Me=Me===0?0:Me||10;var qe=de(Re).toHsl();return qe.s-=Me/100,qe.s=We(qe.s),de(qe)}function Se(Re,Me){Me=Me===0?0:Me||10;var qe=de(Re).toHsl();return qe.s+=Me/100,qe.s=We(qe.s),de(qe)}function Te(Re){return de(Re).desaturate(100)}function we(Re,Me){Me=Me===0?0:Me||10;var qe=de(Re).toHsl();return qe.l+=Me/100,qe.l=We(qe.l),de(qe)}function ke(Re,Me){Me=Me===0?0:Me||10;var qe=de(Re).toRgb();return qe.r=ve(0,pe(255,qe.r-le(-Me/100*255))),qe.g=ve(0,pe(255,qe.g-le(-Me/100*255))),qe.b=ve(0,pe(255,qe.b-le(-Me/100*255))),de(qe)}function xe(Re,Me){Me=Me===0?0:Me||10;var qe=de(Re).toHsl();return qe.l-=Me/100,qe.l=We(qe.l),de(qe)}function Ae(Re,Me){var qe=de(Re).toHsl(),Be=(qe.h+Me)%360;return qe.h=Be<0?360+Be:Be,de(qe)}function Le(Re){var Me=de(Re).toHsl();return Me.h=(Me.h+180)%360,de(Me)}function De(Re){var Me=de(Re).toHsl(),qe=Me.h;return[de(Re),de({h:(qe+120)%360,s:Me.s,l:Me.l}),de({h:(qe+240)%360,s:Me.s,l:Me.l})]}function $e(Re){var Me=de(Re).toHsl(),qe=Me.h;return[de(Re),de({h:(qe+90)%360,s:Me.s,l:Me.l}),de({h:(qe+180)%360,s:Me.s,l:Me.l}),de({h:(qe+270)%360,s:Me.s,l:Me.l})]}function Ve(Re){var Me=de(Re).toHsl(),qe=Me.h;return[de(Re),de({h:(qe+72)%360,s:Me.s,l:Me.l}),de({h:(qe+216)%360,s:Me.s,l:Me.l})]}function Qe(Re,Me,qe){Me=Me||6,qe=qe||30;var Be=de(Re).toHsl(),Oe=360/qe,ye=[de(Re)];for(Be.h=(Be.h-(Oe*Me>>1)+720)%360;--Me;)Be.h=(Be.h+Oe)%360,ye.push(de(Be));return ye}function je(Re,Me){Me=Me||6;for(var qe=de(Re).toHsv(),Be=qe.h,Oe=qe.s,ye=qe.v,Ce=[],Ee=1/Me;Me--;)Ce.push(de({h:Be,s:Oe,v:ye})),ye=(ye+Ee)%1;return Ce}de.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var Re=this.toRgb();return(299*Re.r+587*Re.g+114*Re.b)/1e3},getLuminance:function(){var Re,Me,qe,Be=this.toRgb();return Re=Be.r/255,Me=Be.g/255,qe=Be.b/255,.2126*(Re<=.03928?Re/12.92:ce.pow((Re+.055)/1.055,2.4))+.7152*(Me<=.03928?Me/12.92:ce.pow((Me+.055)/1.055,2.4))+.0722*(qe<=.03928?qe/12.92:ce.pow((qe+.055)/1.055,2.4))},setAlpha:function(Re){return this._a=Ue(Re),this._roundA=le(100*this._a)/100,this},toHsv:function(){var Re=he(this._r,this._g,this._b);return{h:360*Re.h,s:Re.s,v:Re.v,a:this._a}},toHsvString:function(){var Re=he(this._r,this._g,this._b),Me=le(360*Re.h),qe=le(100*Re.s),Be=le(100*Re.v);return this._a==1?"hsv("+Me+", "+qe+"%, "+Be+"%)":"hsva("+Me+", "+qe+"%, "+Be+"%, "+this._roundA+")"},toHsl:function(){var Re=ue(this._r,this._g,this._b);return{h:360*Re.h,s:Re.s,l:Re.l,a:this._a}},toHslString:function(){var Re=ue(this._r,this._g,this._b),Me=le(360*Re.h),qe=le(100*Re.s),Be=le(100*Re.l);return this._a==1?"hsl("+Me+", "+qe+"%, "+Be+"%)":"hsla("+Me+", "+qe+"%, "+Be+"%, "+this._roundA+")"},toHex:function(Re){return me(this._r,this._g,this._b,Re)},toHexString:function(Re){return"#"+this.toHex(Re)},toHex8:function(Re){return function(Me,qe,Be,Oe,ye){var Ce=[Ne(le(Me).toString(16)),Ne(le(qe).toString(16)),Ne(le(Be).toString(16)),Ne(Xe(Oe))];return ye&&Ce[0].charAt(0)==Ce[0].charAt(1)&&Ce[1].charAt(0)==Ce[1].charAt(1)&&Ce[2].charAt(0)==Ce[2].charAt(1)&&Ce[3].charAt(0)==Ce[3].charAt(1)?Ce[0].charAt(0)+Ce[1].charAt(0)+Ce[2].charAt(0)+Ce[3].charAt(0):Ce.join("")}(this._r,this._g,this._b,this._a,Re)},toHex8String:function(Re){return"#"+this.toHex8(Re)},toRgb:function(){return{r:le(this._r),g:le(this._g),b:le(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+le(this._r)+", "+le(this._g)+", "+le(this._b)+")":"rgba("+le(this._r)+", "+le(this._g)+", "+le(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:le(100*Pe(this._r,255))+"%",g:le(100*Pe(this._g,255))+"%",b:le(100*Pe(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+le(100*Pe(this._r,255))+"%, "+le(100*Pe(this._g,255))+"%, "+le(100*Pe(this._b,255))+"%)":"rgba("+le(100*Pe(this._r,255))+"%, "+le(100*Pe(this._g,255))+"%, "+le(100*Pe(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(Ie[me(this._r,this._g,this._b,!0)]||!1)},toFilter:function(Re){var Me="#"+_e(this._r,this._g,this._b,this._a),qe=Me,Be=this._gradientType?"GradientType = 1, ":"";if(Re){var Oe=de(Re);qe="#"+_e(Oe._r,Oe._g,Oe._b,Oe._a)}return"progid:DXImageTransform.Microsoft.gradient("+Be+"startColorstr="+Me+",endColorstr="+qe+")"},toString:function(Re){var Me=!!Re;Re=Re||this._format;var qe=!1,Be=this._a<1&&this._a>=0;return Me||!Be||Re!=="hex"&&Re!=="hex6"&&Re!=="hex3"&&Re!=="hex4"&&Re!=="hex8"&&Re!=="name"?(Re==="rgb"&&(qe=this.toRgbString()),Re==="prgb"&&(qe=this.toPercentageRgbString()),Re!=="hex"&&Re!=="hex6"||(qe=this.toHexString()),Re==="hex3"&&(qe=this.toHexString(!0)),Re==="hex4"&&(qe=this.toHex8String(!0)),Re==="hex8"&&(qe=this.toHex8String()),Re==="name"&&(qe=this.toName()),Re==="hsl"&&(qe=this.toHslString()),Re==="hsv"&&(qe=this.toHsvString()),qe||this.toHexString()):Re==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return de(this.toString())},_applyModification:function(Re,Me){var qe=Re.apply(null,[this].concat([].slice.call(Me)));return this._r=qe._r,this._g=qe._g,this._b=qe._b,this.setAlpha(qe._a),this},lighten:function(){return this._applyModification(we,arguments)},brighten:function(){return this._applyModification(ke,arguments)},darken:function(){return this._applyModification(xe,arguments)},desaturate:function(){return this._applyModification(be,arguments)},saturate:function(){return this._applyModification(Se,arguments)},greyscale:function(){return this._applyModification(Te,arguments)},spin:function(){return this._applyModification(Ae,arguments)},_applyCombination:function(Re,Me){return Re.apply(null,[this].concat([].slice.call(Me)))},analogous:function(){return this._applyCombination(Qe,arguments)},complement:function(){return this._applyCombination(Le,arguments)},monochromatic:function(){return this._applyCombination(je,arguments)},splitcomplement:function(){return this._applyCombination(Ve,arguments)},triad:function(){return this._applyCombination(De,arguments)},tetrad:function(){return this._applyCombination($e,arguments)}},de.fromRatio=function(Re,Me){if(typeof Re=="object"){var qe={};for(var Be in Re)Re.hasOwnProperty(Be)&&(qe[Be]=Be==="a"?Re[Be]:Ke(Re[Be]));Re=qe}return de(Re,Me)},de.equals=function(Re,Me){return!(!Re||!Me)&&de(Re).toRgbString()==de(Me).toRgbString()},de.random=function(){return de.fromRatio({r:ge(),g:ge(),b:ge()})},de.mix=function(Re,Me,qe){qe=qe===0?0:qe||50;var Be=de(Re).toRgb(),Oe=de(Me).toRgb(),ye=qe/100;return de({r:(Oe.r-Be.r)*ye+Be.r,g:(Oe.g-Be.g)*ye+Be.g,b:(Oe.b-Be.b)*ye+Be.b,a:(Oe.a-Be.a)*ye+Be.a})},de.readability=function(Re,Me){var qe=de(Re),Be=de(Me);return(ce.max(qe.getLuminance(),Be.getLuminance())+.05)/(ce.min(qe.getLuminance(),Be.getLuminance())+.05)},de.isReadable=function(Re,Me,qe){var Be,Oe,ye,Ce,Ee,Fe=de.readability(Re,Me);switch(Oe=!1,(ye=qe,(Ce=((ye=ye||{level:"AA",size:"small"}).level||"AA").toUpperCase())!=="AA"&&Ce!=="AAA"&&(Ce="AA"),(Ee=(ye.size||"small").toLowerCase())!=="small"&&Ee!=="large"&&(Ee="small"),Be={level:Ce,size:Ee}).level+Be.size){case"AAsmall":case"AAAlarge":Oe=Fe>=4.5;break;case"AAlarge":Oe=Fe>=3;break;case"AAAsmall":Oe=Fe>=7}return Oe},de.mostReadable=function(Re,Me,qe){var Be,Oe,ye,Ce,Ee=null,Fe=0;Oe=(qe=qe||{}).includeFallbackColors,ye=qe.level,Ce=qe.size;for(var ze=0;ze<Me.length;ze++)(Be=de.readability(Re,Me[ze]))>Fe&&(Fe=Be,Ee=de(Me[ze]));return de.isReadable(Re,Ee,{level:ye,size:Ce})||!Oe?Ee:(qe.includeFallbackColors=!1,de.mostReadable(Re,["#fff","#000"],qe))};var He=de.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Ie=de.hexNames=function(Re){var Me={};for(var qe in Re)Re.hasOwnProperty(qe)&&(Me[Re[qe]]=qe);return Me}(He);function Ue(Re){return Re=parseFloat(Re),(isNaN(Re)||Re<0||Re>1)&&(Re=1),Re}function Pe(Re,Me){(function(Be){return typeof Be=="string"&&Be.indexOf(".")!=-1&&parseFloat(Be)===1})(Re)&&(Re="100%");var qe=function(Be){return typeof Be=="string"&&Be.indexOf("%")!=-1}(Re);return Re=pe(Me,ve(0,parseFloat(Re))),qe&&(Re=parseInt(Re*Me,10)/100),ce.abs(Re-Me)<1e-6?1:Re%Me/parseFloat(Me)}function We(Re){return pe(1,ve(0,Re))}function Ye(Re){return parseInt(Re,16)}function Ne(Re){return Re.length==1?"0"+Re:""+Re}function Ke(Re){return Re<=1&&(Re=100*Re+"%"),Re}function Xe(Re){return ce.round(255*parseFloat(Re)).toString(16)}function Je(Re){return Ye(Re)/255}var nt,ot,ht,ct=(ot="[\\s|\\(]+("+(nt="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+nt+")[,|\\s]+("+nt+")\\s*\\)?",ht="[\\s|\\(]+("+nt+")[,|\\s]+("+nt+")[,|\\s]+("+nt+")[,|\\s]+("+nt+")\\s*\\)?",{CSS_UNIT:new RegExp(nt),rgb:new RegExp("rgb"+ot),rgba:new RegExp("rgba"+ht),hsl:new RegExp("hsl"+ot),hsla:new RegExp("hsla"+ht),hsv:new RegExp("hsv"+ot),hsva:new RegExp("hsva"+ht),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function ut(Re){return!!ct.CSS_UNIT.exec(Re)}ne.exports?ne.exports=de:(fe=function(){return de}.call(re,ie,re,ne))===void 0||(ne.exports=fe)})(Math)},607:function(ne,re,ie){var fe=this&&this.__importDefault||function(oe){return oe&&oe.__esModule?oe:{default:oe}};Object.defineProperty(re,"__esModule",{value:!0}),re.Cursor=re.default=void 0;var ce=fe(ie(678));re.default=ce.default;var se=fe(ie(353));re.Cursor=se.default,ie(413)},353:(ne,re,ie)=>{Object.defineProperty(re,"__esModule",{value:!0});var fe=ie(621),ce=function(){function se(oe,ae,le){this.id=oe,this.name=ae,this.color=le,this.toggleNearCursor=this.toggleNearCursor.bind(this),this._toggleOpenedCursor=this._toggleOpenedCursor.bind(this),this._setHoverState=this._setHoverState.bind(this)}return se.prototype.build=function(oe){var ae=document.createElement(se.CONTAINER_ELEMENT_TAG);ae.classList.add(se.CURSOR_CLASS),ae.id="ql-cursor-".concat(this.id),ae.innerHTML=oe.template;var le=ae.getElementsByClassName(se.SELECTION_CLASS)[0],pe=ae.getElementsByClassName(se.CARET_CONTAINER_CLASS)[0],ve=pe.getElementsByClassName(se.CARET_CLASS)[0],ge=ae.getElementsByClassName(se.FLAG_CLASS)[0];return ge.style.backgroundColor=this.color,ve.style.backgroundColor=this.color,ae.getElementsByClassName(se.NAME_CLASS)[0].textContent=this.name,this._hideDelay="".concat(oe.hideDelayMs,"ms"),this._hideSpeedMs=oe.hideSpeedMs,this._positionFlag=oe.positionFlag,ge.style.transitionDelay=this._hideDelay,ge.style.transitionDuration="".concat(this._hideSpeedMs,"ms"),this._el=ae,this._selectionEl=le,this._caretEl=pe,this._flagEl=ge,pe.addEventListener("mouseover",this._setHoverState),this._el},se.prototype.show=function(){this._el.classList.remove(se.HIDDEN_CLASS)},se.prototype.hide=function(){this._el.classList.add(se.HIDDEN_CLASS)},se.prototype.remove=function(){this._el.parentNode.removeChild(this._el)},se.prototype.toggleNearCursor=function(oe,ae){var le=this._getCoordinates(),pe=le.left,ve=le.right,ge=le.top,de=le.bottom,ue=oe>=pe&&oe<=ve&&ae>=ge&&ae<=de;return this._caretEl.classList.toggle(se.CONTAINER_HOVER_CLASS,ue),ue},se.prototype.toggleFlag=function(oe){var ae=this;this._caretEl.classList.toggle(se.CONTAINER_HOVER_CLASS,oe)||(this._flagEl.classList.add(se.NO_DELAY_CLASS),setTimeout(function(){return ae._flagEl.classList.remove(se.NO_DELAY_CLASS)},this._hideSpeedMs))},se.prototype.updateCaret=function(oe,ae){this._caretEl.style.top="".concat(oe.top,"px"),this._caretEl.style.left="".concat(oe.left,"px"),this._caretEl.style.height="".concat(oe.height,"px"),this._positionFlag?this._positionFlag(this._flagEl,oe,ae):this._updateCaretFlag(oe,ae)},se.prototype.updateSelection=function(oe,ae){var le=this;this._clearSelection(),oe=oe||[],oe=Array.from(oe),oe=this._sanitize(oe),(oe=this._sortByDomPosition(oe)).forEach(function(pe){return le._addSelection(pe,ae)})},se.prototype._setHoverState=function(){document.addEventListener("mousemove",this._toggleOpenedCursor)},se.prototype._toggleOpenedCursor=function(oe){var ae=this.toggleNearCursor(oe.clientX,oe.clientY);this._caretEl.classList.toggle(se.CONTAINER_NO_POINTER_CLASS,ae),ae||document.removeEventListener("mousemove",this._toggleOpenedCursor)},se.prototype._getCoordinates=function(){return this._caretEl.getBoundingClientRect()},se.prototype._updateCaretFlag=function(oe,ae){this._flagEl.style.width="";var le=this._flagEl.getBoundingClientRect();this._flagEl.classList.remove(se.FLAG_FLIPPED_CLASS),oe.left>ae.width-le.width&&this._flagEl.classList.add(se.FLAG_FLIPPED_CLASS),this._flagEl.style.left="".concat(oe.left,"px"),this._flagEl.style.top="".concat(oe.top,"px"),this._flagEl.style.width="".concat(Math.ceil(le.width),"px")},se.prototype._clearSelection=function(){this._selectionEl.innerHTML=""},se.prototype._addSelection=function(oe,ae){var le=this._selectionBlock(oe,ae);this._selectionEl.appendChild(le)},se.prototype._selectionBlock=function(oe,ae){var le=document.createElement(se.SELECTION_ELEMENT_TAG);return le.classList.add(se.SELECTION_BLOCK_CLASS),le.style.top="".concat(oe.top-ae.top,"px"),le.style.left="".concat(oe.left-ae.left,"px"),le.style.width="".concat(oe.width,"px"),le.style.height="".concat(oe.height,"px"),le.style.backgroundColor=fe(this.color).setAlpha(.3).toString(),le},se.prototype._sortByDomPosition=function(oe){return oe.sort(function(ae,le){return ae.top===le.top?ae.left-le.left:ae.top-le.top})},se.prototype._sanitize=function(oe){var ae=this,le=new Set;return oe.filter(function(pe){if(!pe.width||!pe.height)return!1;var ve=ae._serialize(pe);return!le.has(ve)&&(le.add(ve),!0)})},se.prototype._serialize=function(oe){return["top:".concat(oe.top),"right:".concat(oe.right),"bottom:".concat(oe.bottom),"left:".concat(oe.left)].join(";")},se.CONTAINER_ELEMENT_TAG="SPAN",se.SELECTION_ELEMENT_TAG="SPAN",se.CURSOR_CLASS="ql-cursor",se.SELECTION_CLASS="ql-cursor-selections",se.SELECTION_BLOCK_CLASS="ql-cursor-selection-block",se.CARET_CLASS="ql-cursor-caret",se.CARET_CONTAINER_CLASS="ql-cursor-caret-container",se.CONTAINER_HOVER_CLASS="hover",se.CONTAINER_NO_POINTER_CLASS="no-pointer",se.FLAG_CLASS="ql-cursor-flag",se.FLAG_FLIPPED_CLASS="flag-flipped",se.NAME_CLASS="ql-cursor-name",se.HIDDEN_CLASS="hidden",se.NO_DELAY_CLASS="no-delay",se}();re.default=ce},678:function(ne,re,ie){var fe=this&&this.__createBinding||(Object.create?function(ue,he,me,_e){_e===void 0&&(_e=me),Object.defineProperty(ue,_e,{enumerable:!0,get:function(){return he[me]}})}:function(ue,he,me,_e){_e===void 0&&(_e=me),ue[_e]=he[me]}),ce=this&&this.__setModuleDefault||(Object.create?function(ue,he){Object.defineProperty(ue,"default",{enumerable:!0,value:he})}:function(ue,he){ue.default=he}),se=this&&this.__importStar||function(ue){if(ue&&ue.__esModule)return ue;var he={};if(ue!=null)for(var me in ue)me!=="default"&&Object.prototype.hasOwnProperty.call(ue,me)&&fe(he,ue,me);return ce(he,ue),he},oe=this&&this.__importDefault||function(ue){return ue&&ue.__esModule?ue:{default:ue}};Object.defineProperty(re,"__esModule",{value:!0});var ae=oe(ie(353)),le=se(ie(165)),pe=oe(ie(338)),ve=oe(ie(33)),ge=ie(895),de=function(){function ue(he,me){me===void 0&&(me={}),this._cursors={},this._isObserving=!1,this._handleCursorTouch=this._handleCursorTouch.bind(this),this.quill=he,this.options=this._setDefaults(me),this._container=this.quill.addContainer(this.options.containerClass),this._boundsContainer=this.options.boundsContainer||this.quill.container,this._currentSelection=this.quill.getSelection(),this._registerSelectionChangeListeners(),this._registerTextChangeListener(),this._registerDomListeners()}return ue.prototype.createCursor=function(he,me,_e){var be=this._cursors[he];if(!be){be=new ae.default(he,me,_e),this._cursors[he]=be;var Se=be.build(this.options);this._container.appendChild(Se)}return be},ue.prototype.moveCursor=function(he,me){var _e=this._cursors[he];_e&&(_e.range=me,this._updateCursor(_e))},ue.prototype.removeCursor=function(he){var me=this._cursors[he];me&&(me.remove(),delete this._cursors[he])},ue.prototype.update=function(){var he=this;this.cursors().forEach(function(me){return he._updateCursor(me)})},ue.prototype.clearCursors=function(){var he=this;this.cursors().forEach(function(me){return he.removeCursor(me.id)})},ue.prototype.toggleFlag=function(he,me){var _e=this._cursors[he];_e&&_e.toggleFlag(me)},ue.prototype.cursors=function(){var he=this;return Object.keys(this._cursors).map(function(me){return he._cursors[me]})},ue.prototype._registerSelectionChangeListeners=function(){var he=this;this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(me){he._currentSelection=me})},ue.prototype._registerTextChangeListener=function(){var he=this;this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(me){return he._handleTextChange(me)})},ue.prototype._registerDomListeners=function(){var he=this,me=this.quill.container.getElementsByClassName("ql-editor")[0];me.addEventListener("scroll",function(){return he.update()}),me.addEventListener("touchstart",this._handleCursorTouch)},ue.prototype._handleCursorTouch=function(he){var me=this;this.cursors().forEach(function(_e){_e.toggleNearCursor(he.pageX,he.pageY),setTimeout(function(){return _e.toggleFlag(!1)},me.options.hideDelayMs)})},ue.prototype._registerResizeObserver=function(){var he=this;if(!this._isObserving){var me=this.quill.container.getElementsByClassName("ql-editor")[0],_e=new ve.default(function(be){be[0].target.isConnected||(_e.disconnect(),he._isObserving=!1),he.update()});_e.observe(me),this._isObserving=!0}},ue.prototype._updateCursor=function(he){if(this._registerResizeObserver(),!he.range)return he.hide();var me=this._indexWithinQuillBounds(he.range.index),_e=this._indexWithinQuillBounds(he.range.index+he.range.length),be=this.quill.getLeaf(me),Se=this.quill.getLeaf(_e);if(!this._leafIsValid(be)||!this._leafIsValid(Se))return he.hide();he.show();var Te=this._boundsContainer.getBoundingClientRect(),we=this.quill.getBounds(_e);he.updateCaret(we,Te);var ke=this._lineRanges(he,be,Se).reduce(function(xe,Ae){return xe.concat(Array.from(le.getClientRects(Ae)))},[]);he.updateSelection(ke,Te)},ue.prototype._indexWithinQuillBounds=function(he){var me=this.quill.getLength(),_e=me?me-1:0;return he=Math.max(he,0),Math.min(he,_e)},ue.prototype._leafIsValid=function(he){return he&&he[0]&&he[0].domNode&&he[1]>=0},ue.prototype._handleTextChange=function(he){var me=this;window.setTimeout(function(){me.options.transformOnTextChange&&me._transformCursors(he),me.options.selectionChangeSource&&(me._emitSelection(),me.update())})},ue.prototype._emitSelection=function(){this.quill.emitter.emit(this.quill.constructor.events.SELECTION_CHANGE,this.quill.getSelection(),this._currentSelection,this.options.selectionChangeSource)},ue.prototype._setDefaults=function(he){return(he=Object.assign({},he)).template||(he.template=ue.DEFAULTS.template),he.containerClass||(he.containerClass=ue.DEFAULTS.containerClass),he.selectionChangeSource!==null&&(he.selectionChangeSource||(he.selectionChangeSource=ue.DEFAULTS.selectionChangeSource)),he.hideDelayMs=Number.isInteger(he.hideDelayMs)?he.hideDelayMs:ue.DEFAULTS.hideDelayMs,he.hideSpeedMs=Number.isInteger(he.hideSpeedMs)?he.hideSpeedMs:ue.DEFAULTS.hideSpeedMs,he.transformOnTextChange=!!he.transformOnTextChange,he},ue.prototype._lineRanges=function(he,me,_e){var be=this.quill.getLines(he.range);return be.reduce(function(Se,Te,we){if(!Te.children){var ke=document.createRange();return ke.selectNode(Te.domNode),Se.concat(ke)}var xe=we===0?me:Te.path(0).pop(),Ae=xe[0],Le=xe[1],De=we===be.length-1?_e:Te.path(Te.length()-1).pop(),$e=De[0],Ve=De[1],Qe=document.createRange();return Ae.domNode.nodeType===Node.TEXT_NODE?Qe.setStart(Ae.domNode,Le):Qe.setStartBefore(Ae.domNode),$e.domNode.nodeType===Node.TEXT_NODE?Qe.setEnd($e.domNode,Ve):Qe.setEndAfter($e.domNode),Se.concat(Qe)},[])},ue.prototype._transformCursors=function(he){var me=this;he=new ge(he),this.cursors().filter(function(_e){return _e.range}).forEach(function(_e){_e.range.index=he.transformPosition(_e.range.index),me._updateCursor(_e)})},ue.DEFAULTS={template:pe.default,containerClass:"ql-cursors",selectionChangeSource:"api",hideDelayMs:3e3,hideSpeedMs:400},ue}();re.default=de},338:function(ne,re,ie){var fe=this&&this.__importDefault||function(oe){return oe&&oe.__esModule?oe:{default:oe}};Object.defineProperty(re,"__esModule",{value:!0});var ce=fe(ie(353)),se=`
  <span class="`.concat(ce.default.SELECTION_CLASS,`"></span>
  <span class="`).concat(ce.default.CARET_CONTAINER_CLASS,`">
    <span class="`).concat(ce.default.CARET_CLASS,`"></span>
  </span>
  <div class="`).concat(ce.default.FLAG_CLASS,`">
    <small class="`).concat(ce.default.NAME_CLASS,`"></small>
  </div>
`);re.default=se}},X={};function ee(ne){var re=X[ne];if(re!==void 0)return re.exports;var ie=X[ne]={id:ne,loaded:!1,exports:{}};return j[ne].call(ie.exports,ie,ie.exports,ee),ie.loaded=!0,ie.exports}ee.n=ne=>{var re=ne&&ne.__esModule?()=>ne.default:()=>ne;return ee.d(re,{a:re}),re},ee.d=(ne,re)=>{for(var ie in re)ee.o(re,ie)&&!ee.o(ne,ie)&&Object.defineProperty(ne,ie,{enumerable:!0,get:re[ie]})},ee.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),ee.o=(ne,re)=>Object.prototype.hasOwnProperty.call(ne,re),ee.r=ne=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ne,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ne,"__esModule",{value:!0})},ee.nmd=ne=>(ne.paths=[],ne.children||(ne.children=[]),ne),ee.nc=void 0;var te=ee(607);return te.default})())})(quillCursors);const QuillCursors=getDefaultExportFromCjs(quillCursors.exports),BLOCK_ID_ATTR="data-block-id",PREVENT_DEFAULT=!1,ALLOW_DEFAULT=!0,HOTKEYS={UNDO:"command+z,ctrl+z",REDO:"command+shift+z,ctrl+shift+z,ctrl+y",BACKSPACE:"backspace",SELECT_ALL:"command+a,ctrl+a",SHIFT_UP:"shift+up",SHIFT_DOWN:"shift+down",INLINE_CODE:"command+e,ctrl+e",STRIKE:"command+shift+s,ctrl+shift+s",LINK:"command+k,ctrl+k",TEXT:"command+option+0,ctrl+shift+0",H1:"command+option+1,ctrl+shift+1",H2:"command+option+2,ctrl+shift+2",H3:"command+option+3,ctrl+shift+3",H4:"command+option+4,ctrl+shift+4",H5:"command+option+5,ctrl+shift+5",H6:"command+option+6,ctrl+shift+6",BULLETED:"command+option+8,ctrl+shift+8",NUMBERED_LIST:"command+option+9,ctrl+shift+9"};function asyncFocusRichText(q,B){setTimeout(()=>{const j=q.richTextAdapters.get(B);j==null||j.quill.focus()})}function isCollapsedAtBlockStart(q){var B,j;return((B=q.getSelection(!0))==null?void 0:B.index)===0&&((j=q.getSelection())==null?void 0:j.length)===0}function convertToList(q,B,j,X,ee){var te,ne,re,ie,fe;if(B.flavour==="affine:list"&&B.type===j)return!1;if(B.flavour==="affine:paragraph"){const ce=q.getParent(B);if(!ce)return!1;const se=ce.children.indexOf(B);(te=B.text)==null||te.insert(" ",X.length),q.captureSync(),(ne=B.text)==null||ne.delete(0,X.length+1);const oe={flavour:"affine:list",type:j,text:(re=B==null?void 0:B.text)==null?void 0:re.clone(),children:B.children,...ee};q.deleteBlock(B);const ae=q.addBlock(oe,ce,se);asyncFocusRichText(q,ae)}else B.flavour==="affine:list"&&B.type!==j&&((ie=B.text)==null||ie.insert(" ",X.length),q.captureSync(),(fe=B.text)==null||fe.delete(0,X.length+1),q.updateBlock(B,{type:j}));return!0}function convertToParagraph(q,B,j,X){var ee,te,ne,re,ie;if(B.flavour==="affine:paragraph"&&B.type===j)return!1;if(B.flavour!=="affine:paragraph"){const fe=q.getParent(B);if(!fe)return!1;const ce=fe.children.indexOf(B);(ee=B.text)==null||ee.insert(" ",X.length),q.captureSync(),(te=B.text)==null||te.delete(0,X.length+1);const se={flavour:"affine:paragraph",type:j,text:(ne=B==null?void 0:B.text)==null?void 0:ne.clone(),children:B.children};q.deleteBlock(B);const oe=q.addBlock(se,fe,ce);asyncFocusRichText(q,oe)}else B.flavour==="affine:paragraph"&&B.type!==j&&((re=B.text)==null||re.insert(" ",X.length),q.captureSync(),(ie=B.text)==null||ie.delete(0,X.length+1),q.updateBlock(B,{type:j}));return!0}class Point{constructor(B,j){this.x=B,this.y=j}equals({x:B,y:j}){return this.x===B&&this.y===j}xDistance({x:B}){return this.x-B}yDistance({y:B}){return this.y-B}xDistanceAbsolute(B){return Math.abs(this.xDistance(B))}yDistanceAbsolute(B){return Math.abs(this.yDistance(B))}distance(B){return Math.sqrt(Math.pow(this.xDistance(B),2)+Math.pow(this.yDistance(B),2))}}class Rect{constructor(B,j,X,ee){const[te,ne]=j<=ee?[j,ee]:[ee,j],[re,ie]=B<=X?[B,X]:[X,B];this._top=te,this._right=ie,this._left=re,this._bottom=ne}get width(){return Math.abs(this._left-this._right)}get height(){return Math.abs(this._bottom-this._top)}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}equals({top:B,left:j,bottom:X,right:ee}){return B===this._top&&X===this._bottom&&j===this._left&&ee===this._right}isContainPoint({x:B,y:j}){return j>=this._top&&j<=this._bottom&&B>=this.left&&B<=this._right}isContain({top:B,left:j,bottom:X,right:ee}){return B>=this._top&&B<=this._bottom&&X>=this._top&&X<=this._bottom&&j>=this._left&&j<=this.right&&ee>=this.left&&ee<=this._right}isIntersect(B){const{left:j,top:X,width:ee,height:te}=B,{left:ne,top:re,width:ie,height:fe}=this,ce=j+ee>=ne+ie?j+ee:ne+ie,se=X+te>=re+fe?X+te:re+fe,oe=j<=ne?j:ne,ae=X<=re?X:re;return ce-oe<=ee+ie&&se-ae<=te+fe}isPointDown({x:B,y:j}){return this.bottom<j&&this.left<=B&&this.right>=B}isPointUp({x:B,y:j}){return j<this.top&&this.left<=B&&this.right>=B}isPointLeft({x:B,y:j}){return B<this.left&&this.top<=j&&this.bottom>=j}isPointRight({x:B,y:j}){return B>this.right&&this.top<=j&&this.bottom>=j}fromNewLeft(B){return this._left=B,new Rect(B,this.top,this.right,this.bottom)}static fromLTRB(B,j,X,ee){return new Rect(B,j,X,ee)}static fromLWTH(B,j,X,ee){return new Rect(B,X,B+j,X+ee)}static fromPoints(B,j){const{y:X,x:ee}=B,{y:te,x:ne}=j;return Rect.fromLTRB(ee,X,ne,te)}static fromDom(B){const{top:j,width:X,left:ee,height:te}=B.getBoundingClientRect();return Rect.fromLWTH(ee,X,j,te)}}var isff=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function addEvent(q,B,j,X){q.addEventListener?q.addEventListener(B,j,X):q.attachEvent&&q.attachEvent("on".concat(B),function(){j(window.event)})}function getMods(q,B){for(var j=B.slice(0,B.length-1),X=0;X<j.length;X++)j[X]=q[j[X].toLowerCase()];return j}function getKeys(q){typeof q!="string"&&(q=""),q=q.replace(/\s/g,"");for(var B=q.split(","),j=B.lastIndexOf("");j>=0;)B[j-1]+=",",B.splice(j,1),j=B.lastIndexOf("");return B}function compareArray(q,B){for(var j=q.length>=B.length?q:B,X=q.length>=B.length?B:q,ee=!0,te=0;te<j.length;te++)X.indexOf(j[te])===-1&&(ee=!1);return ee}var _keyMap={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":isff?173:189,"=":isff?61:187,";":isff?59:186,"'":222,"[":219,"]":221,"\\":220},_modifier={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},modifierMap={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},_mods={16:!1,18:!1,17:!1,91:!1},_handlers={};for(var k=1;k<20;k++)_keyMap["f".concat(k)]=111+k;var _downKeys=[],winListendFocus=!1,_scope="all",elementHasBindEvent=[],code=function q(B){return _keyMap[B.toLowerCase()]||_modifier[B.toLowerCase()]||B.toUpperCase().charCodeAt(0)},getKey=function q(B){return Object.keys(_keyMap).find(function(j){return _keyMap[j]===B})},getModifier=function q(B){return Object.keys(_modifier).find(function(j){return _modifier[j]===B})};function setScope(q){_scope=q||"all"}function getScope(){return _scope||"all"}function getPressedKeyCodes(){return _downKeys.slice(0)}function getPressedKeyString(){return _downKeys.map(function(q){return getKey(q)||getModifier(q)||String.fromCharCode(q)})}function filter(q){var B=q.target||q.srcElement,j=B.tagName,X=!0;return(B.isContentEditable||(j==="INPUT"||j==="TEXTAREA"||j==="SELECT")&&!B.readOnly)&&(X=!1),X}function isPressed(q){return typeof q=="string"&&(q=code(q)),_downKeys.indexOf(q)!==-1}function deleteScope(q,B){var j,X;q||(q=getScope());for(var ee in _handlers)if(Object.prototype.hasOwnProperty.call(_handlers,ee))for(j=_handlers[ee],X=0;X<j.length;)j[X].scope===q?j.splice(X,1):X++;getScope()===q&&setScope(B||"all")}function clearModifier(q){var B=q.keyCode||q.which||q.charCode,j=_downKeys.indexOf(B);if(j>=0&&_downKeys.splice(j,1),q.key&&q.key.toLowerCase()==="meta"&&_downKeys.splice(0,_downKeys.length),(B===93||B===224)&&(B=91),B in _mods){_mods[B]=!1;for(var X in _modifier)_modifier[X]===B&&(hotkeys[X]=!1)}}function unbind(q){if(typeof q>"u")Object.keys(_handlers).forEach(function(ne){return delete _handlers[ne]});else if(Array.isArray(q))q.forEach(function(ne){ne.key&&eachUnbind(ne)});else if(typeof q=="object")q.key&&eachUnbind(q);else if(typeof q=="string"){for(var B=arguments.length,j=new Array(B>1?B-1:0),X=1;X<B;X++)j[X-1]=arguments[X];var ee=j[0],te=j[1];typeof ee=="function"&&(te=ee,ee=""),eachUnbind({key:q,scope:ee,method:te,splitKey:"+"})}}var eachUnbind=function q(B){var j=B.key,X=B.scope,ee=B.method,te=B.splitKey,ne=te===void 0?"+":te,re=getKeys(j);re.forEach(function(ie){var fe=ie.split(ne),ce=fe.length,se=fe[ce-1],oe=se==="*"?"*":code(se);if(!!_handlers[oe]){X||(X=getScope());var ae=ce>1?getMods(_modifier,fe):[];_handlers[oe]=_handlers[oe].filter(function(le){var pe=ee?le.method===ee:!0;return!(pe&&le.scope===X&&compareArray(le.mods,ae))})}})};function eventHandler(q,B,j,X){if(B.element===X){var ee;if(B.scope===j||B.scope==="all"){ee=B.mods.length>0;for(var te in _mods)Object.prototype.hasOwnProperty.call(_mods,te)&&(!_mods[te]&&B.mods.indexOf(+te)>-1||_mods[te]&&B.mods.indexOf(+te)===-1)&&(ee=!1);(B.mods.length===0&&!_mods[16]&&!_mods[18]&&!_mods[17]&&!_mods[91]||ee||B.shortcut==="*")&&B.method(q,B)===!1&&(q.preventDefault?q.preventDefault():q.returnValue=!1,q.stopPropagation&&q.stopPropagation(),q.cancelBubble&&(q.cancelBubble=!0))}}}function dispatch(q,B){var j=_handlers["*"],X=q.keyCode||q.which||q.charCode;if(!!hotkeys.filter.call(this,q)){if((X===93||X===224)&&(X=91),_downKeys.indexOf(X)===-1&&X!==229&&_downKeys.push(X),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(le){var pe=modifierMap[le];q[le]&&_downKeys.indexOf(pe)===-1?_downKeys.push(pe):!q[le]&&_downKeys.indexOf(pe)>-1?_downKeys.splice(_downKeys.indexOf(pe),1):le==="metaKey"&&q[le]&&_downKeys.length===3&&(q.ctrlKey||q.shiftKey||q.altKey||(_downKeys=_downKeys.slice(_downKeys.indexOf(pe))))}),X in _mods){_mods[X]=!0;for(var ee in _modifier)_modifier[ee]===X&&(hotkeys[ee]=!0);if(!j)return}for(var te in _mods)Object.prototype.hasOwnProperty.call(_mods,te)&&(_mods[te]=q[modifierMap[te]]);q.getModifierState&&!(q.altKey&&!q.ctrlKey)&&q.getModifierState("AltGraph")&&(_downKeys.indexOf(17)===-1&&_downKeys.push(17),_downKeys.indexOf(18)===-1&&_downKeys.push(18),_mods[17]=!0,_mods[18]=!0);var ne=getScope();if(j)for(var re=0;re<j.length;re++)j[re].scope===ne&&(q.type==="keydown"&&j[re].keydown||q.type==="keyup"&&j[re].keyup)&&eventHandler(q,j[re],ne,B);if(X in _handlers){for(var ie=0;ie<_handlers[X].length;ie++)if((q.type==="keydown"&&_handlers[X][ie].keydown||q.type==="keyup"&&_handlers[X][ie].keyup)&&_handlers[X][ie].key){for(var fe=_handlers[X][ie],ce=fe.splitKey,se=fe.key.split(ce),oe=[],ae=0;ae<se.length;ae++)oe.push(code(se[ae]));oe.sort().join("")===_downKeys.sort().join("")&&eventHandler(q,fe,ne,B)}}}}function isElementBind(q){return elementHasBindEvent.indexOf(q)>-1}function hotkeys(q,B,j){_downKeys=[];var X=getKeys(q),ee=[],te="all",ne=document,re=0,ie=!1,fe=!0,ce="+",se=!1;for(j===void 0&&typeof B=="function"&&(j=B),Object.prototype.toString.call(B)==="[object Object]"&&(B.scope&&(te=B.scope),B.element&&(ne=B.element),B.keyup&&(ie=B.keyup),B.keydown!==void 0&&(fe=B.keydown),B.capture!==void 0&&(se=B.capture),typeof B.splitKey=="string"&&(ce=B.splitKey)),typeof B=="string"&&(te=B);re<X.length;re++)q=X[re].split(ce),ee=[],q.length>1&&(ee=getMods(_modifier,q)),q=q[q.length-1],q=q==="*"?"*":code(q),q in _handlers||(_handlers[q]=[]),_handlers[q].push({keyup:ie,keydown:fe,scope:te,mods:ee,shortcut:X[re],method:j,key:X[re],splitKey:ce,element:ne});typeof ne<"u"&&!isElementBind(ne)&&window&&(elementHasBindEvent.push(ne),addEvent(ne,"keydown",function(oe){dispatch(oe,ne)},se),winListendFocus||(winListendFocus=!0,addEvent(window,"focus",function(){_downKeys=[]},se)),addEvent(ne,"keyup",function(oe){dispatch(oe,ne),clearModifier(oe)},se))}function trigger(q){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(_handlers).forEach(function(j){var X=_handlers[j].find(function(ee){return ee.scope===B&&ee.shortcut===q});X&&X.method&&X.method()})}var _api={getPressedKeyString,setScope,getScope,deleteScope,getPressedKeyCodes,isPressed,filter,trigger,unbind,keyMap:_keyMap,modifier:_modifier,modifierMap};for(var a in _api)Object.prototype.hasOwnProperty.call(_api,a)&&(hotkeys[a]=_api[a]);if(typeof window<"u"){var _hotkeys=window.hotkeys;hotkeys.noConflict=function(q){return q&&window.hotkeys===hotkeys&&(window.hotkeys=_hotkeys),hotkeys},window.hotkeys=hotkeys}hotkeys.filter=()=>!0;const SCOPE={AFFINE_PAGE:"affine:page",OTHER:"other"};class HotkeyManager{constructor(){this.hotkeys=hotkeys}setScope(B){this.hotkeys.setScope(B)}addListener(B,j,X=SCOPE.AFFINE_PAGE){this.hotkeys(B,{scope:X},j)}removeListener(B,j=SCOPE.AFFINE_PAGE){this.hotkeys.unbind((Array.isArray(B)?B:[B]).join(","),j)}disableHotkey(){this.hotkeys.setScope(SCOPE.OTHER)}enableHotkey(){this.setScope(SCOPE.AFFINE_PAGE)}async withDisabledHotkey(B){this.disableHotkey();try{return await B()}finally{this.enableHotkey()}}withDisabledHotkeyFn(B){return(...j)=>this.withDisabledHotkey(()=>B(...j))}}const hotkey=new HotkeyManager;function assertExists(q){assertExists$1(q)}const assertFlavours=assertFlavours$1,matchFlavours=matchFlavours$1,IS_FIREFOX=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;function caretRangeFromPoint(q,B){if(IS_FIREFOX){const j=document.caretPositionFromPoint(q,B),X=document.createRange();return X.setStart(j.offsetNode,j.offset),X}return document.caretRangeFromPoint(q,B)}function almostEqual(q,B){return Math.abs(q-B)<1e-4}function createEvent(q,B){return new CustomEvent(q,{detail:B})}function noop(){}const sleep=(q=0)=>new Promise(B=>setTimeout(B,q));function getBlockById(q,B=document.body){return B.querySelector(`[${BLOCK_ID_ATTR}="${q}"]`)}function getParentBlockById(q,B=document.body){var X;const j=getBlockById(q,B);return((X=j==null?void 0:j.parentElement)==null?void 0:X.closest(`[${BLOCK_ID_ATTR}]`))||null}function getSiblingsById(q,B=document.body){var ee;const j=getParentBlockById(q,B),X=(ee=j==null?void 0:j.model)==null?void 0:ee.children;if(X!=null&&X.length){const te=X.map(ne=>`[${BLOCK_ID_ATTR}='${ne.id}']`).join(",");return Array.from(B.querySelectorAll(te))}return[]}function getPreviousSiblingById(q,B=document.body){const j=getSiblingsById(q,B),X=getBlockById(q,B);if(j&&j.length>0&&X){const ee=[...j].indexOf(X);return j[ee-1]||null}return null}function getNextSiblingById(q,B=document.body){const j=getSiblingsById(q,B),X=getBlockById(q,B);if(j&&j.length>0&&X){const ee=[...j].indexOf(X);return j[ee+1]||null}return null}function getNextBlock(q){let B=getBlockById(q);if(B!=null&&B.model.children.length)return B.model.children[0];for(;B;){const j=getParentBlockById(B.model.id);if(j){const X=getNextSiblingById(B.model.id);if(X)return X.model}B=j}return null}function getPreviousBlock(q,B){const j=getParentBlockById(B,q);if(j){const X=getPreviousSiblingById(B,q);if(X!=null&&X.model){if(X.model.children.length){let ee=X.model.children[X.model.children.length-1];for(;ee.children.length;)ee=ee.children[ee.children.length-1];return ee}return X.model}return j.model}return null}function getDefaultPageBlock(q){return assertExists(q.page.root),document.querySelector(`[${BLOCK_ID_ATTR}="${q.page.root.id}"]`)}function getContainerByModel(q){assertExists(q.page.root);const j=document.querySelector(`[${BLOCK_ID_ATTR}="${q.page.root.id}"]`).closest("editor-container");return assertExists(j),j}function getBlockElementByModel(q){assertExists(q.page.root);const B=document.querySelector(`[${BLOCK_ID_ATTR}="${q.page.root.id}"]`);return B?q.id===q.page.root.id?B:B.querySelector(`[${BLOCK_ID_ATTR}="${q.id}"]`):null}function getStartModelBySelection(){const q=window.getSelection();if(q.rangeCount===0)throw new Error("Can't get start model by selection, rangeCount is 0");const B=q.getRangeAt(0);return(B.startContainer instanceof Text?B.startContainer.parentElement:B.startContainer).closest(`[${BLOCK_ID_ATTR}]`).model}function getRichTextByModel(q){const B=getBlockElementByModel(q),j=B==null?void 0:B.querySelector("rich-text");return j||null}function getModelsByRange(q){var ee;let B=q.commonAncestorContainer;if(B.nodeType===Node.TEXT_NODE)return[getStartModelBySelection()];B.attributes&&!B.attributes.getNamedItem(BLOCK_ID_ATTR)&&(B=(ee=B.closest(`[${BLOCK_ID_ATTR}]`))==null?void 0:ee.parentElement);const j=[],X=B.querySelectorAll(`[${BLOCK_ID_ATTR}]`);return X.length>1?(X.forEach(te=>{const ne=te;assertExists(ne.model);const re=getBlockElementByModel(ne.model),ie=ne.model.flavour==="affine:page"?re==null?void 0:re.querySelector(".affine-default-page-block-title-container"):re==null?void 0:re.querySelector("rich-text");ie&&q.intersectsNode(ie)&&(re==null?void 0:re.tagName)!=="GROUP-BLOCK"&&j.push(ne.model)}),j):[getStartModelBySelection()]}function getModelByElement(q){const B=q.closest(`[${BLOCK_ID_ATTR}]`);return assertExists(B.model),B.model}function getCurrentRange(){return window.getSelection().getRangeAt(0)}function textWithoutNode(q,B){let j="";for(let X=0;X<q.childNodes.length;X++){const ee=q.childNodes[X];if(ee!==B||!B.contains(ee))j+=ee.textContent||ee.innerText||"";else return j}return j}function getQuillIndexByNativeSelection(q,B,j){var ne,re;if(q instanceof Element&&q.classList.contains("affine-default-page-block-title-container"))return(j?(ne=q.querySelector("input"))==null?void 0:ne.selectionStart:(re=q.querySelector("input"))==null?void 0:re.selectionEnd)||0;let X=0,ee=q,te=!1;for(;q&&(!(ee!=null&&ee.getAttributeNode)||!ee.getAttributeNode("contenteditable"));){if(q instanceof Element&&q.hasAttribute("data-block-id")){X=0;break}te?X+=textWithoutNode(q,ee).length:(te=!0,X+=B),ee=q,q=q==null?void 0:q.parentNode}return X}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{H:l}=z,c$1=()=>document.createComment(""),r=(q,B,j)=>{var X;const ee=q._$AA.parentNode,te=B===void 0?q._$AB:B._$AA;if(j===void 0){const ne=ee.insertBefore(c$1(),te),re=ee.insertBefore(c$1(),te);j=new l(ne,re,q,q.options)}else{const ne=j._$AB.nextSibling,re=j._$AM,ie=re!==q;if(ie){let fe;(X=j._$AQ)===null||X===void 0||X.call(j,q),j._$AM=q,j._$AP!==void 0&&(fe=q._$AU)!==re._$AU&&j._$AP(fe)}if(ne!==te||ie){let fe=j._$AA;for(;fe!==ne;){const ce=fe.nextSibling;ee.insertBefore(fe,te),fe=ce}}}return j},u$1=(q,B,j=q)=>(q._$AI(B,j),q),f={},s=(q,B=f)=>q._$AH=B,m=q=>q._$AH,p=q=>{var B;(B=q._$AP)===null||B===void 0||B.call(q,!1,!0);let j=q._$AA;const X=q._$AB.nextSibling;for(;j!==X;){const ee=j.nextSibling;j.remove(),j=ee}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const u=(q,B,j)=>{const X=new Map;for(let ee=B;ee<=j;ee++)X.set(q[ee],ee);return X},c=e(class extends i$1{constructor(q){if(super(q),q.type!==t.CHILD)throw Error("repeat() can only be used in text expressions")}ht(q,B,j){let X;j===void 0?j=B:B!==void 0&&(X=B);const ee=[],te=[];let ne=0;for(const re of q)ee[ne]=X?X(re,ne):ne,te[ne]=j(re,ne),ne++;return{values:te,keys:ee}}render(q,B,j){return this.ht(q,B,j).values}update(q,[B,j,X]){var ee;const te=m(q),{values:ne,keys:re}=this.ht(B,j,X);if(!Array.isArray(te))return this.ut=re,ne;const ie=(ee=this.ut)!==null&&ee!==void 0?ee:this.ut=[],fe=[];let ce,se,oe=0,ae=te.length-1,le=0,pe=ne.length-1;for(;oe<=ae&&le<=pe;)if(te[oe]===null)oe++;else if(te[ae]===null)ae--;else if(ie[oe]===re[le])fe[le]=u$1(te[oe],ne[le]),oe++,le++;else if(ie[ae]===re[pe])fe[pe]=u$1(te[ae],ne[pe]),ae--,pe--;else if(ie[oe]===re[pe])fe[pe]=u$1(te[oe],ne[pe]),r(q,fe[pe+1],te[oe]),oe++,pe--;else if(ie[ae]===re[le])fe[le]=u$1(te[ae],ne[le]),r(q,te[oe],te[ae]),ae--,le++;else if(ce===void 0&&(ce=u(re,le,pe),se=u(ie,oe,ae)),ce.has(ie[oe]))if(ce.has(ie[ae])){const ve=se.get(re[le]),ge=ve!==void 0?te[ve]:null;if(ge===null){const de=r(q,te[oe]);u$1(de,ne[le]),fe[le]=de}else fe[le]=u$1(ge,ne[le]),r(q,te[oe],ge),te[ve]=null;le++}else p(te[ae]),ae--;else p(te[oe]),oe++;for(;le<=pe;){const ve=r(q,fe[pe+1]);u$1(ve,ne[le]),fe[le++]=ve}for(;oe<=ae;){const ve=te[oe++];ve!==null&&p(ve)}return this.ut=re,s(q,fe),x}});function BlockElement(q,B){switch(q.flavour){case"affine:paragraph":return y`
        <paragraph-block
          .model=${q}
          .host=${B}
        ></paragraph-block>
      `;case"affine:list":return y`
        <list-block
          .model=${q}
          .host=${B}
        ></list-block>
      `;case"affine:group":return y`
        <group-block
          .model=${q}
          .host=${B}
        ></group-block>
      `}return y`<div>Unknown block type: "${q.flavour}"</div>`}function BlockChildrenContainer(q,B){return y`
    <style>
      .affine-block-children-container {
        padding-left: 26px;
      }
    </style>
    <div class="affine-block-children-container">
      ${c(q.children,j=>j.id,j=>BlockElement(j,B))}
    </div>
  `}function isFarEnough(q,B,j=2){return Math.pow(q.x-B.x,2)+Math.pow(q.y-B.y,2)>j*j}function toSelectionEvent(q,B,j,X,ee=null){var ce,se;const te={x:0,y:0},ne={x:j,y:X},re=q.clientX-((ce=B==null?void 0:B.left)!=null?ce:0),ie=q.clientY-((se=B==null?void 0:B.top)!=null?se:0),fe={x:re,y:ie,raw:q,delta:te,start:ne,keys:{shift:q.shiftKey,cmd:q.metaKey||q.ctrlKey,alt:q.altKey},button:q.button};return ee&&(te.x=re-ee.x,te.y=ie-ee.y),fe}function isPageTitle(q){return q.target instanceof HTMLInputElement}function tryPreventDefault(q){isPageTitle(q)||q.preventDefault()}function initMouseEventHandlers(q,B,j,X,ee,te,ne,re,ie){let fe=-1/0,ce=-1/0,se=!1,oe=null,ae=null;const le=me=>re(toSelectionEvent(me,ae,fe,ce)),pe=me=>{tryPreventDefault(me),ae=q.getBoundingClientRect(),fe=me.clientX-ae.left,ce=me.clientY-ae.top,se=!1,me.button||(oe=toSelectionEvent(me,ae,fe,ce)),document.addEventListener("mouseup",ge),document.addEventListener("mouseout",le)},ve=me=>{tryPreventDefault(me),ae||(ae=q.getBoundingClientRect());const _e={x:fe,y:ce},be=me.clientX-ae.left,Se=me.clientY-ae.top,Te={x:be,y:Se};if(!oe){ne(toSelectionEvent(me,ae,fe,ce,oe));return}isFarEnough(_e,Te)&&!se&&(se=!0,B(oe)),se&&(j(toSelectionEvent(me,ae,fe,ce,oe)),ne(toSelectionEvent(me,ae,fe,ce,oe)),oe=toSelectionEvent(me,ae,fe,ce))},ge=me=>{tryPreventDefault(me),se?X(toSelectionEvent(me,ae,fe,ce,oe)):ee(toSelectionEvent(me,ae,fe,ce)),fe=ce=-1/0,se=!1,oe=null,document.removeEventListener("mouseup",ge),document.removeEventListener("mouseout",le)},de=me=>{ie(toSelectionEvent(me,ae,fe,ce))},ue=me=>{te(toSelectionEvent(me,ae,fe,ce))};return q.addEventListener("mousedown",pe),q.addEventListener("mousemove",ve),q.addEventListener("contextmenu",de),q.addEventListener("dblclick",ue),()=>{q.removeEventListener("mousedown",pe),q.removeEventListener("mousemove",ve),q.removeEventListener("contextmenu",de),q.removeEventListener("dblclick",ue)}}const SCROLL_THRESHOLD=100,notStrictCharacterReg=/[^\p{Alpha}\p{M}\p{Nd}\p{Pc}\p{Join_C}]/u,notStrictCharacterAndSpaceReg=/[^\p{Alpha}\p{M}\p{Nd}\p{Pc}\p{Join_C}\s]/u;function forwardSelect(q,B){var j,X;if(q.endContainer.nodeType!==Node.TEXT_NODE){const ee=getLastTextNode(q.endContainer);ee&&(q=document.createRange(),q.setStart(ee,((j=ee.textContent)==null?void 0:j.length)||0),q.setEnd(ee,((X=ee.textContent)==null?void 0:X.length)||0))}B.setEnd(q.endContainer,q.endOffset)}function backwardSelect(q,B){if(q.startContainer.nodeType!==Node.TEXT_NODE){const j=getFirstTextNode(q.startContainer);j&&(q=document.createRange(),q.setStart(j,0),q.setEnd(j,0))}B.setStart(q.endContainer,q.endOffset)}function fixCurrentRangeToText(q,B,j,X){const ee=X?j.endContainer:j.startContainer;let te=j;if(ee.nodeType!==Node.TEXT_NODE){const ne=Array.from(j.commonAncestorContainer.querySelectorAll(".ql-editor"));if(ne.length){const re=X?ne.reverse().find(ce=>{const se=ce.getBoundingClientRect();return B>=se.top}):ne.find(ce=>{const se=ce.getBoundingClientRect();return B<=se.bottom});if(!re)throw new Error("Failed to focus text node!");const ie=re.getBoundingClientRect(),fe=X?ie.bottom-6:ie.top+6;te=caretRangeFromPoint(q,fe),X&&te?forwardSelect(te,j):!X&&te&&backwardSelect(te,j)}}return j}function setStartRange(q){const B=document.createRange();let j=q.firstChild;for(;j!=null&&j.firstChild;)j=j.firstChild;return j&&(B.setStart(j,0),B.setEnd(j,0)),B}function setEndRange(q){var X,ee;const B=document.createRange();let j=q.lastChild;for(;j!=null&&j.lastChild;)j=j.lastChild;return j&&(B.setStart(j,((X=j.textContent)==null?void 0:X.length)||0),B.setEnd(j,((ee=j.textContent)==null?void 0:ee.length)||0)),B}async function setNewTop(q,B){const j=B.closest(".affine-editor-container"),{top:X,bottom:ee}=Rect.fromDom(B),{clientHeight:te}=document.documentElement,ne=Number(window.getComputedStyle(B).lineHeight.replace(/\D+$/,""))||16;switch(ee<q){case!0:{let ie=ee;return ee<SCROLL_THRESHOLD&&j&&(j.scrollTop=j.scrollTop-SCROLL_THRESHOLD+ee,await sleep(),ie=B.getBoundingClientRect().bottom),ie-ne/2}case!1:{let ie=X;return j&&X>te-SCROLL_THRESHOLD&&(j.scrollTop=j.scrollTop+(X+SCROLL_THRESHOLD-te),await sleep(),ie=B.getBoundingClientRect().top),ie+ne/2}}}async function focusRichText(q,B){const{left:j,right:X}=Rect.fromDom(B);let ee=null;switch(q){case"start":ee=setStartRange(B);break;case"end":ee=setEndRange(B);break;default:{const{x:te,y:ne}=q;let re=te;const ie=await setNewTop(ne,B);te<=j&&(re=j+1),te>=X&&(re=X-1),ee=caretRangeFromPoint(re,ie),resetNativeSelection(ee);break}}resetNativeSelection(ee)}function focusRichTextByModel(q,B){const j=getBlockElementByModel(B),X=j==null?void 0:j.querySelector("[contenteditable]");X&&focusRichText(q,X)}function focusPreviousBlock(q,B){const j=getDefaultPageBlock(q),X=getContainerByModel(q);let ee=B;ee?j.lastSelectionPosition=ee:j.lastSelectionPosition&&(ee=j.lastSelectionPosition);const te=getPreviousBlock(X,q.id);te&&ee&&focusRichTextByModel(ee,te)}function focusNextBlock(q,B="start"){const j=getDefaultPageBlock(q);let X=B;X?j.lastSelectionPosition=X:j.lastSelectionPosition&&(X=j.lastSelectionPosition);const ee=getNextBlock(q.id);ee&&focusRichTextByModel(X,ee)}function resetNativeSelection(q){const B=window.getSelection();B==null||B.removeAllRanges(),q&&(B==null||B.addRange(q))}function focusRichTextByOffset(q,B){const j=q.querySelector("rich-text");assertExists(j);const X=j.getBoundingClientRect(),ee=X.y+X.height/2,te=caretRangeFromPoint(B,ee);(te==null?void 0:te.startContainer)instanceof Node&&resetNativeSelection(te)}function isNoneSelection(){const q=window.getSelection();return q?q.type==="None":!0}function isCollapsedSelection(){const q=window.getSelection();return q?q.isCollapsed:!1}function isRangeSelection(){const q=window.getSelection();return q?!q.isCollapsed:!1}function isMultiBlockRange(q){return q.commonAncestorContainer.nodeType!==Node.TEXT_NODE}function getSelectedBlock(q){var X;const B=[],j=new Map;for(let ee=0;ee<q.length;ee++){const te=q[ee],ne=te.page.getParent(te),re={id:te.id,children:[]};!ne||!j.has(ne.id)?B.push(re):(X=j.get(ne.id))==null||X.children.push(re),j.set(te.id,re)}return B}function getLastSelectBlock(q){if(q.length===0)return null;const B=q[q.length-1];return B.children.length===0?B:getLastSelectBlock(B.children)}function getSelectInfo(q){if(!q.root)return{type:"None",selectedBlocks:[]};let B="None",j=[],X=[];const ee=getDefaultPageBlock(q.root),{state:te}=ee.selection,ne=window.getSelection();if(te.type==="block"){B="Block";const{selectedRichTexts:re}=te;X=re.map(ie=>ie.model)}else ne&&ne.type!=="None"&&(B=ne.type,X=getModelsByRange(getCurrentRange()));if(B!=="None"&&(j=getSelectedBlock(X),B!=="Block"&&ne&&j.length>0)){const re=ne.getRangeAt(0),ie=getQuillIndexByNativeSelection(re.startContainer,re.startOffset,!0),fe=getQuillIndexByNativeSelection(re.endContainer,re.endOffset,!1);j[0].startPos=ie;const ce=getLastSelectBlock(j);ce&&(ce.endPos=fe)}return{type:B,selectedBlocks:j}}function handleNativeRangeDragMove(q,B){let j=!0;assertExists(q);const{startContainer:X,startOffset:ee,endContainer:te,endOffset:ne}=q;let re=caretRangeFromPoint(B.raw.clientX,B.raw.clientY);(re==null?void 0:re.comparePoint(te,ne))===1?(j=!1,re==null||re.setEnd(te,ne)):re==null||re.setStart(X,ee),re&&(re=fixCurrentRangeToText(B.raw.clientX,B.raw.clientY,re,j)),resetNativeSelection(re)}function isBlankAreaBetweenBlocks(q){return q instanceof HTMLElement?q.className.includes("affine-paragraph-block-container"):!1}function isBlankAreaAfterLastBlock(q){return q.tagName==="GROUP-BLOCK"}function isBlankAreaBeforeFirstBlock(q){return q instanceof HTMLElement?q.className.includes("affine-group-block-container"):!1}function isBlankArea(q){const{cursor:B}=window.getComputedStyle(q.raw.target);return B!=="text"}function handleNativeRangeClick(q,B){const j=caretRangeFromPoint(B.raw.clientX,B.raw.clientY),X=j==null?void 0:j.startContainer;if(!B.button&&(X instanceof Node&&resetNativeSelection(j),X instanceof HTMLElement)){if(isBlankAreaBetweenBlocks(X)||isBlankAreaBeforeFirstBlock(X))focusRichTextByOffset(X,B.raw.clientX);else if(isBlankAreaAfterLastBlock(X)){const{root:ee}=q,te=ee==null?void 0:ee.lastChild();if(assertExists(te),matchFlavours(te,["affine:paragraph","affine:list"])){const ne=getBlockElementByModel(te);if(!ne)return;focusRichTextByOffset(ne,B.raw.clientX)}}}}function handleNativeRangeDblClick(q,B){var X;const j=window.getSelection();if(j&&j.isCollapsed&&j.anchorNode){const ee=(X=j.anchorNode.parentElement)==null?void 0:X.closest("[contenteditable]");ee&&expandRangesByCharacter(j,ee)}}function expandRangesByCharacter(q,B){const j=leftFirstSearchLeafNodes(B);if(!j.length)return;const[X,ee,te]=getNewRangeForDblClick(j,q);trySelectBySegmenter(q,X,ee,j,te),resetNativeSelection(X)}function getNewStartAndEndForDblClick(q,B,j,X){var ie,fe,ce;let ee=B[0],te=0,ne=B[B.length-1],re=((ie=ne.textContent)==null?void 0:ie.length)||0;for(let se=q;se>=0;se--){const oe=B[se];if(oe instanceof Text){const ae=(fe=oe.textContent)==null?void 0:fe.slice(0,se===q?j.anchorOffset:void 0);if(ae){const le=Array.from(ae).reverse().join(""),pe=le.search(X);if(pe!==-1){ee=oe,te=le.length-pe;break}}}}for(let se=q;se<B.length;se++){const oe=B[se];if(oe instanceof Text){const ae=(ce=oe.textContent)==null?void 0:ce.slice(se===q?j.anchorOffset:void 0);if(ae){const le=ae.search(X);if(le!==-1){ne=oe,re=se===q?j.anchorOffset+le:le;break}}}}return[ee,te,ne,re]}function getNewRangeForDblClick(q,B){var ce,se;let j=q[0],X=0,ee=q[q.length-1],te=((ce=ee.textContent)==null?void 0:ce.length)||0;const ne=B.anchorNode instanceof Element?B.anchorNode.firstChild:B.anchorNode,re=((se=ne==null?void 0:ne.textContent)==null?void 0:se[B.anchorOffset])||"",ie=q.findIndex(oe=>oe===ne);if(re&&notStrictCharacterAndSpaceReg.test(re)&&ne)j=ne,ee=ne,X=B.anchorOffset,te=B.anchorOffset+1;else{let oe=notStrictCharacterReg;/\s/.test(re)&&(oe=/\S/),/\w/.test(re)&&(oe=/\W/);const[ae,le,pe,ve]=getNewStartAndEndForDblClick(ie,q,B,oe);j=ae,X=le,ee=pe,te=ve}const fe=document.createRange();return fe.setStart(j,X),fe.setEnd(ee,te),[fe,re,ie]}function trySelectBySegmenter(q,B,j,X,ee){var te,ne;if(Intl.Segmenter&&!notStrictCharacterAndSpaceReg.test(j)&&!/\w/.test(j)){const[re,ie]=getCurrentCharIndex(B,X,q,j);let fe=re,ce=ie.length-re;for(let se=ee;se>=0;se--){const oe=X[se],ae=se===ee?q.anchorOffset:((te=oe.textContent)==null?void 0:te.length)||0;if(fe<=ae){B.setStart(oe,ae-fe);break}else fe=fe-ae}for(let se=ee;se<X.length;se++){const oe=X[se],ae=((ne=oe.textContent)==null?void 0:ne.length)||0,le=se===ee?ae-q.anchorOffset:ae;if(ce<=le){B.setEnd(oe,ae-le+ce);break}else ce=ce-le}}}function getCurrentCharIndex(q,B,j,X){var oe;const ee=q.toString(),ne=new Intl.Segmenter([],{granularity:"word"}).segment(ee)[Symbol.iterator](),re=Array.from(ne);let ie=0,fe=!1;for(let ae=0;ae<B.length;ae++){const le=B[ae];if(fe||le===q.startContainer)if(fe=!0,le!==j.anchorNode)ie=ie+(((oe=le.textContent)==null?void 0:oe.length)||0);else{ie=ie+j.anchorOffset-q.startOffset;break}}let ce=re[re.length-1].segment;for(let ae=0;ae<re.length;ae++){const le=re[ae];if(ie===le.index){ce=le.segment;break}if(ie<le.index){ce=re[ae-1].segment;break}}return[ce.indexOf(X),ce]}function leftFirstSearchLeafNodes(q,B=[]){if(q.nodeType===Node.TEXT_NODE)B.push(q);else{const j=q.childNodes;for(let X=0;X<j.length;X++)leftFirstSearchLeafNodes(j[X],B)}return B}function getLastTextNode(q){return leftFirstSearchLeafNodes(q).pop()}function getFirstTextNode(q){return leftFirstSearchLeafNodes(q)[0]}function getSplicedTitle(q){const B=[...q.value];return assertExists(q.selectionStart),assertExists(q.selectionEnd),B.splice(q.selectionStart,q.selectionEnd-q.selectionStart),B.join("")}function handleBlockEndEnter(q,B){const j=q.getParent(B),X=j==null?void 0:j.children.indexOf(B);if(j&&X!==void 0&&X>-1){q.captureSync();let ee="";if(B.flavour==="affine:list"){const te={flavour:B.flavour,type:B.type};B.children.length===0?ee=q.addBlock(te,j,X+1):ee=q.addBlock(te,B,0)}else{const te={flavour:B.flavour,type:"text"};ee=q.addBlock(te,j,X+1)}ee&&asyncFocusRichText(q,ee)}}function handleSoftEnter(q,B,j){var X;q.captureSync(),(X=B.text)==null||X.insert(`
`,j)}function handleBlockSplit(q,B,j){if(!(B.text instanceof Text$1))return;const X=q.getParent(B);if(!X)return;const[ee,te]=B.text.split(j);q.captureSync(),q.markTextSplit(B.text,ee,te),q.updateBlock(B,{text:ee});let ne=X,re=ne.children.indexOf(B)+1;B.flavour==="affine:list"&&B.children.length>0&&(ne=B,re=0);const ie=q.addBlock({flavour:B.flavour,text:te,type:B.type},ne,re);asyncFocusRichText(q,ie)}function handleIndent(q,B,j){var ee;const X=q.getPreviousSibling(B);if(X){q.captureSync();const te={flavour:B.flavour,type:B.type,text:(ee=B==null?void 0:B.text)==null?void 0:ee.clone(),children:B.children};q.deleteBlock(B);const ne=q.addBlock(te,X);requestAnimationFrame(()=>{const re=q.getBlockById(ne);assertExists(re);const ie=getRichTextByModel(re);ie==null||ie.quill.setSelection(j,0)})}}async function handleUnindent(q,B,j){var ie;const X=q.getParent(B);if(!X||(X==null?void 0:X.flavour)==="affine:group")return;const ee=q.getParent(X);if(!ee)return;const te=ee.children.indexOf(X),ne={flavour:B.flavour,text:(ie=B==null?void 0:B.text)==null?void 0:ie.clone(),children:B.children,type:B.type};q.captureSync(),q.deleteBlock(B);const re=q.addBlock(ne,ee,te+1);requestAnimationFrame(()=>{const fe=q.getBlockById(re);assertExists(fe);const ce=getRichTextByModel(fe);ce==null||ce.quill.setSelection(j,0)})}function handleLineStartBackspace(q,B){var j,X,ee,te,ne;if(B.flavour==="affine:paragraph")if(B.type!=="text")q.captureSync(),q.updateBlock(B,{type:"text"});else{const re=q.getParent(B);if(!re||(re==null?void 0:re.flavour)==="affine:group"){const ie=getContainerByModel(B),fe=getPreviousBlock(ie,B.id);if(fe&&fe.flavour==="affine:paragraph"){q.captureSync();const ce=((j=fe.text)==null?void 0:j.length)||0;(X=fe.text)==null||X.join(B.text),q.deleteBlock(B);const se=getRichTextByModel(fe);(ee=se==null?void 0:se.quill)==null||ee.setSelection(ce,0)}}else{const ie=q.getParent(re);if(!ie)return;const fe=ie.children.indexOf(re),ce={flavour:B.flavour,text:(te=B==null?void 0:B.text)==null?void 0:te.clone(),children:B.children,type:B.type};q.captureSync(),q.deleteBlock(B),q.addBlock(ce,ie,fe+1)}}else if(B.flavour==="affine:list"){const re=q.getParent(B);if(!re)return;const ie=re.children.indexOf(B);q.captureSync();const fe={flavour:"affine:paragraph",type:"text",text:(ne=B==null?void 0:B.text)==null?void 0:ne.clone(),children:B.children};q.deleteBlock(B);const ce=q.addBlock(fe,re,ie);asyncFocusRichText(q,ce)}}function handleKeyUp(q,B){var X;const j=window.getSelection();if(j){const ee=j.getRangeAt(0),{height:te,left:ne,top:re}=ee.getBoundingClientRect();if(te===0&&re===0){const fe=(X=ee.startContainer.parentElement)==null?void 0:X.getBoundingClientRect();return fe&&focusPreviousBlock(q,new Point(fe.left,fe.top)),PREVENT_DEFAULT}const ie=caretRangeFromPoint(ne,re-te/2);if((!ie||!B.contains(ie.startContainer))&&!isAtLineEdge(ee)){const fe=getContainerByModel(q),ce=getPreviousBlock(fe,q.id);return(ce==null?void 0:ce.flavour)==="affine:group"?document.querySelector(".affine-default-page-block-title").focus():focusPreviousBlock(q,new Point(ne,re)),PREVENT_DEFAULT}}return ALLOW_DEFAULT}function isAtLineEdge(q){var B;if(q.startOffset>0&&Number((B=q.startContainer.textContent)==null?void 0:B.length)-q.startOffset>0){const j=q.cloneRange();j.setStart(q.startContainer,q.startOffset-1),j.setEnd(q.startContainer,q.startOffset-1);const X=q.cloneRange();return X.setStart(q.endContainer,q.endOffset+1),X.setEnd(q.endContainer,q.endOffset+1),j.getBoundingClientRect().top!==X.getBoundingClientRect().top}return!1}function handleKeyDown(q,B){var X;const j=window.getSelection();if(j){const ee=j.getRangeAt(0),{bottom:te,left:ne,height:re}=ee.getBoundingClientRect();if(re===0&&te===0){const fe=(X=ee.startContainer.parentElement)==null?void 0:X.getBoundingClientRect();return getNextBlock(q.id)?(fe&&focusNextBlock(q,new Point(fe.left,fe.top)),PREVENT_DEFAULT):ALLOW_DEFAULT}const ie=caretRangeFromPoint(ne,te+re/2);if(!ie||!B.contains(ie.startContainer))return getNextBlock(q.id)?(focusNextBlock(q,new Point(ne,te)),PREVENT_DEFAULT):ALLOW_DEFAULT;if(isAtLineEdge(ee)){const{height:fe,left:ce,bottom:se}=ie.getBoundingClientRect(),oe=caretRangeFromPoint(ce,se+fe/2);if(!oe||!B.contains(oe.startContainer))return focusNextBlock(q,new Point(B.getBoundingClientRect().left||ce,te)),PREVENT_DEFAULT}}return ALLOW_DEFAULT}function tryMatchSpaceHotkey(q,B,j,X,ee){const[,te]=j.getLine(ee.index);if(te>X.length)return ALLOW_DEFAULT;let ne=!1;switch(X.trim()){case"[]":case"[ ]":ne=convertToList(q,B,"todo",X,{checked:!1});break;case"[x]":ne=convertToList(q,B,"todo",X,{checked:!0});break;case"-":case"*":ne=convertToList(q,B,"bulleted",X);break;case"#":ne=convertToParagraph(q,B,"h1",X);break;case"##":ne=convertToParagraph(q,B,"h2",X);break;case"###":ne=convertToParagraph(q,B,"h3",X);break;case"####":ne=convertToParagraph(q,B,"h4",X);break;case"#####":ne=convertToParagraph(q,B,"h5",X);break;case"######":ne=convertToParagraph(q,B,"h6",X);break;case">":ne=convertToParagraph(q,B,"quote",X);break;default:ne=convertToList(q,B,"numbered",X)}return ne?PREVENT_DEFAULT:ALLOW_DEFAULT}const _Shortcuts=class{static match(q,B,j){const X=q.getSelection();if(!X)return PREVENT_DEFAULT;const[ee]=q.getLine(X.index);if(_Shortcuts._isValid(j,ee.domNode.tagName)){for(const te of _Shortcuts._matches)if(j.match(te.pattern))return te.action(B,q,j,X,te.pattern)}return PREVENT_DEFAULT}static _isValid(q,B){return typeof q<"u"&&q&&_Shortcuts._ignoreTags.indexOf(B)===-1}};let Shortcuts=_Shortcuts;Shortcuts._ignoreTags=["PRE"];Shortcuts._matches=[{name:"bolditalic",pattern:/(?:\*){3}(.+?)(?:\*){3}$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce,se,oe;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return j.match(/^([* \n]+)$/g)?PREVENT_DEFAULT:((ie=q.text)==null||ie.insert(" ",re+ne.length),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{bold:!0,italic:!0}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),(se=q.text)==null||se.delete(re+ne.length-3,3),(oe=q.text)==null||oe.delete(re,3),B.format("bold",!1),B.format("italic",!1),ALLOW_DEFAULT)}},{name:"bold",pattern:/(?:\*){2}(.+?)(?:\*){2}$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce,se,oe;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return j.match(/^([* \n]+)$/g)?PREVENT_DEFAULT:((ie=q.text)==null||ie.insert(" ",re+ne.length),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{bold:!0}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),(se=q.text)==null||se.delete(re+ne.length-2,2),(oe=q.text)==null||oe.delete(re,2),B.format("bold",!1),ALLOW_DEFAULT)}},{name:"italic",pattern:/(?:\*){1}(.+?)(?:\*){1}$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce,se,oe;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return j.match(/^([* \n]+)$/g)?PREVENT_DEFAULT:((ie=q.text)==null||ie.insert(" ",re+ne.length),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{italic:!0}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),(se=q.text)==null||se.delete(re+ne.length-1,1),(oe=q.text)==null||oe.delete(re,1),B.format("italic",!1),ALLOW_DEFAULT)}},{name:"strikethrough",pattern:/(?:~~)(.+?)(?:~~)$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce,se,oe;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return j.match(/^([* \n]+)$/g)?PREVENT_DEFAULT:((ie=q.text)==null||ie.insert(" ",re+ne.length),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{strike:!0}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),(se=q.text)==null||se.delete(re+ne.length-2,2),(oe=q.text)==null||oe.delete(re,2),B.format("strike",!1),ALLOW_DEFAULT)}},{name:"underthrough",pattern:/(?:~)(.+?)(?:~)$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce,se,oe,ae;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return j.match(/^([* \n]+)$/g)?PREVENT_DEFAULT:((ie=q.text)==null||ie.insert(" ",X.index),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{underline:!0}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),(se=q.text)==null||se.delete(X.index,1),(oe=q.text)==null||oe.delete(X.index-1,1),(ae=q.text)==null||ae.delete(re,1),B.format("underline",!1),ALLOW_DEFAULT)}},{name:"code",pattern:/(?:`)(.+?)(?:`)$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce,se,oe;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return j.match(/^([* \n]+)$/g)?PREVENT_DEFAULT:((ie=q.text)==null||ie.insert(" ",re+ne.length),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{code:!0}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),(se=q.text)==null||se.delete(re+ne.length-1,1),(oe=q.text)==null||oe.delete(re,1),B.format("code",!1),ALLOW_DEFAULT)}},{name:"link",pattern:/(((https?|ftp|file):\/\/)|www.)[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]$/g,action:(q,B,j,X,ee)=>{var ie,fe,ce;const te=ee.exec(j);if(!te)return PREVENT_DEFAULT;const ne=te[0],re=X.index-ne.length;return(ie=q.text)==null||ie.insert(" ",re+ne.length),q.page.captureSync(),(fe=q.text)==null||fe.format(re,ne.length,{link:ne}),B.setSelection(re+ne.length+1,0),(ce=q.text)==null||ce.delete(re+ne.length,1),B.format("link",!1),ALLOW_DEFAULT}},{name:"link",pattern:/(?:\[(.+?)\])(?:\((.+?)\))$/g,action:(q,B,j,X,ee)=>{var ce,se,oe,ae,le,pe,ve,ge;const te=j.search(ee),ne=(ce=j.match(ee))==null?void 0:ce[0],re=(se=j.match(/(?:\[(.*?)\])/g))==null?void 0:se[0],ie=(oe=j.match(/(?:\((.*?)\))/g))==null?void 0:oe[0];if(te===-1||!ne||!re||!ie)return PREVENT_DEFAULT;const fe=X.index-ne.length;return(ae=q.text)==null||ae.insert(" ",X.index),q.page.captureSync(),(le=q.text)==null||le.format(fe,re.length,{link:ie.slice(1,ie.length-1)}),B.setSelection(te+ne.length+1,0),(pe=q.text)==null||pe.delete(te+ne.length,1),(ve=q.text)==null||ve.delete(X.index-ie.length-1,ie.length+1),(ge=q.text)==null||ge.delete(fe,1),B.format("link",!1),ALLOW_DEFAULT}}];function isAtBlockEnd(q){var B;return q.getLength()-1===((B=q.getSelection(!0))==null?void 0:B.index)}function createKeyboardBindings(q,B){function j(pe,ve){const{prefix:ge}=ve;return Shortcuts.match(this.quill,B,ge),ALLOW_DEFAULT}function X(pe,ve){const{prefix:ge}=ve;return Shortcuts.match(this.quill,B,ge)?PREVENT_DEFAULT:ALLOW_DEFAULT}function ee(){var me,_e;const pe=isAtBlockEnd(this.quill),ve=q.getParent(B),ge=(ve==null?void 0:ve.lastChild())===B,de=B.flavour==="affine:list"&&((me=B.text)==null?void 0:me.length)===0,ue=((_e=this.quill.getSelection())==null?void 0:_e.index)||0,he=[{flavour:"affine:paragraph",type:"quote"}];if(de&&(ve==null?void 0:ve.flavour)==="affine:group"&&B.children.length===0)handleLineStartBackspace(q,B);else if(de&&ge)handleUnindent(q,B,ue);else if(pe){const be=he.findIndex(({flavour:we,type:ke})=>B.flavour===we&&B.type===ke)!==-1,Se=/\n\n$/.test(this.quill.getText());be&&!Se?te.bind(this)():(be&&this.quill.deleteText(ue,1),handleBlockEndEnter(q,B))}else he.findIndex(({flavour:Se,type:Te})=>B.flavour===Se&&B.type===Te)!==-1?te.bind(this)():handleBlockSplit(q,B,ue);return PREVENT_DEFAULT}function te(){var ve;const pe=((ve=this.quill.getSelection())==null?void 0:ve.index)||0;return handleSoftEnter(q,B,pe),this.quill.setSelection(pe+1,0),PREVENT_DEFAULT}function ne(){var ve;const pe=((ve=this.quill.getSelection())==null?void 0:ve.index)||0;return handleIndent(q,B,pe),PREVENT_DEFAULT}function re(){var ve;const pe=((ve=this.quill.getSelection())==null?void 0:ve.index)||0;return handleUnindent(q,B,pe),PREVENT_DEFAULT}function ie(pe){return pe.index>=0?handleKeyUp(B,this.quill.root):ALLOW_DEFAULT}function fe(pe){return pe.index>=0?handleKeyDown(B,this.quill.root):ALLOW_DEFAULT}function ce(pe){return pe.index===0&&pe.length===0?(focusPreviousBlock(B,"end"),PREVENT_DEFAULT):ALLOW_DEFAULT}function se(pe){const ve=this.quill.getText().length;return pe.index+1===ve?(focusNextBlock(B,"start"),PREVENT_DEFAULT):ALLOW_DEFAULT}function oe(pe,ve){const{quill:ge}=this,{prefix:de}=ve;return tryMatchSpaceHotkey(q,B,ge,de,pe)}function ae(){return isCollapsedAtBlockStart(this.quill)?(handleLineStartBackspace(q,B),PREVENT_DEFAULT):(isMultiBlockRange(getCurrentRange()),ALLOW_DEFAULT)}return{enterMarkdownMatch:{key:"enter",handler:j},spaceMarkdownMatch:{key:" ",handler:X},hardEnter:{key:"enter",handler:ee},softEnter:{key:"enter",shiftKey:!0,handler:te},tab:{key:"tab",handler:ne},shiftTab:{key:"tab",shiftKey:!0,handler:re},"list autofill":{key:" ",shiftKey:!1,prefix:/^(\d+\.|-|\*|\[ ?\]|\[x\]|(#){1,6}|>)$/,handler:oe},"list autofill shift":{key:" ",shiftKey:!0,prefix:/^(\d+\.|-|\*|\[ ?\]|\[x\]|(#){1,6}|>)$/,handler:oe},backspace:{key:"backspace",handler:ae},up:{key:"up",shiftKey:!1,handler:ie},down:{key:"down",shiftKey:!1,handler:fe},"embed left":{key:37,shiftKey:!1,handler:ce},right:{key:"right",shiftKey:!1,handler:se}}}const style$6=`.ql-container{box-sizing:border-box;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-container p{margin:0;padding:0}.ql-editor{box-sizing:border-box;height:100%;outline:none;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word;margin:3px 0}.ql-editor>*{cursor:text}.ql-editor.ql-blank:before{color:var(--affine-disable-color);content:attr(data-placeholder);pointer-events:none;position:absolute}
`;var __defProp$d=Object.defineProperty,__getOwnPropDesc$d=Object.getOwnPropertyDescriptor,__decorateClass$d=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$d(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$d(B,j,ee),ee};Quill.register("modules/cursors",QuillCursors);const Clipboard=Quill.import("modules/clipboard");class EmptyClipboard extends Clipboard{onPaste(){}}Quill.register("modules/clipboard",EmptyClipboard,!0);const Strike=Quill.import("formats/strike");Strike.tagName="del";Quill.register(Strike,!0);let RichText=class extends s$1{createRenderRoot(){return this}firstUpdated(){const{host:q,model:B,placeholder:j,_textContainer:X}=this,{page:ee}=q,te=createKeyboardBindings(ee,B);this.quill=new Quill(X,{modules:{cursors:!0,toolbar:!1,history:{maxStack:0,userOnly:!0},keyboard:{bindings:te}},placeholder:j}),ee.attachRichText(B.id,this.quill),ee.awareness.updateLocalCursor(),this.model.propsUpdated.on(()=>this.requestUpdate()),this.quill.on("text-change",ne=>{var fe,ce,se,oe,ae,le,pe,ve,ge,de,ue,he,me,_e;const re={code:"code",link:"link-code"};let ie="";if((ce=(fe=ne.ops[1])==null?void 0:fe.attributes)!=null&&ce.code&&(ie="code"),(oe=(se=ne.ops[1])==null?void 0:se.attributes)!=null&&oe.link&&(ie="link"),ne.ops.length===2&&((ae=ne.ops[1])==null?void 0:ae.insert)&&ie){const be=ne.ops[0].retain,Se=re[ie];if(be!==void 0){const Te=this.quill.getLeaf(be+Number((le=ne.ops[1])==null?void 0:le.insert.toString().length)),we=this.quill.getLeaf(be+Number((pe=ne.ops[1])==null?void 0:pe.insert.toString().length)+1),ke=(ge=(ve=Te[0])==null?void 0:ve.domNode)==null?void 0:ge.parentElement,xe=ke==null?void 0:ke.closest(Se),Ae=(ue=(de=we[0])==null?void 0:de.domNode)==null?void 0:ue.parentElement,Le=Ae==null?void 0:Ae.closest(Se),De=(he=ne.ops[1])==null?void 0:he.insert.toString();(Le&&Le!==xe||!Le)&&((_e=B.text)==null||_e.replace(be,De.length,this.host.isCompositionStart?" ":((me=ne.ops[1])==null?void 0:me.insert.toString())||"",{[ie]:!1}))}}})}disconnectedCallback(){super.disconnectedCallback(),this.host.page.detachRichText(this.model.id)}updated(){var q,B;(B=this.quill)==null||B.root.setAttribute("data-placeholder",(q=this.placeholder)!=null?q:"")}render(){return y`
      <div class="affine-rich-text quill-container ql-container"></div>
    `}};RichText.styles=i$5`
    ${r$3(style$6)}
  `;__decorateClass$d([i$2(".affine-rich-text.quill-container")],RichText.prototype,"_textContainer",2);__decorateClass$d([e$1()],RichText.prototype,"host",2);__decorateClass$d([e$1()],RichText.prototype,"model",2);__decorateClass$d([e$1()],RichText.prototype,"placeholder",2);RichText=__decorateClass$d([e$2("rich-text")],RichText);var __defProp$c=Object.defineProperty,__getOwnPropDesc$c=Object.getOwnPropertyDescriptor,__decorateClass$c=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$c(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$c(B,j,ee),ee};let IconButton=class extends s$1{constructor(){super(),this.size="28px",this.text=null,this.disabled=!1,this.tabIndex=0,this.addEventListener("keypress",q=>{this.disabled||q.key==="Enter"&&this.click()})}connectedCallback(){super.connectedCallback(),this.style.setProperty("--button-size",typeof this.size=="string"?this.size:`${this.size}px`),this.style.setProperty("--button-width",typeof this.size=="string"?this.size:`${this.size}px`),this.style.setProperty("--button-height",typeof this.size=="string"?this.size:`${this.size}px`)}render(){return y`<slot></slot> ${this.text?y`<span style="margin-left: 12px;">${this.text}</span>`:""}`}};IconButton.styles=i$5`
    :host {
      box-sizing: border-box;
      display: flex;
      justify-content: center;
      align-items: center;
      border: none;
      width: var(--button-width);
      height: var(--button-height);
      border-radius: 5px;
      background: transparent;
      cursor: pointer;
      user-select: none;
      fill: var(--affine-icon-color);
      font-family: var(--affine-font-family);
      color: var(--affine-popover-color);
    }

    :host(:hover) {
      background: var(--affine-hover-background);
      fill: var(--affine-primary-color);
      color: var(--affine-primary-color);
    }

    :host(:active) {
      background: transparent;
      fill: var(--affine-primary-color);
      color: var(--affine-primary-color);
    }

    :host([disabled]),
    :host(:disabled) {
      background: transparent;
      fill: var(--affine-icon-color);
      cursor: not-allowed;
    }

    /* You can add a 'active' attribute to the button to revert the active style */
    :host([active]) {
      fill: var(--affine-primary-color);
    }

    :host(:active[active]) {
      background: transparent;
      fill: var(--affine-icon-color);
    }
  `;__decorateClass$c([e$1()],IconButton.prototype,"size",2);__decorateClass$c([e$1()],IconButton.prototype,"text",2);__decorateClass$c([e$1({type:Boolean})],IconButton.prototype,"disabled",2);IconButton=__decorateClass$c([e$2("icon-button")],IconButton);let ToastContainer=null;const htmlToElement=q=>{const B=document.createElement("template");if(typeof q=="string")q=q.trim(),B.innerHTML=q;else{const{strings:j,values:X}=q,ee=[...X,""],te=j.reduce((ne,re,ie)=>ne+re+ee[ie],"");B.innerHTML=te}return B.content.firstChild},createToastContainer=()=>{const q=i$5`
    position: fixed;
    z-index: 9999;
    top: 16px;
    left: 16px;
    right: 16px;
    bottom: 78px;
    pointer-events: none;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
  `,B=y`<div style="${q}"></div>`,j=htmlToElement(B);return document.body.appendChild(j),j},toast=(q,B=2500)=>{ToastContainer||(ToastContainer=createToastContainer());const j=i$5`
    max-width: 480px;
    text-align: center;
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    padding: 6px 12px;
    margin: 10px 0 0 0;
    color: var(--affine-tooltip-color);
    background: var(--affine-tooltip-background);
    box-shadow: var(--affine-tooltip-shadow);
    border-radius: 10px;
    transition: all 230ms cubic-bezier(0.21, 1.02, 0.73, 1);
    opacity: 0;
  `,X=y`<div style="${j}"></div>`,ee=htmlToElement(X);ee.textContent=q,ToastContainer.appendChild(ee);const te=[{opacity:0},{opacity:1}],ne={duration:230,easing:"cubic-bezier(0.21, 1.02, 0.73, 1)",fill:"forwards"};return ee.animate(te,ne),setTimeout(async()=>{const re=te.reverse();await ee.animate(re,ne).finished,ee.style.maxHeight="0",ee.style.margin="0",ee.style.padding="0",await sleep(230),ee.remove()},B),ee},ConfirmIcon=w`<svg
   width="20"
   height="20"
   viewBox="0 0 20 20"
   xmlns="http://www.w3.org/2000/svg"
 >
   <path
     fill-rule="evenodd"
     clip-rule="evenodd"
     d="M17.6726 6.0059L7.49998 16.1785L2.32739 11.0059L3.5059 9.82739L7.49998 13.8215L16.4941 4.82739L17.6726 6.0059Z"
   />
 </svg>`,EditIcon=w`<svg
   width="20"
   height="20"
   viewBox="0 0 20 20"
   xmlns="http://www.w3.org/2000/svg"
 >
   <path
     fill-rule="evenodd"
     clip-rule="evenodd"
     d="M5.332 13.2203L5.01238 14.1792L5.82087 14.9877L6.77971 14.668L13.6405 7.80725L12.1928 6.35954L5.332 13.2203ZM13.1356 5.41673L14.5833 6.86444L15.7238 5.72395C16.1236 5.32417 16.1236 4.67601 15.7238 4.27623C15.324 3.87646 14.6759 3.87646 14.2761 4.27623L13.1356 5.41673ZM13.3333 3.33342L4.27791 12.3888C4.20472 12.462 4.14958 12.5512 4.11686 12.6494L2.92159 16.2352C2.74787 16.7563 3.2437 17.2522 3.76487 17.0785L7.35065 15.8832C7.44884 15.8505 7.53806 15.7953 7.61124 15.7221L16.6666 6.66676C17.5871 5.74628 17.5871 4.2539 16.6666 3.33342C15.7461 2.41295 14.2538 2.41295 13.3333 3.33342Z"
   />
 </svg>`,UnlinkIcon=w`<svg
 width="20"
 height="20"
 viewBox="0 0 20 20"
 xmlns="http://www.w3.org/2000/svg"
>
 <path
   fill-rule="evenodd"
   clip-rule="evenodd"
   d="M14.3544 11.3678L16.5109 9.2113C17.9754 7.74683 17.9754 5.37246 16.5109 3.908L16.085 3.48214C14.6206 2.01767 12.2462 2.01767 10.7817 3.48214L8.06422 6.19966C6.59975 7.66413 6.59975 10.0385 8.06422 11.503L8.49008 11.9288C8.75643 12.1952 9.05289 12.4131 9.3685 12.5826L10.042 11.909C10.1513 11.7997 10.2324 11.6729 10.2852 11.5376C9.97446 11.4201 9.68307 11.2362 9.43289 10.986L9.00703 10.5602C8.06326 9.61639 8.06326 8.08624 9.00703 7.14247L11.7246 4.42495C12.6683 3.48118 14.1985 3.48118 15.1422 4.42495L15.5681 4.85081C16.5119 5.79457 16.5119 7.32472 15.5681 8.26849L14.1479 9.6887C14.3104 10.2349 14.3792 10.803 14.3544 11.3678ZM5.63767 8.62376L3.48116 10.7803C2.0167 12.2447 2.0167 14.6191 3.48116 16.0836L3.90702 16.5094C5.37149 17.9739 7.74586 17.9739 9.21032 16.5094L11.9278 13.7919C13.3923 12.3274 13.3923 9.95307 11.9278 8.48861L11.502 8.06275C11.2356 7.79639 10.9392 7.57848 10.6236 7.40901L9.95003 8.08255C9.84074 8.19184 9.75969 8.31867 9.70686 8.45398C10.0176 8.57152 10.309 8.75538 10.5592 9.00556L10.985 9.43142C11.9288 10.3752 11.9288 11.9053 10.985 12.8491L8.26752 15.5666C7.32375 16.5104 5.7936 16.5104 4.84983 15.5666L4.42397 15.1408C3.4802 14.197 3.4802 12.6668 4.42397 11.7231L5.84418 10.3029C5.68166 9.75667 5.61282 9.18854 5.63767 8.62376ZM12.78 14.3772C12.9325 14.2416 13.1295 14.1666 13.3336 14.1666C13.5547 14.1666 13.7666 14.2544 13.9229 14.4107C14.0792 14.567 14.167 14.7789 14.167 15V16.6666L14.1611 16.7641C14.1361 16.975 14.0314 17.1684 13.8685 17.3047C13.7056 17.4411 13.4968 17.51 13.2848 17.4976C13.0728 17.4852 12.8735 17.3922 12.7277 17.2378C12.5819 17.0833 12.5005 16.879 12.5003 16.6666V15L12.5061 14.9025C12.53 14.6997 12.6275 14.5129 12.78 14.3772ZM15.2625 12.7273C15.417 12.5815 15.6212 12.5002 15.8336 12.5H16.667L16.7645 12.5058C16.9754 12.5309 17.1688 12.6356 17.3051 12.7984C17.4414 12.9613 17.5104 13.1701 17.498 13.3821C17.4855 13.5942 17.3926 13.7934 17.2381 13.9392C17.0837 14.0851 16.8794 14.1664 16.667 14.1666H15.8336L15.7361 14.1608C15.5252 14.1357 15.3319 14.031 15.1955 13.8681C15.0592 13.7053 14.9902 13.4965 15.0027 13.2845C15.0151 13.0724 15.1081 12.8731 15.2625 12.7273ZM2.74439 6.07737C2.90067 5.92109 3.11263 5.83329 3.33365 5.83329H4.16698C4.38799 5.83329 4.59995 5.92109 4.75623 6.07737C4.91252 6.23365 5.00031 6.44561 5.00031 6.66662C5.00031 6.88764 4.91252 7.0996 4.75623 7.25588C4.59995 7.41216 4.38799 7.49996 4.16698 7.49996H3.33365C3.11263 7.49996 2.90067 7.41216 2.74439 7.25588C2.58811 7.0996 2.50031 6.88764 2.50031 6.66662C2.50031 6.44561 2.58811 6.23365 2.74439 6.07737ZM6.11334 2.71055C6.26587 2.57492 6.46287 2.49998 6.66698 2.49996C6.88799 2.49996 7.09995 2.58775 7.25623 2.74403C7.41251 2.90031 7.50031 3.11228 7.50031 3.33329V4.99996L7.49448 5.09746C7.46939 5.30837 7.36472 5.50174 7.20184 5.63807C7.03896 5.77439 6.83018 5.84338 6.61814 5.83093C6.40611 5.81849 6.20683 5.72554 6.06102 5.5711C5.91521 5.41665 5.83388 5.21236 5.83365 4.99996V3.33329L5.83948 3.23579C5.86336 3.03308 5.96081 2.84619 6.11334 2.71055Z"
 />
</svg>`,toolTipStyle=i$5`
  tool-tip {
    font-family: var(--affine-font-family);
    position: absolute;
    left: 0;
    top: 0;
    inline-size: max-content;
    text-align: center;
    font-size: var(--affine-font-xs);
    padding: 4px 12px;
    border-radius: 10px 10px 10px 0px;
    color: var(--affine-tooltip-color);
    background: var(--affine-tooltip-background);
    box-shadow: var(--affine-tooltip-shadow);
    border-radius: 10px 10px 10px 0px;

    opacity: 0;
    transform: translateX(0) translateY(calc(-100% - 8px));
    transition: opacity 0.2s ease, transform 0.2s ease;
    pointer-events: none;
    user-select: none;
  }

  .has-tool-tip {
    position: relative;
  }
  .has-tool-tip:is(:hover, :focus-visible, :active) > tool-tip {
    opacity: 1;
    transition-delay: 200ms;
  }
`,editLinkStyle=i$5`
  .affine-link-edit-popover {
    box-sizing: border-box;
    width: 404px;
    height: 112px;
    padding: 12px;
    box-shadow: var(--affine-popover-shadow);
    background: var(--affine-popover-background);
    border-radius: 10px;
    display: grid;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(2, 1fr);
    gap: 12px;
    grid-template-areas:
      'text-area .'
      'link-area btn';
    justify-items: center;
    align-items: center;
  }

  .affine-edit-text-area {
    grid-area: text-area;
    width: 338px;
    display: grid;
    gap: 6px;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(1, 1fr);
    grid-template-areas: 'text span text-input';
    justify-items: center;
    align-items: center;
  }

  .affine-edit-link-area {
    grid-area: link-area;
    width: 338px;
    display: grid;
    gap: 6px;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(1, 1fr);
    grid-template-areas: 'link span link-input';
    justify-items: center;
    align-items: center;
  }

  .affine-link-popover-dividing-line {
    grid-area: span;
  }
  .affine-edit-text-text {
    grid-area: text;
  }

  .affine-edit-text-input {
    grid-area: text-input;
  }

  .affine-edit-link-text {
    grid-area: link;
  }

  .affine-edit-link-input {
    grid-area: link-input;
  }

  .affine-confirm-button {
    grid-area: btn;
    fill: var(--affine-primary-color);
  }
  .affine-confirm-button[disabled],
  .affine-confirm-button:disabled {
    fill: var(--affine-icon-color);
  }
`,linkPopoverStyle=i$5`
  .overlay-container {
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-base);
    font-style: normal;
    line-height: 24px;
    color: var(--affine-popover-color);
    z-index: var(--affine-z-index-popover);
    animation: affine-popover-fade-in 0.2s ease;
  }

  @keyframes affine-popover-fade-in {
    from {
      opacity: 0;
      transform: translateY(-3px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .overlay-mask {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
  }
  .affine-edit-text-area {
    border: 1px solid var(--affine-border-color);
    outline: none;
    border-radius: 10px;
    background: transparent;
  }
  .affine-edit-text-area:focus-within {
    border: 1px solid var(--affine-primary-color);
  }
  .affine-edit-link-area {
    border: 1px solid var(--affine-border-color);
    outline: none;
    border-radius: 10px;
    background: transparent;
  }
  .affine-edit-link-area:focus-within {
    border: 1px solid var(--affine-primary-color);
  }

  label {
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    box-sizing: border-box;
    padding: 6px 0px 6px 12px;
    color: var(--affine-icon-color);
  }

  input {
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-base);
    box-sizing: border-box;
    padding: 6px 12px 6px 0px;
    width: 260px;
    height: 34px;
    color: inherit;
    border: none;
    background: transparent;
  }
  input::placeholder {
    color: var(--affine-placeholder-color);
  }
  input:focus {
    outline: none;
  }
  input:focus ~ label,
  input:active ~ label {
    color: var(--affine-primary-color);
  }

  .affine-link-popover {
    display: flex;
    align-items: center;
    height: 34px;
    padding: 0 12px;

    background: var(--affine-popover-background);
    box-shadow: var(--affine-popover-shadow);
    border-radius: 0px 10px 10px 10px;
  }

  .affine-link-popover-input {
    border: none;
  }
  .affine-link-popover-input::placeholder {
    color: var(--affine-placeholder-color);
  }
  .affine-link-popover-input:focus {
    border: none;
  }

  .affine-link-preview {
    width: 260px;
    height: 28px;
    display: flex;
    align-items: center;
    user-select: none;
    cursor: pointer;
  }

  .affine-link-popover-dividing-line {
    margin: 0 6px;
    width: 1px;
    height: 20px;
    background-color: var(--affine-border-color);
  }

  ${editLinkStyle}
  ${toolTipStyle}
`;var __defProp$b=Object.defineProperty,__getOwnPropDesc$b=Object.getOwnPropertyDescriptor,__decorateClass$b=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$b(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$b(B,j,ee),ee};const ALLOWED_SCHEMES=["http","https","ftp","sftp","mailto","tel"],MAIL_REGEX=/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,URL_REGEX=/^(?:(?:(?:https?|s?ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;function normalizeUrl(q){return ALLOWED_SCHEMES.some(X=>q.startsWith(X+":"))?q:MAIL_REGEX.test(q)?"mailto:"+q:"http://"+q}const isValidLink=q=>{if(!q)return!1;const B=normalizeUrl(q);return B===q?!0:URL_REGEX.test(B)};let LinkPopover=class extends s$1{constructor(){super(...arguments),this.left="0px",this.top="0px",this.type="create",this.showMask=!0,this.text="",this.previewLink="",this.link="",this.bodyOverflowStyle="",this.disableConfirm=!0}connectedCallback(){super.connectedCallback(),this.showMask&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow="hidden")}firstUpdated(q){super.firstUpdated(q),this.linkInput&&this.linkInput.focus()}disconnectedCallback(){super.disconnectedCallback(),this.showMask&&(document.body.style.overflow=this.bodyOverflowStyle)}hide(){this.dispatchEvent(new CustomEvent("updateLink",{detail:{type:"cancel"}}))}onConfirm(){var j,X;if(this.disableConfirm)return;if(!this.linkInput)throw new Error("Failed to update link! Link input not found!");const q=normalizeUrl(this.linkInput.value),B=(X=(j=this.textInput)==null?void 0:j.value)!=null?X:void 0;!q||this.dispatchEvent(createEvent("updateLink",{type:"confirm",link:q,text:B}))}onCopy(q){navigator.clipboard.writeText(this.previewLink),toast("Copied link to clipboard")}onUnlink(q){this.dispatchEvent(createEvent("updateLink",{type:"remove"}))}onEdit(q){this.dispatchEvent(createEvent("editLink",null)),this.disableConfirm=!1}onKeyup(q){if(q.key==="Enter"&&this.onConfirm(),!this.linkInput)throw new Error("Failed to update link! Link input not found!");const B=isValidLink(this.linkInput.value);this.disableConfirm=!B}confirmBtnTemplate(){return y`<icon-button
      class="affine-confirm-button"
      ?disabled=${this.disableConfirm}
      @click=${this.onConfirm}
      >${ConfirmIcon}</icon-button
    >`}createLinkTemplate(){return y`<div class="affine-link-popover">
      <input
        id="link-input"
        class="affine-link-popover-input"
        type="text"
        spellcheck="false"
        placeholder="Paste or type a link"
        value=${this.previewLink}
        @keyup=${this.onKeyup}
      />
      <span class="affine-link-popover-dividing-line"></span>
      ${this.confirmBtnTemplate()}
    </div>`}previewTemplate(){return y`<div class="affine-link-popover">
      <div class="affine-link-preview has-tool-tip" @click=${this.onCopy}>
        <tool-tip inert role="tooltip">Click to copy link</tool-tip>
        ${this.previewLink}
      </div>
      <span class="affine-link-popover-dividing-line"></span>
      <icon-button class="has-tool-tip" @click=${this.onUnlink}>
        ${UnlinkIcon}
        <tool-tip inert role="tooltip">Remove</tool-tip>
      </icon-button>
      <icon-button class="has-tool-tip" @click=${this.onEdit}>
        ${EditIcon}
        <tool-tip inert role="tooltip">Edit link</tool-tip>
      </icon-button>
    </div>`}simpleTemplate(){return!this.previewLink?this.createLinkTemplate():this.previewTemplate()}editTemplate(){return y`<div class="affine-link-edit-popover">
      <div class="affine-edit-text-area">
        <input
          class="affine-edit-text-input"
          id="text-input"
          type="text"
          placeholder="Enter text"
          value=${this.text}
          @keyup=${this.onKeyup}
        />
        <span class="affine-link-popover-dividing-line"></span>
        <label class="affine-edit-text-text" for="text-input">Text</label>
      </div>
      <div class="affine-edit-link-area">
        <input
          id="link-input"
          class="affine-edit-link-input"
          type="text"
          spellcheck="false"
          placeholder="Paste or type a link"
          value=${this.previewLink}
          @keyup=${this.onKeyup}
        />
        <span class="affine-link-popover-dividing-line"></span>
        <label class="affine-edit-link-text" for="link-input">Link</label>
      </div>
      ${this.confirmBtnTemplate()}
    </div>`}render(){const q=this.showMask?y`<div class="overlay-mask" @click="${this.hide}"></div>`:y``,B=this.type==="create"?this.simpleTemplate():this.editTemplate();return y`
      <div class="overlay-root">
        ${q}
        <div
          class="overlay-container"
          style="position: absolute; left: ${this.left}; top: ${this.top};${this.style.cssText}"
        >
          ${B}
        </div>
      </div>
    `}};LinkPopover.styles=linkPopoverStyle;__decorateClass$b([e$1()],LinkPopover.prototype,"left",2);__decorateClass$b([e$1()],LinkPopover.prototype,"top",2);__decorateClass$b([e$1()],LinkPopover.prototype,"type",2);__decorateClass$b([e$1()],LinkPopover.prototype,"showMask",2);__decorateClass$b([e$1()],LinkPopover.prototype,"text",2);__decorateClass$b([e$1()],LinkPopover.prototype,"previewLink",2);__decorateClass$b([t$1()],LinkPopover.prototype,"link",2);__decorateClass$b([t$1()],LinkPopover.prototype,"bodyOverflowStyle",2);__decorateClass$b([t$1()],LinkPopover.prototype,"disableConfirm",2);__decorateClass$b([i$2("#text-input")],LinkPopover.prototype,"textInput",2);__decorateClass$b([i$2("#link-input")],LinkPopover.prototype,"linkInput",2);LinkPopover=__decorateClass$b([e$2("edit-link-panel")],LinkPopover);const createEditLinkElement=(q,B,{showMask:j,previewLink:X})=>{const ee=q.getBoundingClientRect(),te=document.body.getBoundingClientRect(),ne=ee.top-te.top+ee.height,re=5,ie=document.createElement("edit-link-panel");return ie.left=`${ee.left}px`,ie.top=`${ne+re}px`,ie.showMask=j,ie.previewLink=X,B.appendChild(ie),ie},bindHoverState=(q,B,j)=>{let ee;const te=re=>{clearTimeout(ee)},ne=re=>{ee=window.setTimeout(()=>{j.abort()},300)};return q.addEventListener("mouseover",te),q.addEventListener("mouseout",ne),B.addEventListener("mouseover",te),B.addEventListener("mouseout",ne),()=>{q.removeEventListener("mouseover",te),q.removeEventListener("mouseout",ne),B.removeEventListener("mouseover",te),B.removeEventListener("mouseout",ne)}},showLinkPopover=async({anchorEl:q,container:B=document.body,text:j="",link:X="",showMask:ee=!0,interactionKind:te="always",signal:ne=new AbortController})=>{if(!q)throw new Error("Can't show tooltip without anchor element!");if(ne.signal.aborted)return Promise.resolve({type:"cancel"});const re=createEditLinkElement(q,B,{showMask:ee,previewLink:X}),ie=te==="hover"?bindHoverState(q,re,ne):noop;return new Promise(fe=>{ne.signal.addEventListener("abort",()=>{re.remove(),fe({type:"cancel"})}),re.addEventListener("editLink",ce=>{ne.signal.aborted||(re.type="edit",re.showMask=!0,re.text=j,ie())}),re.addEventListener("updateLink",ce=>{ne.signal.aborted||(re.remove(),fe(ce.detail))})})},iconStyle=i$5`
  width: 0.9em;
  height: 0.9em;
  vertical-align: middle;
  font-size: inherit;
  margin-bottom: 0.1em;
`,LinkIcon$1=w`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
  style="${iconStyle}"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M11.4835 9.0944L13.2087 7.36919C14.3803 6.19761 14.3803 4.29812 13.2087 3.12655L12.868 2.78586C11.6965 1.61429 9.79697 1.61429 8.62539 2.78586L6.45138 4.95988C5.2798 6.13145 5.2798 8.03094 6.45138 9.20252L6.79206 9.5432C7.00515 9.75629 7.24231 9.93062 7.4948 10.0662L8.03363 9.52736C8.12106 9.43993 8.1859 9.33847 8.22816 9.23022C7.97957 9.13619 7.74646 8.9891 7.54631 8.78896L7.20562 8.44827C6.45061 7.69326 6.45061 6.46914 7.20562 5.71412L9.37964 3.54011C10.1347 2.78509 11.3588 2.78509 12.1138 3.5401L12.4545 3.88079C13.2095 4.63581 13.2095 5.85992 12.4545 6.61494L11.3183 7.75111C11.4483 8.18806 11.5034 8.64257 11.4835 9.0944Z"
    fill="#6880FF"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.5099 6.89898L2.78469 8.62419C1.61311 9.79576 1.61311 11.6953 2.78469 12.8668L3.12537 13.2075C4.29695 14.3791 6.19644 14.3791 7.36802 13.2075L9.54203 11.0335C10.7136 9.86193 10.7136 7.96243 9.54203 6.79086L9.20135 6.45017C8.98826 6.23709 8.75109 6.06276 8.49861 5.92718L7.95978 6.46601C7.87235 6.55344 7.80751 6.65491 7.76525 6.76315C8.01384 6.85719 8.24695 7.00427 8.4471 7.20442L8.78779 7.54511C9.5428 8.30012 9.5428 9.52424 8.78779 10.2793L6.61377 12.4533C5.85875 13.2083 4.63463 13.2083 3.87962 12.4533L3.53893 12.1126C2.78392 11.3576 2.78392 10.1335 3.53893 9.37844L4.6751 8.24227C4.54508 7.80531 4.49002 7.35081 4.5099 6.89898Z"
    fill="#6880FF"
  />
</svg>`;var __defProp$a=Object.defineProperty,__getOwnPropDesc$a=Object.getOwnPropertyDescriptor,__decorateClass$a=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$a(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$a(B,j,ee),ee};let LinkNodeComponent=class extends s$1{constructor(){super(),this.popoverHoverOpenDelay=150,this.popoverTimer=0,this.addEventListener("mouseover",this.onHover),this.addEventListener("mouseout",this.onHoverEnd)}onHover(q){this.popoverTimer=window.setTimeout(async()=>{this.onDelayHover(q)},this.popoverHoverOpenDelay)}async onDelayHover(q){var X;const B=Quill.find(this);assertExists(B);const j=(X=B.domNode.textContent)!=null?X:void 0;hotkey.withDisabledHotkey(async()=>{const ee=await showLinkPopover({anchorEl:q.target,text:j,link:this.href,showMask:!1,interactionKind:"hover"});if(ee.type==="confirm"){const te=ee.link,ne=ee.text,re=ne!==j;assertExists(B),this.updateLink(B,te,re?ne:void 0);return}if(ee.type==="remove"){assertExists(B),this.updateLink(B,!1);return}})}async updateLink(q,B,j){var te,ne,re,ie;const X=getModelByElement(this),{page:ee}=X;if(j){const fe=q.offset();ee.captureSync(),(te=X.text)==null||te.delete(fe,q.length()),(ne=X.text)==null||ne.insert(j,fe),(re=X.text)==null||re.format(fe,j.length,{link:B})}else ee.captureSync(),(ie=X.text)==null||ie.format(q.offset(),q.length(),{link:B})}async onHoverEnd(q){clearTimeout(this.popoverTimer)}render(){return y`<a href=${this.href} rel="noopener noreferrer" target="_blank"
      >${LinkIcon$1}<slot></slot
    ></a>`}};LinkNodeComponent.styles=i$5`
    a {
      color: var(--affine-link-color);
      text-decoration: none;
    }

    /*
    a:visited {
      color: var(--affine-link-visited-color);
    }
    */

    a:hover {
      text-decoration: underline;
    }
  `;__decorateClass$a([e$1()],LinkNodeComponent.prototype,"href",2);__decorateClass$a([e$1()],LinkNodeComponent.prototype,"popoverHoverOpenDelay",2);__decorateClass$a([t$1()],LinkNodeComponent.prototype,"popoverTimer",2);LinkNodeComponent=__decorateClass$a([e$2("link-node")],LinkNodeComponent);const Link=Quill.import("formats/link");Link.tagName="link-node";Link.PROTOCOL_WHITELIST=ALLOWED_SCHEMES;Quill.register(Link,!0);const Inline=Quill.import("blots/inline");class MockSelectNode extends Inline{static create(B){const j=super.create();return j.style.backgroundColor="rgba(35, 131, 226, 0.28)",j}static formats(B){return!0}format(B,j){const X=this.domNode;j||(X.style.backgroundColor="",X.getAttribute("style")||X.removeAttribute("style")),(B!==this.statics.blotName||!j)&&super.format(B,j)}}MockSelectNode.blotName="mock-select";MockSelectNode.tagName="span";MockSelectNode.className="affine-mock-select";Quill.register({"formats/mock-select":MockSelectNode},!0);const createLink=hotkey.withDisabledHotkeyFn(async q=>{var oe,ae;if(!isRangeSelection())return;const B=getStartModelBySelection(),j=getRichTextByModel(B);if(!j)return;const{quill:X}=j,ee=X.getSelection();assertExists(ee);const te=X.getFormat(ee);if(te!=null&&te.link){q.captureSync();const{index:le,length:pe}=ee;(oe=B.text)==null||oe.format(le,pe,{link:!1});return}X.format("mock-select",!0);const[ne,re]=X.scroll.descendant(MockSelectNode,ee.index);if(!ne)throw console.error("Error on getBlotNode",MockSelectNode,X,ee),new Error("Failed to getBlotNode, node not found!");const ie=ne,fe=ie==null?void 0:ie.domNode;if(!fe)throw console.error("Error on createLink",ie,X,ee),new Error("Failed to create link, mockSelectDom not found!");const ce=await showLinkPopover({anchorEl:fe});if(X.formatText(ee,{"mock-select":!1}),ce.type!=="confirm")return;const se=ce.link;q.captureSync(),(ae=B.text)==null||ae.format(ee.index,ee.length,{link:se})});function deleteModels(q,B){var ce,se,oe,ae;const j=window.getSelection(),X=B[0],ee=B[B.length-1],te=getRichTextByModel(X),ne=getRichTextByModel(ee);assertExists(te),assertExists(ne),assertExists(j);const re=getQuillIndexByNativeSelection(j.anchorNode,j.anchorOffset,!0),ie=getQuillIndexByNativeSelection(j.focusNode,j.focusOffset,!1);(ce=te.model.text)==null||ce.delete(re,te.model.text.length-re),((se=ne.model.text)==null?void 0:se.length)===ie||((oe=ne.model.text)==null||oe.delete(0,ie),(ae=te.model.text)==null||ae.join(ne.model.text));for(let le=1;le<=B.length-1;le++)q.deleteBlock(B[le]);te.quill.setSelection(re,0)}function updateTextType(q,B,j){var te;const X=(te=window.getSelection())==null?void 0:te.getRangeAt(0);assertExists(X);const ee=getModelsByRange(X);j.captureSync(),ee.forEach(ne=>{assertFlavours(ne,["affine:paragraph","affine:list"]),ne.flavour===q?j.updateBlock(ne,{type:B}):transformBlock(j,ne,q,B)})}function transformBlock(q,B,j,X){var ie;const ee=q.getParent(B);assertExists(ee);const te={flavour:j,type:X,text:(ie=B==null?void 0:B.text)==null?void 0:ie.clone(),children:B.children},ne=ee.children.indexOf(B);q.deleteBlock(B);const re=q.addBlock(te,ee,ne);asyncFocusRichText(q,re)}function batchUpdateTextType(q,B,j,X){B.captureSync();for(const ee of j)assertFlavours(ee,["affine:paragraph","affine:list"]),ee.flavour===q?B.updateBlock(ee,{type:X}):transformBlock(B,ee,"affine:paragraph",X)}function handleBackspace(q,B){if(!(B.target instanceof HTMLInputElement)&&!isNoneSelection()){if(isCollapsedSelection()){const j=getStartModelBySelection(),X=getRichTextByModel(j);if(X){const{quill:ee}=X;isCollapsedAtBlockStart(ee)}}else if(isRangeSelection()){const j=getCurrentRange();if(isMultiBlockRange(j)){B.preventDefault();const X=getModelsByRange(j);deleteModels(q,X)}}}}const getFormat=()=>{const q=getModelsByRange(getCurrentRange());if(q.length===1){const oe=getRichTextByModel(q[0]);assertExists(oe);const{quill:ae}=oe,le=ae.getSelection();return assertExists(le),ae.getFormat(le)}const B=window.getSelection(),j=q[0],X=q[q.length-1],ee=getRichTextByModel(j),te=getRichTextByModel(X);assertExists(ee),assertExists(te),assertExists(B);const ne=getQuillIndexByNativeSelection(B.anchorNode,B.anchorOffset,!0),re=getQuillIndexByNativeSelection(B.focusNode,B.focusOffset,!1),ie=ee.quill.getFormat(ne,ee.quill.getLength()-ne-1),fe=te.quill.getFormat(0,re),ce=[];ce.push(ie,fe);for(let oe=1;oe<q.length-1;oe++){const ae=getRichTextByModel(q[oe]);assertExists(ae);const le=ae.quill.getFormat(0,ae.quill.getLength()-1);ce.push(le)}return ce.reduce((oe,ae)=>{const le={};for(const pe in oe)oe[pe]===ae[pe]&&(le[pe]=oe[pe]);return le})};function formatModelsByRange(q,B,j){var se,oe,ae;const X=window.getSelection(),ee=q[0],te=q[q.length-1],ne=getRichTextByModel(ee),re=getRichTextByModel(te);assertExists(ne),assertExists(re),assertExists(X);const ie=getQuillIndexByNativeSelection(X.anchorNode,X.anchorOffset,!0),fe=getQuillIndexByNativeSelection(X.focusNode,X.focusOffset,!1),ce=getFormat()[j];B.captureSync(),(se=ne.model.text)==null||se.format(ie,ne.quill.getLength()-ie-1,{[j]:!ce}),(oe=re.model.text)==null||oe.format(0,fe,{[j]:!ce});for(let le=1;le<q.length-1;le++){const pe=getRichTextByModel(q[le]);assertExists(pe),(ae=pe.model.text)==null||ae.format(0,pe.quill.getLength()-1,{[j]:!ce})}re.quill.setSelection(fe,0),(j==="code"||j==="link")&&re.quill.format(j,!1)}function handleFormat(q,B){var j;if(!isNoneSelection()&&isRangeSelection()){const X=getModelsByRange(getCurrentRange());if(X.length===1){const ee=getRichTextByModel(X[0]);assertExists(ee);const{quill:te}=ee,ne=te.getSelection();assertExists(ne),q.captureSync();const{index:re,length:ie}=ne,fe=te.getFormat(ne);(j=X[0].text)==null||j.format(re,ie,{[B]:!fe[B]})}else formatModelsByRange(X,q,B)}}function handleSelectAll(){const q=document.querySelectorAll(".ql-editor"),B=q[0],j=q[q.length-1],X=document.createRange();assertExists(B),assertExists(j),assertExists(X);const ee=findLastNode(j),te=findFirstNode(B);X.setStart(te,0),X.setEnd(ee,ee.length);const ne=findNearestCommonAncestor(B,j,document.querySelector("body"));initQuickBarEventHandlersAfterSelectAll(ne),resetNativeSelection(X)}function initQuickBarEventHandlersAfterSelectAll(q){q.addEventListener("mousemove",B=>{B.stopPropagation(),console.log(q)},{once:!0})}function findLastNode(q){return q.lastChild?findLastNode(q.lastChild):q}function findFirstNode(q){return q.firstChild?findFirstNode(q.firstChild):q}function findNearestCommonAncestor(q,B,j=document.querySelector("body")){const X=new Array(2).fill(0).map(()=>[]);[q,B].forEach((ee,te)=>{for(;ee!==j&&ee.parentElement;)ee=ee.parentElement,X[te].push(ee)});for(let ee=0;ee<X[0].length;ee++)for(let te=0;te<X[1].length;te++)if(X[0][ee]===X[1][te])return X[0][ee];return j}function handleBlockSelectionBatchDelete(q,B){q.captureSync(),assertExists(B[0].text),B[0].text.delete(0,B[0].text.length);for(let j=1;j<B.length;j++)q.deleteBlock(B[j])}function tryUpdateGroupSize(q,B){requestAnimationFrame(()=>{if(!q.root)return;q.root.children.forEach(X=>{const ee=getBlockElementByModel(X);if(!ee)return;const te=ee.getBoundingClientRect();if(!te)return;const[ne,re,ie,fe]=JSON.parse(X.xywh),ce=te.width/B,se=te.height/B;(!almostEqual(ce,ie)||!almostEqual(se,fe))&&q.updateBlock(X,{xywh:JSON.stringify([ne,re,ce,se])})})})}const{UNDO,REDO,INLINE_CODE,STRIKE,LINK}=HOTKEYS;function bindCommonHotkey(q){hotkey.addListener(INLINE_CODE,B=>{B.preventDefault(),!(B.target instanceof HTMLInputElement)&&handleFormat(q,"code")}),hotkey.addListener(STRIKE,B=>{B.preventDefault(),!(B.target instanceof HTMLInputElement)&&handleFormat(q,"strike")}),hotkey.addListener(LINK,B=>{B.preventDefault(),!(B.target instanceof HTMLInputElement)&&createLink(q)}),hotkey.addListener(UNDO,()=>q.undo()),hotkey.addListener(REDO,()=>q.redo())}function removeCommonHotKey(){hotkey.removeListener([UNDO,REDO,INLINE_CODE,STRIKE,LINK])}function repairContextMenuRange(q){var X;const B=(X=window.getSelection())==null?void 0:X.getRangeAt(0),j=caretRangeFromPoint(q.x,q.y);B&&j&&B.isPointInRange(j.startContainer,j.startOffset)&&B.isPointInRange(j.endContainer,j.endOffset)&&requestAnimationFrame(()=>{resetNativeSelection(B)})}function isSelectionEvent(q){return q.raw!==void 0}function getDragDirection(q){const B=q.start.x,j=q.start.y,X=isSelectionEvent(q)?q.x:q.end.x,ee=isSelectionEvent(q)?q.y:q.end.y;return X>B?ee>j?"right-bottom":"right-top":ee>j?"left-bottom":"left-top"}function getNativeSelectionMouseDragInfo(q){const B=getDragDirection(q),j=window.getSelection();assertExists(j);const X=j.type==="Caret"?"Caret":"Text",{anchorNode:ee,focusNode:te,focusOffset:ne,anchorOffset:re}=j,[ie,fe]=["left-top","right-top"].includes(B)?[ee,re]:[te,ne];assertExists(ie);const ce=document.createRange();return ce.setStart(ie,fe),{selectedType:X,direction:B,anchor:ce}}var __defProp$9=Object.defineProperty,__getOwnPropDesc$9=Object.getOwnPropertyDescriptor,__decorateClass$9=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$9(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$9(B,j,ee),ee};let FormatBarButton=class extends IconButton{constructor(){super(...arguments),this.width="32px",this.height="32px",this.active=!1}connectedCallback(){super.connectedCallback(),this.style.setProperty("--button-width",typeof this.width=="string"?this.width:`${this.width}px`),this.style.setProperty("--button-height",typeof this.height=="string"?this.height:`${this.height}px`)}};FormatBarButton.styles=i$5`
    ${IconButton.styles}

    :host {
      width: var(--button-width);
      height: var(--button-height);
      fill: var(--affine-icon-color);
    }
  `;__decorateClass$9([e$1()],FormatBarButton.prototype,"width",2);__decorateClass$9([e$1()],FormatBarButton.prototype,"height",2);__decorateClass$9([e$1()],FormatBarButton.prototype,"active",2);FormatBarButton=__decorateClass$9([e$2("format-bar-button")],FormatBarButton);const TextIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.36664 2.49995C3.36664 2.05812 3.72481 1.69995 4.16664 1.69995H15.8333C16.2751 1.69995 16.6333 2.05812 16.6333 2.49995V4.99995C16.6333 5.44178 16.2751 5.79995 15.8333 5.79995C15.3915 5.79995 15.0333 5.44178 15.0333 4.99995V3.29995H10.8V16.7H12.5C12.9418 16.7 13.3 17.0581 13.3 17.5C13.3 17.9418 12.9418 18.2999 12.5 18.2999H7.49997C7.05814 18.2999 6.69997 17.9418 6.69997 17.5C6.69997 17.0581 7.05814 16.7 7.49997 16.7H9.19997V3.29995H4.96664V4.99995C4.96664 5.44178 4.60847 5.79995 4.16664 5.79995C3.72481 5.79995 3.36664 5.44178 3.36664 4.99995V2.49995Z"
  />
</svg>`,H1Icon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 4.16666C3.33334 3.70642 2.96024 3.33333 2.50001 3.33333C2.03977 3.33333 1.66667 3.70642 1.66667 4.16666V15.8333C1.66667 16.2936 2.03977 16.6667 2.50001 16.6667C2.96024 16.6667 3.33334 16.2936 3.33334 15.8333V10.8333H7.5V15.8333C7.5 16.2936 7.8731 16.6667 8.33334 16.6667C8.79358 16.6667 9.16667 16.2936 9.16667 15.8333V4.16666C9.16667 3.70642 8.79358 3.33333 8.33334 3.33333C7.8731 3.33333 7.5 3.70642 7.5 4.16666V9.16666H3.33334V4.16666ZM13.1327 7.62569L14.1667 6.41941V15H12.5C12.0398 15 11.6667 15.3731 11.6667 15.8334C11.6667 16.2936 12.0398 16.6667 12.5 16.6667H17.5C17.9602 16.6667 18.3333 16.2936 18.3333 15.8334C18.3333 15.3731 17.9602 15 17.5 15H15.8333V5.96886L15.8333 5.93697C15.8334 5.68637 15.8334 5.44664 15.817 5.25625C15.8032 5.09635 15.7677 4.74213 15.5149 4.45957C15.239 4.15126 14.8285 3.99941 14.4185 4.05397C14.0426 4.10398 13.7851 4.34982 13.6706 4.46225C13.5343 4.59613 13.3783 4.77816 13.2152 4.96844L13.2152 4.96847L13.1944 4.99268L11.8673 6.54103C11.5678 6.89047 11.6082 7.41655 11.9577 7.71607C12.3071 8.01559 12.8332 7.97512 13.1327 7.62569Z"
  />
</svg>`,H2Icon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 4.16666C3.33334 3.70642 2.96024 3.33333 2.50001 3.33333C2.03977 3.33333 1.66667 3.70642 1.66667 4.16666V15.8333C1.66667 16.2936 2.03977 16.6667 2.50001 16.6667C2.96024 16.6667 3.33334 16.2936 3.33334 15.8333V10.8333H7.5V15.8333C7.5 16.2936 7.8731 16.6667 8.33334 16.6667C8.79358 16.6667 9.16667 16.2936 9.16667 15.8333V4.16666C9.16667 3.70642 8.79358 3.33333 8.33334 3.33333C7.8731 3.33333 7.5 3.70642 7.5 4.16666V9.16666H3.33334V4.16666ZM12.5 7.91668C12.5 6.75657 13.5864 5.83335 14.5833 5.83335C15.136 5.83335 15.6602 5.99814 16.0314 6.31278C16.38 6.60828 16.6667 7.09585 16.6667 7.91668C16.6667 8.52546 16.3923 9.27964 15.8767 10.1266C15.3704 10.9584 14.6825 11.7975 13.9741 12.5564C13.2688 13.3122 12.5606 13.97 12.0273 14.4398C11.7612 14.6742 11.5401 14.8606 11.3864 14.9876C11.3096 15.051 11.2498 15.0996 11.2097 15.1318L11.1649 15.1678L11.1542 15.1762L11.152 15.178L11.1518 15.1781L11.1517 15.1782C10.8724 15.3977 10.763 15.7701 10.8791 16.1057C10.9952 16.4415 11.3114 16.6667 11.6667 16.6667H17.5C17.9603 16.6667 18.3333 16.2936 18.3333 15.8333C18.3333 15.3731 17.9603 15 17.5 15H13.8876C14.2952 14.6169 14.7434 14.1749 15.1926 13.6936C15.9426 12.89 16.7129 11.9583 17.3004 10.9932C17.8786 10.0433 18.3333 8.97457 18.3333 7.91668C18.3333 6.65418 17.8664 5.68341 17.1091 5.04142C16.3743 4.41856 15.4402 4.16668 14.5833 4.16668C12.7614 4.16668 10.8333 5.74346 10.8333 7.91668C10.8333 8.37692 11.2064 8.75002 11.6667 8.75002C12.1269 8.75002 12.5 8.37692 12.5 7.91668Z"
  />
</svg>`,H3Icon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 4.16666C3.33334 3.70642 2.96024 3.33333 2.50001 3.33333C2.03977 3.33333 1.66667 3.70642 1.66667 4.16666V15.8333C1.66667 16.2936 2.03977 16.6667 2.50001 16.6667C2.96024 16.6667 3.33334 16.2936 3.33334 15.8333V10.8333H7.5V15.8333C7.5 16.2936 7.8731 16.6667 8.33334 16.6667C8.79358 16.6667 9.16667 16.2936 9.16667 15.8333V4.16666C9.16667 3.70642 8.79358 3.33333 8.33334 3.33333C7.8731 3.33333 7.5 3.70642 7.5 4.16666V9.16666H3.33334V4.16666ZM14.8665 9.34782H14.7684L14.5276 9.38795C14.365 9.41321 14.1837 9.48114 14.045 9.63663C13.903 9.79584 13.8576 9.98844 13.8576 10.1591C13.8576 10.3717 13.9411 10.5615 14.0866 10.7071L14.0943 10.7148L14.1024 10.7221C14.2357 10.8434 14.4016 10.9202 14.5891 10.9345L14.7838 10.9516L14.7934 10.9522C15.2796 10.9843 15.703 11.069 16.0681 11.2009L16.0735 11.2027C16.4091 11.3193 16.6529 11.4975 16.8268 11.7308L16.8301 11.735C16.9904 11.945 17.0967 12.2648 17.0967 12.7452C17.0967 13.1855 16.981 13.5761 16.7505 13.929L16.7497 13.9302C16.5169 14.289 16.21 14.5754 15.8222 14.7918C15.4406 14.999 15.0218 15.1043 14.5572 15.1043C14.0926 15.1043 13.6588 14.9989 13.2495 14.7873C12.8359 14.5676 12.506 14.2802 12.2522 13.9247C12.1057 13.7141 11.8812 13.5921 11.6189 13.5921C11.4129 13.5921 11.2206 13.6667 11.0699 13.8135C10.909 13.9641 10.8333 14.1626 10.8333 14.3691C10.8333 14.5273 10.877 14.6899 10.9835 14.8311C11.3861 15.3916 11.9004 15.8373 12.5206 16.1664C13.1501 16.5004 13.8314 16.6667 14.5572 16.6667C15.2846 16.6667 15.9628 16.4968 16.5834 16.1542L16.5848 16.1534C17.2047 15.8082 17.7056 15.3409 18.0799 14.7538C18.4668 14.1504 18.6592 13.477 18.6592 12.7452C18.6592 11.9692 18.4524 11.2907 18.0071 10.7468C17.7726 10.4532 17.5051 10.207 17.2056 10.0101C17.4392 9.79677 17.6469 9.54803 17.8292 9.26611C18.1887 8.71327 18.367 8.09316 18.367 7.41834C18.367 6.7752 18.2019 6.17733 17.8714 5.6346C17.5511 5.09926 17.1179 4.66998 16.5777 4.35103C16.0289 4.02702 15.4237 3.86629 14.772 3.86629C13.9404 3.86629 13.2047 4.10357 12.5884 4.59253C12.0085 5.0514 11.5898 5.60545 11.3512 6.25482L11.3427 6.27791L11.3368 6.30177C11.3213 6.36376 11.3059 6.44231 11.3059 6.5248C11.3059 6.72114 11.3709 6.91128 11.5112 7.06554L11.5185 7.07363L11.5263 7.08135C11.6781 7.23315 11.8733 7.3103 12.0828 7.3103C12.2318 7.3103 12.3933 7.27508 12.5379 7.17461C12.6823 7.07437 12.7718 6.93566 12.823 6.7947C12.9573 6.43445 13.193 6.11131 13.5478 5.82548C13.8693 5.56652 14.2656 5.42871 14.7634 5.42871C15.1432 5.42871 15.4801 5.52025 15.7843 5.69998L15.7888 5.70257C16.0994 5.88143 16.3433 6.12093 16.5263 6.4259L16.529 6.43029C16.7126 6.72859 16.8046 7.05454 16.8046 7.41834C16.8046 7.77298 16.7171 8.08864 16.5441 8.3755C16.366 8.67075 16.1287 8.90617 15.8264 9.08565L15.8237 9.0873C15.5368 9.26033 15.2212 9.34782 14.8665 9.34782Z"
  />
</svg>`,H4Icon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 4.16666C3.33334 3.70642 2.96024 3.33333 2.50001 3.33333C2.03977 3.33333 1.66667 3.70642 1.66667 4.16666V15.8333C1.66667 16.2936 2.03977 16.6667 2.50001 16.6667C2.96024 16.6667 3.33334 16.2936 3.33334 15.8333V10.8333H7.5V15.8333C7.5 16.2936 7.8731 16.6667 8.33334 16.6667C8.79358 16.6667 9.16667 16.2936 9.16667 15.8333V4.16666C9.16667 3.70642 8.79358 3.33333 8.33334 3.33333C7.8731 3.33333 7.5 3.70642 7.5 4.16666V9.16666H3.33334V4.16666ZM16.6667 4.44193C16.6667 3.53496 15.4904 3.17883 14.9873 3.93345L10.2263 11.0749C9.82022 11.6841 10.2569 12.5 10.989 12.5H15V15.8334C15 16.2936 15.3731 16.6667 15.8333 16.6667C16.2936 16.6667 16.6667 16.2936 16.6667 15.8334V12.5H17.9167C18.3769 12.5 18.75 12.1269 18.75 11.6667C18.75 11.2065 18.3769 10.8334 17.9167 10.8334H16.6667V4.44193ZM15 6.91901V10.8334H12.3904L15 6.91901Z"
  />
</svg>`,H5Icon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 4.16668C3.33334 3.70644 2.96024 3.33334 2.50001 3.33334C2.03977 3.33334 1.66667 3.70644 1.66667 4.16668V15.8333C1.66667 16.2936 2.03977 16.6667 2.50001 16.6667C2.96024 16.6667 3.33334 16.2936 3.33334 15.8333V10.8333H7.5V15.8333C7.5 16.2936 7.8731 16.6667 8.33334 16.6667C8.79358 16.6667 9.16667 16.2936 9.16667 15.8333V4.16668C9.16667 3.70644 8.79358 3.33334 8.33334 3.33334C7.8731 3.33334 7.5 3.70644 7.5 4.16668V9.16668H3.33334V4.16668ZM11.2744 7.38106C11.3938 6.67097 11.5459 5.75795 11.7309 4.64198L11.7311 4.64096C11.764 4.45693 11.8472 4.30502 11.9821 4.19005C12.1166 4.06933 12.2764 4.00831 12.4577 4.00831H17.9541C18.1439 4.00831 18.3177 4.08004 18.4737 4.21626C18.6312 4.34781 18.7178 4.50681 18.7178 4.69142C18.7178 4.92367 18.6495 5.12302 18.5092 5.2834L18.508 5.28473C18.3653 5.44098 18.178 5.51775 17.9541 5.51775H13.1016L12.6374 8.41108C13.242 8.12 13.8687 7.97397 14.5166 7.97397C15.3299 7.97397 16.0666 8.16532 16.7248 8.5492C17.3876 8.93232 17.9112 9.45282 18.2945 10.1098C18.6846 10.7683 18.8789 11.5142 18.8789 12.3452C18.8789 13.1825 18.6815 13.9345 18.2853 14.599C17.8901 15.2617 17.3577 15.788 16.689 16.177C16.019 16.5607 15.27 16.7523 14.445 16.7523C13.499 16.7523 12.6704 16.5095 11.9628 16.0214C11.2604 15.537 10.7427 14.9566 10.4133 14.2795L10.4121 14.2769C10.3589 14.1572 10.3333 14.023 10.3333 13.876C10.3333 13.7047 10.4126 13.5474 10.5547 13.4053L10.556 13.404C10.7043 13.2621 10.8672 13.1839 11.0433 13.1839C11.2127 13.1839 11.3622 13.2183 11.488 13.2914C11.6143 13.3649 11.7116 13.4743 11.7806 13.6156C12.0005 14.0671 12.3367 14.4534 12.7917 14.7743C13.247 15.0855 13.7968 15.2429 14.445 15.2429C14.9926 15.2429 15.4854 15.1178 15.9254 14.8689C16.3665 14.6135 16.7172 14.2685 16.9784 13.8333C17.2387 13.3935 17.3695 12.9011 17.3695 12.3542C17.3695 11.8006 17.2414 11.3113 16.9873 10.8839L16.9866 10.8828C16.7377 10.4486 16.3907 10.1072 15.9441 9.85776C15.4984 9.6089 14.9875 9.48341 14.4092 9.48341C13.9549 9.48341 13.5197 9.6154 13.1023 9.88209C12.6791 10.1466 12.3691 10.426 12.1686 10.718C12.0237 10.935 11.8261 11.05 11.5804 11.05C11.3929 11.05 11.2174 10.9859 11.0555 10.8629C10.8915 10.7382 10.7988 10.5845 10.7988 10.4027C10.7988 10.3738 10.8023 10.331 10.8083 10.2771C10.8145 10.2207 10.8329 10.1021 10.8626 9.9237C10.8924 9.73858 10.9402 9.44616 11.0058 9.04651C11.0714 8.64073 11.161 8.08521 11.2744 7.38106Z"
  />
</svg>`,H6Icon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 4.16668C3.33334 3.70644 2.96024 3.33334 2.50001 3.33334C2.03977 3.33334 1.66667 3.70644 1.66667 4.16668V15.8333C1.66667 16.2936 2.03977 16.6667 2.50001 16.6667C2.96024 16.6667 3.33334 16.2936 3.33334 15.8333V10.8333H7.5V15.8333C7.5 16.2936 7.8731 16.6667 8.33334 16.6667C8.79358 16.6667 9.16667 16.2936 9.16667 15.8333V4.16668C9.16667 3.70644 8.79358 3.33334 8.33334 3.33334C7.8731 3.33334 7.5 3.70644 7.5 4.16668V9.16668H3.33334V4.16668ZM14.9347 16.7501C14.1626 16.7501 13.4857 16.5686 12.9073 16.203C12.3329 15.8338 11.8526 15.3407 11.4672 14.7256L11.4667 14.7248C11.0882 14.1056 10.8032 13.4114 10.6117 12.6442C10.4261 11.872 10.3333 11.079 10.3333 10.2654C10.3333 9.46904 10.4318 8.70499 10.629 7.97346C10.8264 7.23542 11.12 6.57403 11.5104 5.99006C11.9017 5.40459 12.3848 4.9416 12.9595 4.6025C13.5428 4.25567 14.2133 4.08338 14.9682 4.08338C15.7418 4.08338 16.4145 4.2834 16.9825 4.68624C17.5495 5.0845 17.9856 5.56026 18.2879 6.11269C18.3608 6.24842 18.3983 6.38948 18.3983 6.53495C18.3983 6.70308 18.3254 6.86132 18.1935 7.00839C18.0673 7.1552 17.9236 7.2415 17.7627 7.2415C17.4421 7.2415 17.1998 7.11674 17.0544 6.86105L17.0538 6.85991C16.8654 6.51634 16.5902 6.21696 16.2257 5.96223L16.225 5.96172C15.8665 5.70556 15.4487 5.57662 14.9682 5.57662C14.4131 5.57662 13.9355 5.70979 13.5325 5.97279C13.1315 6.23227 12.8001 6.58445 12.5384 7.03113C12.2755 7.48004 12.0776 7.98831 11.9454 8.55666C11.8395 9.03172 11.7778 9.5171 11.7603 10.0129C11.881 9.84739 12.039 9.67114 12.233 9.48421C12.5411 9.18669 12.911 8.93267 13.3416 8.72163C13.7832 8.50196 14.2645 8.3925 14.7841 8.3925C15.5567 8.3925 16.2498 8.58008 16.8607 8.95674C17.4705 9.32668 17.9518 9.8362 18.3044 10.4836C18.6576 11.1263 18.8333 11.8525 18.8333 12.6603C18.8333 13.3799 18.6684 14.0522 18.3384 14.6758C18.0083 15.2995 17.5494 15.803 16.9629 16.1847C16.379 16.5624 15.702 16.7501 14.9347 16.7501ZM16.2368 14.905C16.6032 14.6699 16.8889 14.3518 17.0944 13.949C17.3053 13.5406 17.4116 13.0817 17.4116 12.5713C17.4116 12.0867 17.2953 11.641 17.0628 11.2325L17.0624 11.2318C16.8346 10.8221 16.5284 10.4937 16.1442 10.2461C15.7677 9.99999 15.3485 9.87683 14.8845 9.87683C14.4152 9.87683 13.9903 10.003 13.6082 10.255C13.2297 10.5024 12.9263 10.8337 12.6983 11.2496C12.4713 11.658 12.3574 12.107 12.3574 12.598C12.3574 13.0936 12.4817 13.5411 12.7297 13.9427C12.9849 14.3471 13.3127 14.667 13.7137 14.9033C14.1144 15.1396 14.5322 15.2568 14.9682 15.2568C15.4504 15.2568 15.8723 15.1389 16.2368 14.905Z"
  />
</svg>`,BulletedListIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M1.66667 5C1.66667 4.30964 2.22632 3.75 2.91667 3.75C3.60703 3.75 4.16667 4.30964 4.16667 5C4.16667 5.69036 3.60703 6.25 2.91667 6.25C2.22631 6.25 1.66667 5.69035 1.66667 5ZM5.83334 5.00051C5.83336 4.54027 6.20648 4.1672 6.66672 4.16722L17.5 4.16782C17.9603 4.16785 18.3333 4.54097 18.3333 5.0012C18.3333 5.46144 17.9602 5.83452 17.4999 5.83449L6.66663 5.83389C6.20639 5.83386 5.83331 5.46075 5.83334 5.00051ZM1.66667 10C1.66667 9.30964 2.22632 8.75 2.91667 8.75C3.60703 8.75 4.16667 9.30964 4.16667 10C4.16667 10.6904 3.60703 11.25 2.91667 11.25C2.22631 11.25 1.66667 10.6904 1.66667 10ZM5.83334 10.0006C5.83337 9.54031 6.20648 9.16724 6.66672 9.16727L17.5001 9.16792C17.9603 9.16795 18.3334 9.54107 18.3334 10.0013C18.3333 10.4615 17.9602 10.8346 17.5 10.8346L6.66662 10.8339C6.20638 10.8339 5.83331 10.4608 5.83334 10.0006ZM1.66667 15C1.66667 14.3096 2.22632 13.75 2.91667 13.75C3.60703 13.75 4.16667 14.3096 4.16667 15C4.16667 15.6904 3.60703 16.25 2.91667 16.25C2.22632 16.25 1.66667 15.6904 1.66667 15ZM5.83334 15.0006C5.83337 14.5403 6.20649 14.1672 6.66672 14.1673L17.5001 14.1679C17.9603 14.168 18.3334 14.5411 18.3334 15.0013C18.3333 15.4615 17.9602 15.8346 17.5 15.8346L6.66662 15.8339C6.20638 15.8339 5.83331 15.4608 5.83334 15.0006Z"
  />
</svg>`,NumberedIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.60478 2.62446C4.85046 2.7763 5 3.04452 5 3.33333V7.5H5.83334C6.29357 7.5 6.66667 7.8731 6.66667 8.33333C6.66667 8.79357 6.29357 9.16667 5.83334 9.16667H2.5C2.03977 9.16667 1.66667 8.79357 1.66667 8.33333C1.66667 7.8731 2.03977 7.5 2.5 7.5H3.33334V4.6817L2.87268 4.91202C2.46103 5.11785 1.96047 4.95099 1.75465 4.53935C1.54882 4.1277 1.71568 3.62714 2.12733 3.42131L3.79399 2.58798C4.05232 2.45882 4.3591 2.47262 4.60478 2.62446ZM7.5 4.99995C7.50003 4.53971 7.87315 4.16664 8.33339 4.16667L17.5001 4.16722C17.9603 4.16725 18.3334 4.54037 18.3333 5.0006C18.3333 5.46084 17.9602 5.83391 17.5 5.83389L8.33329 5.83333C7.87305 5.83331 7.49998 5.46019 7.5 4.99995ZM7.5 9.99995C7.50003 9.53971 7.87315 9.16664 8.33339 9.16667L17.5001 9.16722C17.9603 9.16725 18.3334 9.54037 18.3333 10.0006C18.3333 10.4608 17.9602 10.8339 17.5 10.8339L8.33329 10.8333C7.87305 10.8333 7.49998 10.4602 7.5 9.99995ZM4.16667 12.5C3.77951 12.5 3.4521 12.7648 3.35954 13.1244C3.24482 13.5701 2.79051 13.8384 2.3448 13.7237C1.89909 13.609 1.63076 13.1547 1.74548 12.709C2.02296 11.6309 3.00063 10.8333 4.16667 10.8333H4.40028C5.65197 10.8333 6.66667 11.848 6.66667 13.0997C6.66667 13.7533 6.38455 14.375 5.89271 14.8054L4.71788 15.8333H5.83334C6.29357 15.8333 6.66667 16.2064 6.66667 16.6667C6.66667 17.1269 6.29357 17.5 5.83334 17.5H2.5C2.15283 17.5 1.84203 17.2848 1.71992 16.9598C1.59781 16.6348 1.68998 16.2681 1.95125 16.0395L4.7952 13.5511C4.92535 13.4372 5 13.2727 5 13.0997C5 12.7685 4.7315 12.5 4.40028 12.5H4.16667ZM7.5 15C7.50003 14.5397 7.87315 14.1666 8.33339 14.1667L17.5001 14.1672C17.9603 14.1672 18.3334 14.5404 18.3333 15.0006C18.3333 15.4608 17.9602 15.8339 17.5 15.8339L8.33329 15.8333C7.87305 15.8333 7.49998 15.4602 7.5 15Z"
  />
</svg>`,TodoIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.96788 2.5H14.0321C14.4714 2.49999 14.8504 2.49997 15.1625 2.52548C15.492 2.55239 15.8197 2.61182 16.135 2.77249C16.6054 3.01217 16.9878 3.39462 17.2275 3.86503C17.3882 4.18034 17.4476 4.50802 17.4745 4.83748C17.5 5.14962 17.5 5.52858 17.5 5.96786V14.0321C17.5 14.4714 17.5 14.8504 17.4745 15.1625C17.4476 15.492 17.3882 15.8197 17.2275 16.135C16.9878 16.6054 16.6054 16.9878 16.135 17.2275C15.8197 17.3882 15.492 17.4476 15.1625 17.4745C14.8504 17.5 14.4714 17.5 14.0321 17.5H5.96786C5.52858 17.5 5.14962 17.5 4.83748 17.4745C4.50802 17.4476 4.18034 17.3882 3.86503 17.2275C3.39462 16.9878 3.01217 16.6054 2.77249 16.135C2.61182 15.8197 2.55239 15.492 2.52548 15.1625C2.49997 14.8504 2.49999 14.4714 2.5 14.0321V5.96788C2.49999 5.52859 2.49997 5.14962 2.52548 4.83748C2.55239 4.50802 2.61182 4.18034 2.77249 3.86503C3.01217 3.39462 3.39462 3.01217 3.86503 2.77249C4.18034 2.61182 4.50802 2.55239 4.83748 2.52548C5.14962 2.49997 5.52859 2.49999 5.96788 2.5ZM4.9732 4.18661C4.74681 4.2051 4.66288 4.2365 4.62168 4.2575C4.46487 4.33739 4.33739 4.46487 4.2575 4.62168C4.2365 4.66288 4.2051 4.74681 4.18661 4.9732C4.16732 5.20931 4.16667 5.51954 4.16667 6V14C4.16667 14.4805 4.16732 14.7907 4.18661 15.0268C4.2051 15.2532 4.2365 15.3371 4.2575 15.3783C4.33739 15.5351 4.46487 15.6626 4.62168 15.7425C4.66288 15.7635 4.74681 15.7949 4.9732 15.8134C5.20931 15.8327 5.51954 15.8333 6 15.8333H14C14.4805 15.8333 14.7907 15.8327 15.0268 15.8134C15.2532 15.7949 15.3371 15.7635 15.3783 15.7425C15.5351 15.6626 15.6626 15.5351 15.7425 15.3783C15.7635 15.3371 15.7949 15.2532 15.8134 15.0268C15.8327 14.7907 15.8333 14.4805 15.8333 14V6C15.8333 5.51954 15.8327 5.20931 15.8134 4.9732C15.7949 4.74681 15.7635 4.66288 15.7425 4.62168C15.6626 4.46487 15.5351 4.33739 15.3783 4.2575C15.3371 4.2365 15.2532 4.2051 15.0268 4.18661C14.7907 4.16732 14.4805 4.16667 14 4.16667H6C5.51954 4.16667 5.20931 4.16732 4.9732 4.18661ZM13.8964 6.88571C14.2357 7.1967 14.2586 7.72384 13.9476 8.06311L9.3643 13.0631C9.21071 13.2307 8.99535 13.3282 8.76811 13.3331C8.54086 13.3381 8.32147 13.25 8.16075 13.0893L6.07741 11.0059C5.75198 10.6805 5.75198 10.1528 6.07741 9.82741C6.40285 9.50198 6.93049 9.50198 7.25592 9.82741L8.72382 11.2953L12.719 6.9369C13.03 6.59763 13.5572 6.57471 13.8964 6.88571Z"
  />
</svg>`,CodeIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.13455 3.33334H14.8655C15.3048 3.33333 15.6837 3.33332 15.9959 3.35882C16.3253 3.38574 16.653 3.44517 16.9683 3.60583C17.4387 3.84551 17.8212 4.22796 18.0609 4.69837C18.2215 5.01369 18.2809 5.34137 18.3079 5.67082C18.3334 5.98296 18.3334 6.36192 18.3333 6.80121V13.1988C18.3334 13.6381 18.3334 14.0171 18.3079 14.3292C18.2809 14.6587 18.2215 14.9863 18.0609 15.3017C17.8212 15.7721 17.4387 16.1545 16.9683 16.3942C16.653 16.5549 16.3253 16.6143 15.9959 16.6412C15.6837 16.6667 15.3047 16.6667 14.8654 16.6667H5.13457C4.69527 16.6667 4.3163 16.6667 4.00415 16.6412C3.6747 16.6143 3.34701 16.5549 3.0317 16.3942C2.56129 16.1545 2.17884 15.7721 1.93916 15.3017C1.7785 14.9863 1.71907 14.6587 1.69215 14.3292C1.66664 14.0171 1.66666 13.6381 1.66667 13.1988V6.80122C1.66666 6.36193 1.66664 5.98296 1.69215 5.67082C1.71907 5.34137 1.7785 5.01369 1.93916 4.69837C2.17884 4.22796 2.56129 3.84551 3.0317 3.60583C3.34701 3.44517 3.6747 3.38574 4.00415 3.35882C4.31629 3.33332 4.69526 3.33333 5.13455 3.33334ZM4.13987 5.01995C3.91348 5.03845 3.82955 5.06985 3.78835 5.09084C3.63155 5.17073 3.50406 5.29822 3.42417 5.45502C3.40317 5.49622 3.37178 5.58016 3.35328 5.80654C3.33399 6.04266 3.33334 6.35288 3.33334 6.83334V13.1667C3.33334 13.6471 3.33399 13.9574 3.35328 14.1935C3.37178 14.4199 3.40317 14.5038 3.42417 14.545C3.50406 14.7018 3.63155 14.8293 3.78835 14.9092C3.82955 14.9302 3.91348 14.9616 4.13987 14.9801C4.37598 14.9994 4.68621 15 5.16667 15H14.8333C15.3138 15 15.624 14.9994 15.8601 14.9801C16.0865 14.9616 16.1705 14.9302 16.2117 14.9092C16.3685 14.8293 16.4959 14.7018 16.5758 14.545C16.5968 14.5038 16.6282 14.4199 16.6467 14.1935C16.666 13.9574 16.6667 13.6471 16.6667 13.1667V6.83334C16.6667 6.35288 16.666 6.04266 16.6467 5.80654C16.6282 5.58016 16.5968 5.49622 16.5758 5.45502C16.4959 5.29822 16.3685 5.17073 16.2117 5.09084C16.1705 5.06985 16.0865 5.03845 15.8601 5.01995C15.624 5.00066 15.3138 5.00001 14.8333 5.00001H5.16667C4.68621 5.00001 4.37598 5.00066 4.13987 5.01995Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.92259 6.91073C9.24803 7.23617 9.24803 7.76381 8.92259 8.08925L7.01184 9.99999L8.92259 11.9107C9.24803 12.2362 9.24803 12.7638 8.92259 13.0892C8.59715 13.4147 8.06951 13.4147 7.74408 13.0892L5.24408 10.5892C4.91864 10.2638 4.91864 9.73617 5.24408 9.41073L7.74408 6.91073C8.06951 6.5853 8.59715 6.5853 8.92259 6.91073ZM11.0774 6.91073C11.4028 6.5853 11.9305 6.5853 12.2559 6.91073L14.7559 9.41073C15.0814 9.73617 15.0814 10.2638 14.7559 10.5892L12.2559 13.0892C11.9305 13.4147 11.4028 13.4147 11.0774 13.0892C10.752 12.7638 10.752 12.2362 11.0774 11.9107L12.9882 9.99999L11.0774 8.08925C10.752 7.76381 10.752 7.23617 11.0774 6.91073Z"
  />
</svg>`,QuoteIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33334 3.33333C3.33334 2.8731 2.96024 2.5 2.50001 2.5C2.03977 2.5 1.66667 2.8731 1.66667 3.33333V16.6667C1.66667 17.1269 2.03977 17.5 2.50001 17.5C2.96024 17.5 3.33334 17.1269 3.33334 16.6667L3.33334 3.33333ZM15.8333 7.5C16.2936 7.5 16.6667 7.1269 16.6667 6.66667C16.6667 6.20643 16.2936 5.83333 15.8333 5.83333H5.83334C5.3731 5.83333 5.00001 6.20643 5.00001 6.66667C5.00001 7.1269 5.3731 7.5 5.83334 7.5H15.8333ZM13.3333 10C13.3333 10.4602 12.9602 10.8333 12.5 10.8333H5.83334C5.3731 10.8333 5.00001 10.4602 5.00001 10C5.00001 9.53976 5.3731 9.16667 5.83334 9.16667H12.5C12.9602 9.16667 13.3333 9.53976 13.3333 10ZM16.6667 14.1667C17.1269 14.1667 17.5 13.7936 17.5 13.3333C17.5 12.8731 17.1269 12.5 16.6667 12.5H5.83334C5.3731 12.5 5.00001 12.8731 5.00001 13.3333C5.00001 13.7936 5.3731 14.1667 5.83334 14.1667H16.6667Z"
    fill="#9096A5"
  />
</svg>`,CalloutIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.5 5C2.5 3.61929 3.61929 2.5 5 2.5H15C16.3807 2.5 17.5 3.61929 17.5 5V6.66667C17.5 8.04738 16.3807 9.16667 15 9.16667H5C3.61929 9.16667 2.5 8.04738 2.5 6.66667V5ZM5 4.16667C4.53976 4.16667 4.16667 4.53976 4.16667 5V6.66667C4.16667 7.1269 4.53976 7.5 5 7.5H15C15.4602 7.5 15.8333 7.1269 15.8333 6.66667V5C15.8333 4.53976 15.4602 4.16667 15 4.16667H5ZM3.33333 16.6667C3.33333 16.2064 3.70643 15.8333 4.16667 15.8333H12.5C12.9602 15.8333 13.3333 16.2064 13.3333 16.6667C13.3333 17.1269 12.9602 17.5 12.5 17.5H4.16667C3.70643 17.5 3.33333 17.1269 3.33333 16.6667ZM4.16667 11.6667C3.70643 11.6667 3.33333 12.0398 3.33333 12.5C3.33333 12.9602 3.70643 13.3333 4.16667 13.3333H15.8333C16.2936 13.3333 16.6667 12.9602 16.6667 12.5C16.6667 12.0398 16.2936 11.6667 15.8333 11.6667H4.16667Z"
    fill="#9096A5"
  />
</svg>`,BoldIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.16666 2.5C4.16666 2.03976 4.53976 1.66667 5 1.66667H10.4167C12.948 1.66667 15 3.7187 15 6.25C15 7.63233 14.3881 8.87172 13.4203 9.71206C14.8569 10.4858 15.8333 12.0039 15.8333 13.75C15.8333 16.2813 13.7813 18.3333 11.25 18.3333H5C4.53976 18.3333 4.16666 17.9602 4.16666 17.5V2.5ZM5.83333 10.8333V16.6667H11.25C12.8608 16.6667 14.1667 15.3608 14.1667 13.75C14.1667 12.1392 12.8608 10.8333 11.25 10.8333H5.83333ZM5.83333 9.16667H10.4167C12.0275 9.16667 13.3333 7.86083 13.3333 6.25C13.3333 4.63917 12.0275 3.33333 10.4167 3.33333H5.83333V9.16667Z"
  />
</svg>`,ItalicIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M12.4805 1.66669H8.33333C7.8731 1.66669 7.5 2.03978 7.5 2.50002C7.5 2.96026 7.8731 3.33335 8.33333 3.33335H11.3438L6.89937 16.6667H3.33333C2.8731 16.6667 2.5 17.0398 2.5 17.5C2.5 17.9603 2.8731 18.3334 3.33333 18.3334H7.48079C7.49371 18.3337 7.50659 18.3337 7.51945 18.3334H11.6667C12.1269 18.3334 12.5 17.9603 12.5 17.5C12.5 17.0398 12.1269 16.6667 11.6667 16.6667H8.65619L13.1006 3.33335H16.6667C17.1269 3.33335 17.5 2.96026 17.5 2.50002C17.5 2.03978 17.1269 1.66669 16.6667 1.66669H12.5192C12.5063 1.66639 12.4934 1.66639 12.4805 1.66669Z"
  />
</svg>`,UnderlineIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.5 2.5C2.5 2.03976 2.8731 1.66667 3.33333 1.66667H6.66667C7.1269 1.66667 7.5 2.03976 7.5 2.5C7.5 2.96024 7.1269 3.33333 6.66667 3.33333H5.83333V9.16667C5.83333 11.4679 7.69881 13.3333 10 13.3333C12.3012 13.3333 14.1667 11.4679 14.1667 9.16667V3.33333H13.3333C12.8731 3.33333 12.5 2.96024 12.5 2.5C12.5 2.03976 12.8731 1.66667 13.3333 1.66667H16.6667C17.1269 1.66667 17.5 2.03976 17.5 2.5C17.5 2.96024 17.1269 3.33333 16.6667 3.33333H15.8333V9.16667C15.8333 12.3883 13.2217 15 10 15C6.77834 15 4.16667 12.3883 4.16667 9.16667V3.33333H3.33333C2.8731 3.33333 2.5 2.96024 2.5 2.5ZM2.5 17.5C2.5 17.0398 2.8731 16.6667 3.33333 16.6667H16.6667C17.1269 16.6667 17.5 17.0398 17.5 17.5C17.5 17.9602 17.1269 18.3333 16.6667 18.3333H3.33333C2.8731 18.3333 2.5 17.9602 2.5 17.5Z"
  />
</svg>`,StrikethroughIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.33333 6.25C3.33333 3.7187 5.38536 1.66667 7.91667 1.66667H12.2396C14.6846 1.66667 16.6667 3.64874 16.6667 6.09375V6.25C16.6667 6.71024 16.2936 7.08333 15.8333 7.08333C15.3731 7.08333 15 6.71024 15 6.25V6.09375C15 4.56922 13.7641 3.33333 12.2396 3.33333H7.91667C6.30584 3.33333 5 4.63917 5 6.25C5 7.86083 6.30584 9.16667 7.91667 9.16667H17.5C17.9602 9.16667 18.3333 9.53976 18.3333 10C18.3333 10.4602 17.9602 10.8333 17.5 10.8333H15.619C16.2735 11.6258 16.6667 12.642 16.6667 13.75C16.6667 16.2813 14.6146 18.3333 12.0833 18.3333H7.83854C5.35038 18.3333 3.33333 16.3163 3.33333 13.8281V13.75C3.33333 13.2898 3.70643 12.9167 4.16667 12.9167C4.6269 12.9167 5 13.2898 5 13.75V13.8281C5 15.3958 6.27086 16.6667 7.83854 16.6667H12.0833C13.6942 16.6667 15 15.3608 15 13.75C15 12.1392 13.6942 10.8333 12.0833 10.8333H2.5C2.03976 10.8333 1.66667 10.4602 1.66667 10C1.66667 9.53976 2.03976 9.16667 2.5 9.16667H4.38097C3.72651 8.37422 3.33333 7.35803 3.33333 6.25Z"
  />
</svg>`,InlineCodeIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M11.8688 2.52488C12.3153 2.6365 12.5867 3.08895 12.4751 3.53544L9.14179 16.8688C9.03016 17.3153 8.57772 17.5867 8.13122 17.4751C7.68473 17.3635 7.41326 16.911 7.52488 16.4645L10.8582 3.13122C10.9698 2.68472 11.4223 2.41325 11.8688 2.52488ZM6.44567 6.10143C6.75784 6.43961 6.73675 6.96683 6.39857 7.279L3.67939 9.78901L6.444 12.7663C6.75717 13.1035 6.73764 13.6308 6.40038 13.944C6.06312 14.2572 5.53584 14.2376 5.22267 13.9004L1.88934 10.3106C1.73866 10.1484 1.65876 9.93279 1.66729 9.71151C1.67581 9.49023 1.77205 9.28145 1.93477 9.13125L5.2681 6.05433C5.60629 5.74216 6.1335 5.76324 6.44567 6.10143ZM13.5543 6.10143C13.8665 5.76324 14.3937 5.74216 14.7319 6.05433L18.0652 9.13125C18.2279 9.28145 18.3242 9.49023 18.3327 9.71151C18.3412 9.93279 18.2613 10.1484 18.1107 10.3106L14.7773 13.9004C14.4642 14.2376 13.9369 14.2572 13.5996 13.944C13.2624 13.6308 13.2428 13.1035 13.556 12.7663L16.3206 9.78901L13.6014 7.279C13.2633 6.96683 13.2422 6.43961 13.5543 6.10143Z"
  />
</svg>`,LinkIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M14.3542 11.368L16.5107 9.21144C17.9752 7.74698 17.9752 5.37261 16.5107 3.90814L16.0849 3.48228C14.6204 2.01782 12.246 2.01782 10.7816 3.48228L8.06404 6.19981C6.59957 7.66427 6.59957 10.0386 8.06403 11.5031L8.48989 11.929C8.75625 12.1953 9.05271 12.4132 9.36831 12.5827L10.0418 11.9092C10.1511 11.7999 10.2322 11.673 10.285 11.5377C9.97427 11.4202 9.68289 11.2363 9.4327 10.9862L9.00684 10.5603C8.06308 9.61653 8.06308 8.08638 9.00684 7.14262L11.7244 4.42509C12.6681 3.48133 14.1983 3.48133 15.1421 4.42509L15.5679 4.85095C16.5117 5.79472 16.5117 7.32487 15.5679 8.26863L14.1477 9.68884C14.3102 10.235 14.3791 10.8032 14.3542 11.368Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.63749 8.62368L3.48098 10.7802C2.01651 12.2447 2.01651 14.619 3.48098 16.0835L3.90684 16.5094C5.37131 17.9738 7.74568 17.9738 9.21014 16.5094L11.9277 13.7918C13.3921 12.3274 13.3921 9.95299 11.9277 8.48853L11.5018 8.06267C11.2354 7.79631 10.939 7.5784 10.6234 7.40893L9.94985 8.08247C9.84056 8.19176 9.7595 8.31859 9.70668 8.4539C10.0174 8.57144 10.3088 8.7553 10.559 9.00548L10.9849 9.43134C11.9286 10.3751 11.9286 11.9053 10.9849 12.849L8.26733 15.5665C7.32356 16.5103 5.79342 16.5103 4.84965 15.5665L4.42379 15.1407C3.48002 14.1969 3.48002 12.6668 4.42379 11.723L5.844 10.3028C5.68148 9.7566 5.61264 9.18846 5.63749 8.62368Z"
  />
</svg>`,CopyIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.9679 1.66667L13.3333 1.66667C13.5543 1.66667 13.7663 1.75447 13.9226 1.91075L17.2559 5.24408C17.4122 5.40036 17.5 5.61232 17.5 5.83334V10.6988C17.5 11.1381 17.5 11.5171 17.4745 11.8292C17.4476 12.1586 17.3882 12.4863 17.2275 12.8016C16.9878 13.2721 16.6054 13.6545 16.135 13.8942C15.8197 14.0548 15.492 14.1143 15.1625 14.1412C14.8504 14.1667 14.4714 14.1667 14.0321 14.1667H12.5V15.8333C12.5 17.214 11.3807 18.3333 10 18.3333H5C3.61929 18.3333 2.5 17.214 2.5 15.8333V8.33334C2.5 6.95262 3.61929 5.83334 5 5.83334H7.5L7.5 5.13455C7.49998 4.69526 7.49997 4.31629 7.52547 4.00415C7.55239 3.67469 7.61182 3.34701 7.77248 3.03169C8.01217 2.56129 8.39462 2.17884 8.86502 1.93915C9.18034 1.77849 9.50802 1.71906 9.83748 1.69214C10.1496 1.66664 10.5286 1.66665 10.9679 1.66667ZM7.5 7.5H5C4.53976 7.5 4.16667 7.8731 4.16667 8.33334V15.8333C4.16667 16.2936 4.53976 16.6667 5 16.6667H10C10.4602 16.6667 10.8333 16.2936 10.8333 15.8333V14.1666C10.4508 14.1664 10.1173 14.1641 9.83748 14.1412C9.50802 14.1143 9.18034 14.0548 8.86502 13.8942C8.39462 13.6545 8.01217 13.2721 7.77248 12.8016C7.61182 12.4863 7.55239 12.1586 7.52547 11.8292C7.49997 11.517 7.49998 11.1381 7.5 10.6988L7.5 7.5ZM9.9732 3.35328C9.74681 3.37177 9.66288 3.40317 9.62167 3.42416C9.46487 3.50406 9.33739 3.63154 9.25749 3.78834C9.2365 3.82955 9.2051 3.91348 9.18661 4.13987C9.16732 4.37598 9.16667 4.68621 9.16667 5.16667V10.6667C9.16667 11.1471 9.16732 11.4574 9.18661 11.6935C9.2051 11.9199 9.2365 12.0038 9.25749 12.045C9.33739 12.2018 9.46487 12.3293 9.62167 12.4092C9.66288 12.4302 9.74681 12.4616 9.9732 12.4801C10.2093 12.4994 10.5195 12.5 11 12.5H14C14.4805 12.5 14.7907 12.4994 15.0268 12.4801C15.2532 12.4616 15.3371 12.4302 15.3783 12.4092C15.5351 12.3293 15.6626 12.2018 15.7425 12.045C15.7635 12.0038 15.7949 11.9199 15.8134 11.6935C15.8327 11.4574 15.8333 11.1471 15.8333 10.6667V7.5L13.8068 7.50001C13.5964 7.50003 13.3916 7.50005 13.2181 7.48588C13.0276 7.47032 12.8029 7.43359 12.5767 7.31835C12.2631 7.15856 12.0081 6.90359 11.8483 6.58999C11.7331 6.3638 11.6964 6.13902 11.6808 5.94853C11.6666 5.77506 11.6666 5.57023 11.6667 5.3599L11.6667 3.33334H11C10.5195 3.33334 10.2093 3.33398 9.9732 3.35328ZM13.3333 3.67851V5.33334C13.3333 5.58044 13.334 5.71565 13.3419 5.81281C13.3422 5.81668 13.3426 5.82034 13.3429 5.8238C13.3463 5.82411 13.35 5.82443 13.3539 5.82475C13.451 5.83269 13.5862 5.83334 13.8333 5.83334H15.4882L13.3333 3.67851Z"
  />
</svg>`,ArrowDownIcon=w`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M9.97678 11.318C9.96662 11.3111 9.94678 11.2967 9.9152 11.2699C9.82898 11.1967 9.71943 11.0881 9.52859 10.8972L6.39901 7.76763C6.08659 7.45521 5.58006 7.45521 5.26764 7.76763C4.95522 8.08005 4.95522 8.58658 5.26764 8.899L8.39722 12.0286C8.40353 12.0349 8.40982 12.0412 8.41611 12.0475C8.5813 12.2127 8.73751 12.3689 8.87972 12.4897C9.03447 12.621 9.22442 12.7566 9.46951 12.8363C9.81429 12.9483 10.1857 12.9483 10.5305 12.8363C10.7756 12.7566 10.9655 12.621 11.1203 12.4897C11.2625 12.3689 11.4187 12.2127 11.5839 12.0475L14.7323 8.899C15.0448 8.58658 15.0448 8.08005 14.7323 7.76763C14.4199 7.45521 13.9134 7.45521 13.601 7.76763L10.4714 10.8972C10.2806 11.0881 10.171 11.1967 10.0848 11.2699C10.0532 11.2967 10.0334 11.3111 10.0232 11.318C10.0079 11.3211 9.9921 11.3211 9.97678 11.318Z"
  />
</svg>`,paragraphButtons=[{key:"text",name:"Text",icon:TextIcon},{key:"h1",name:"Heading 1",icon:H1Icon},{key:"h2",name:"Heading 2",icon:H2Icon},{key:"h3",name:"Heading 3",icon:H3Icon},{key:"h4",name:"Heading 4",icon:H4Icon},{key:"h5",name:"Heading 5",icon:H5Icon},{key:"h6",name:"Heading 6",icon:H6Icon},{key:"bulleted",name:"Bulleted List",icon:BulletedListIcon},{key:"numbered",name:"Numbered List",icon:NumberedIcon},{key:"todo",name:"To-do List",icon:TodoIcon},{key:"code",name:"Code Block",icon:CodeIcon},{key:"quote",name:"Quote",icon:QuoteIcon},{key:"callout",name:"Callout",icon:CalloutIcon}],formatButtons=[{name:"Bold",icon:BoldIcon,activeWhen:q=>"bold"in q,action:q=>{handleFormat(q,"bold")}},{name:"Italic",icon:ItalicIcon,activeWhen:q=>"italic"in q,action:q=>{handleFormat(q,"italic")}},{name:"Underline",icon:UnderlineIcon,activeWhen:q=>"underline"in q,action:q=>{handleFormat(q,"underline")}},{name:"Strikethrough",icon:StrikethroughIcon,activeWhen:q=>"strike"in q,action:q=>{handleFormat(q,"strike")}},{name:"Code",icon:InlineCodeIcon,activeWhen:q=>"code"in q,action:q=>{handleFormat(q,"code")}},{name:"Link",icon:LinkIcon,activeWhen:q=>"link"in q,showWhen:q=>q.length===1,action:(q,B)=>{createLink(q),B.abort()}}],paragraphPanelStyle=i$5`
  .paragraph-button > svg:nth-child(2) {
    transition-duration: 0.3s;
  }
  .paragraph-button:is(:hover, :focus-visible, :active) > svg:nth-child(2) {
    transform: rotate(180deg);
  }

  .paragraph-panel {
    box-sizing: border-box;
    position: absolute;
    width: 173px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    padding: 8px 4px;

    background: var(--affine-popover-background);
    box-shadow: var(--affine-popover-shadow);
    border-radius: 0px 10px 10px 10px;
    z-index: var(--affine-z-index-popover);
  }
`,formatQuickBarStyle=i$5`
  .format-quick-bar {
    box-sizing: border-box;
    position: fixed;
    display: flex;
    align-items: center;
    padding: 4px 8px;
    gap: 4px;
    height: 40px;

    border-radius: 10px 10px 10px 0;
    background: var(--affine-popover-background);
    box-shadow: var(--affine-popover-shadow);
    z-index: var(--affine-z-index-popover);
  }

  .divider {
    width: 1px;
    height: 100%;
    background-color: #e0e6eb;
  }

  ${paragraphPanelStyle}
  ${toolTipStyle}
`;var __defProp$8=Object.defineProperty,__getOwnPropDesc$8=Object.getOwnPropertyDescriptor,__decorateClass$8=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$8(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$8(B,j,ee),ee};const isListType=q=>["bulleted","numbered","todo"].includes(q),onCopy=()=>{document.dispatchEvent(new ClipboardEvent("copy")),toast("Copied to clipboard")};let FormatQuickBar=class extends s$1{constructor(){super(...arguments),this.left=null,this.top=null,this.bottom=null,this.abortController=new AbortController,this.positionUpdated=new Signal,this.models=[],this.page=null,this.paragraphType="text",this.paragraphPanelHoverDelay=150,this.paragraphPanelTimer=0,this.showParagraphPanel="hidden",this.format={}}connectedCallback(){super.connectedCallback();const q=getModelsByRange(getCurrentRange());if(this.models=q,!q.length)return;this.format=getFormat();const B=q[0];this.paragraphType=B.type,this.page=B.page,q.length>1}onHover(){if(this.showParagraphPanel!=="hidden"){clearTimeout(this.paragraphPanelTimer);return}this.paragraphPanelTimer=window.setTimeout(async()=>{const q=this.formatQuickBarElement.getBoundingClientRect(),B=document.body.getBoundingClientRect(),j=q.top-B.top,X=B.bottom-q.bottom;this.showParagraphPanel=j>X?"top":"bottom"},this.paragraphPanelHoverDelay)}onHoverEnd(){if(this.showParagraphPanel!=="hidden"){this.paragraphPanelTimer=window.setTimeout(async()=>{this.showParagraphPanel="hidden"},this.paragraphPanelHoverDelay);return}clearTimeout(this.paragraphPanelTimer)}paragraphPanelTemplate(){if(this.showParagraphPanel==="hidden")return y``;const q=j=>{this.models.filter(X=>X.type!==j).forEach(async X=>{if(!this.page)throw new Error("Space is not defined");isListType(j)?convertToList(this.page,X,j,""):(this.page.updateBlock(X,{type:j}),await sleep(),this.positionUpdated.emit()),this.paragraphType=j})},B=i({left:"0",top:this.showParagraphPanel==="bottom"?"calc(100% + 4px)":null,bottom:this.showParagraphPanel==="top"?"calc(100% + 4px)":null,display:"flex",flexDirection:this.showParagraphPanel==="bottom"?"column":"column-reverse"});return y`<div
      class="paragraph-panel"
      style="${B}"
      @mouseover=${this.onHover}
      @mouseout=${this.onHoverEnd}
    >
      ${paragraphButtons.map(({key:j,name:X,icon:ee})=>y`<format-bar-button
          width="100%"
          style="padding-left: 12px; justify-content: flex-start;"
          text="${X}"
          @click=${()=>q(j)}
        >
          ${ee}
        </format-bar-button>`)}
    </div>`}render(){var re,ie;const q=this.page;if(!this.models.length||!q)return console.error("Failed to render format-quick-bar! space not found!"),y``;const B=(ie=(re=paragraphButtons.find(fe=>fe.key===this.paragraphType))==null?void 0:re.icon)!=null?ie:paragraphButtons[0].icon,j=y`<format-bar-button
      class="paragraph-button"
      width="52px"
      @mouseover=${this.onHover}
      @mouseout=${this.onHoverEnd}
    >
      ${B} ${ArrowDownIcon}
    </format-bar-button>`,X=this.paragraphPanelTemplate(),ee=y`
      ${formatButtons.filter(({showWhen:fe=()=>!0})=>fe(this.models)).map(({name:fe,icon:ce,action:se,activeWhen:oe})=>y`<format-bar-button
            class="has-tool-tip"
            ?active=${oe(this.format)}
            @click=${()=>{se(q,this.abortController),this.format=getFormat()}}
          >
            ${ce}
            <tool-tip inert role="tooltip">${fe}</tool-tip>
          </format-bar-button>`)}
    `,te=y`<format-bar-button
      class="has-tool-tip"
      @click=${()=>onCopy()}
    >
      ${CopyIcon}
      <tool-tip inert role="tooltip">Copy</tool-tip>
    </format-bar-button>`,ne=i({left:this.left,top:this.top,bottom:this.bottom});return y`<div class="format-quick-bar" style="${ne}">
      ${j}
      <div class="divider"></div>
      ${ee}
      <div class="divider"></div>
      ${te} ${X}
    </div>`}};FormatQuickBar.styles=formatQuickBarStyle;__decorateClass$8([e$1()],FormatQuickBar.prototype,"left",2);__decorateClass$8([e$1()],FormatQuickBar.prototype,"top",2);__decorateClass$8([e$1()],FormatQuickBar.prototype,"bottom",2);__decorateClass$8([e$1()],FormatQuickBar.prototype,"abortController",2);__decorateClass$8([e$1()],FormatQuickBar.prototype,"positionUpdated",2);__decorateClass$8([t$1()],FormatQuickBar.prototype,"models",2);__decorateClass$8([t$1()],FormatQuickBar.prototype,"page",2);__decorateClass$8([t$1()],FormatQuickBar.prototype,"paragraphType",2);__decorateClass$8([e$1()],FormatQuickBar.prototype,"paragraphPanelHoverDelay",2);__decorateClass$8([t$1()],FormatQuickBar.prototype,"paragraphPanelTimer",2);__decorateClass$8([t$1()],FormatQuickBar.prototype,"showParagraphPanel",2);__decorateClass$8([t$1()],FormatQuickBar.prototype,"format",2);__decorateClass$8([i$2(".format-quick-bar")],FormatQuickBar.prototype,"formatQuickBarElement",2);FormatQuickBar=__decorateClass$8([e$2("format-quick-bar")],FormatQuickBar);const showFormatQuickBar=async({anchorEl:q,direction:B="right-bottom",container:j=document.body,abortController:X=new AbortController})=>{const ee=document.createElement("format-quick-bar");ee.abortController=X;const te=new Signal;ee.positionUpdated=te;const ne=getModelsByRange(getCurrentRange());if(!ne.length)return;const ie=getContainerByModel(ne[0]).querySelector(".affine-default-viewport"),fe=()=>{const se=q.getBoundingClientRect(),oe=document.body.getBoundingClientRect(),ae=5;if(ee.left=`${se.left}px`,B.includes("bottom")){const le=se.top-oe.top+se.height;ee.top=`${le+ae}px`}else if(B.includes("top")){const le=oe.bottom-se.bottom+se.height;ee.bottom=`${le+ae}px`}};ie==null||ie.addEventListener("scroll",fe,{passive:!0}),te.on(fe),fe();const ce=se=>{se.target!==ee&&(X.abort(),window.removeEventListener("mousedown",ce))};return window.addEventListener("mousedown",ce),j.appendChild(ee),new Promise(se=>{X.signal.addEventListener("abort",()=>{ee.remove(),ie==null||ie.removeEventListener("scroll",fe),se()})})};function intersects(q,B){return q.left<B.right&&q.right>B.left&&q.top<B.bottom&&q.bottom>B.top}function filterSelectedRichText(q,B){return Array.from(q.keys()).filter(X=>{const ee=X.getBoundingClientRect();return intersects(ee,B)})}function createSelectionRect(q,B){const j=Math.abs(q.x-B.x),X=Math.abs(q.y-B.y),ee=Math.min(q.x,B.x),te=Math.min(q.y,B.y);return new DOMRect(ee,te,j,X)}class PageSelectionState{constructor(B){this.selectedRichTexts=[],this._startRange=null,this._startPoint=null,this._richTextCache=new Map,this.type=B}get startRange(){return this._startRange}get startPoint(){return this._startPoint}get richTextCache(){return this._richTextCache}resetStartRange(B){this._startRange=caretRangeFromPoint(B.raw.clientX,B.raw.clientY),this._startPoint={x:B.raw.clientX,y:B.raw.clientY}}refreshRichTextBoundsCache(B){Array.from(B.querySelectorAll("rich-text")).forEach(X=>{const ee=X.getBoundingClientRect();this._richTextCache.set(X,ee)})}clear(){this.type="none",this._richTextCache.clear(),this._startRange=null,this._startPoint=null,this.selectedRichTexts=[]}}class DefaultSelectionManager{constructor(B,j,X){this.state=new PageSelectionState("none"),this._onContainerDragStart=ee=>{this.state.resetStartRange(ee),!isPageTitle(ee.raw)&&(isBlankArea(ee)?this._onBlockSelectionDragStart(ee):this._onNativeSelectionDragStart(ee))},this._onContainerDragMove=ee=>{this.state.type==="native"?this._onNativeSelectionDragMove(ee):this.state.type==="block"&&this._onBlockSelectionDragMove(ee)},this._onContainerDragEnd=ee=>{this.state.type==="native"?this._onNativeSelectionDragEnd(ee):this.state.type==="block"&&this._onBlockSelectionDragEnd(ee),this._showFormatQuickBar(ee)},this._onContainerClick=ee=>{this.state.clear(),this._signals.updateSelectedRects.emit([]),ee.raw.target.tagName!=="DEBUG-MENU"&&(ee.raw.target instanceof HTMLInputElement||ee.keys.shift||handleNativeRangeClick(this.page,ee))},this._onContainerDblClick=ee=>{this.state.clear(),this._signals.updateSelectedRects.emit([]),ee.raw.target.tagName!=="DEBUG-MENU"&&(ee.raw.target instanceof HTMLInputElement||handleNativeRangeDblClick(this.page))},this._onContainerContextMenu=ee=>{repairContextMenuRange(ee)},this._onContainerMouseMove=ee=>{},this._onContainerMouseOut=ee=>{},this.page=B,this._signals=X,this._container=j,this._mouseDisposeCallback=initMouseEventHandlers(this._container,this._onContainerDragStart,this._onContainerDragMove,this._onContainerDragEnd,this._onContainerClick,this._onContainerDblClick,this._onContainerMouseMove,this._onContainerMouseOut,this._onContainerContextMenu)}_onBlockSelectionDragStart(B){this.state.type="block",this.state.resetStartRange(B),this.state.refreshRichTextBoundsCache(this._container),resetNativeSelection(null)}_onBlockSelectionDragMove(B){assertExists(this.state.startPoint);const{selectionRect:j,richTextCache:X,selectedRichTexts:ee}=this._getSelectedBlockInfo(B);this.state.selectedRichTexts=ee;const te=ee.map(ne=>X.get(ne));this._signals.updateSelectedRects.emit(te),this._signals.updateFrameSelectionRect.emit(j)}_getSelectedBlockInfo(B){assertExists(this.state.startPoint);const j={x:B.raw.clientX,y:B.raw.clientY},{startPoint:X}=this.state,ee=createSelectionRect(j,X),{richTextCache:te}=this.state,ne=filterSelectedRichText(te,ee);return{selectionRect:ee,richTextCache:te,selectedRichTexts:ne}}_onBlockSelectionDragEnd(B){this._signals.updateFrameSelectionRect.emit(null)}_onNativeSelectionDragStart(B){this.state.type="native"}_onNativeSelectionDragMove(B){handleNativeRangeDragMove(this.state.startRange,B)}_onNativeSelectionDragEnd(B){}_showFormatQuickBar(B){if(this.state.type==="native"){const{anchor:j,direction:X,selectedType:ee}=getNativeSelectionMouseDragInfo(B);if(ee==="Caret")return;showFormatQuickBar({anchorEl:j,direction:X})}else this.state.type}dispose(){this._signals.updateSelectedRects.dispose(),this._signals.updateFrameSelectionRect.dispose(),this._mouseDisposeCallback()}selectBlockByRect(B){this.state.type="block",this.state.refreshRichTextBoundsCache(this._container);const{richTextCache:j}=this.state,X=filterSelectedRichText(j,B);this.state.selectedRichTexts=X;const ee=[B];this._signals.updateSelectedRects.emit(ee)}}const style$5=`.affine-default-viewport{overflow-x:hidden;overflow-y:auto;height:100%}.affine-default-page-block-container{font-family:var(--affine-font-family);font-size:var(--affine-font-base);line-height:var(--affine-line-height-base);color:var(--affine-text-color);font-weight:400;width:720px;margin:0 auto;cursor:default;min-height:calc(100% - 78px);height:auto;overflow:hidden;padding-bottom:150px}.affine-default-page-block-container>.affine-block-children-container{padding-left:0}.affine-default-page-block-title{width:100%;font-size:40px;line-height:50px;font-weight:700;outline:none;border:0;font-family:inherit;color:inherit}.affine-default-page-block-title::placeholder{color:var(--affine-placeholder-color)}.affine-default-page-block-title-container{margin-top:78px}
`;var __defProp$7=Object.defineProperty,__getOwnPropDesc$7=Object.getOwnPropertyDescriptor,__decorateClass$7=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$7(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$7(B,j,ee),ee};function focusTextEnd(q){const B=q.value;q.focus(),q.value="",q.value=B}function FrameSelectionRect(q){if(q===null)return y``;const B={left:q.left+"px",top:q.top+"px",width:q.width+"px",height:q.height+"px"};return y`
    <style>
      .affine-page-frame-selection-rect {
        position: absolute;
        background: var(--affine-selected-color);
        z-index: 1;
        pointer-events: none;
      }
    </style>
    <div
      class="affine-page-frame-selection-rect"
      style=${i(B)}
    ></div>
  `}function SelectedRectsContainer(q){return y`
    <style>
      .affine-page-selected-rects-container > div {
        position: fixed;
        background: var(--affine-selected-color);
        z-index: 1;
        pointer-events: none;
        border-radius: 5px;
      }
    </style>
    <div class="affine-page-selected-rects-container">
      ${q.map(B=>{const j={display:"block",left:B.left+"px",top:B.top+"px",width:B.width+"px",height:B.height+"px"};return y`<div style=${i(j)}></div>`})}
    </div>
  `}let DefaultPageBlockComponent=class extends s$1{constructor(){super(...arguments),this.flavour="affine:page",this.lastSelectionPosition="start",this.frameSelectionRect=null,this.selectedRects=[],this.signals={updateFrameSelectionRect:new Signal,updateSelectedRects:new Signal},this.isCompositionStart=!1,this._handleCompositionStart=()=>{this.isCompositionStart=!0},this._handleCompositionEnd=()=>{this.isCompositionStart=!1}}_bindHotkeys(){const{page:q}=this,{BACKSPACE:B,SELECT_ALL:j,H1:X,H2:ee,H3:te,H4:ne,H5:re,H6:ie,SHIFT_UP:fe,SHIFT_DOWN:ce,NUMBERED_LIST:se,BULLETED:oe,TEXT:ae}=HOTKEYS;bindCommonHotkey(q),hotkey.addListener(B,le=>{const{state:pe}=this.selection;if(isPageTitle(le)){const ve=le.target;if(ve.selectionStart!==ve.selectionEnd){le.preventDefault();const ge=getSplicedTitle(ve);q.updateBlock(this.model,{title:ge})}return}if(pe.type==="native")handleBackspace(q,le);else if(pe.type==="block"){const{selectedRichTexts:ve}=pe;handleBlockSelectionBatchDelete(q,ve.map(ge=>ge.model)),pe.clear(),this.signals.updateSelectedRects.emit([])}}),hotkey.addListener(j,le=>{le.preventDefault(),handleSelectAll(),this.selection.state.type="native"}),hotkey.addListener(X,()=>this._updateType("affine:paragraph","h1",q)),hotkey.addListener(ee,()=>this._updateType("affine:paragraph","h2",q)),hotkey.addListener(te,()=>this._updateType("affine:paragraph","h3",q)),hotkey.addListener(ne,()=>this._updateType("affine:paragraph","h4",q)),hotkey.addListener(re,()=>this._updateType("affine:paragraph","h5",q)),hotkey.addListener(ie,()=>this._updateType("affine:paragraph","h6",q)),hotkey.addListener(se,()=>this._updateType("affine:list","numbered",q)),hotkey.addListener(oe,()=>this._updateType("affine:list","bulleted",q)),hotkey.addListener(ae,()=>this._updateType("affine:paragraph","text",q)),hotkey.addListener(fe,le=>{}),hotkey.addListener(ce,le=>{})}_removeHotkeys(){removeCommonHotKey(),hotkey.removeListener([HOTKEYS.BACKSPACE,HOTKEYS.SELECT_ALL,HOTKEYS.H1,HOTKEYS.H2,HOTKEYS.H3,HOTKEYS.H4,HOTKEYS.H5,HOTKEYS.H6,HOTKEYS.SHIFT_UP,HOTKEYS.SHIFT_DOWN,HOTKEYS.BULLETED,HOTKEYS.NUMBERED_LIST,HOTKEYS.TEXT])}_onTitleKeyDown(q){const B=!this.page.isEmpty;if(q.key==="Enter"&&B){assertExists(this._title.selectionStart);const j=this._title.selectionStart,X=this._title.value.slice(0,j),ee=this._title.value.slice(j),te=this.model.children[0],ne={flavour:"affine:paragraph",text:new Text$1(this.page,ee)},re=this.page.addBlock(ne,te,0);this.page.updateBlock(this.model,{title:X}),asyncFocusRichText(this.page,re)}else q.key==="ArrowDown"&&B&&(q.preventDefault(),asyncFocusRichText(this.page,this.model.children[0].children[0].id))}_onTitleInput(q){const{page:B}=this;if(!this.model.id){const X=q.target.value,ee=B.addBlock({flavour:"affine:page",title:X}),te=B.addBlock({flavour:"affine:group"},ee);B.addBlock({flavour:"affine:paragraph"},te);return}const j=q.target.value;B.updateBlock(this.model,{title:j})}_updateType(q,B,j){const{state:X}=this.selection;X.selectedRichTexts.length>0?batchUpdateTextType(q,j,X.selectedRichTexts.map(ee=>ee.model),B):updateTextType(q,B,j)}_clearSelection(){this.selection.state.clear(),this.signals.updateSelectedRects.emit([])}createRenderRoot(){return this}update(q){q.has("mouseRoot")&&q.has("page")&&(this.selection=new DefaultSelectionManager(this.page,this.mouseRoot,this.signals)),super.update(q)}firstUpdated(){this._bindHotkeys(),hotkey.enableHotkey(),this.model.propsUpdated.on(()=>{this.model.title!==this._title.value&&(this._title.value=this.model.title||"",this.requestUpdate())}),this.signals.updateFrameSelectionRect.on(j=>{this.frameSelectionRect=j,this.requestUpdate()}),this.signals.updateSelectedRects.on(j=>{this.selectedRects=j,this.requestUpdate()}),tryUpdateGroupSize(this.page,1),this.addEventListener("keydown",j=>{j.ctrlKey||j.metaKey||j.shiftKey||tryUpdateGroupSize(this.page,1)});const q=this.mouseRoot.querySelector(".affine-default-viewport"),B=Signal.fromEvent(q,"scroll");this._scrollDisposable=B.on(()=>this._clearSelection()),window.addEventListener("compositionstart",this._handleCompositionStart),window.addEventListener("compositionend",this._handleCompositionEnd),focusTextEnd(this._title)}disconnectedCallback(){super.disconnectedCallback(),this._removeHotkeys(),this._scrollDisposable.dispose(),this.selection.dispose(),window.removeEventListener("compositionstart",this._handleCompositionStart),window.removeEventListener("compositionend",this._handleCompositionEnd)}render(){this.setAttribute(BLOCK_ID_ATTR,this.model.id);const q=BlockChildrenContainer(this.model,this),B=FrameSelectionRect(this.frameSelectionRect),j=SelectedRectsContainer(this.selectedRects);return y`
      <div class="affine-default-viewport">
        <div class="affine-default-page-block-container">
          <div class="affine-default-page-block-title-container">
            <input
              placeholder="Title"
              class="affine-default-page-block-title"
              value=${this.model.title}
              @keydown=${this._onTitleKeyDown}
              @input=${this._onTitleInput}
            />
          </div>
          ${q}
        </div>
        ${B} ${j}
      </div>
    `}};DefaultPageBlockComponent.styles=i$5`
    ${r$3(style$5)}
  `;__decorateClass$7([e$1()],DefaultPageBlockComponent.prototype,"page",2);__decorateClass$7([e$1()],DefaultPageBlockComponent.prototype,"mouseRoot",2);__decorateClass$7([t$1()],DefaultPageBlockComponent.prototype,"frameSelectionRect",2);__decorateClass$7([t$1()],DefaultPageBlockComponent.prototype,"selectedRects",2);__decorateClass$7([e$1({hasChanged(){return!0}})],DefaultPageBlockComponent.prototype,"model",2);__decorateClass$7([i$2(".affine-default-page-block-title")],DefaultPageBlockComponent.prototype,"_title",2);DefaultPageBlockComponent=__decorateClass$7([e$2("default-page-block")],DefaultPageBlockComponent);const PADDING_X=48,PADDING_Y=48;function isPointIn(q,B,j){const X=JSON.parse(q.xywh),[ee,te,ne,re]=X,ie=ne+PADDING_X,fe=re+PADDING_Y;return ee<B&&B<=ee+ie&&te<j&&j<=te+fe}function pick(q,B,j){for(let X=q.length-1;X>=0;X--)if(isPointIn(q[X],B,j))return q[X];return null}function getSelectionBoxBound(q,B){const[j,X,ee,te]=JSON.parse(B),[ne,re]=q.toViewCoord(j,X);return new DOMRect(ne,re,ee*q.zoom,te*q.zoom)}function initWheelEventHandlers(q){const B=X=>{X.preventDefault();const{viewport:ee}=q;if(X.ctrlKey){const te=X.deltaX!==0?-X.deltaX:-X.deltaY;ee.applyDeltaZoom(te),q.signals.viewportUpdated.emit()}else{const te=X.deltaX/ee.zoom,ne=X.deltaY/ee.zoom;ee.applyDeltaCenter(te,ne),q.signals.viewportUpdated.emit()}};return q.addEventListener("wheel",B),()=>q.removeEventListener("wheel",B)}function getCommonRectStyle(q,B){return{position:"absolute",left:q.x+"px",top:q.y+"px",width:q.width+PADDING_X*B+"px",height:q.height+PADDING_Y*B+"px",borderRadius:`${10*B}px`,pointerEvents:"none",boxSizing:"border-box"}}function EdgelessHoverRect(q,B){if(!q)return y`<div></div>`;const j={...getCommonRectStyle(q,B),border:"1px solid var(--affine-primary-color)"};return y`
    <div class="affine-edgeless-hover-rect" style=${i(j)}></div>
  `}function Handle(q,B){const j={position:"absolute",left:q-6+"px",top:B-6+"px",width:"12px",height:"12px",borderRadius:"6px",zIndex:"10",border:"2px var(--affine-primary-color) solid",background:"white",cursor:"not-allowed"};return y` <div style=${i(j)}></div> `}function EdgelessSelectedRect(q,B){const j=q.blockSelectionState,{type:X}=j;if(X==="none")return y``;const{rect:ee}=j,te={border:`${j.active?2:1}px solid var(--affine-primary-color)`,...getCommonRectStyle(ee,B)};let ne=null;if(!j.active){const re=[ee.x,ee.y+ee.height/2+PADDING_Y*B/2],ie=[ee.x+ee.width+PADDING_X*B,ee.y+ee.height/2+PADDING_Y*B/2],fe=Handle(re[0],re[1]),ce=Handle(ie[0],ie[1]);ne=y` ${fe}${ce} `}return y`
    ${ne}
    <div class="affine-edgeless-selected-rect" style=${i(te)}></div>
  `}function EdgelessFrameSelectionRect(q){if(q===null)return y``;const B={left:q.left+"px",top:q.top+"px",width:q.width+"px",height:q.height+"px"};return y`
    <style>
      .affine-edgeless-frame-selection-rect {
        position: absolute;
        background: var(--affine-selected-color);
        z-index: 1;
        pointer-events: none;
      }
    </style>
    <div
      class="affine-edgeless-frame-selection-rect"
      style=${i(B)}
    ></div>
  `}function EdgelessBlockChild(q,B,j){const{xywh:X}=q,{zoom:ee,viewportX:te,viewportY:ne}=j,[re,ie,fe,ce]=JSON.parse(X),se=(re-te)*ee,oe=(ie-ne)*ee,ae={position:"absolute",transform:`translate(${se}px, ${oe}px) scale(${ee})`,transformOrigin:"0 0",width:fe+PADDING_X+"px",height:ce+PADDING_Y+"px",padding:`${PADDING_X/2}px`,background:"white"};return y`
    <div class="affine-edgeless-block-child" style=${i(ae)}>
      ${BlockElement(q,B)}
    </div>
  `}function EdgelessBlockChildrenContainer(q,B,j){const{zoom:X,viewportX:ee,viewportY:te}=j,ne=-ee*X,re=-te*X,ie={backgroundImage:"linear-gradient(#cccccc66 1px, transparent 1px),linear-gradient(90deg, #cccccc66 1px, transparent 1px)"},fe={},se=location.href.includes("grid")?ie:fe;return y`
    <style>
      .affine-block-children-container.edgeless {
        padding-left: 0;
        position: relative;
        overflow: hidden;
        height: 100%;

        /* background-image: linear-gradient(#cccccc66 1px, transparent 1px),
          linear-gradient(90deg, #cccccc66 1px, transparent 1px); */
        background-size: ${20*j.zoom}px ${20*j.zoom}px;
        background-position: ${ne}px ${re}px;
        background-color: #fff;
      }
    </style>
    <div
      class="affine-block-children-container edgeless"
      style=${i(se)}
    >
      ${c(q.children,oe=>oe.id,oe=>EdgelessBlockChild(oe,B,j))}
    </div>
  `}const MIN_ZOOM=.3;class ViewportState{constructor(){this._width=0,this._height=0,this._zoom=1,this._centerX=0,this._centerY=0}get zoom(){return this._zoom}get centerX(){return this._centerX}get centerY(){return this._centerY}get viewportX(){return this._centerX-this._width/2/this._zoom}get viewportY(){return this._centerY-this._height/2/this._zoom}get width(){return this._width}get height(){return this._height}toModelCoord(B,j){return[this.viewportX+B/this._zoom,this.viewportY+j/this._zoom]}toViewCoord(B,j){return[(B-this.viewportX)*this._zoom,(j-this.viewportY)*this._zoom]}setSize(B,j){this._width=B,this._height=j}setZoom(B){this._zoom=B}applyDeltaZoom(B){const j=this.zoom*(100+B)/100,X=Math.max(j,MIN_ZOOM);this.setZoom(X)}applyDeltaCenter(B,j){this._centerX+=B,this._centerY+=j}setCenter(B,j){this._centerX=B,this._centerY=j}}class EdgelessSelectionManager{constructor(B){this._blockSelectionState={type:"none"},this._startRange=null,this._hoverState=null,this._frameSelectionState=null,this._onContainerDragStart=j=>{const{viewport:X}=this._container,[ee,te]=X.toModelCoord(j.x,j.y),ne=pick(this._blocks,ee,te);ne?this._handleClickOnSelected(ne,j):(this._blockSelectionState={type:"none"},this._frameSelectionState={start:new DOMPoint(j.raw.x,j.raw.y),end:new DOMPoint(j.raw.x,j.raw.y)},this._container.signals.updateSelection.emit(this.blockSelectionState),resetNativeSelection(null)),this._startRange=caretRangeFromPoint(j.raw.clientX,j.raw.clientY)},this._onContainerDragMove=j=>{switch(this.blockSelectionState.type){case"none":break;case"single":if(this.blockSelectionState.active)handleNativeRangeDragMove(this._startRange,j);else if(!this._frameSelectionState){const X=this.blockSelectionState.selected,[ee,te,ne,re]=JSON.parse(X.xywh),{zoom:ie}=this._container.viewport;this._space.updateBlock(X,{xywh:JSON.stringify([ee+j.delta.x/ie,te+j.delta.y/ie,ne,re])}),this._container.signals.updateSelection.emit(this.blockSelectionState)}break}this._frameSelectionState&&this._updateFrameSelectionState(j.raw.x,j.raw.y)},this._onContainerDragEnd=j=>{if(this.isActive){const{anchor:X,direction:ee,selectedType:te}=getNativeSelectionMouseDragInfo(j);if(te==="Caret")return;showFormatQuickBar({anchorEl:X,direction:ee})}this._frameSelectionState=null},this._onContainerClick=j=>{const{viewport:X}=this._container,[ee,te]=X.toModelCoord(j.x,j.y),ne=pick(this._blocks,ee,te);ne?this._handleClickOnSelected(ne,j):(this._blockSelectionState={type:"none"},this._container.signals.updateSelection.emit(this.blockSelectionState),resetNativeSelection(null))},this._onContainerDblClick=j=>{},this._onContainerMouseMove=j=>{const{viewport:X}=this._container,[ee,te]=X.toModelCoord(j.x,j.y),ne=pick(this._blocks,ee,te);this._updateHoverState(ne),this._container.signals.hoverUpdated.emit()},this._onContainerMouseOut=j=>{},this._onContainerContextMenu=j=>{repairContextMenuRange(j)},this._container=B,this._mouseDisposeCallback=initMouseEventHandlers(this._container,this._onContainerDragStart,this._onContainerDragMove,this._onContainerDragEnd,this._onContainerClick,this._onContainerDblClick,this._onContainerMouseMove,this._onContainerMouseOut,this._onContainerContextMenu),this._wheelDisposeCallback=initWheelEventHandlers(B)}get blockSelectionState(){return this._blockSelectionState}get hoverRect(){return this._hoverState?this._hoverState.rect:null}get frameSelectionRect(){if(!this._frameSelectionState)return null;const{start:B,end:j}=this._frameSelectionState,X=Math.min(B.x,j.x),ee=Math.min(B.y,j.y),te=Math.max(B.x,j.x),ne=Math.max(B.y,j.y);return new DOMRect(X,ee,te-X,ne-ee)}get _space(){return this._container.page}get _blocks(){var B,j;return(j=(B=this._space.root)==null?void 0:B.children)!=null?j:[]}get isActive(){return this._blockSelectionState.type==="single"&&this._blockSelectionState.active}_updateFrameSelectionState(B,j){this._frameSelectionState&&(this._frameSelectionState.end=new DOMPoint(B,j)),this._hoverState&&(this._blockSelectionState={type:"single",selected:this._hoverState.block,rect:this._hoverState.rect,active:!1})}_updateHoverState(B){B?this._hoverState={rect:getSelectionBoxBound(this._container.viewport,B.xywh),block:B}:this._hoverState=null}_handleClickOnSelected(B,j){const{viewport:X}=this._container;switch(this.blockSelectionState.type){case"none":this._blockSelectionState={type:"single",active:!1,selected:B,rect:getSelectionBoxBound(X,B.xywh)},this._container.signals.updateSelection.emit(this.blockSelectionState);break;case"single":this.blockSelectionState.selected===B?(this.blockSelectionState.active=!0,this._container.signals.updateSelection.emit(this.blockSelectionState)):(this._blockSelectionState={type:"single",active:!1,selected:B,rect:getSelectionBoxBound(X,B.xywh)},this._container.signals.updateSelection.emit(this.blockSelectionState)),handleNativeRangeClick(this._space,j);break}}syncBlockSelectionRect(){var B;if(this.blockSelectionState.type==="single"){const j=getSelectionBoxBound(this._container.viewport,this.blockSelectionState.selected.xywh);this.blockSelectionState.rect=j}this._updateHoverState(((B=this._hoverState)==null?void 0:B.block)||null),this._container.signals.updateSelection.emit(this.blockSelectionState)}dispose(){this._mouseDisposeCallback(),this._wheelDisposeCallback()}}const style$4=`.affine-edgeless-page-block-container{position:relative;box-sizing:border-box;overflow:hidden;height:100%;font-family:var(--affine-font-family);font-size:var(--affine-font-base);line-height:var(--affine-line-height-base);color:var(--affine-edgeless-text-color);font-weight:400}
`;var __defProp$6=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$6(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$6(B,j,ee),ee};let EdgelessPageBlockComponent=class extends s$1{constructor(){super(...arguments),this.flavour="edgeless",this.viewport=new ViewportState,this.signals={viewportUpdated:new Signal,updateSelection:new Signal,hoverUpdated:new Signal}}_bindHotkeys(){const{page:q}=this;hotkey.addListener(HOTKEYS.BACKSPACE,this._handleBackspace.bind(this)),hotkey.addListener(HOTKEYS.H1,()=>this._updateType("affine:paragraph","h1",q)),hotkey.addListener(HOTKEYS.H2,()=>this._updateType("affine:paragraph","h2",q)),hotkey.addListener(HOTKEYS.H3,()=>this._updateType("affine:paragraph","h3",q)),hotkey.addListener(HOTKEYS.H4,()=>this._updateType("affine:paragraph","h4",q)),hotkey.addListener(HOTKEYS.H5,()=>this._updateType("affine:paragraph","h5",q)),hotkey.addListener(HOTKEYS.H6,()=>this._updateType("affine:paragraph","h6",q)),hotkey.addListener(HOTKEYS.NUMBERED_LIST,()=>this._updateType("affine:list","numbered",q)),hotkey.addListener(HOTKEYS.BULLETED,()=>this._updateType("affine:list","bulleted",q)),hotkey.addListener(HOTKEYS.TEXT,()=>this._updateType("affine:paragraph","text",q)),bindCommonHotkey(q)}_updateType(q,B,j){updateTextType(q,B,j)}_removeHotkeys(){hotkey.removeListener([HOTKEYS.BACKSPACE,HOTKEYS.H1,HOTKEYS.H2,HOTKEYS.H3,HOTKEYS.H4,HOTKEYS.H5,HOTKEYS.H6,HOTKEYS.SHIFT_DOWN,HOTKEYS.NUMBERED_LIST,HOTKEYS.BULLETED,HOTKEYS.TEXT],this.flavour),removeCommonHotKey()}_handleBackspace(q){this._selection.blockSelectionState.type==="single"&&handleBackspace(this.page,q)}_initViewport(){const q=this.mouseRoot.getBoundingClientRect();this.viewport.setSize(q.width,q.height);const B=this.model.children[0],[j,X,ee,te]=JSON.parse(B.xywh);this.viewport.setCenter(j+ee/2,X+te/2)}_clearSelection(){requestAnimationFrame(()=>{this._selection.isActive||resetNativeSelection(null)})}createRenderRoot(){return this}update(q){q.has("mouseRoot")&&q.has("page")&&(this._selection=new EdgelessSelectionManager(this)),super.update(q)}firstUpdated(){this.model.children.forEach(q=>{q.propsUpdated.on(()=>this._selection.syncBlockSelectionRect())}),this.signals.viewportUpdated.on(()=>this._selection.syncBlockSelectionRect()),this.signals.hoverUpdated.on(()=>this.requestUpdate()),this.signals.updateSelection.on(()=>this.requestUpdate()),this._historyDisposable=this.page.signals.historyUpdated.on(()=>{this._clearSelection()}),this._bindHotkeys(),this.addEventListener("keydown",q=>{q.ctrlKey||q.metaKey||q.shiftKey||tryUpdateGroupSize(this.page,this.viewport.zoom)}),requestAnimationFrame(()=>{this._initViewport(),this.requestUpdate()}),this._clearSelection()}disconnectedCallback(){super.disconnectedCallback(),this.signals.updateSelection.dispose(),this.signals.viewportUpdated.dispose(),this.signals.hoverUpdated.dispose(),this._historyDisposable.dispose(),this._selection.dispose(),this._removeHotkeys()}render(){this.setAttribute(BLOCK_ID_ATTR,this.model.id);const q=EdgelessBlockChildrenContainer(this.model,this,this.viewport),{_selection:B}=this,{frameSelectionRect:j}=B,{zoom:X}=this.viewport,ee=EdgelessSelectedRect(B,X),te=EdgelessFrameSelectionRect(j),ne=EdgelessHoverRect(B.hoverRect,X);return y`
      <style></style>
      <div class="affine-edgeless-page-block-container">
        ${q} ${ne} ${te} ${ee}
      </div>
    `}};EdgelessPageBlockComponent.styles=i$5`
    ${r$3(style$4)}
  `;__decorateClass$6([e$1()],EdgelessPageBlockComponent.prototype,"page",2);__decorateClass$6([e$1()],EdgelessPageBlockComponent.prototype,"mouseRoot",2);__decorateClass$6([e$1({hasChanged(){return!0}})],EdgelessPageBlockComponent.prototype,"model",2);__decorateClass$6([t$1()],EdgelessPageBlockComponent.prototype,"viewport",2);EdgelessPageBlockComponent=__decorateClass$6([e$2("edgeless-page-block")],EdgelessPageBlockComponent);class PageBlockModel extends BaseBlockModel{constructor(B,j){var X;super(B,j),this.flavour="affine:page",this.title="",this.title=(X=j.title)!=null?X:""}block2html(B,j,X,ee,te){return`<div>${this.title}${B}</div>`}block2Text(B,j,X){return`${(this.title||"").slice(j||0,X)}${B}`}}var __defProp$5=Object.defineProperty,__getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$5(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$5(B,j,ee),ee};let CounterBlock=class extends s$1{constructor(){super(),this.count=0}async _notify(){this.count++,await this.updateComplete;const q={detail:this.count,bubbles:!0,composed:!0};this.dispatchEvent(new CustomEvent("block-count-update",q))}render(){return y` <div @click=${this._notify}>${this.count}</div> `}};__decorateClass$5([e$1()],CounterBlock.prototype,"count",2);CounterBlock=__decorateClass$5([e$2("counter-block")],CounterBlock);const style$3=`.affine-paragraph-block-container{border-radius:5px}.affine-paragraph-block-container.selected{background-color:var(--affine-selected-color)}.h1{font-size:calc(var(--affine-font-base) + 12px);line-height:calc(var(--affine-line-height-base) + 14px);margin-top:calc(var(--affine-paragraph-space) + 20px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h1 code{font-size:calc(var(--affine-font-base) + 8px)}.h2{font-size:calc(var(--affine-font-base) + 10px);line-height:calc(var(--affine-line-height-base) + 12px);margin-top:calc(var(--affine-paragraph-space) + 18px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h2 code{font-size:calc(var(--affine-font-base) + 6px)}.h3{font-size:calc(var(--affine-font-base) + 8px);line-height:calc(var(--affine-line-height-base) + 10px);margin-top:calc(var(--affine-paragraph-space) + 16px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h3 code{font-size:calc(var(--affine-font-base) + 4px)}.h4{font-size:calc(var(--affine-font-base) + 6px);line-height:calc(var(--affine-line-height-base) + 8px);margin-top:calc(var(--affine-paragraph-space) + 14px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h4 code{font-size:calc(var(--affine-font-base) + 2px)}.h5{font-size:calc(var(--affine-font-base) + 4px);line-height:calc(var(--affine-line-height-base) + 4px);margin-top:calc(var(--affine-paragraph-space) + 12px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h5 code{font-size:calc(var(--affine-font-base))}.h6{font-size:calc(var(--affine-font-base) + 2px);line-height:calc(var(--affine-line-height-base) + 2px);margin-top:calc(var(--affine-paragraph-space) + 10px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h6 code{font-size:calc(var(--affine-font-base) - 2px)}.quote{font-size:18px;line-height:26px;padding-left:12px;margin-top:18px;position:relative}.quote:after{content:"";width:4px;height:100%;position:absolute;left:0;top:0;background:var(--affine-quote-color);border-radius:4px}.text{margin-top:var(--affine-paragraph-space);font-size:var(--affine-font-base)}strong{font-weight:600}code{background:var(--affine-code-background);color:var(--affine-code-color);font-family:var(--affine-font-family2);padding:0 5px;border-radius:5px;font-size:calc(var(--affine-font-base) - 4px)}u{text-decoration:none;border-bottom:1px solid var(--affine-text-color)}del{text-decoration:line-through}em{font-style:italic}
`;var __defProp$4=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$4(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$4(B,j,ee),ee};const getPlaceholder=q=>{const{type:B}=q;switch(B){case"h1":return"Heading 1";case"h2":return"Heading 2";case"h3":return"Heading 3";case"h4":return"Heading 4";case"h5":return"Heading 5";case"h6":return"Heading 6";default:return""}};let ParagraphBlockComponent=class extends s$1{createRenderRoot(){return this}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(BLOCK_ID_ATTR,this.model.id);const{type:q}=this.model,B=BlockChildrenContainer(this.model,this.host),j=getPlaceholder(this.model);return y`
      <div class="affine-paragraph-block-container ${q}">
        <rich-text
          .host=${this.host}
          .model=${this.model}
          .placeholder=${j}
        ></rich-text>
        ${B}
      </div>
    `}};ParagraphBlockComponent.styles=i$5`
    ${r$3(style$3)}
  `;__decorateClass$4([e$1({hasChanged(){return!0}})],ParagraphBlockComponent.prototype,"model",2);__decorateClass$4([e$1()],ParagraphBlockComponent.prototype,"host",2);ParagraphBlockComponent=__decorateClass$4([e$2("paragraph-block")],ParagraphBlockComponent);class ParagraphBlockModel extends BaseBlockModel{constructor(B,j){var X;super(B,j),this.flavour="affine:paragraph",this.type="text",this.type=(X=j.type)!=null?X:"text"}block2html(B,j,X,ee,te){const ne=super.block2html(B,j,X,ee,te);switch(this.type){case"text":return`<p>${ne}</p>`;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return`<${this.type}>${ne}</${this.type}>`;case"quote":return`<blockquote>${ne}</blockquote>`;default:return ne}}}const point1=()=>y`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <circle cx="12" cy="12" r="2" />
    </svg>
  `,point2=()=>y`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M12 13.5C12.8284 13.5 13.5 12.8284 13.5 12C13.5 11.1716 12.8284 10.5 12 10.5C11.1716 10.5 10.5 11.1716 10.5 12C10.5 12.8284 11.1716 13.5 12 13.5ZM12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14Z"
      />
    </svg>
  `,point3=()=>y`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path
        d="M11.6056 10.1634C11.8234 9.94555 12.1766 9.94555 12.3944 10.1634L13.8366 11.6056C14.0545 11.8234 14.0545 12.1766 13.8366 12.3944L12.3944 13.8366C12.1766 14.0545 11.8234 14.0545 11.6056 13.8366L10.1634 12.3944C9.94555 12.1766 9.94555 11.8234 10.1634 11.6056L11.6056 10.1634Z"
      />
    </svg>
  `,point4=()=>y`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M13.4422 12L12 10.5578L10.5578 12L12 13.4422L13.4422 12ZM12.3944 10.1634C12.1766 9.94555 11.8234 9.94555 11.6056 10.1634L10.1634 11.6056C9.94555 11.8234 9.94555 12.1766 10.1634 12.3944L11.6056 13.8366C11.8234 14.0545 12.1766 14.0545 12.3944 13.8366L13.8366 12.3944C14.0545 12.1766 14.0545 11.8234 13.8366 11.6056L12.3944 10.1634Z"
        fill="#7389FD"
      />
    </svg>
  `,checkboxChecked=()=>y`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7 4C5.34315 4 4 5.34315 4 7V17C4 18.6569 5.34315 20 7 20H17C18.6569 20 20 18.6569 20 17V7C20 5.34315 18.6569 4 17 4H7ZM17.5665 9.56473C17.8785 9.25181 17.8776 8.74528 17.5647 8.43336C17.2518 8.12144 16.7453 8.12225 16.4334 8.43517L10.3547 14.5333L7.56666 11.7352C7.2548 11.4222 6.74827 11.4213 6.43529 11.7331C6.1223 12.045 6.12139 12.5515 6.43325 12.8645L9.64626 16.0891C10.037 16.4813 10.672 16.4814 11.0629 16.0893L17.5665 9.56473Z"
        fill="#A6ABB7"
      />
    </svg>
  `,checkboxUnchecked=()=>y`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M17 5.6H7C6.2268 5.6 5.6 6.2268 5.6 7V17C5.6 17.7732 6.2268 18.4 7 18.4H17C17.7732 18.4 18.4 17.7732 18.4 17V7C18.4 6.2268 17.7732 5.6 17 5.6ZM7 4C5.34315 4 4 5.34315 4 7V17C4 18.6569 5.34315 20 7 20H17C18.6569 20 20 18.6569 20 17V7C20 5.34315 18.6569 4 17 4H7Z"
        fill="#A6ABB7"
      />
    </svg>
  `,points=[point1(),point2(),point3(),point4()];function number2letter(q){const B="a".charCodeAt(0),X="z".charCodeAt(0)-B+1;let ee="";for(;q>=0;)ee=String.fromCharCode(q%X+B)+ee,q=Math.floor(q/X)-1;return ee}function number2roman(q){const B={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let j="";for(const X in B)for(;q>=B[X];)j+=X,q-=B[X];return j}function getPrefix(q,B){const j=[()=>B+1,number2letter,()=>number2roman(B+1)];return j[q%j.length](B)}function getNumberPrefix({index:q,deep:B}){return`${getPrefix(B,q)} .`}function getListIcon({model:q,index:B,deep:j,onClick:X}){return y`<div
    class="affine-list-block__prefix ${q.type==="todo"?"affine-list-block__todo-prefix":""}"
    @click="${ee=>{X==null||X(ee)}}"
  >
    ${(()=>{switch(q.type){case"bulleted":return points[j%points.length];case"numbered":return getNumberPrefix({deep:j,index:B});case"todo":return q.checked?checkboxChecked():checkboxUnchecked();default:return""}})()}
  </div>`}const getIndex=(q,B)=>{var te;const j=((te=q.page.getParent(B))==null?void 0:te.children)||[],X=j.findIndex(ne=>ne===B);let ee=0;for(let ne=0;ne<X;ne++)j[ne].flavour===B.flavour&&j[ne].type===B.type?ee+=1:ee=0;return ee},getListDeep=(q,B)=>{let j=0,X=q.page.getParent(B);for(;(X==null?void 0:X.flavour)===B.flavour;)j++,X=q.page.getParent(X);return j},getListInfo=(q,B)=>{const j=getListDeep(q,B),X=getIndex(q,B);return{deep:j,index:X}},style$2=`.affine-list-block-container{box-sizing:border-box;border-radius:5px;margin-top:2px}.affine-list-block-container--first{margin-top:var(--affine-paragraph-space)}.affine-list-block-container .affine-list-block-container{margin-top:0}.affine-list-block-container.selected{background-color:var(--affine-selected-color)}.affine-list-rich-text-wrapper{display:flex}.affine-list-rich-text-wrapper rich-text{flex:1}.affine-list-block__prefix{flex-shrink:0;min-width:26px;height:26px;margin-top:3px;margin-right:4px;display:flex;align-items:center;justify-content:flex-start;color:var(--affine-code-color);font-size:14px;line-height:var(--affine-line-height-base);user-select:none}.affine-list-block__todo-prefix{cursor:pointer}.affine-list-block__todo{width:16px;height:16px;border-radius:4px;border:1px solid var(--affine-icon-color)}.affine-list-block__todo.affine-list-block__todo--active{background:var(--affine-icon-color)}.affine-list--checked{color:var(--affine-icon-color)}
`;var __defProp$3=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$3(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$3(B,j,ee),ee};function selectList(q){const B=getDefaultPageBlock(q).selection,j=getBlockElementByModel(q);if(!j)throw console.error("list block model:",q,"blockElement:",j),new Error("Failed to select list! blockElement not found!");const X=j.getBoundingClientRect();B.selectBlockByRect(X)}let ListBlockComponent=class extends s$1{createRenderRoot(){return this}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(BLOCK_ID_ATTR,this.model.id);const{deep:q,index:B}=getListInfo(this.host,this.model),j=getListIcon({model:this.model,deep:q,index:B,onClick:()=>{if(this.model.type!=="todo"){selectList(this.model);return}this.host.page.captureSync(),this.host.page.updateBlock(this.model,{checked:!this.model.checked})}}),X=BlockChildrenContainer(this.model,this.host);return y`
      <div
        class=${`affine-list-block-container ${B===0&&q===0?"affine-list-block-container--first":""}`}
      >
        <div
          class=${`affine-list-rich-text-wrapper ${this.model.checked?"affine-list--checked":""}`}
        >
          ${j}
          <rich-text .host=${this.host} .model=${this.model}></rich-text>
        </div>
        ${X}
      </div>
    `}};ListBlockComponent.styles=i$5`
    ${r$3(style$2)}
  `;__decorateClass$3([e$1({hasChanged(){return!0}})],ListBlockComponent.prototype,"model",2);__decorateClass$3([e$1()],ListBlockComponent.prototype,"host",2);ListBlockComponent=__decorateClass$3([e$2("list-block")],ListBlockComponent);class ListBlockModel extends BaseBlockModel{constructor(B,j){var X,ee;super(B,j),this.flavour="affine:list",this.type=(X=j.type)!=null?X:"bulleted",this.checked=(ee=j.checked)!=null?ee:!1}block2html(B,j,X,ee,te){let ne=super.block2html(B,j,X,ee,te);const re=this.page.getBlockById(j),ie=this.page.getBlockById(X);switch(this.type){case"bulleted":ne=`<li>${ne}</li>`;break;case"numbered":ne=`<li>${ne}</li>`;break;case"todo":ne=`<li><input disabled type="checkbox" ${this.checked?"checked":""}>${ne}</li>`;break}if((re==null?void 0:re.flavour)!==this.flavour||re.type!==this.type)switch(this.type){case"bulleted":case"todo":ne=`<ul>${ne}`;break;case"numbered":ne=`<ol>${ne}`;break}if((ie==null?void 0:ie.flavour)!==this.flavour||ie.type!==this.type)switch(this.type){case"bulleted":case"todo":ne=`${ne}</ul>`;break;case"numbered":ne=`${ne}</ol>`;break}return ne}}class GroupBlockModel extends BaseBlockModel{constructor(B,j){var X;super(B,j),this.flavour="affine:group",this.xywh=(X=j.xywh)!=null?X:"[0,0,720,480]"}}const style$1=`.affine-group-block-container>.affine-block-children-container{padding-left:0}.affine-group-block-container.selected{background-color:var(--affine-selected-color)}
`;var __defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$2(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$2(B,j,ee),ee};let GroupBlockComponent=class extends s$1{createRenderRoot(){return this}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(BLOCK_ID_ATTR,this.model.id);const q=BlockChildrenContainer(this.model,this.host);return y`
      <div class="affine-group-block-container">${q}</div>
    `}};GroupBlockComponent.styles=i$5`
    ${r$3(style$1)}
  `;__decorateClass$2([e$1({hasChanged(){return!0}})],GroupBlockComponent.prototype,"model",2);__decorateClass$2([e$1()],GroupBlockComponent.prototype,"host",2);GroupBlockComponent=__decorateClass$2([e$2("group-block")],GroupBlockComponent);const env$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},importIdentifier$1="__ $BLOCKSUITE_BLOCKS$ __";env$1[importIdentifier$1]===!0&&console.error("@blocksuite/blocks was already imported. This breaks constructor checks and will lead to issues!");env$1[importIdentifier$1]=!0;/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o=(q,B,j)=>{for(const X of B)if(X[0]===q)return(0,X[1])();return j==null?void 0:j()},BlockSchema={"affine:paragraph":ParagraphBlockModel,"affine:page":PageBlockModel,"affine:list":ListBlockModel,"affine:group":GroupBlockModel};var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc$1(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp$1(B,j,ee),ee};let EditorContainer=class extends s$1{constructor(){super(...arguments),this.mode="page",this.clipboard=new ClipboardManager(this,this),this.contentParser=new ContentParser(this),this.isEmptyPage=!0,this.unsubscribe=[]}update(q){q.has("page")&&(this.placeholderModel=new BlockSchema["affine:page"](this.page,{})),super.update(q)}_subscribeStore(){const q=this.page.signals.updated.on(()=>{this.isEmptyPage=this.page.isEmpty});this.unsubscribe.push(q.dispose);const B=this.page.signals.rootAdded.on(j=>{this.model=j,this.model.childrenUpdated.on(()=>this.requestUpdate()),this.requestUpdate()});this.unsubscribe.push(B.dispose)}createRenderRoot(){return this}connectedCallback(){var q;if(super.connectedCallback(),!this.page)throw new Error("EditorContainer's store is not set!");this.placeholderModel=new BlockSchema["affine:page"](this.page,{}),window.addEventListener("affine.switch-mode",({detail:B})=>{this.mode=B}),this._subscribeStore(),(q=this._placeholderInput)==null||q.focus()}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribe.forEach(q=>q())}render(){const q=y`
      <default-page-block
        .mouseRoot=${this}
        .page=${this.page}
        .model=${this.placeholderModel}
      ></default-page-block>
    `,B=y`
      <default-page-block
        .mouseRoot=${this}
        .page=${this.page}
        .model=${this.model}
      ></default-page-block>
    `,j=y`
      <edgeless-page-block
        .mouseRoot=${this}
        .page=${this.page}
        .model=${this.model}
      ></edgeless-page-block>
    `,X=y`
      ${o(this.mode,[["page",()=>B],["edgeless",()=>j]])}
    `;return y`
      <style>
        .affine-editor-container {
          height: 100%;
          position: relative;
          overflow-y: auto;
          overflow-x: hidden;
        }
      </style>
      <div class="affine-editor-container">
        ${this.isEmptyPage?q:X}
      </div>
    `}};__decorateClass$1([e$1()],EditorContainer.prototype,"page",2);__decorateClass$1([t$1()],EditorContainer.prototype,"mode",2);__decorateClass$1([t$1()],EditorContainer.prototype,"model",2);__decorateClass$1([t$1()],EditorContainer.prototype,"clipboard",2);__decorateClass$1([t$1()],EditorContainer.prototype,"contentParser",2);__decorateClass$1([t$1()],EditorContainer.prototype,"isEmptyPage",2);__decorateClass$1([i$2(".affine-block-placeholder-input")],EditorContainer.prototype,"_placeholderInput",2);__decorateClass$1([t$1()],EditorContainer.prototype,"placeholderModel",2);__decorateClass$1([t$1()],EditorContainer.prototype,"unsubscribe",2);EditorContainer=__decorateClass$1([e$2("editor-container")],EditorContainer);var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(q,B,j,X)=>{for(var ee=X>1?void 0:X?__getOwnPropDesc(B,j):B,te=q.length-1,ne;te>=0;te--)(ne=q[te])&&(ee=(X?ne(B,j,ee):ne(ee))||ee);return X&&ee&&__defProp(B,j,ee),ee};const icons={undo:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M48.5 224H40c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H48.5z"
      />
    </svg>
  `,redo:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M463.5 224H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1c-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5z"
      />
    </svg>
  `,quote:y`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 448 512"
      style="width: 11px;"
    >
      <path
        d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V320 288 216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H320c-35.3 0-64-28.7-64-64V320 288 216z"
      />
    </svg>
  `,ul:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"
      />
    </svg>
  `,ol:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M24 56c0-13.3 10.7-24 24-24H80c13.3 0 24 10.7 24 24V176h16c13.3 0 24 10.7 24 24s-10.7 24-24 24H40c-13.3 0-24-10.7-24-24s10.7-24 24-24H56V80H48C34.7 80 24 69.3 24 56zM86.7 341.2c-6.5-7.4-18.3-6.9-24 1.2L51.5 357.9c-7.7 10.8-22.7 13.3-33.5 5.6s-13.3-22.7-5.6-33.5l11.1-15.6c23.7-33.2 72.3-35.6 99.2-4.9c21.3 24.4 20.8 60.9-1.1 84.7L86.8 432H120c13.3 0 24 10.7 24 24s-10.7 24-24 24H32c-9.5 0-18.2-5.6-22-14.4s-2.1-18.9 4.3-25.9l72-78c5.3-5.8 5.4-14.6 .3-20.5zM224 64H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H224c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 160H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H224c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 160H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
  `,checklist:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
      <path
        d="M211.8 339.8C200.9 350.7 183.1 350.7 172.2 339.8L108.2 275.8C97.27 264.9 97.27 247.1 108.2 236.2C119.1 225.3 136.9 225.3 147.8 236.2L192 280.4L300.2 172.2C311.1 161.3 328.9 161.3 339.8 172.2C350.7 183.1 350.7 200.9 339.8 211.8L211.8 339.8zM0 96C0 60.65 28.65 32 64 32H384C419.3 32 448 60.65 448 96V416C448 451.3 419.3 480 384 480H64C28.65 480 0 451.3 0 416V96zM48 96V416C48 424.8 55.16 432 64 432H384C392.8 432 400 424.8 400 416V96C400 87.16 392.8 80 384 80H64C55.16 80 48 87.16 48 96z"
      />
    </svg>
  `,switchMode:y`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 512 512"
      style="width: 12px;"
    >
      <path
        d="M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"
      />
    </svg>
  `,addGroup:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M32 119.4C12.9 108.4 0 87.7 0 64C0 28.7 28.7 0 64 0c23.7 0 44.4 12.9 55.4 32H328.6C339.6 12.9 360.3 0 384 0c35.3 0 64 28.7 64 64c0 23.7-12.9 44.4-32 55.4V232.6c19.1 11.1 32 31.7 32 55.4c0 35.3-28.7 64-64 64c-23.7 0-44.4-12.9-55.4-32H119.4c-11.1 19.1-31.7 32-55.4 32c-35.3 0-64-28.7-64-64c0-23.7 12.9-44.4 32-55.4V119.4zM119.4 96c-5.6 9.7-13.7 17.8-23.4 23.4V232.6c9.7 5.6 17.8 13.7 23.4 23.4H328.6c5.6-9.7 13.7-17.8 23.4-23.4V119.4c-9.7-5.6-17.8-13.7-23.4-23.4H119.4zm192 384c-11.1 19.1-31.7 32-55.4 32c-35.3 0-64-28.7-64-64c0-23.7 12.9-44.4 32-55.4V352h64v40.6c9.7 5.6 17.8 13.7 23.4 23.4H520.6c5.6-9.7 13.7-17.8 23.4-23.4V279.4c-9.7-5.6-17.8-13.7-23.4-23.4h-46c-5.4-15.4-14.6-28.9-26.5-39.6V192h72.6c11.1-19.1 31.7-32 55.4-32c35.3 0 64 28.7 64 64c0 23.7-12.9 44.4-32 55.4V392.6c19.1 11.1 32 31.7 32 55.4c0 35.3-28.7 64-64 64c-23.7 0-44.4-12.9-55.4-32H311.4z"
      />
    </svg>
  `,html:y`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 384 512"
      style="width: 11px;"
    >
      <path
        d="M0 32l34.9 395.8L191.5 480l157.6-52.2L384 32H0zm308.2 127.9H124.4l4.1 49.4h175.6l-13.6 148.4-97.9 27v.3h-1.1l-98.7-27.3-6-75.8h47.7L138 320l53.5 14.5 53.7-14.5 6-62.2H84.3L71.5 112.2h241.1l-4.4 47.7z"
      />
    </svg>
  `,markdown:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M593.8 59.1H46.2C20.7 59.1 0 79.8 0 105.2v301.5c0 25.5 20.7 46.2 46.2 46.2h547.7c25.5 0 46.2-20.7 46.1-46.1V105.2c0-25.4-20.7-46.1-46.2-46.1zM338.5 360.6H277v-120l-61.5 76.9-61.5-76.9v120H92.3V151.4h61.5l61.5 76.9 61.5-76.9h61.5v209.2zm135.3 3.1L381.5 256H443V151.4h61.5V256H566z"
      />
    </svg>
  `,trash:y`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 448 512"
      style="width: 11px;"
    >
      <path
        d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"
      />
    </svg>
  `,connected:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M54.2 202.9C123.2 136.7 216.8 96 320 96s196.8 40.7 265.8 106.9c12.8 12.2 33 11.8 45.2-.9s11.8-33-.9-45.2C549.7 79.5 440.4 32 320 32S90.3 79.5 9.8 156.7C-2.9 169-3.3 189.2 8.9 202s32.5 13.2 45.2 .9zM320 256c56.8 0 108.6 21.1 148.2 56c13.3 11.7 33.5 10.4 45.2-2.8s10.4-33.5-2.8-45.2C459.8 219.2 393 192 320 192s-139.8 27.2-190.5 72c-13.3 11.7-14.5 31.9-2.8 45.2s31.9 14.5 45.2 2.8c39.5-34.9 91.3-56 148.2-56zm64 160c0-35.3-28.7-64-64-64s-64 28.7-64 64s28.7 64 64 64s64-28.7 64-64z"
      />
    </svg>
  `,disconnected:y`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L440.6 320h73.8c34.2 0 93.7-28 93.7-64c0-35-59.5-64-93.7-64l-116.6 0L297.2 16.1C291.5 6.2 280.9 0 269.4 0H213.2c-10.6 0-18.3 10.2-15.4 20.4l40.3 140.9L38.8 5.1zm2.7 123.6C36 130.6 32 135.9 32 142c0 1.3 .2 2.6 .5 3.9L64 256 32.5 366.1c-.4 1.3-.5 2.6-.5 3.9c0 7.8 6.3 14 14 14H88c5 0 9.8-2.4 12.8-6.4L144 320H246.9l-49 171.6c-2.9 10.2 4.8 20.4 15.4 20.4l56.2 0c11.5 0 22.1-6.2 27.8-16.1l65.3-114.3L41.5 128.7z"
      />
    </svg>
  `};let DebugMenu=class extends s$1{constructor(){super(...arguments),this.connected=!0,this.canUndo=!1,this.canRedo=!1,this.mode="page"}get page(){return this.editor.page}get contentParser(){return this.editor.contentParser}_onToggleConnection(){this.connected?(this.workspace.providers.forEach(q=>q.disconnect()),this.connected=!1):(this.workspace.providers.forEach(q=>q.connect()),this.connected=!0)}_convertToList(q){var ne;const B=window.getSelection(),X=((ne=B==null?void 0:B.focusNode)==null?void 0:ne.parentElement).closest("[data-block-id]");if(!X)return;const{page:ee}=X.host,te=ee.getBlockById(X.model.id);convertToList(this.page,te,q,"")}_onDelete(){}_onSetParagraphType(q){var ee,te;const B=window.getSelection(),X=(te=((ee=B==null?void 0:B.focusNode)==null?void 0:ee.parentElement).closest("paragraph-block"))==null?void 0:te.model;!X||(this.page.captureSync(),this.page.updateBlock(X,{type:q}))}_onSwitchMode(){this.mode=this.mode==="page"?"edgeless":"page";const q=createEvent("affine.switch-mode",this.mode);window.dispatchEvent(q)}_onAddGroup(){const q=this.page.root;if(!q)return;const B=q.id;this.page.captureSync();const X=`[0,${q.children.length*60},720,480]`,ee=this.page.addBlock({flavour:"affine:group",xywh:X},B);this.page.addBlock({flavour:"affine:paragraph"},ee)}_onExportHtml(){this.contentParser.onExportHtml()}_onExportMarkDown(){this.contentParser.onExportMarkdown()}firstUpdated(){this.page.signals.historyUpdated.on(()=>{this.canUndo=this.page.canUndo,this.canRedo=this.page.canRedo})}render(){return y`
      <div class="debug-menu">
        <button
          aria-label="undo"
          title="undo"
          .disabled=${!this.canUndo}
          tabindex="-1"
          @click=${()=>this.page.undo()}
        >
          ${icons.undo}
        </button>
        <button
          aria-label="redo"
          title="redo"
          .disabled=${!this.canRedo}
          tabindex="-1"
          @click=${()=>this.page.redo()}
        >
          ${icons.redo}
        </button>
        <button
          aria-label="heading-1"
          title="heading-1"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h1")}
        >
          𝐇𝟏
        </button>
        <button
          aria-label="heading-2"
          title="heading-2"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h2")}
        >
          𝐇𝟐
        </button>
        <button
          aria-label="heading-3"
          title="heading-3"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h3")}
        >
          𝐇𝟑
        </button>
        <button
          aria-label="heading-4"
          title="heading-4"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h4")}
        >
          𝐇𝟒
        </button>
        <button
          aria-label="heading-5"
          title="heading-5"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h5")}
        >
          𝐇𝟓
        </button>
        <button
          aria-label="heading-6"
          title="heading-6"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h6")}
        >
          𝐇𝟔
        </button>
        <button
          aria-label="text"
          title="text"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("text")}
        >
          𝐓
        </button>
        <button
          aria-label="quote"
          title="quote"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("quote")}
        >
          ${icons.quote}
        </button>
        <button
          aria-label="convert to bulleted list"
          title="convert to bulleted list"
          tabindex="-1"
          @click=${()=>this._convertToList("bulleted")}
        >
          ${icons.ul}
        </button>
        <button
          aria-label="convert to numbered list"
          title="convert to numbered list"
          tabindex="-1"
          @click=${()=>this._convertToList("numbered")}
        >
          ${icons.ol}
        </button>
        <button
          aria-label="convert to todo list"
          title="convert to todo list"
          tabindex="-1"
          @click=${()=>this._convertToList("todo")}
        >
          ${icons.checklist}
        </button>
        <!--
        <button
          aria-label="delete"
          title="delete"
          disabled
          tabindex="-1"
          @click=${this._onDelete}
        >
          ❌
        </button>
        -->
        <button
          aria-label=${this.connected?"disconnect":"connect"}
          title=${this.connected?"disconnect":"connect"}
          tabindex="-1"
          @click=${this._onToggleConnection}
        >
          ${this.connected?icons.connected:icons.disconnected}
        </button>
        <button
          aria-label="switch mode"
          title="switch mode"
          tabindex="-1"
          @click=${this._onSwitchMode}
        >
          ${icons.switchMode}
        </button>
        <button
          aria-label="add group"
          title="add group"
          tabindex="-1"
          @click=${this._onAddGroup}
        >
          ${icons.addGroup}
        </button>
        <button
          aria-label="export markdown"
          title="export markdown"
          tabindex="-1"
          @click=${this._onExportMarkDown}
        >
          ${icons.markdown}
        </button>
        <button
          aria-label="export html"
          title="export html"
          tabindex="-1"
          @click=${this._onExportHtml}
        >
          ${icons.html}
        </button>
        <button aria-label="clear data" title="clear data" disabled>
          ${icons.trash}
        </button>
      </div>
    `}};DebugMenu.styles=i$5`
    .debug-menu {
      display: flex;
      flex-wrap: wrap;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000; /* for debug visibility */
    }
    .debug-menu > button {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-left: 2px;
      margin-top: 2px;
      width: 26px;
      height: 22px;
      border: 0;
      border-radius: 2px;
      background-color: var(--affine-border-color);
      color: var(--affine-text-color);
      transition: all 0.3s;
      cursor: pointer;
    }
    .debug-menu > button:hover {
      background-color: var(--affine-hover-background);
    }
    .debug-menu > button:disabled,
    .debug-menu > button:disabled:hover {
      opacity: 0.5;
      background-color: var(--affine-border-color);
      cursor: default;
    }
    .debug-menu > button path {
      fill: var(--affine-text-color);
    }
    .debug-menu > button > * {
      flex: 1;
    }
  `;__decorateClass([e$1()],DebugMenu.prototype,"workspace",2);__decorateClass([e$1()],DebugMenu.prototype,"editor",2);__decorateClass([t$1()],DebugMenu.prototype,"connected",2);__decorateClass([t$1()],DebugMenu.prototype,"canUndo",2);__decorateClass([t$1()],DebugMenu.prototype,"canRedo",2);__decorateClass([t$1()],DebugMenu.prototype,"mode",2);DebugMenu=__decorateClass([e$2("debug-menu")],DebugMenu);var CLIPBOARD_MIMETYPE=(q=>(q.BLOCKS_CLIP_WRAPPED="blocksuite/x-c+w",q.HTML="text/html",q.TEXT="text/plain",q.IMAGE_BMP="image/bmp",q.IMAGE_GIF="image/gif",q.IMAGE_JPEG="image/jpeg",q.IMAGE_JPG="image/jpg",q.IMAGE_PNG="image/png",q.IMAGE_SVG="image/svg",q.IMAGE_WEBP="image/webp",q))(CLIPBOARD_MIMETYPE||{}),ClipboardAction=(q=>(q.copy="copy",q.cut="cut",q.paste="paste",q))(ClipboardAction||{});class ClipEventDispatch{constructor(B){this.signals={[ClipboardAction.copy]:new Signal,[ClipboardAction.cut]:new Signal,[ClipboardAction.paste]:new Signal},this._copyHandler=this._copyHandler.bind(this),this._cutHandler=this._cutHandler.bind(this),this._pasteHandler=this._pasteHandler.bind(this),this.initialClipboardTargetEvent(B)}initialClipboardTargetEvent(B){!B||(this.disposeClipboardTargetEvent(B),B.addEventListener(ClipboardAction.copy,this._copyHandler),B.addEventListener(ClipboardAction.cut,this._cutHandler),B.addEventListener(ClipboardAction.paste,this._pasteHandler),document.addEventListener(ClipboardAction.copy,this._copyHandler),document.addEventListener(ClipboardAction.cut,this._cutHandler),document.addEventListener(ClipboardAction.paste,this._pasteHandler))}disposeClipboardTargetEvent(B){!B||(B.removeEventListener(ClipboardAction.copy,this._copyHandler),B.removeEventListener(ClipboardAction.cut,this._cutHandler),B.removeEventListener(ClipboardAction.paste,this._pasteHandler))}_copyHandler(B){this.signals.copy.emit(B)}_cutHandler(B){this.signals.cut.emit(B)}_pasteHandler(B){this.signals.paste.emit(B)}dispose(B){this.signals.copy.dispose(),this.signals.cut.dispose(),this.signals.paste.dispose(),this.disposeClipboardTargetEvent(B)}}class ClipItem{constructor(B,j){this.mimeType=B,this.data=j}hasData(){return this.data!==null&&this.data!==void 0}}class CopyCutManager{constructor(B){this._editor=B,this.handleCopy=this.handleCopy.bind(this),this.handleCut=this.handleCut.bind(this)}handleCopy(B){B.preventDefault(),B.stopPropagation();const j=this._getClipItems();!j.length||this._copyToClipboard(B,j)}handleCut(B){this.handleCopy(B)}_getClipItems(){const B=[],X=getSelectInfo(this._editor.page).selectedBlocks,ee=this._getCustomClip(X);ee&&B.push(ee);const te=this._getTextClip(X);te&&B.push(te);const ne=this._getHtmlClip(X);return ne&&B.push(ne),B}_getCustomClip(B){const j=B.map(X=>this._getClipInfoBySelectionInfo(X));return new ClipItem(CLIPBOARD_MIMETYPE.BLOCKS_CLIP_WRAPPED,JSON.stringify({data:j}))}_getHtmlClip(B){const j=this._editor.contentParser.block2Html(B);return new ClipItem(CLIPBOARD_MIMETYPE.HTML,j)}_getTextClip(B){const j=this._editor.contentParser.block2Text(B);return new ClipItem(CLIPBOARD_MIMETYPE.TEXT,j)}_getClipInfoBySelectionInfo(B){var re;const j=this._editor.page.getBlockById(B.id);if(!j)return null;let{flavour:X,type:ee}=j,te=[];j.flavour==="affine:page"?(X="affine:paragraph",ee="text",te=[{insert:j.block2Text("",B==null?void 0:B.startPos,B==null?void 0:B.endPos)}]):te=(re=j==null?void 0:j.text)==null?void 0:re.sliceToDelta((B==null?void 0:B.startPos)||0,B==null?void 0:B.endPos);const ne=[];return B.children.forEach(ie=>{const fe=this._getClipInfoBySelectionInfo(ie);fe&&ne.push(fe)}),{flavour:X,type:ee,text:te,checked:j instanceof ListBlockModel?j.checked:void 0,children:ne}}_copyToClipboard(B,j){const X=B.clipboardData;if(X)try{j.forEach(ee=>{X.setData(ee.mimeType,ee.data)})}catch{}else this._copyToClipboardFromPc(j)}_copyToClipboardFromPc(B){let j=!1;const X=document.createElement("textarea");X.value="temp",document.body.appendChild(X),X.select(),X.setSelectionRange(0,X.value.length);const ee=function(te){const ne=te.clipboardData;ne&&B.forEach(re=>{ne.setData(re.mimeType,re.data)}),te.preventDefault(),te.stopPropagation(),X.removeEventListener("copy",ee)};X.addEventListener("copy",ee);try{j=document.execCommand("copy")}finally{X.removeEventListener("copy",ee),document.body.removeChild(X)}return j}}const _MarkdownUtils=class{static checkIfTextContainsMd(q){q=q.replace(/¨/g,"\xA8T"),q=q.replace(/\$/g,"\xA8D"),q=q.replace(/\r\n/g,`
`),q=q.replace(/\r/g,`
`),q=q.replace(/\u00A0/g,"&nbsp;"),q=`

${q}

`,q=_MarkdownUtils._detab(q);for(let B=0;B<_MarkdownUtils._checkRegArr.length;B++){const j=B===3?`${q}\xA80`:q;if(_MarkdownUtils._checkRegArr[B].test(j))return!0}return!1}static _detab(q){return q=q.replace(/\t(?=\t)/g," "),q=q.replace(/\t/g,"\xA8A\xA8B"),q=q.replace(/¨B(.+?)¨A/g,(B,j)=>{let X=j;const ee=4-X.length%4;for(let te=0;te<ee;te++)X+=" ";return X}),q=q.replace(/¨A/g," "),q=q.replace(/¨B/g,""),q}};let MarkdownUtils=_MarkdownUtils;MarkdownUtils._checkRegArr=[/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm,/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,/!\[([^\[\]]+)]()()()()()/g,/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,/\[([^\[\]]+)]()()()()()/g];const _PasteManager=class{constructor(q){this._editor=q,this.handlePaste=this.handlePaste.bind(this)}async handlePaste(q){q.preventDefault(),q.stopPropagation();const B=await this._clipboardEvent2Blocks(q);this.insertBlocks(B)}async _clipboardEvent2Blocks(q){const B=q.clipboardData;return B?_PasteManager._isPureFileInClipboard(B)?this._file2Blocks(B):this._clipboardData2Blocks(B):void 0}getOptimalClip(q){for(let B=0;B<_PasteManager._optimalMimeTypes.length;B++){const j=_PasteManager._optimalMimeTypes[B],X=q==null?void 0:q.getData(j);if(X)return{type:j,data:X}}return null}async _clipboardData2Blocks(q){const B=this.getOptimalClip(q);if((B==null?void 0:B.type)===CLIPBOARD_MIMETYPE.BLOCKS_CLIP_WRAPPED)return JSON.parse(B.data).data;const j=q.getData(CLIPBOARD_MIMETYPE.TEXT),X=MarkdownUtils.checkIfTextContainsMd(j);return(B==null?void 0:B.type)===CLIPBOARD_MIMETYPE.HTML&&!X?this._editor.contentParser.htmlText2Block(B.data):X?this._editor.contentParser.markdown2Block(j):this._editor.contentParser.text2blocks(j)}async _file2Blocks(q){return _PasteManager._getImageFile(q)?[]:[]}static _isPureFileInClipboard(q){const B=q.types;return B.length===1&&B[0]==="Files"||B.length===2&&(B.includes("text/plain")||B.includes("text/html"))&&B.includes("Files")}static _getImageFile(q){const B=q.files;if(B&&B[0]&&B[0].type.indexOf("image")>-1)return B[0]}insertBlocks(q,B){var X,ee,te,ne,re,ie,fe,ce,se,oe;if(q.length===0)return;const j=B||getSelectInfo(this._editor.page);if(j.type==="Range"||j.type==="Caret"){const ae=j.selectedBlocks[j.selectedBlocks.length-1],le=this._editor.page.getBlockById(ae.id);let pe=le,ve=0;if(le)if(le.flavour==="affine:page")if(((X=le.children[0])==null?void 0:X.flavour)==="affine:group")pe=le.children[0];else{const de=this._editor.page.addBlock({flavour:"affine:group"},le.id);pe=this._editor.page.getBlockById(de)}else le.flavour!=="affine:group"&&(pe=this._editor.page.getParent(le),ve=((pe==null?void 0:pe.children.indexOf(le))||0)+1);const ge=[];if((le==null?void 0:le.flavour)!=="affine:page"){const de=ae.endPos||((ee=le==null?void 0:le.text)==null?void 0:ee.length)||0,ue=q[0].text,he=ue.reduce((be,Se)=>be+(Se.insert||"").length,0);(te=le==null?void 0:le.text)==null||te.insertList(ue,de),le&&this._addBlocks(q[0].children,le,0,ge),pe&&this._addBlocks(q.slice(1),pe,ve,ge);let me=le==null?void 0:le.id,_e=de+he;if(ge.length>0){const be=(ne=le==null?void 0:le.text)==null?void 0:ne.sliceToDelta(de+he);me=ge[ge.length-1];const Se=this._editor.page.getBlockById(me);(ie=le==null?void 0:le.text)==null||ie.delete(de+he,(re=le==null?void 0:le.text)==null?void 0:re.length),_e=((fe=Se==null?void 0:Se.text)==null?void 0:fe.length)||0,(se=Se==null?void 0:Se.text)==null||se.insertList(be,(ce=Se==null?void 0:Se.text)==null?void 0:ce.length)}setTimeout(()=>{var be;me&&((be=this._editor.page.richTextAdapters.get(me))==null||be.quill.setSelection(_e,0))})}else pe&&this._addBlocks(q,pe,ve,ge)}else if(j.type==="Block"){const ae=this._editor.page.getBlockById(j.selectedBlocks[j.selectedBlocks.length-1].id);let le=ae,pe=0;if(ae)if(ae.flavour==="affine:page")if(((oe=ae.children[0])==null?void 0:oe.flavour)==="affine:group")le=ae.children[0];else{const ge=this._editor.page.addBlock({flavour:"affine:group"},ae.id);le=this._editor.page.getBlockById(ge)}else ae.flavour!=="affine:group"&&(le=this._editor.page.getParent(ae),pe=((le==null?void 0:le.children.indexOf(ae))||0)+1);const ve=[];le&&this._addBlocks(q,le,pe,ve)}}_addBlocks(q,B,j,X){var ee;for(let te=0;te<q.length;te++){const ne=q[te],re={flavour:ne.flavour,type:ne.type,checked:ne.checked},ie=this._editor.page.addBlock(re,B,j+te),fe=this._editor.page.getBlockById(ie);ne.text&&((ee=fe==null?void 0:fe.text)==null||ee.applyDelta(ne.text)),X.push(ie),fe&&this._addBlocks(ne.children,fe,0,X)}}};let PasteManager=_PasteManager;PasteManager._optimalMimeTypes=[CLIPBOARD_MIMETYPE.BLOCKS_CLIP_WRAPPED,CLIPBOARD_MIMETYPE.HTML,CLIPBOARD_MIMETYPE.TEXT];function getDefaults(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let defaults=getDefaults();function changeDefaults(q){defaults=q}const escapeTest=/[&<>"']/,escapeReplace=/[&<>"']/g,escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g,escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=q=>escapeReplacements[q];function escape$1(q,B){if(B){if(escapeTest.test(q))return q.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(q))return q.replace(escapeReplaceNoEncode,getEscapeReplacement);return q}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape$1(q){return q.replace(unescapeTest,(B,j)=>(j=j.toLowerCase(),j==="colon"?":":j.charAt(0)==="#"?j.charAt(1)==="x"?String.fromCharCode(parseInt(j.substring(2),16)):String.fromCharCode(+j.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(q,B){q=typeof q=="string"?q:q.source,B=B||"";const j={replace:(X,ee)=>(ee=ee.source||ee,ee=ee.replace(caret,"$1"),q=q.replace(X,ee),j),getRegex:()=>new RegExp(q,B)};return j}const nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(q,B,j){if(q){let X;try{X=decodeURIComponent(unescape$1(j)).replace(nonWordAndColonTest,"").toLowerCase()}catch{return null}if(X.indexOf("javascript:")===0||X.indexOf("vbscript:")===0||X.indexOf("data:")===0)return null}B&&!originIndependentUrl.test(j)&&(j=resolveUrl(B,j));try{j=encodeURI(j).replace(/%25/g,"%")}catch{return null}return j}const baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(q,B){baseUrls[" "+q]||(justDomain.test(q)?baseUrls[" "+q]=q+"/":baseUrls[" "+q]=rtrim(q,"/",!0)),q=baseUrls[" "+q];const j=q.indexOf(":")===-1;return B.substring(0,2)==="//"?j?B:q.replace(protocol,"$1")+B:B.charAt(0)==="/"?j?B:q.replace(domain,"$1")+B:q+B}const noopTest={exec:function q(){}};function merge(q){let B=1,j,X;for(;B<arguments.length;B++){j=arguments[B];for(X in j)Object.prototype.hasOwnProperty.call(j,X)&&(q[X]=j[X])}return q}function splitCells(q,B){const j=q.replace(/\|/g,(te,ne,re)=>{let ie=!1,fe=ne;for(;--fe>=0&&re[fe]==="\\";)ie=!ie;return ie?"|":" |"}),X=j.split(/ \|/);let ee=0;if(X[0].trim()||X.shift(),X.length>0&&!X[X.length-1].trim()&&X.pop(),X.length>B)X.splice(B);else for(;X.length<B;)X.push("");for(;ee<X.length;ee++)X[ee]=X[ee].trim().replace(/\\\|/g,"|");return X}function rtrim(q,B,j){const X=q.length;if(X===0)return"";let ee=0;for(;ee<X;){const te=q.charAt(X-ee-1);if(te===B&&!j)ee++;else if(te!==B&&j)ee++;else break}return q.slice(0,X-ee)}function findClosingBracket(q,B){if(q.indexOf(B[1])===-1)return-1;const j=q.length;let X=0,ee=0;for(;ee<j;ee++)if(q[ee]==="\\")ee++;else if(q[ee]===B[0])X++;else if(q[ee]===B[1]&&(X--,X<0))return ee;return-1}function checkSanitizeDeprecation(q){q&&q.sanitize&&!q.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(q,B){if(B<1)return"";let j="";for(;B>1;)B&1&&(j+=q),B>>=1,q+=q;return j+q}function outputLink(q,B,j,X){const ee=B.href,te=B.title?escape$1(B.title):null,ne=q[1].replace(/\\([\[\]])/g,"$1");if(q[0].charAt(0)!=="!"){X.state.inLink=!0;const re={type:"link",raw:j,href:ee,title:te,text:ne,tokens:X.inlineTokens(ne)};return X.state.inLink=!1,re}return{type:"image",raw:j,href:ee,title:te,text:escape$1(ne)}}function indentCodeCompensation(q,B){const j=q.match(/^(\s+)(?:```)/);if(j===null)return B;const X=j[1];return B.split(`
`).map(ee=>{const te=ee.match(/^\s+/);if(te===null)return ee;const[ne]=te;return ne.length>=X.length?ee.slice(X.length):ee}).join(`
`)}class Tokenizer{constructor(B){this.options=B||defaults}space(B){const j=this.rules.block.newline.exec(B);if(j&&j[0].length>0)return{type:"space",raw:j[0]}}code(B){const j=this.rules.block.code.exec(B);if(j){const X=j[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:j[0],codeBlockStyle:"indented",text:this.options.pedantic?X:rtrim(X,`
`)}}}fences(B){const j=this.rules.block.fences.exec(B);if(j){const X=j[0],ee=indentCodeCompensation(X,j[3]||"");return{type:"code",raw:X,lang:j[2]?j[2].trim():j[2],text:ee}}}heading(B){const j=this.rules.block.heading.exec(B);if(j){let X=j[2].trim();if(/#$/.test(X)){const ee=rtrim(X,"#");(this.options.pedantic||!ee||/ $/.test(ee))&&(X=ee.trim())}return{type:"heading",raw:j[0],depth:j[1].length,text:X,tokens:this.lexer.inline(X)}}}hr(B){const j=this.rules.block.hr.exec(B);if(j)return{type:"hr",raw:j[0]}}blockquote(B){const j=this.rules.block.blockquote.exec(B);if(j){const X=j[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:j[0],tokens:this.lexer.blockTokens(X,[]),text:X}}}list(B){let j=this.rules.block.list.exec(B);if(j){let X,ee,te,ne,re,ie,fe,ce,se,oe,ae,le,pe=j[1].trim();const ve=pe.length>1,ge={type:"list",raw:"",ordered:ve,start:ve?+pe.slice(0,-1):"",loose:!1,items:[]};pe=ve?`\\d{1,9}\\${pe.slice(-1)}`:`\\${pe}`,this.options.pedantic&&(pe=ve?pe:"[*+-]");const de=new RegExp(`^( {0,3}${pe})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;B&&(le=!1,!(!(j=de.exec(B))||this.rules.block.hr.test(B)));){if(X=j[0],B=B.substring(X.length),ce=j[2].split(`
`,1)[0],se=B.split(`
`,1)[0],this.options.pedantic?(ne=2,ae=ce.trimLeft()):(ne=j[2].search(/[^ ]/),ne=ne>4?1:ne,ae=ce.slice(ne),ne+=j[1].length),ie=!1,!ce&&/^ *$/.test(se)&&(X+=se+`
`,B=B.substring(se.length+1),le=!0),!le){const he=new RegExp(`^ {0,${Math.min(3,ne-1)}}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))`),me=new RegExp(`^ {0,${Math.min(3,ne-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),_e=new RegExp(`^ {0,${Math.min(3,ne-1)}}(?:\`\`\`|~~~)`),be=new RegExp(`^ {0,${Math.min(3,ne-1)}}#`);for(;B&&(oe=B.split(`
`,1)[0],ce=oe,this.options.pedantic&&(ce=ce.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(_e.test(ce)||be.test(ce)||he.test(ce)||me.test(B)));){if(ce.search(/[^ ]/)>=ne||!ce.trim())ae+=`
`+ce.slice(ne);else if(!ie)ae+=`
`+ce;else break;!ie&&!ce.trim()&&(ie=!0),X+=oe+`
`,B=B.substring(oe.length+1)}}ge.loose||(fe?ge.loose=!0:/\n *\n *$/.test(X)&&(fe=!0)),this.options.gfm&&(ee=/^\[[ xX]\] /.exec(ae),ee&&(te=ee[0]!=="[ ] ",ae=ae.replace(/^\[[ xX]\] +/,""))),ge.items.push({type:"list_item",raw:X,task:!!ee,checked:te,loose:!1,text:ae}),ge.raw+=X}ge.items[ge.items.length-1].raw=X.trimRight(),ge.items[ge.items.length-1].text=ae.trimRight(),ge.raw=ge.raw.trimRight();const ue=ge.items.length;for(re=0;re<ue;re++){this.lexer.state.top=!1,ge.items[re].tokens=this.lexer.blockTokens(ge.items[re].text,[]);const he=ge.items[re].tokens.filter(_e=>_e.type==="space"),me=he.every(_e=>{const be=_e.raw.split("");let Se=0;for(const Te of be)if(Te===`
`&&(Se+=1),Se>1)return!0;return!1});!ge.loose&&he.length&&me&&(ge.loose=!0,ge.items[re].loose=!0)}return ge}}html(B){const j=this.rules.block.html.exec(B);if(j){const X={type:"html",raw:j[0],pre:!this.options.sanitizer&&(j[1]==="pre"||j[1]==="script"||j[1]==="style"),text:j[0]};if(this.options.sanitize){const ee=this.options.sanitizer?this.options.sanitizer(j[0]):escape$1(j[0]);X.type="paragraph",X.text=ee,X.tokens=this.lexer.inline(ee)}return X}}def(B){const j=this.rules.block.def.exec(B);if(j){j[3]&&(j[3]=j[3].substring(1,j[3].length-1));const X=j[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:X,raw:j[0],href:j[2],title:j[3]}}}table(B){const j=this.rules.block.table.exec(B);if(j){const X={type:"table",header:splitCells(j[1]).map(ee=>({text:ee})),align:j[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:j[3]&&j[3].trim()?j[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(X.header.length===X.align.length){X.raw=j[0];let ee=X.align.length,te,ne,re,ie;for(te=0;te<ee;te++)/^ *-+: *$/.test(X.align[te])?X.align[te]="right":/^ *:-+: *$/.test(X.align[te])?X.align[te]="center":/^ *:-+ *$/.test(X.align[te])?X.align[te]="left":X.align[te]=null;for(ee=X.rows.length,te=0;te<ee;te++)X.rows[te]=splitCells(X.rows[te],X.header.length).map(fe=>({text:fe}));for(ee=X.header.length,ne=0;ne<ee;ne++)X.header[ne].tokens=this.lexer.inline(X.header[ne].text);for(ee=X.rows.length,ne=0;ne<ee;ne++)for(ie=X.rows[ne],re=0;re<ie.length;re++)ie[re].tokens=this.lexer.inline(ie[re].text);return X}}}lheading(B){const j=this.rules.block.lheading.exec(B);if(j)return{type:"heading",raw:j[0],depth:j[2].charAt(0)==="="?1:2,text:j[1],tokens:this.lexer.inline(j[1])}}paragraph(B){const j=this.rules.block.paragraph.exec(B);if(j){const X=j[1].charAt(j[1].length-1)===`
`?j[1].slice(0,-1):j[1];return{type:"paragraph",raw:j[0],text:X,tokens:this.lexer.inline(X)}}}text(B){const j=this.rules.block.text.exec(B);if(j)return{type:"text",raw:j[0],text:j[0],tokens:this.lexer.inline(j[0])}}escape(B){const j=this.rules.inline.escape.exec(B);if(j)return{type:"escape",raw:j[0],text:escape$1(j[1])}}tag(B){const j=this.rules.inline.tag.exec(B);if(j)return!this.lexer.state.inLink&&/^<a /i.test(j[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(j[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(j[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(j[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:j[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(j[0]):escape$1(j[0]):j[0]}}link(B){const j=this.rules.inline.link.exec(B);if(j){const X=j[2].trim();if(!this.options.pedantic&&/^</.test(X)){if(!/>$/.test(X))return;const ne=rtrim(X.slice(0,-1),"\\");if((X.length-ne.length)%2===0)return}else{const ne=findClosingBracket(j[2],"()");if(ne>-1){const ie=(j[0].indexOf("!")===0?5:4)+j[1].length+ne;j[2]=j[2].substring(0,ne),j[0]=j[0].substring(0,ie).trim(),j[3]=""}}let ee=j[2],te="";if(this.options.pedantic){const ne=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(ee);ne&&(ee=ne[1],te=ne[3])}else te=j[3]?j[3].slice(1,-1):"";return ee=ee.trim(),/^</.test(ee)&&(this.options.pedantic&&!/>$/.test(X)?ee=ee.slice(1):ee=ee.slice(1,-1)),outputLink(j,{href:ee&&ee.replace(this.rules.inline._escapes,"$1"),title:te&&te.replace(this.rules.inline._escapes,"$1")},j[0],this.lexer)}}reflink(B,j){let X;if((X=this.rules.inline.reflink.exec(B))||(X=this.rules.inline.nolink.exec(B))){let ee=(X[2]||X[1]).replace(/\s+/g," ");if(ee=j[ee.toLowerCase()],!ee||!ee.href){const te=X[0].charAt(0);return{type:"text",raw:te,text:te}}return outputLink(X,ee,X[0],this.lexer)}}emStrong(B,j,X=""){let ee=this.rules.inline.emStrong.lDelim.exec(B);if(!ee||ee[3]&&X.match(/[\p{L}\p{N}]/u))return;const te=ee[1]||ee[2]||"";if(!te||te&&(X===""||this.rules.inline.punctuation.exec(X))){const ne=ee[0].length-1;let re,ie,fe=ne,ce=0;const se=ee[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(se.lastIndex=0,j=j.slice(-1*B.length+ne);(ee=se.exec(j))!=null;){if(re=ee[1]||ee[2]||ee[3]||ee[4]||ee[5]||ee[6],!re)continue;if(ie=re.length,ee[3]||ee[4]){fe+=ie;continue}else if((ee[5]||ee[6])&&ne%3&&!((ne+ie)%3)){ce+=ie;continue}if(fe-=ie,fe>0)continue;if(ie=Math.min(ie,ie+fe+ce),Math.min(ne,ie)%2){const ae=B.slice(1,ne+ee.index+ie);return{type:"em",raw:B.slice(0,ne+ee.index+ie+1),text:ae,tokens:this.lexer.inlineTokens(ae)}}const oe=B.slice(2,ne+ee.index+ie-1);return{type:"strong",raw:B.slice(0,ne+ee.index+ie+1),text:oe,tokens:this.lexer.inlineTokens(oe)}}}}codespan(B){const j=this.rules.inline.code.exec(B);if(j){let X=j[2].replace(/\n/g," ");const ee=/[^ ]/.test(X),te=/^ /.test(X)&&/ $/.test(X);return ee&&te&&(X=X.substring(1,X.length-1)),X=escape$1(X,!0),{type:"codespan",raw:j[0],text:X}}}br(B){const j=this.rules.inline.br.exec(B);if(j)return{type:"br",raw:j[0]}}del(B){const j=this.rules.inline.del.exec(B);if(j)return{type:"del",raw:j[0],text:j[2],tokens:this.lexer.inlineTokens(j[2])}}autolink(B,j){const X=this.rules.inline.autolink.exec(B);if(X){let ee,te;return X[2]==="@"?(ee=escape$1(this.options.mangle?j(X[1]):X[1]),te="mailto:"+ee):(ee=escape$1(X[1]),te=ee),{type:"link",raw:X[0],text:ee,href:te,tokens:[{type:"text",raw:ee,text:ee}]}}}url(B,j){let X;if(X=this.rules.inline.url.exec(B)){let ee,te;if(X[2]==="@")ee=escape$1(this.options.mangle?j(X[0]):X[0]),te="mailto:"+ee;else{let ne;do ne=X[0],X[0]=this.rules.inline._backpedal.exec(X[0])[0];while(ne!==X[0]);ee=escape$1(X[0]),X[1]==="www."?te="http://"+ee:te=ee}return{type:"link",raw:X[0],text:ee,href:te,tokens:[{type:"text",raw:ee,text:ee}]}}}inlineText(B,j){const X=this.rules.inline.text.exec(B);if(X){let ee;return this.lexer.state.inRawBlock?ee=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(X[0]):escape$1(X[0]):X[0]:ee=escape$1(this.options.smartypants?j(X[0]):X[0]),{type:"text",raw:X[0],text:ee}}}}const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex();block.bullet=/(?:[*+-]|\d{1,9}[.)])/;block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex();block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex();block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex();block.normal=merge({},block);block.gfm=merge({},block.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.pedantic=merge({},block.normal,{html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex();inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;inline.escapedEmSt=/\\\*|\\_/g;inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex();inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex();inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex();inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex();inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex();inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex();inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex();inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex();inline.normal=merge({},inline);inline.pedantic=merge({},inline.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()});inline.gfm=merge({},inline.normal,{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex();inline.breaks=merge({},inline.gfm,{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function smartypants(q){return q.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function mangle(q){let B="",j,X;const ee=q.length;for(j=0;j<ee;j++)X=q.charCodeAt(j),Math.random()>.5&&(X="x"+X.toString(16)),B+="&#"+X+";";return B}class Lexer{constructor(B){this.tokens=[],this.tokens.links=Object.create(null),this.options=B||defaults,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const j={block:block.normal,inline:inline.normal};this.options.pedantic?(j.block=block.pedantic,j.inline=inline.pedantic):this.options.gfm&&(j.block=block.gfm,this.options.breaks?j.inline=inline.breaks:j.inline=inline.gfm),this.tokenizer.rules=j}static get rules(){return{block,inline}}static lex(B,j){return new Lexer(j).lex(B)}static lexInline(B,j){return new Lexer(j).inlineTokens(B)}lex(B){B=B.replace(/\r\n|\r/g,`
`),this.blockTokens(B,this.tokens);let j;for(;j=this.inlineQueue.shift();)this.inlineTokens(j.src,j.tokens);return this.tokens}blockTokens(B,j=[]){this.options.pedantic?B=B.replace(/\t/g,"    ").replace(/^ +$/gm,""):B=B.replace(/^( *)(\t+)/gm,(re,ie,fe)=>ie+"    ".repeat(fe.length));let X,ee,te,ne;for(;B;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(re=>(X=re.call({lexer:this},B,j))?(B=B.substring(X.raw.length),j.push(X),!0):!1))){if(X=this.tokenizer.space(B)){B=B.substring(X.raw.length),X.raw.length===1&&j.length>0?j[j.length-1].raw+=`
`:j.push(X);continue}if(X=this.tokenizer.code(B)){B=B.substring(X.raw.length),ee=j[j.length-1],ee&&(ee.type==="paragraph"||ee.type==="text")?(ee.raw+=`
`+X.raw,ee.text+=`
`+X.text,this.inlineQueue[this.inlineQueue.length-1].src=ee.text):j.push(X);continue}if(X=this.tokenizer.fences(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.heading(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.hr(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.blockquote(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.list(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.html(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.def(B)){B=B.substring(X.raw.length),ee=j[j.length-1],ee&&(ee.type==="paragraph"||ee.type==="text")?(ee.raw+=`
`+X.raw,ee.text+=`
`+X.raw,this.inlineQueue[this.inlineQueue.length-1].src=ee.text):this.tokens.links[X.tag]||(this.tokens.links[X.tag]={href:X.href,title:X.title});continue}if(X=this.tokenizer.table(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.lheading(B)){B=B.substring(X.raw.length),j.push(X);continue}if(te=B,this.options.extensions&&this.options.extensions.startBlock){let re=1/0;const ie=B.slice(1);let fe;this.options.extensions.startBlock.forEach(function(ce){fe=ce.call({lexer:this},ie),typeof fe=="number"&&fe>=0&&(re=Math.min(re,fe))}),re<1/0&&re>=0&&(te=B.substring(0,re+1))}if(this.state.top&&(X=this.tokenizer.paragraph(te))){ee=j[j.length-1],ne&&ee.type==="paragraph"?(ee.raw+=`
`+X.raw,ee.text+=`
`+X.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=ee.text):j.push(X),ne=te.length!==B.length,B=B.substring(X.raw.length);continue}if(X=this.tokenizer.text(B)){B=B.substring(X.raw.length),ee=j[j.length-1],ee&&ee.type==="text"?(ee.raw+=`
`+X.raw,ee.text+=`
`+X.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=ee.text):j.push(X);continue}if(B){const re="Infinite loop on byte: "+B.charCodeAt(0);if(this.options.silent){console.error(re);break}else throw new Error(re)}}return this.state.top=!0,j}inline(B,j=[]){return this.inlineQueue.push({src:B,tokens:j}),j}inlineTokens(B,j=[]){let X,ee,te,ne=B,re,ie,fe;if(this.tokens.links){const ce=Object.keys(this.tokens.links);if(ce.length>0)for(;(re=this.tokenizer.rules.inline.reflinkSearch.exec(ne))!=null;)ce.includes(re[0].slice(re[0].lastIndexOf("[")+1,-1))&&(ne=ne.slice(0,re.index)+"["+repeatString("a",re[0].length-2)+"]"+ne.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(re=this.tokenizer.rules.inline.blockSkip.exec(ne))!=null;)ne=ne.slice(0,re.index)+"["+repeatString("a",re[0].length-2)+"]"+ne.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(re=this.tokenizer.rules.inline.escapedEmSt.exec(ne))!=null;)ne=ne.slice(0,re.index)+"++"+ne.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;B;)if(ie||(fe=""),ie=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(ce=>(X=ce.call({lexer:this},B,j))?(B=B.substring(X.raw.length),j.push(X),!0):!1))){if(X=this.tokenizer.escape(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.tag(B)){B=B.substring(X.raw.length),ee=j[j.length-1],ee&&X.type==="text"&&ee.type==="text"?(ee.raw+=X.raw,ee.text+=X.text):j.push(X);continue}if(X=this.tokenizer.link(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.reflink(B,this.tokens.links)){B=B.substring(X.raw.length),ee=j[j.length-1],ee&&X.type==="text"&&ee.type==="text"?(ee.raw+=X.raw,ee.text+=X.text):j.push(X);continue}if(X=this.tokenizer.emStrong(B,ne,fe)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.codespan(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.br(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.del(B)){B=B.substring(X.raw.length),j.push(X);continue}if(X=this.tokenizer.autolink(B,mangle)){B=B.substring(X.raw.length),j.push(X);continue}if(!this.state.inLink&&(X=this.tokenizer.url(B,mangle))){B=B.substring(X.raw.length),j.push(X);continue}if(te=B,this.options.extensions&&this.options.extensions.startInline){let ce=1/0;const se=B.slice(1);let oe;this.options.extensions.startInline.forEach(function(ae){oe=ae.call({lexer:this},se),typeof oe=="number"&&oe>=0&&(ce=Math.min(ce,oe))}),ce<1/0&&ce>=0&&(te=B.substring(0,ce+1))}if(X=this.tokenizer.inlineText(te,smartypants)){B=B.substring(X.raw.length),X.raw.slice(-1)!=="_"&&(fe=X.raw.slice(-1)),ie=!0,ee=j[j.length-1],ee&&ee.type==="text"?(ee.raw+=X.raw,ee.text+=X.text):j.push(X);continue}if(B){const ce="Infinite loop on byte: "+B.charCodeAt(0);if(this.options.silent){console.error(ce);break}else throw new Error(ce)}}return j}}class Renderer{constructor(B){this.options=B||defaults}code(B,j,X){const ee=(j||"").match(/\S*/)[0];if(this.options.highlight){const te=this.options.highlight(B,ee);te!=null&&te!==B&&(X=!0,B=te)}return B=B.replace(/\n$/,"")+`
`,ee?'<pre><code class="'+this.options.langPrefix+escape$1(ee,!0)+'">'+(X?B:escape$1(B,!0))+`</code></pre>
`:"<pre><code>"+(X?B:escape$1(B,!0))+`</code></pre>
`}blockquote(B){return`<blockquote>
${B}</blockquote>
`}html(B){return B}heading(B,j,X,ee){if(this.options.headerIds){const te=this.options.headerPrefix+ee.slug(X);return`<h${j} id="${te}">${B}</h${j}>
`}return`<h${j}>${B}</h${j}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(B,j,X){const ee=j?"ol":"ul",te=j&&X!==1?' start="'+X+'"':"";return"<"+ee+te+`>
`+B+"</"+ee+`>
`}listitem(B){return`<li>${B}</li>
`}checkbox(B){return"<input "+(B?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(B){return`<p>${B}</p>
`}table(B,j){return j&&(j=`<tbody>${j}</tbody>`),`<table>
<thead>
`+B+`</thead>
`+j+`</table>
`}tablerow(B){return`<tr>
${B}</tr>
`}tablecell(B,j){const X=j.header?"th":"td";return(j.align?`<${X} align="${j.align}">`:`<${X}>`)+B+`</${X}>
`}strong(B){return`<strong>${B}</strong>`}em(B){return`<em>${B}</em>`}codespan(B){return`<code>${B}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(B){return`<del>${B}</del>`}link(B,j,X){if(B=cleanUrl(this.options.sanitize,this.options.baseUrl,B),B===null)return X;let ee='<a href="'+escape$1(B)+'"';return j&&(ee+=' title="'+j+'"'),ee+=">"+X+"</a>",ee}image(B,j,X){if(B=cleanUrl(this.options.sanitize,this.options.baseUrl,B),B===null)return X;let ee=`<img src="${B}" alt="${X}"`;return j&&(ee+=` title="${j}"`),ee+=this.options.xhtml?"/>":">",ee}text(B){return B}}class TextRenderer{strong(B){return B}em(B){return B}codespan(B){return B}del(B){return B}html(B){return B}text(B){return B}link(B,j,X){return""+X}image(B,j,X){return""+X}br(){return""}}class Slugger{constructor(){this.seen={}}serialize(B){return B.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(B,j){let X=B,ee=0;if(this.seen.hasOwnProperty(X)){ee=this.seen[B];do ee++,X=B+"-"+ee;while(this.seen.hasOwnProperty(X))}return j||(this.seen[B]=ee,this.seen[X]=0),X}slug(B,j={}){const X=this.serialize(B);return this.getNextSafeSlug(X,j.dryrun)}}class Parser{constructor(B){this.options=B||defaults,this.options.renderer=this.options.renderer||new Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(B,j){return new Parser(j).parse(B)}static parseInline(B,j){return new Parser(j).parseInline(B)}parse(B,j=!0){let X="",ee,te,ne,re,ie,fe,ce,se,oe,ae,le,pe,ve,ge,de,ue,he,me,_e;const be=B.length;for(ee=0;ee<be;ee++){if(ae=B[ee],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[ae.type]&&(_e=this.options.extensions.renderers[ae.type].call({parser:this},ae),_e!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(ae.type))){X+=_e||"";continue}switch(ae.type){case"space":continue;case"hr":{X+=this.renderer.hr();continue}case"heading":{X+=this.renderer.heading(this.parseInline(ae.tokens),ae.depth,unescape$1(this.parseInline(ae.tokens,this.textRenderer)),this.slugger);continue}case"code":{X+=this.renderer.code(ae.text,ae.lang,ae.escaped);continue}case"table":{for(se="",ce="",re=ae.header.length,te=0;te<re;te++)ce+=this.renderer.tablecell(this.parseInline(ae.header[te].tokens),{header:!0,align:ae.align[te]});for(se+=this.renderer.tablerow(ce),oe="",re=ae.rows.length,te=0;te<re;te++){for(fe=ae.rows[te],ce="",ie=fe.length,ne=0;ne<ie;ne++)ce+=this.renderer.tablecell(this.parseInline(fe[ne].tokens),{header:!1,align:ae.align[ne]});oe+=this.renderer.tablerow(ce)}X+=this.renderer.table(se,oe);continue}case"blockquote":{oe=this.parse(ae.tokens),X+=this.renderer.blockquote(oe);continue}case"list":{for(le=ae.ordered,pe=ae.start,ve=ae.loose,re=ae.items.length,oe="",te=0;te<re;te++)de=ae.items[te],ue=de.checked,he=de.task,ge="",de.task&&(me=this.renderer.checkbox(ue),ve?de.tokens.length>0&&de.tokens[0].type==="paragraph"?(de.tokens[0].text=me+" "+de.tokens[0].text,de.tokens[0].tokens&&de.tokens[0].tokens.length>0&&de.tokens[0].tokens[0].type==="text"&&(de.tokens[0].tokens[0].text=me+" "+de.tokens[0].tokens[0].text)):de.tokens.unshift({type:"text",text:me}):ge+=me),ge+=this.parse(de.tokens,ve),oe+=this.renderer.listitem(ge,he,ue);X+=this.renderer.list(oe,le,pe);continue}case"html":{X+=this.renderer.html(ae.text);continue}case"paragraph":{X+=this.renderer.paragraph(this.parseInline(ae.tokens));continue}case"text":{for(oe=ae.tokens?this.parseInline(ae.tokens):ae.text;ee+1<be&&B[ee+1].type==="text";)ae=B[++ee],oe+=`
`+(ae.tokens?this.parseInline(ae.tokens):ae.text);X+=j?this.renderer.paragraph(oe):oe;continue}default:{const Se='Token with "'+ae.type+'" type was not found.';if(this.options.silent){console.error(Se);return}else throw new Error(Se)}}}return X}parseInline(B,j){j=j||this.renderer;let X="",ee,te,ne;const re=B.length;for(ee=0;ee<re;ee++){if(te=B[ee],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[te.type]&&(ne=this.options.extensions.renderers[te.type].call({parser:this},te),ne!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(te.type))){X+=ne||"";continue}switch(te.type){case"escape":{X+=j.text(te.text);break}case"html":{X+=j.html(te.text);break}case"link":{X+=j.link(te.href,te.title,this.parseInline(te.tokens,j));break}case"image":{X+=j.image(te.href,te.title,te.text);break}case"strong":{X+=j.strong(this.parseInline(te.tokens,j));break}case"em":{X+=j.em(this.parseInline(te.tokens,j));break}case"codespan":{X+=j.codespan(te.text);break}case"br":{X+=j.br();break}case"del":{X+=j.del(this.parseInline(te.tokens,j));break}case"text":{X+=j.text(te.text);break}default:{const ie='Token with "'+te.type+'" type was not found.';if(this.options.silent){console.error(ie);return}else throw new Error(ie)}}}return X}}function marked(q,B,j){if(typeof q>"u"||q===null)throw new Error("marked(): input parameter is undefined or null");if(typeof q!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(q)+", string expected");if(typeof B=="function"&&(j=B,B=null),B=merge({},marked.defaults,B||{}),checkSanitizeDeprecation(B),j){const ee=B.highlight;let te;try{te=Lexer.lex(q,B)}catch(ie){return j(ie)}const ne=function(ie){let fe;if(!ie)try{B.walkTokens&&marked.walkTokens(te,B.walkTokens),fe=Parser.parse(te,B)}catch(ce){ie=ce}return B.highlight=ee,ie?j(ie):j(null,fe)};if(!ee||ee.length<3||(delete B.highlight,!te.length))return ne();let re=0;marked.walkTokens(te,function(ie){ie.type==="code"&&(re++,setTimeout(()=>{ee(ie.text,ie.lang,function(fe,ce){if(fe)return ne(fe);ce!=null&&ce!==ie.text&&(ie.text=ce,ie.escaped=!0),re--,re===0&&ne()})},0))}),re===0&&ne();return}function X(ee){if(ee.message+=`
Please report this to https://github.com/markedjs/marked.`,B.silent)return"<p>An error occurred:</p><pre>"+escape$1(ee.message+"",!0)+"</pre>";throw ee}try{const ee=Lexer.lex(q,B);if(B.walkTokens){if(B.async)return Promise.all(marked.walkTokens(ee,B.walkTokens)).then(()=>Parser.parse(ee,B)).catch(X);marked.walkTokens(ee,B.walkTokens)}return Parser.parse(ee,B)}catch(ee){X(ee)}}marked.options=marked.setOptions=function(q){return merge(marked.defaults,q),changeDefaults(marked.defaults),marked};marked.getDefaults=getDefaults;marked.defaults=defaults;marked.use=function(...q){const B=merge({},...q),j=marked.defaults.extensions||{renderers:{},childTokens:{}};let X;q.forEach(ee=>{if(ee.extensions&&(X=!0,ee.extensions.forEach(te=>{if(!te.name)throw new Error("extension name required");if(te.renderer){const ne=j.renderers?j.renderers[te.name]:null;ne?j.renderers[te.name]=function(...re){let ie=te.renderer.apply(this,re);return ie===!1&&(ie=ne.apply(this,re)),ie}:j.renderers[te.name]=te.renderer}if(te.tokenizer){if(!te.level||te.level!=="block"&&te.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");j[te.level]?j[te.level].unshift(te.tokenizer):j[te.level]=[te.tokenizer],te.start&&(te.level==="block"?j.startBlock?j.startBlock.push(te.start):j.startBlock=[te.start]:te.level==="inline"&&(j.startInline?j.startInline.push(te.start):j.startInline=[te.start]))}te.childTokens&&(j.childTokens[te.name]=te.childTokens)})),ee.renderer){const te=marked.defaults.renderer||new Renderer;for(const ne in ee.renderer){const re=te[ne];te[ne]=(...ie)=>{let fe=ee.renderer[ne].apply(te,ie);return fe===!1&&(fe=re.apply(te,ie)),fe}}B.renderer=te}if(ee.tokenizer){const te=marked.defaults.tokenizer||new Tokenizer;for(const ne in ee.tokenizer){const re=te[ne];te[ne]=(...ie)=>{let fe=ee.tokenizer[ne].apply(te,ie);return fe===!1&&(fe=re.apply(te,ie)),fe}}B.tokenizer=te}if(ee.walkTokens){const te=marked.defaults.walkTokens;B.walkTokens=function(ne){let re=[];return re.push(ee.walkTokens.call(this,ne)),te&&(re=re.concat(te.call(this,ne))),re}}X&&(B.extensions=j),marked.setOptions(B)})};marked.walkTokens=function(q,B){let j=[];for(const X of q)switch(j=j.concat(B.call(marked,X)),X.type){case"table":{for(const ee of X.header)j=j.concat(marked.walkTokens(ee.tokens,B));for(const ee of X.rows)for(const te of ee)j=j.concat(marked.walkTokens(te.tokens,B));break}case"list":{j=j.concat(marked.walkTokens(X.items,B));break}default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[X.type]?marked.defaults.extensions.childTokens[X.type].forEach(function(ee){j=j.concat(marked.walkTokens(X[ee],B))}):X.tokens&&(j=j.concat(marked.walkTokens(X.tokens,B)))}return j};marked.parseInline=function(q,B){if(typeof q>"u"||q===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof q!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(q)+", string expected");B=merge({},marked.defaults,B||{}),checkSanitizeDeprecation(B);try{const j=Lexer.lexInline(q,B);return B.walkTokens&&marked.walkTokens(j,B.walkTokens),Parser.parseInline(j,B)}catch(j){if(j.message+=`
Please report this to https://github.com/markedjs/marked.`,B.silent)return"<p>An error occurred:</p><pre>"+escape$1(j.message+"",!0)+"</pre>";throw j}};marked.Parser=Parser;marked.parser=Parser.parse;marked.Renderer=Renderer;marked.TextRenderer=TextRenderer;marked.Lexer=Lexer;marked.lexer=Lexer.lex;marked.Tokenizer=Tokenizer;marked.Slugger=Slugger;marked.parse=marked;marked.options;marked.setOptions;marked.use;marked.walkTokens;marked.parseInline;Parser.parse;Lexer.lex;function extend(q){for(var B=1;B<arguments.length;B++){var j=arguments[B];for(var X in j)j.hasOwnProperty(X)&&(q[X]=j[X])}return q}function repeat(q,B){return Array(B+1).join(q)}function trimLeadingNewlines(q){return q.replace(/^\n*/,"")}function trimTrailingNewlines(q){for(var B=q.length;B>0&&q[B-1]===`
`;)B--;return q.substring(0,B)}var blockElements=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function isBlock(q){return is(q,blockElements)}var voidElements=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function isVoid(q){return is(q,voidElements)}function hasVoid(q){return has(q,voidElements)}var meaningfulWhenBlankElements=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function isMeaningfulWhenBlank(q){return is(q,meaningfulWhenBlankElements)}function hasMeaningfulWhenBlank(q){return has(q,meaningfulWhenBlankElements)}function is(q,B){return B.indexOf(q.nodeName)>=0}function has(q,B){return q.getElementsByTagName&&B.some(function(j){return q.getElementsByTagName(j).length})}var rules={};rules.paragraph={filter:"p",replacement:function(q){return`

`+q+`

`}};rules.lineBreak={filter:"br",replacement:function(q,B,j){return j.br+`
`}};rules.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(q,B,j){var X=Number(B.nodeName.charAt(1));if(j.headingStyle==="setext"&&X<3){var ee=repeat(X===1?"=":"-",q.length);return`

`+q+`
`+ee+`

`}else return`

`+repeat("#",X)+" "+q+`

`}};rules.blockquote={filter:"blockquote",replacement:function(q){return q=q.replace(/^\n+|\n+$/g,""),q=q.replace(/^/gm,"> "),`

`+q+`

`}};rules.list={filter:["ul","ol"],replacement:function(q,B){var j=B.parentNode;return j.nodeName==="LI"&&j.lastElementChild===B?`
`+q:`

`+q+`

`}};rules.listItem={filter:"li",replacement:function(q,B,j){q=q.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var X=j.bulletListMarker+"   ",ee=B.parentNode;if(ee.nodeName==="OL"){var te=ee.getAttribute("start"),ne=Array.prototype.indexOf.call(ee.children,B);X=(te?Number(te)+ne:ne+1)+".  "}return X+q+(B.nextSibling&&!/\n$/.test(q)?`
`:"")}};rules.indentedCodeBlock={filter:function(q,B){return B.codeBlockStyle==="indented"&&q.nodeName==="PRE"&&q.firstChild&&q.firstChild.nodeName==="CODE"},replacement:function(q,B,j){return`

    `+B.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};rules.fencedCodeBlock={filter:function(q,B){return B.codeBlockStyle==="fenced"&&q.nodeName==="PRE"&&q.firstChild&&q.firstChild.nodeName==="CODE"},replacement:function(q,B,j){for(var X=B.firstChild.getAttribute("class")||"",ee=(X.match(/language-(\S+)/)||[null,""])[1],te=B.firstChild.textContent,ne=j.fence.charAt(0),re=3,ie=new RegExp("^"+ne+"{3,}","gm"),fe;fe=ie.exec(te);)fe[0].length>=re&&(re=fe[0].length+1);var ce=repeat(ne,re);return`

`+ce+ee+`
`+te.replace(/\n$/,"")+`
`+ce+`

`}};rules.horizontalRule={filter:"hr",replacement:function(q,B,j){return`

`+j.hr+`

`}};rules.inlineLink={filter:function(q,B){return B.linkStyle==="inlined"&&q.nodeName==="A"&&q.getAttribute("href")},replacement:function(q,B){var j=B.getAttribute("href"),X=cleanAttribute(B.getAttribute("title"));return X&&(X=' "'+X+'"'),"["+q+"]("+j+X+")"}};rules.referenceLink={filter:function(q,B){return B.linkStyle==="referenced"&&q.nodeName==="A"&&q.getAttribute("href")},replacement:function(q,B,j){var X=B.getAttribute("href"),ee=cleanAttribute(B.getAttribute("title"));ee&&(ee=' "'+ee+'"');var te,ne;switch(j.linkReferenceStyle){case"collapsed":te="["+q+"][]",ne="["+q+"]: "+X+ee;break;case"shortcut":te="["+q+"]",ne="["+q+"]: "+X+ee;break;default:var re=this.references.length+1;te="["+q+"]["+re+"]",ne="["+re+"]: "+X+ee}return this.references.push(ne),te},references:[],append:function(q){var B="";return this.references.length&&(B=`

`+this.references.join(`
`)+`

`,this.references=[]),B}};rules.emphasis={filter:["em","i"],replacement:function(q,B,j){return q.trim()?j.emDelimiter+q+j.emDelimiter:""}};rules.strong={filter:["strong","b"],replacement:function(q,B,j){return q.trim()?j.strongDelimiter+q+j.strongDelimiter:""}};rules.code={filter:function(q){var B=q.previousSibling||q.nextSibling,j=q.parentNode.nodeName==="PRE"&&!B;return q.nodeName==="CODE"&&!j},replacement:function(q){if(!q)return"";q=q.replace(/\r?\n|\r/g," ");for(var B=/^`|^ .*?[^ ].* $|`$/.test(q)?" ":"",j="`",X=q.match(/`+/gm)||[];X.indexOf(j)!==-1;)j=j+"`";return j+B+q+B+j}};rules.image={filter:"img",replacement:function(q,B){var j=cleanAttribute(B.getAttribute("alt")),X=B.getAttribute("src")||"",ee=cleanAttribute(B.getAttribute("title")),te=ee?' "'+ee+'"':"";return X?"!["+j+"]("+X+te+")":""}};function cleanAttribute(q){return q?q.replace(/(\n+\s*)+/g,`
`):""}function Rules(q){this.options=q,this._keep=[],this._remove=[],this.blankRule={replacement:q.blankReplacement},this.keepReplacement=q.keepReplacement,this.defaultRule={replacement:q.defaultReplacement},this.array=[];for(var B in q.rules)this.array.push(q.rules[B])}Rules.prototype={add:function(q,B){this.array.unshift(B)},keep:function(q){this._keep.unshift({filter:q,replacement:this.keepReplacement})},remove:function(q){this._remove.unshift({filter:q,replacement:function(){return""}})},forNode:function(q){if(q.isBlank)return this.blankRule;var B;return(B=findRule(this.array,q,this.options))||(B=findRule(this._keep,q,this.options))||(B=findRule(this._remove,q,this.options))?B:this.defaultRule},forEach:function(q){for(var B=0;B<this.array.length;B++)q(this.array[B],B)}};function findRule(q,B,j){for(var X=0;X<q.length;X++){var ee=q[X];if(filterValue(ee,B,j))return ee}}function filterValue(q,B,j){var X=q.filter;if(typeof X=="string"){if(X===B.nodeName.toLowerCase())return!0}else if(Array.isArray(X)){if(X.indexOf(B.nodeName.toLowerCase())>-1)return!0}else if(typeof X=="function"){if(X.call(q,B,j))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function collapseWhitespace(q){var B=q.element,j=q.isBlock,X=q.isVoid,ee=q.isPre||function(se){return se.nodeName==="PRE"};if(!(!B.firstChild||ee(B))){for(var te=null,ne=!1,re=null,ie=next(re,B,ee);ie!==B;){if(ie.nodeType===3||ie.nodeType===4){var fe=ie.data.replace(/[ \r\n\t]+/g," ");if((!te||/ $/.test(te.data))&&!ne&&fe[0]===" "&&(fe=fe.substr(1)),!fe){ie=remove(ie);continue}ie.data=fe,te=ie}else if(ie.nodeType===1)j(ie)||ie.nodeName==="BR"?(te&&(te.data=te.data.replace(/ $/,"")),te=null,ne=!1):X(ie)||ee(ie)?(te=null,ne=!0):te&&(ne=!1);else{ie=remove(ie);continue}var ce=next(re,ie,ee);re=ie,ie=ce}te&&(te.data=te.data.replace(/ $/,""),te.data||remove(te))}}function remove(q){var B=q.nextSibling||q.parentNode;return q.parentNode.removeChild(q),B}function next(q,B,j){return q&&q.parentNode===B||j(B)?B.nextSibling||B.parentNode:B.firstChild||B.nextSibling||B.parentNode}var root=typeof window<"u"?window:{};function canParseHTMLNatively(){var q=root.DOMParser,B=!1;try{new q().parseFromString("","text/html")&&(B=!0)}catch{}return B}function createHTMLParser(){var q=function(){};return shouldUseActiveX()?q.prototype.parseFromString=function(B){var j=new window.ActiveXObject("htmlfile");return j.designMode="on",j.open(),j.write(B),j.close(),j}:q.prototype.parseFromString=function(B){var j=document.implementation.createHTMLDocument("");return j.open(),j.write(B),j.close(),j},q}function shouldUseActiveX(){var q=!1;try{document.implementation.createHTMLDocument("").open()}catch{window.ActiveXObject&&(q=!0)}return q}var HTMLParser=canParseHTMLNatively()?root.DOMParser:createHTMLParser();function RootNode(q,B){var j;if(typeof q=="string"){var X=htmlParser().parseFromString('<x-turndown id="turndown-root">'+q+"</x-turndown>","text/html");j=X.getElementById("turndown-root")}else j=q.cloneNode(!0);return collapseWhitespace({element:j,isBlock,isVoid,isPre:B.preformattedCode?isPreOrCode:null}),j}var _htmlParser;function htmlParser(){return _htmlParser=_htmlParser||new HTMLParser,_htmlParser}function isPreOrCode(q){return q.nodeName==="PRE"||q.nodeName==="CODE"}function Node$1(q,B){return q.isBlock=isBlock(q),q.isCode=q.nodeName==="CODE"||q.parentNode.isCode,q.isBlank=isBlank(q),q.flankingWhitespace=flankingWhitespace(q,B),q}function isBlank(q){return!isVoid(q)&&!isMeaningfulWhenBlank(q)&&/^\s*$/i.test(q.textContent)&&!hasVoid(q)&&!hasMeaningfulWhenBlank(q)}function flankingWhitespace(q,B){if(q.isBlock||B.preformattedCode&&q.isCode)return{leading:"",trailing:""};var j=edgeWhitespace(q.textContent);return j.leadingAscii&&isFlankedByWhitespace("left",q,B)&&(j.leading=j.leadingNonAscii),j.trailingAscii&&isFlankedByWhitespace("right",q,B)&&(j.trailing=j.trailingNonAscii),{leading:j.leading,trailing:j.trailing}}function edgeWhitespace(q){var B=q.match(/^(([ \t\r\n]*)(\s*))[\s\S]*?((\s*?)([ \t\r\n]*))$/);return{leading:B[1],leadingAscii:B[2],leadingNonAscii:B[3],trailing:B[4],trailingNonAscii:B[5],trailingAscii:B[6]}}function isFlankedByWhitespace(q,B,j){var X,ee,te;return q==="left"?(X=B.previousSibling,ee=/ $/):(X=B.nextSibling,ee=/^ /),X&&(X.nodeType===3?te=ee.test(X.nodeValue):j.preformattedCode&&X.nodeName==="CODE"?te=!1:X.nodeType===1&&!isBlock(X)&&(te=ee.test(X.textContent))),te}var reduce=Array.prototype.reduce,escapes=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function TurndownService(q){if(!(this instanceof TurndownService))return new TurndownService(q);var B={rules,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(j,X){return X.isBlock?`

`:""},keepReplacement:function(j,X){return X.isBlock?`

`+X.outerHTML+`

`:X.outerHTML},defaultReplacement:function(j,X){return X.isBlock?`

`+j+`

`:j}};this.options=extend({},B,q),this.rules=new Rules(this.options)}TurndownService.prototype={turndown:function(q){if(!canConvert(q))throw new TypeError(q+" is not a string, or an element/document/fragment node.");if(q==="")return"";var B=process$1.call(this,new RootNode(q,this.options));return postProcess.call(this,B)},use:function(q){if(Array.isArray(q))for(var B=0;B<q.length;B++)this.use(q[B]);else if(typeof q=="function")q(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(q,B){return this.rules.add(q,B),this},keep:function(q){return this.rules.keep(q),this},remove:function(q){return this.rules.remove(q),this},escape:function(q){return escapes.reduce(function(B,j){return B.replace(j[0],j[1])},q)}};function process$1(q){var B=this;return reduce.call(q.childNodes,function(j,X){X=new Node$1(X,B.options);var ee="";return X.nodeType===3?ee=X.isCode?X.nodeValue:B.escape(X.nodeValue):X.nodeType===1&&(ee=replacementForNode.call(B,X)),join(j,ee)},"")}function postProcess(q){var B=this;return this.rules.forEach(function(j){typeof j.append=="function"&&(q=join(q,j.append(B.options)))}),q.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function replacementForNode(q){var B=this.rules.forNode(q),j=process$1.call(this,q),X=q.flankingWhitespace;return(X.leading||X.trailing)&&(j=j.trim()),X.leading+B.replacement(j,q,this.options)+X.trailing}function join(q,B){var j=trimTrailingNewlines(q),X=trimLeadingNewlines(B),ee=Math.max(q.length-j.length,B.length-X.length),te=`

`.substring(0,ee);return j+te+X}function canConvert(q){return q!=null&&(typeof q=="string"||q.nodeType&&(q.nodeType===1||q.nodeType===9||q.nodeType===11))}const FileExporter={injectHtmlCss:()=>`
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <style>
    :root {
      --affine-primary-color: #3a4c5c;
      --affine-font-family: Avenir Next, apple-system, BlinkMacSystemFont, Helvetica Neue, Tahoma, PingFang SC, Microsoft Yahei, Arial, Hiragino Sans GB, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
      --affine-font-family2: Roboto Mono, apple-system, BlinkMacSystemFont, Helvetica Neue, Tahoma, PingFang SC, Microsoft Yahei, Arial, Hiragino Sans GB, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
  }
    body {
      font-family: var(--affine-font-family);
      color: var(--affine-primary-color);
    }
    </style>
    `,exportFile:(q,B,j)=>{const X=document.createElement("a");X.setAttribute("href","data:"+j+";charset=utf-8,"+encodeURIComponent(B)),X.setAttribute("download",q),X.style.display="none",document.body.appendChild(X),X.click(),document.body.removeChild(X)},decorateHtml:(q,B)=>{const j=FileExporter.injectHtmlCss();return`<!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <title>${q}</title>
          ${j}
        </head>
        <body>
            <div style="margin:0 auto;width:720px" >
                 ${B}
            </div>
        </body>
        </html>`},exportHtml:(q,B)=>{FileExporter.exportFile((q||"Untitled")+".html",FileExporter.decorateHtml(q,B),"text/html")},exportMarkdown:(q,B)=>{const j=new TurndownService;j.addRule("input",{filter:["input"],replacement:function(ee,te){return te.getAttribute("checked")===null?"[ ] ":"[x] "}});const X=j.turndown(B);FileExporter.exportFile((q||"Undefined")+".md",X,"text/plain")}},INLINE_TAGS=["DEL","STRONG","B","EM","I","U","S","SPAN","A","INPUT","MARK","CODE","LABEL","BIG","SMALL","ABBR","CITE"];class ParserHtml{constructor(B){this._contentParser=B}registerParsers(){this._contentParser.registerParserHtmlText2Block("nodeParser",this._nodePaser.bind(this)),this._contentParser.registerParserHtmlText2Block("commonParser",this._commonParser.bind(this)),this._contentParser.registerParserHtmlText2Block("listItemParser",this._listItemParser.bind(this)),this._contentParser.registerParserHtmlText2Block("blockQuoteParser",this._blockQuoteParser.bind(this))}_nodePaser(B){var ee,te,ne,re,ie,fe,ce,se,oe,ae,le;let j;if(j=(ee=this._contentParser.getParserHtmlText2Block("customNodeParser"))==null?void 0:ee(B),j&&j.length>0)return j;const X=B.tagName;if(B instanceof Text||INLINE_TAGS.includes(X))j=(te=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:te({element:B,flavour:"affine:paragraph",type:"text"});else switch(X){case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":j=(ne=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:ne({element:B,flavour:"affine:paragraph",type:X.toLowerCase()});break;case"BLOCKQUOTE":j=(re=this._contentParser.getParserHtmlText2Block("blockQuoteParser"))==null?void 0:re(B);break;case"P":B.firstChild instanceof Text&&(((ie=B.firstChild.textContent)==null?void 0:ie.startsWith("[] "))||((fe=B.firstChild.textContent)==null?void 0:fe.startsWith("[ ] "))||((ce=B.firstChild.textContent)==null?void 0:ce.startsWith("[x] ")))?j=(se=this._contentParser.getParserHtmlText2Block("listItemParser"))==null?void 0:se(B):j=(oe=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:oe({element:B,flavour:"affine:paragraph",type:"text"});break;case"DIV":j=(ae=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:ae({element:B,flavour:"affine:paragraph",type:"text"});break;case"LI":j=(le=this._contentParser.getParserHtmlText2Block("listItemParser"))==null?void 0:le(B);break}return j&&j.length>0?j:Array.from(B.children).map(pe=>{var ge;const ve=((ge=this._contentParser.getParserHtmlText2Block("nodeParser"))==null?void 0:ge(pe))||[];return ve&&ve.length?ve:[]}).flat().filter(pe=>pe)}_commonParser({element:B,flavour:j,type:X,checked:ee,ignoreEmptyElement:te=!0}){const ne=this._commonHTML2Block(B,j,X,ee,te);return ne?[ne]:null}_commonHTML2Block(B,j,X,ee,te=!0){const ne=B.childNodes;let re=!1;const ie=[],fe=[];for(let ce=0;ce<ne.length;ce++){const se=ne.item(ce);if(!!se){if(!re){if(se instanceof Text){ie.push(...this._commonHTML2Text(se,{},te));continue}const oe=se;if(INLINE_TAGS.includes(oe.tagName)){ie.push(...this._commonHTML2Text(se,{},te));continue}}if(se instanceof Element){const oe=this._nodePaser(se);oe&&fe.push(...oe)}re=!0}}return{flavour:j,type:X,checked:ee,text:ie,children:fe}}_commonHTML2Text(B,j={},X=!0){if(B instanceof Text)return(B.textContent||"").split(`
`).map(ie=>({insert:ie,attributes:j}));const ee=B,te=Array.from(ee.childNodes),ne=getTextStyle(ee);return te.length?te.reduce((ie,fe)=>{const ce=this._commonHTML2Text(fe,{...j,...ne},X);return ie.push(...ce),ie},[]).filter(ie=>ie):X?[]:[{insert:"",attributes:ne}]}_listItemParser(B){var re,ie,fe,ce,se,oe,ae,le;let X=((re=B.parentElement)==null?void 0:re.tagName)==="OL"?"numbered":"bulleted",ee,te;return(((ie=te=B.firstElementChild)==null?void 0:ie.tagName)==="INPUT"||((ce=te=(fe=B.firstElementChild)==null?void 0:fe.firstElementChild)==null?void 0:ce.tagName)==="INPUT")&&(X="todo",ee=(te==null?void 0:te.getAttribute("checked"))!==null),B.firstChild instanceof Text&&((se=B.firstChild.textContent)!=null&&se.startsWith("[] ")?(B.firstChild.textContent=B.firstChild.textContent.slice(3),X="todo",ee=!1):(oe=B.firstChild.textContent)!=null&&oe.startsWith("[ ] ")?(B.firstChild.textContent=B.firstChild.textContent.slice(4),X="todo",ee=!1):(ae=B.firstChild.textContent)!=null&&ae.startsWith("[x] ")&&(B.firstChild.textContent=B.firstChild.textContent.slice(4),X="todo",ee=!0)),(le=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:le({element:B,flavour:"affine:list",type:X,checked:ee})}_blockQuoteParser(B){var ee;const j=te=>{const ne=[];return te.forEach(re=>{const ie=re.text.filter(ce=>ce.insert);ne.length>0&&ie.length>0&&ne.push({insert:`
`}),ne.push(...ie);const fe=j(re.children);ne.length>0&&fe.length>0&&ne.push({insert:`
`}),ne.push(...fe)}),ne},X=(ee=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:ee({element:B,flavour:"affine:paragraph",type:"text"});return X?[{flavour:"affine:paragraph",type:"quote",text:j(X),children:[]}]:null}}const getIsLink=q=>["A"].includes(q.tagName),getTextStyle=q=>{const B=q.tagName,j={},X=(q.getAttribute("style")||"").split(";").reduce((ee,te)=>{const[ne,re]=te.split(":");return ne&&re&&(ee[ne]=re),ee},{});return(X["font-weight"]==="bold"||Number(X["font-weight"])>400||["STRONG","B","H1","H2","H3","H4","H5","H6"].includes(q.tagName))&&(j.bold=!0),getIsLink(q)&&(j.link=q.getAttribute("href")||q.getAttribute("src")),(B==="EM"||X.fontStyle==="italic")&&(j.italic=!0),(B==="U"||X["text-decoration"]&&X["text-decoration"].indexOf("underline")!==-1||X["border-bottom"])&&(j.underline=!0),B==="CODE"&&(j.code=!0),(B==="S"||B==="DEL"||X["text-decoration"]&&X["text-decoration"].indexOf("line-through")!==-1)&&(j.strike=!0),B==="MARK"&&(j.background="yellow"),j};class ContentParser{constructor(B){this.signals={beforeHtml2Block:new Signal},this._parsers={},this._editor=B,this._parseHtml=new ParserHtml(this),this._parseHtml.registerParsers()}onExportHtml(){const B=this._editor.page.root;if(!B)return;const j=this.block2Html(this._getSelectedBlock(B).children);FileExporter.exportHtml(B.title,j)}onExportMarkdown(){const B=this._editor.page.root;if(!B)return;const j=this.block2Html(this._getSelectedBlock(B).children);FileExporter.exportMarkdown(B.title,j)}block2Html(B){return B.reduce((X,ee,te,ne)=>X+this._getHtmlInfoBySelectionInfo(ee,te>0?ne[te-1]:null,te<ne.length-1?ne[te+1]:null),"")}block2Text(B){return B.reduce((X,ee)=>X+this._getTextInfoBySelectionInfo(ee),"")}htmlText2Block(B){var X;const j=document.createElement("html");return j.innerHTML=B,(X=j.querySelector("head"))==null||X.remove(),this.signals.beforeHtml2Block.emit(j),this._convertHtml2Blocks(j)}markdown2Block(B){const j={name:"underline",level:"inline",start(ee){return ee.indexOf("~")},tokenizer(ee){const ne=/^~([^~]+)~/.exec(ee);if(ne)return{type:"underline",raw:ne[0],text:ne[1].trim()}},renderer(ee){return`<u>${ee.text}</u>`}};marked.use({extensions:[j]});const X=marked.parse(B);return this.htmlText2Block(X)}registerParserHtmlText2Block(B,j){this._parsers[B]=j}getParserHtmlText2Block(B){return this._parsers[B]||null}text2blocks(B){return B.split(`
`).map(j=>({flavour:"affine:paragraph",type:"text",text:[{insert:j}],children:[]}))}_getSelectedBlock(B){return{id:B.id,children:B.children.map(X=>this._getSelectedBlock(X))}}_getHtmlInfoBySelectionInfo(B,j,X){const ee=this._editor.page.getBlockById(B.id);if(!ee)return"";const te=B.children.reduce((re,ie,fe,ce)=>{const se=this._getHtmlInfoBySelectionInfo(ie,fe>0?ce[fe-1]:null,fe<ce.length-1?ce[fe+1]:null);return se&&re.push(se),re},[]);return ee.block2html(te.join(""),(j==null?void 0:j.id)||"",(X==null?void 0:X.id)||"",B.startPos,B.endPos)}_getTextInfoBySelectionInfo(B){const j=this._editor.page.getBlockById(B.id);if(!j)return"";const X=[];return B.children.forEach(te=>{const ne=this._getTextInfoBySelectionInfo(te);ne&&X.push(ne)}),j.block2Text(X.join(""),B.startPos,B.endPos)}_convertHtml2Blocks(B){return Array.from(B.children).map(j=>{var ee;const X=((ee=this.getParserHtmlText2Block("nodeParser"))==null?void 0:ee(j))||[];return X&&X.length?X:[]}).flat().filter(j=>j)}}class ClipboardManager{constructor(B,j){this._editor=B,this._clipboardTarget=j,this._copy=new CopyCutManager(this._editor),this._paste=new PasteManager(this._editor),this._clipboardEventDispatcher=new ClipEventDispatch(this._clipboardTarget),this._clipboardEventDispatcher.signals.copy.on(this._copy.handleCopy),this._clipboardEventDispatcher.signals.cut.on(this._copy.handleCut),this._clipboardEventDispatcher.signals.paste.on(this._paste.handlePaste)}set clipboardTarget(B){this._clipboardEventDispatcher.disposeClipboardTargetEvent(this._clipboardTarget),this._clipboardTarget=B,this._clipboardEventDispatcher.initialClipboardTargetEvent(this._clipboardTarget)}get clipboardTarget(){return this._clipboardTarget}importMarkdown(B,j){const X=this._editor.contentParser.markdown2Block(B);this._paste.insertBlocks(X,{type:"Block",selectedBlocks:[{id:j,children:[]}]})}dispose(){this._clipboardEventDispatcher.dispose(this.clipboardTarget)}}const env=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},importIdentifier="__ $BLOCKSUITE_EDITOR$ __";env[importIdentifier]===!0&&console.error("@blocksuite/editor was already imported. This breaks constructor checks and will lead to issues!");env[importIdentifier]=!0;const createEditor=q=>{const B=document.createElement("editor-container");return B.page=q,B},createDebugMenu=(q,B)=>{const j=document.createElement("debug-menu");return j.workspace=q,j.editor=B,j},style="",params=new URLSearchParams(location.search);var In;const room=(In=params.get("room"))!=null?In:"",isTest=params.get("isTest")==="true";function editorOptionsFromParam(){var ee;const q=[];let B=!1;((ee=params.get("syncModes"))!=null?ee:"debug").split(",").forEach(te=>{switch(te){case"debug":q.push(DebugDocProvider);break;case"indexeddb":q.push(IndexedDBDocProvider),B=!0;break;case"websocket":{const ne=createWebsocketDocProvider("ws://127.0.0.1:1234");q.push(ne),B=!0;break}default:throw new TypeError(`Unknown provider ("${te}") supplied in search param ?syncModes=... (for example "debug" and "indexeddb")`)}});const X=B?uuidv4:createAutoIncrement();return{providers:q,idGenerator:X}}window.onload=()=>{const q=new Workspace({room,...editorOptionsFromParam()});if(window.workspace=q,window.blockSchema=BlockSchema,!isTest){const B=q.createPage("page0").register(BlockSchema),j=createEditor(B),X=createDebugMenu(q,j);document.body.appendChild(j),document.body.appendChild(X)}};

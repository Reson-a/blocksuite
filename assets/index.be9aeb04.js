(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Eo=window,Aa=Eo.ShadowRoot&&(Eo.ShadyCSS===void 0||Eo.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Oa=Symbol(),Rl=new WeakMap;class Hc{constructor(t,e,r){if(this._$cssResult$=!0,r!==Oa)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(Aa&&t===void 0){const r=e!==void 0&&e.length===1;r&&(t=Rl.get(e)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),r&&Rl.set(e,t))}return t}toString(){return this.cssText}}const Ve=n=>new Hc(typeof n=="string"?n:n+"",void 0,Oa),Kt=(n,...t)=>{const e=n.length===1?n[0]:t.reduce((r,i,o)=>r+(s=>{if(s._$cssResult$===!0)return s.cssText;if(typeof s=="number")return s;throw Error("Value passed to 'css' function must be a 'css' function result: "+s+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+n[o+1],n[0]);return new Hc(e,n,Oa)},Uh=(n,t)=>{Aa?n.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):t.forEach(e=>{const r=document.createElement("style"),i=Eo.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=e.cssText,n.appendChild(r)})},Ll=Aa?n=>n:n=>n instanceof CSSStyleSheet?(t=>{let e="";for(const r of t.cssRules)e+=r.cssText;return Ve(e)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Rs;const Mo=window,Nl=Mo.trustedTypes,Fh=Nl?Nl.emptyScript:"",Pl=Mo.reactiveElementPolyfillSupport,aa={toAttribute(n,t){switch(t){case Boolean:n=n?Fh:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,t){let e=n;switch(t){case Boolean:e=n!==null;break;case Number:e=n===null?null:Number(n);break;case Object:case Array:try{e=JSON.parse(n)}catch{e=null}}return e}},zc=(n,t)=>t!==n&&(t==t||n==n),Ls={attribute:!0,type:String,converter:aa,reflect:!1,hasChanged:zc};class Pr extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;(e=this.h)!==null&&e!==void 0||(this.h=[]),this.h.push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach((e,r)=>{const i=this._$Ep(r,e);i!==void 0&&(this._$Ev.set(i,r),t.push(i))}),t}static createProperty(t,e=Ls){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const r=typeof t=="symbol"?Symbol():"__"+t,i=this.getPropertyDescriptor(t,r,e);i!==void 0&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,r){return{get(){return this[e]},set(i){const o=this[t];this[e]=i,this.requestUpdate(t,o,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||Ls}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,r=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const i of r)this.createProperty(i,e[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const i of r)e.unshift(Ll(i))}else t!==void 0&&e.push(Ll(t));return e}static _$Ep(t,e){const r=e.attribute;return r===!1?void 0:typeof r=="string"?r:typeof t=="string"?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(t=this.constructor.h)===null||t===void 0||t.forEach(e=>e(this))}addController(t){var e,r;((e=this._$ES)!==null&&e!==void 0?e:this._$ES=[]).push(t),this.renderRoot!==void 0&&this.isConnected&&((r=t.hostConnected)===null||r===void 0||r.call(t))}removeController(t){var e;(e=this._$ES)===null||e===void 0||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])})}createRenderRoot(){var t;const e=(t=this.shadowRoot)!==null&&t!==void 0?t:this.attachShadow(this.constructor.shadowRootOptions);return Uh(e,this.constructor.elementStyles),e}connectedCallback(){var t;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$ES)===null||t===void 0||t.forEach(e=>{var r;return(r=e.hostConnected)===null||r===void 0?void 0:r.call(e)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$ES)===null||t===void 0||t.forEach(e=>{var r;return(r=e.hostDisconnected)===null||r===void 0?void 0:r.call(e)})}attributeChangedCallback(t,e,r){this._$AK(t,r)}_$EO(t,e,r=Ls){var i;const o=this.constructor._$Ep(t,r);if(o!==void 0&&r.reflect===!0){const s=(((i=r.converter)===null||i===void 0?void 0:i.toAttribute)!==void 0?r.converter:aa).toAttribute(e,r.type);this._$El=t,s==null?this.removeAttribute(o):this.setAttribute(o,s),this._$El=null}}_$AK(t,e){var r;const i=this.constructor,o=i._$Ev.get(t);if(o!==void 0&&this._$El!==o){const s=i.getPropertyOptions(o),c=typeof s.converter=="function"?{fromAttribute:s.converter}:((r=s.converter)===null||r===void 0?void 0:r.fromAttribute)!==void 0?s.converter:aa;this._$El=o,this[o]=c.fromAttribute(e,s.type),this._$El=null}}requestUpdate(t,e,r){let i=!0;t!==void 0&&(((r=r||this.constructor.getPropertyOptions(t)).hasChanged||zc)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),r.reflect===!0&&this._$El!==t&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(t,r))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((i,o)=>this[o]=i),this._$Ei=void 0);let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),(t=this._$ES)===null||t===void 0||t.forEach(i=>{var o;return(o=i.hostUpdate)===null||o===void 0?void 0:o.call(i)}),this.update(r)):this._$Ek()}catch(i){throw e=!1,this._$Ek(),i}e&&this._$AE(r)}willUpdate(t){}_$AE(t){var e;(e=this._$ES)===null||e===void 0||e.forEach(r=>{var i;return(i=r.hostUpdated)===null||i===void 0?void 0:i.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){this._$EC!==void 0&&(this._$EC.forEach((e,r)=>this._$EO(r,this[r],e)),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}Pr.finalized=!0,Pr.elementProperties=new Map,Pr.elementStyles=[],Pr.shadowRootOptions={mode:"open"},Pl==null||Pl({ReactiveElement:Pr}),((Rs=Mo.reactiveElementVersions)!==null&&Rs!==void 0?Rs:Mo.reactiveElementVersions=[]).push("1.4.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Ns;const Bo=window,qr=Bo.trustedTypes,Dl=qr?qr.createPolicy("lit-html",{createHTML:n=>n}):void 0,In=`lit$${(Math.random()+"").slice(9)}$`,Ta="?"+In,Hh=`<${Ta}>`,Ur=document,xi=(n="")=>Ur.createComment(n),Ei=n=>n===null||typeof n!="object"&&typeof n!="function",Vc=Array.isArray,Kc=n=>Vc(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",di=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Il=/-->/g,Ml=/>/g,sr=RegExp(`>|[ 	
\f\r](?:([^\\s"'>=/]+)([ 	
\f\r]*=[ 	
\f\r]*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Bl=/'/g,$l=/"/g,Wc=/^(?:script|style|textarea|title)$/i,Gc=n=>(t,...e)=>({_$litType$:n,strings:t,values:e}),ft=Gc(1),ss=Gc(2),Un=Symbol.for("lit-noChange"),be=Symbol.for("lit-nothing"),jl=new WeakMap,zh=(n,t,e)=>{var r,i;const o=(r=e==null?void 0:e.renderBefore)!==null&&r!==void 0?r:t;let s=o._$litPart$;if(s===void 0){const c=(i=e==null?void 0:e.renderBefore)!==null&&i!==void 0?i:null;o._$litPart$=s=new Qr(t.insertBefore(xi(),c),c,void 0,e!=null?e:{})}return s._$AI(n),s},Mr=Ur.createTreeWalker(Ur,129,null,!1),Yc=(n,t)=>{const e=n.length-1,r=[];let i,o=t===2?"<svg>":"",s=di;for(let a=0;a<e;a++){const y=n[a];let g,u,l=-1,f=0;for(;f<y.length&&(s.lastIndex=f,u=s.exec(y),u!==null);)f=s.lastIndex,s===di?u[1]==="!--"?s=Il:u[1]!==void 0?s=Ml:u[2]!==void 0?(Wc.test(u[2])&&(i=RegExp("</"+u[2],"g")),s=sr):u[3]!==void 0&&(s=sr):s===sr?u[0]===">"?(s=i!=null?i:di,l=-1):u[1]===void 0?l=-2:(l=s.lastIndex-u[2].length,g=u[1],s=u[3]===void 0?sr:u[3]==='"'?$l:Bl):s===$l||s===Bl?s=sr:s===Il||s===Ml?s=di:(s=sr,i=void 0);const h=s===sr&&n[a+1].startsWith("/>")?" ":"";o+=s===di?y+Hh:l>=0?(r.push(g),y.slice(0,l)+"$lit$"+y.slice(l)+In+h):y+In+(l===-2?(r.push(void 0),a):h)}const c=o+(n[e]||"<?>")+(t===2?"</svg>":"");if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return[Dl!==void 0?Dl.createHTML(c):c,r]};class Si{constructor({strings:t,_$litType$:e},r){let i;this.parts=[];let o=0,s=0;const c=t.length-1,a=this.parts,[y,g]=Yc(t,e);if(this.el=Si.createElement(y,r),Mr.currentNode=this.el.content,e===2){const u=this.el.content,l=u.firstChild;l.remove(),u.append(...l.childNodes)}for(;(i=Mr.nextNode())!==null&&a.length<c;){if(i.nodeType===1){if(i.hasAttributes()){const u=[];for(const l of i.getAttributeNames())if(l.endsWith("$lit$")||l.startsWith(In)){const f=g[s++];if(u.push(l),f!==void 0){const h=i.getAttribute(f.toLowerCase()+"$lit$").split(In),m=/([.?@])?(.*)/.exec(f);a.push({type:1,index:o,name:m[2],strings:h,ctor:m[1]==="."?Xc:m[1]==="?"?Jc:m[1]==="@"?Qc:Vi})}else a.push({type:6,index:o})}for(const l of u)i.removeAttribute(l)}if(Wc.test(i.tagName)){const u=i.textContent.split(In),l=u.length-1;if(l>0){i.textContent=qr?qr.emptyScript:"";for(let f=0;f<l;f++)i.append(u[f],xi()),Mr.nextNode(),a.push({type:2,index:++o});i.append(u[l],xi())}}}else if(i.nodeType===8)if(i.data===Ta)a.push({type:2,index:o});else{let u=-1;for(;(u=i.data.indexOf(In,u+1))!==-1;)a.push({type:7,index:o}),u+=In.length-1}o++}}static createElement(t,e){const r=Ur.createElement("template");return r.innerHTML=t,r}}function fr(n,t,e=n,r){var i,o,s,c;if(t===Un)return t;let a=r!==void 0?(i=e._$Cl)===null||i===void 0?void 0:i[r]:e._$Cu;const y=Ei(t)?void 0:t._$litDirective$;return(a==null?void 0:a.constructor)!==y&&((o=a==null?void 0:a._$AO)===null||o===void 0||o.call(a,!1),y===void 0?a=void 0:(a=new y(n),a._$AT(n,e,r)),r!==void 0?((s=(c=e)._$Cl)!==null&&s!==void 0?s:c._$Cl=[])[r]=a:e._$Cu=a),a!==void 0&&(t=fr(n,a._$AS(n,t.values),a,r)),t}class Zc{constructor(t,e){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var e;const{el:{content:r},parts:i}=this._$AD,o=((e=t==null?void 0:t.creationScope)!==null&&e!==void 0?e:Ur).importNode(r,!0);Mr.currentNode=o;let s=Mr.nextNode(),c=0,a=0,y=i[0];for(;y!==void 0;){if(c===y.index){let g;y.type===2?g=new Qr(s,s.nextSibling,this,t):y.type===1?g=new y.ctor(s,y.name,y.strings,this,t):y.type===6&&(g=new tu(s,this,t)),this.v.push(g),y=i[++a]}c!==(y==null?void 0:y.index)&&(s=Mr.nextNode(),c++)}return o}m(t){let e=0;for(const r of this.v)r!==void 0&&(r.strings!==void 0?(r._$AI(t,r,e),e+=r.strings.length-2):r._$AI(t[e])),e++}}class Qr{constructor(t,e,r,i){var o;this.type=2,this._$AH=be,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=r,this.options=i,this._$C_=(o=i==null?void 0:i.isConnected)===null||o===void 0||o}get _$AU(){var t,e;return(e=(t=this._$AM)===null||t===void 0?void 0:t._$AU)!==null&&e!==void 0?e:this._$C_}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&t.nodeType===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=fr(this,t,e),Ei(t)?t===be||t==null||t===""?(this._$AH!==be&&this._$AR(),this._$AH=be):t!==this._$AH&&t!==Un&&this.$(t):t._$litType$!==void 0?this.T(t):t.nodeType!==void 0?this.k(t):Kc(t)?this.O(t):this.$(t)}S(t,e=this._$AB){return this._$AA.parentNode.insertBefore(t,e)}k(t){this._$AH!==t&&(this._$AR(),this._$AH=this.S(t))}$(t){this._$AH!==be&&Ei(this._$AH)?this._$AA.nextSibling.data=t:this.k(Ur.createTextNode(t)),this._$AH=t}T(t){var e;const{values:r,_$litType$:i}=t,o=typeof i=="number"?this._$AC(t):(i.el===void 0&&(i.el=Si.createElement(i.h,this.options)),i);if(((e=this._$AH)===null||e===void 0?void 0:e._$AD)===o)this._$AH.m(r);else{const s=new Zc(o,this),c=s.p(this.options);s.m(r),this.k(c),this._$AH=s}}_$AC(t){let e=jl.get(t.strings);return e===void 0&&jl.set(t.strings,e=new Si(t)),e}O(t){Vc(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let r,i=0;for(const o of t)i===e.length?e.push(r=new Qr(this.S(xi()),this.S(xi()),this,this.options)):r=e[i],r._$AI(o),i++;i<e.length&&(this._$AR(r&&r._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var r;for((r=this._$AP)===null||r===void 0||r.call(this,!1,!0,e);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){var e;this._$AM===void 0&&(this._$C_=t,(e=this._$AP)===null||e===void 0||e.call(this,t))}}class Vi{constructor(t,e,r,i,o){this.type=1,this._$AH=be,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=o,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=be}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,r,i){const o=this.strings;let s=!1;if(o===void 0)t=fr(this,t,e,0),s=!Ei(t)||t!==this._$AH&&t!==Un,s&&(this._$AH=t);else{const c=t;let a,y;for(t=o[0],a=0;a<o.length-1;a++)y=fr(this,c[r+a],e,a),y===Un&&(y=this._$AH[a]),s||(s=!Ei(y)||y!==this._$AH[a]),y===be?t=be:t!==be&&(t+=(y!=null?y:"")+o[a+1]),this._$AH[a]=y}s&&!i&&this.P(t)}P(t){t===be?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t!=null?t:"")}}class Xc extends Vi{constructor(){super(...arguments),this.type=3}P(t){this.element[this.name]=t===be?void 0:t}}const Vh=qr?qr.emptyScript:"";class Jc extends Vi{constructor(){super(...arguments),this.type=4}P(t){t&&t!==be?this.element.setAttribute(this.name,Vh):this.element.removeAttribute(this.name)}}class Qc extends Vi{constructor(t,e,r,i,o){super(t,e,r,i,o),this.type=5}_$AI(t,e=this){var r;if((t=(r=fr(this,t,e,0))!==null&&r!==void 0?r:be)===Un)return;const i=this._$AH,o=t===be&&i!==be||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==be&&(i===be||o);o&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,r;typeof this._$AH=="function"?this._$AH.call((r=(e=this.options)===null||e===void 0?void 0:e.host)!==null&&r!==void 0?r:this.element,t):this._$AH.handleEvent(t)}}class tu{constructor(t,e,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){fr(this,t)}}const Kh={A:"$lit$",M:In,C:Ta,L:1,R:Yc,D:Zc,V:Kc,I:fr,H:Qr,N:Vi,U:Jc,B:Qc,F:Xc,W:tu},ql=Bo.litHtmlPolyfillSupport;ql==null||ql(Si,Qr),((Ns=Bo.litHtmlVersions)!==null&&Ns!==void 0?Ns:Bo.litHtmlVersions=[]).push("2.3.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Ps,Ds;class zt extends Pr{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const r=super.createRenderRoot();return(t=(e=this.renderOptions).renderBefore)!==null&&t!==void 0||(e.renderBefore=r.firstChild),r}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=zh(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!1)}render(){return Un}}zt.finalized=!0,zt._$litElement$=!0,(Ps=globalThis.litElementHydrateSupport)===null||Ps===void 0||Ps.call(globalThis,{LitElement:zt});const Ul=globalThis.litElementPolyfillSupport;Ul==null||Ul({LitElement:zt});((Ds=globalThis.litElementVersions)!==null&&Ds!==void 0?Ds:globalThis.litElementVersions=[]).push("3.2.2");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Xt=n=>t=>typeof t=="function"?((e,r)=>(customElements.define(e,r),r))(n,t):((e,r)=>{const{kind:i,elements:o}=r;return{kind:i,elements:o,finisher(s){customElements.define(e,s)}}})(n,t);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Wh=(n,t)=>t.kind==="method"&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(e){e.createProperty(t.key,n)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){typeof t.initializer=="function"&&(this[t.key]=t.initializer.call(this))},finisher(e){e.createProperty(t.key,n)}};function xt(n){return(t,e)=>e!==void 0?((r,i,o)=>{i.constructor.createProperty(o,r)})(n,t,e):Wh(n,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function ke(n){return xt({...n,state:!0})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Gh=({finisher:n,descriptor:t})=>(e,r)=>{var i;if(r===void 0){const o=(i=e.originalKey)!==null&&i!==void 0?i:e.key,s=t!=null?{kind:"method",placement:"prototype",key:o,descriptor:t(e.key)}:{...e,key:o};return n!=null&&(s.finisher=function(c){n(c,o)}),s}{const o=e.constructor;t!==void 0&&Object.defineProperty(e,r,t(r)),n==null||n(o,r)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Ki(n,t){return Gh({descriptor:e=>{const r={get(){var i,o;return(o=(i=this.renderRoot)===null||i===void 0?void 0:i.querySelector(n))!==null&&o!==void 0?o:null},enumerable:!0,configurable:!0};if(t){const i=typeof e=="symbol"?Symbol():"__"+e;r.get=function(){var o,s;return this[i]===void 0&&(this[i]=(s=(o=this.renderRoot)===null||o===void 0?void 0:o.querySelector(n))!==null&&s!==void 0?s:null),this[i]}}return r}})}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Is;((Is=window.HTMLSlotElement)===null||Is===void 0?void 0:Is.prototype.assignedElements)!=null;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ra={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},La=n=>(...t)=>({_$litDirective$:n,values:t});class Na{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,r){this._$Ct=t,this._$AM=e,this._$Ci=r}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ce=La(class extends Na{constructor(n){var t;if(super(n),n.type!==Ra.ATTRIBUTE||n.name!=="style"||((t=n.strings)===null||t===void 0?void 0:t.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(n){return Object.keys(n).reduce((t,e)=>{const r=n[e];return r==null?t:t+`${e=e.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(n,[t]){const{style:e}=n.element;if(this.vt===void 0){this.vt=new Set;for(const r in t)this.vt.add(r);return this.render(t)}this.vt.forEach(r=>{t[r]==null&&(this.vt.delete(r),r.includes("-")?e.removeProperty(r):e[r]="")});for(const r in t){const i=t[r];i!=null&&(this.vt.add(r),r.includes("-")?e.setProperty(r,i):e[r]=i)}return Un}}),Yh=String.fromCharCode,Zh=n=>n.toLowerCase(),Xh=/^\s*/g,Jh=n=>n.replace(Xh,""),Qh=/([A-Z])/g,Fl=(n,t)=>Jh(n.replace(Qh,e=>`${t}${Zh(e)}`)),td=n=>{const t=unescape(encodeURIComponent(n)),e=t.length,r=new Uint8Array(e);for(let i=0;i<e;i++)r[i]=t.codePointAt(i);return r},as=typeof TextEncoder<"u"?new TextEncoder:null,ed=n=>as.encode(n),la=as?ed:td;let bi=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});bi&&bi.decode(new Uint8Array).length===1&&(bi=null);const yn=()=>new Map,$o=n=>{const t=yn();return n.forEach((e,r)=>{t.set(r,e)}),t},He=(n,t,e)=>{let r=n.get(t);return r===void 0&&n.set(t,r=e()),r},nd=(n,t)=>{const e=[];for(const[r,i]of n)e.push(t(i,r));return e},rd=(n,t)=>{for(const[e,r]of n)if(t(r,e))return!0;return!1},Hl=n=>n===void 0?null:n;class id{constructor(){this.map=new Map}setItem(t,e){this.map.set(t,e)}getItem(t){return this.map.get(t)}}let eu=new id,nu=!0;try{typeof localStorage<"u"&&(eu=localStorage,nu=!1)}catch{}const ru=eu,od=n=>nu||addEventListener("storage",n),ls=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),iu=typeof window<"u"&&!ls;typeof navigator<"u"&&/Mac/.test(navigator.platform);let dn;const sd=()=>{if(dn===void 0)if(ls){dn=yn();const n=process.argv;let t=null;for(let e=0;e<n.length;e++){const r=n[e];r[0]==="-"?(t!==null&&dn.set(t,""),t=r):t!==null&&(dn.set(t,r),t=null)}t!==null&&dn.set(t,"")}else typeof location=="object"?(dn=yn(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[t,e]=n.split("=");dn.set(`--${Fl(t,"-")}`,e),dn.set(`-${Fl(t,"-")}`,e)}})):dn=yn();return dn},ad=n=>sd().has(n),ou=n=>Hl(ls?process.env[n.toUpperCase()]:ru.getItem(n)),ld=n=>ad("--"+n)||ou(n)!==null;ld("production");const zl=1,Vl=2,Ms=4,Bs=8,Ci=32,Mn=64,$e=128,cs=31,ca=63,cr=127,cd=2147483647,wn=Math.floor,So=Math.abs,ud=Math.log10,Pa=(n,t)=>n<t?n:t,wr=(n,t)=>n>t?n:t,su=n=>n!==0?n<0:1/n<0,au=Number.MAX_SAFE_INTEGER,fd=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&wn(n)===n);class us{constructor(t){this.arr=t,this.pos=0}}const On=n=>new us(n),hd=n=>n.pos!==n.arr.length,dd=(n,t)=>{const e=Ma(n.arr.buffer,n.pos+n.arr.byteOffset,t);return n.pos+=t,e},ye=n=>dd(n,Tt(n)),hr=n=>n.arr[n.pos++],Tt=n=>{let t=0,e=1;for(;;){const r=n.arr[n.pos++];if(t=t+(r&cr)*e,e*=128,r<$e)return t;if(t>au)throw new Error("Integer out of range!")}},Da=n=>{let t=n.arr[n.pos++],e=t&ca,r=64;const i=(t&Mn)>0?-1:1;if((t&$e)===0)return i*e;for(;;){if(t=n.arr[n.pos++],e=e+(t&cr)*r,r*=128,t<$e)return i*e;if(e>au)throw new Error("Integer out of range!")}},pd=n=>{let t=Tt(n);if(t===0)return"";{let e=String.fromCodePoint(hr(n));if(--t<100)for(;t--;)e+=String.fromCodePoint(hr(n));else for(;t>0;){const r=t<1e4?t:1e4,i=n.arr.subarray(n.pos,n.pos+r);n.pos+=r,e+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(e))}},gd=n=>bi.decode(ye(n)),Bn=bi?gd:pd,Ia=(n,t)=>{const e=new DataView(n.arr.buffer,n.arr.byteOffset+n.pos,t);return n.pos+=t,e},yd=n=>Ia(n,4).getFloat32(0,!1),vd=n=>Ia(n,8).getFloat64(0,!1),md=n=>Ia(n,8).getBigInt64(0,!1),bd=[n=>{},n=>null,Da,yd,vd,md,n=>!1,n=>!0,Bn,n=>{const t=Tt(n),e={};for(let r=0;r<t;r++){const i=Bn(n);e[i]=Fr(n)}return e},n=>{const t=Tt(n),e=[];for(let r=0;r<t;r++)e.push(Fr(n));return e},ye],Fr=n=>bd[127-hr(n)](n);class Kl extends us{constructor(t,e){super(t),this.reader=e,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),hd(this)?this.count=Tt(this)+1:this.count=-1),this.count--,this.s}}class Co extends us{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=Da(this);const t=su(this.s);this.count=1,t&&(this.s=-this.s,this.count=Tt(this)+2)}return this.count--,this.s}}class $s extends us{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=Da(this),e=t&1;this.diff=wn(t/2),this.count=1,e&&(this.count=Tt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class _d{constructor(t){this.decoder=new Co(t),this.str=Bn(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}const lu=n=>new Uint8Array(n),Ma=(n,t,e)=>new Uint8Array(n,t,e),wd=n=>new Uint8Array(n),kd=n=>{let t="";for(let e=0;e<n.byteLength;e++)t+=Yh(n[e]);return btoa(t)},xd=n=>Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("base64"),Ed=n=>{const t=atob(n),e=lu(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e},Sd=n=>{const t=Buffer.from(n,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},cu=iu?kd:xd,uu=iu?Ed:Sd,Cd=n=>{const t=lu(n.byteLength);return t.set(n),t};class Wi{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const me=()=>new Wi,Ad=n=>{let t=n.cpos;for(let e=0;e<n.bufs.length;e++)t+=n.bufs[e].length;return t},Qt=n=>{const t=new Uint8Array(Ad(n));let e=0;for(let r=0;r<n.bufs.length;r++){const i=n.bufs[r];t.set(i,e),e+=i.length}return t.set(Ma(n.cbuf.buffer,0,n.cpos),e),t},Od=(n,t)=>{const e=n.cbuf.length;e-n.cpos<t&&(n.bufs.push(Ma(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(wr(e,t)*2),n.cpos=0)},ge=(n,t)=>{const e=n.cbuf.length;n.cpos===e&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(e*2),n.cpos=0),n.cbuf[n.cpos++]=t},Ai=ge,St=(n,t)=>{for(;t>cr;)ge(n,$e|cr&t),t=wn(t/128);ge(n,cr&t)},Ba=(n,t)=>{const e=su(t);for(e&&(t=-t),ge(n,(t>ca?$e:0)|(e?Mn:0)|ca&t),t=wn(t/64);t>0;)ge(n,(t>cr?$e:0)|cr&t),t=wn(t/128)},ua=new Uint8Array(3e4),Td=ua.length/3,Rd=(n,t)=>{if(t.length<Td){const e=as.encodeInto(t,ua).written||0;St(n,e);for(let r=0;r<e;r++)ge(n,ua[r])}else ne(n,la(t))},Ld=(n,t)=>{const e=unescape(encodeURIComponent(t)),r=e.length;St(n,r);for(let i=0;i<r;i++)ge(n,e.codePointAt(i))},vn=as?Rd:Ld,fs=(n,t)=>{const e=n.cbuf.length,r=n.cpos,i=Pa(e-r,t.length),o=t.length-i;n.cbuf.set(t.subarray(0,i),r),n.cpos+=i,o>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(wr(e*2,o)),n.cbuf.set(t.subarray(i)),n.cpos=o)},ne=(n,t)=>{St(n,t.byteLength),fs(n,t)},$a=(n,t)=>{Od(n,t);const e=new DataView(n.cbuf.buffer,n.cpos,t);return n.cpos+=t,e},Nd=(n,t)=>$a(n,4).setFloat32(0,t,!1),Pd=(n,t)=>$a(n,8).setFloat64(0,t,!1),Dd=(n,t)=>$a(n,8).setBigInt64(0,t,!1),Wl=new DataView(new ArrayBuffer(4)),Id=n=>(Wl.setFloat32(0,n),Wl.getFloat32(0)===n),Hr=(n,t)=>{switch(typeof t){case"string":ge(n,119),vn(n,t);break;case"number":fd(t)&&So(t)<=cd?(ge(n,125),Ba(n,t)):Id(t)?(ge(n,124),Nd(n,t)):(ge(n,123),Pd(n,t));break;case"bigint":ge(n,122),Dd(n,t);break;case"object":if(t===null)ge(n,126);else if(t instanceof Array){ge(n,117),St(n,t.length);for(let e=0;e<t.length;e++)Hr(n,t[e])}else if(t instanceof Uint8Array)ge(n,116),ne(n,t);else{ge(n,118);const e=Object.keys(t);St(n,e.length);for(let r=0;r<e.length;r++){const i=e[r];vn(n,i),Hr(n,t[i])}}break;case"boolean":ge(n,t?120:121);break;default:ge(n,127)}};class Gl extends Wi{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&St(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Yl=n=>{n.count>0&&(Ba(n.encoder,n.count===1?n.s:-n.s),n.count>1&&St(n.encoder,n.count-2))};class Ao{constructor(){this.encoder=new Wi,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Yl(this),this.count=1,this.s=t)}toUint8Array(){return Yl(this),Qt(this.encoder)}}const Zl=n=>{if(n.count>0){const t=n.diff*2+(n.count===1?0:1);Ba(n.encoder,t),n.count>1&&St(n.encoder,n.count-2)}};class js{constructor(){this.encoder=new Wi,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Zl(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Zl(this),Qt(this.encoder)}}class Md{constructor(){this.sarr=[],this.s="",this.lensE=new Ao}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Wi;return this.sarr.push(this.s),this.s="",vn(t,this.sarr.join("")),fs(t,this.lensE.toUint8Array()),Qt(t)}}const kn=Date.now,Oi=()=>new Set,qs=n=>n[n.length-1],Bd=(n,t)=>{for(let e=0;e<t.length;e++)n.push(t[e])},fu=Array.from,Xl=Array.isArray;class ti{constructor(){this._observers=yn()}on(t,e){He(this._observers,t,Oi).add(e)}once(t,e){const r=(...i)=>{this.off(t,r),e(...i)};this.on(t,r)}off(t,e){const r=this._observers.get(t);r!==void 0&&(r.delete(e),r.size===0&&this._observers.delete(t))}emit(t,e){return fu((this._observers.get(t)||yn()).values()).forEach(r=>r(...e))}destroy(){this._observers=yn()}}const $d=Object.keys,jo=n=>$d(n).length,jd=(n,t)=>{for(const e in n)if(!t(n[e],e))return!1;return!0},hu=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),qd=(n,t)=>n===t||jo(n)===jo(t)&&jd(n,(e,r)=>(e!==void 0||hu(t,r))&&t[r]===e),ja=(n,t,e=0)=>{try{for(;e<n.length;e++)n[e](...t)}finally{e<n.length&&ja(n,t,e+1)}},Ud=()=>{},Fd=(n,t)=>n===t,_i=(n,t)=>{if(n==null||t==null)return Fd(n,t);if(n.constructor!==t.constructor)return!1;if(n===t)return!0;switch(n.constructor){case ArrayBuffer:n=new Uint8Array(n),t=new Uint8Array(t);case Uint8Array:{if(n.byteLength!==t.byteLength)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;break}case Set:{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;break}case Map:{if(n.size!==t.size)return!1;for(const e of n.keys())if(!t.has(e)||!_i(n.get(e),t.get(e)))return!1;break}case Object:if(jo(n)!==jo(t))return!1;for(const e in n)if(!hu(n,e)||!_i(n[e],t[e]))return!1;break;case Array:if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!_i(n[e],t[e]))return!1;break;default:return!1}return!0},Jl=typeof crypto>"u"?null:crypto,Hd=Jl!==null?n=>{const t=new ArrayBuffer(n),e=new Uint8Array(t);return Jl.getRandomValues(e),t}:n=>{const t=new ArrayBuffer(n),e=new Uint8Array(t);for(let r=0;r<n;r++)e[r]=Math.ceil(Math.random()*4294967295>>>0);return t},zd=Math.random,du=()=>new Uint32Array(Hd(4))[0],Vd=[1e7]+-1e3+-4e3+-8e3+-1e11,qa=()=>Vd.replace(/[018]/g,n=>(n^du()&15>>n/4).toString(16)),hs=n=>new Promise(n),Kd=n=>Promise.reject(n),Ua=n=>Promise.resolve(n),kr=n=>new Error(n),mn=()=>{throw kr("Method unimplemented")},en=()=>{throw kr("Unexpected case")},Kn=Symbol;class Wd{constructor(t,e){this.left=t,this.right=e}}const Dn=(n,t)=>new Wd(n,t),xr=typeof document<"u"?document:{};typeof DOMParser<"u"&&new DOMParser;const Gd=n=>nd(n,(t,e)=>`${e}:${t};`).join("");xr.ELEMENT_NODE;xr.TEXT_NODE;xr.CDATA_SECTION_NODE;xr.COMMENT_NODE;xr.DOCUMENT_NODE;xr.DOCUMENT_TYPE_NODE;xr.DOCUMENT_FRAGMENT_NODE;const Be=Kn(),er=Kn(),Fa=Kn(),ds=Kn(),Ha=Kn(),za=Kn(),Va=Kn(),ps=Kn(),Gi=Kn(),Yd={[Be]:Dn("font-weight","bold"),[er]:Dn("font-weight","normal"),[Fa]:Dn("color","blue"),[Ha]:Dn("color","green"),[ds]:Dn("color","grey"),[za]:Dn("color","red"),[Va]:Dn("color","purple"),[ps]:Dn("color","orange"),[Gi]:Dn("color","black")},Zd={[Be]:"\x1B[1m",[er]:"\x1B[2m",[Fa]:"\x1B[34m",[Ha]:"\x1B[32m",[ds]:"\x1B[37m",[za]:"\x1B[31m",[Va]:"\x1B[35m",[ps]:"\x1B[38;5;208m",[Gi]:"\x1B[0m"},Xd=n=>{const t=[],e=[],r=yn();let i=[],o=0;for(;o<n.length;o++){const s=n[o],c=Yd[s];if(c!==void 0)r.set(c.left,c.right);else if(s.constructor===String||s.constructor===Number){const a=Gd(r);o>0||a.length>0?(t.push("%c"+s),e.push(a)):t.push(s)}else break}for(o>0&&(i=e,i.unshift(t.join("")));o<n.length;o++){const s=n[o];s instanceof Symbol||i.push(s)}return i},Jd=n=>{const t=[],e=[];let r=0;for(;r<n.length;r++){const i=n[r],o=Zd[i];if(o!==void 0)t.push(o);else if(i.constructor===String||i.constructor===Number)t.push(i);else break}for(r>0&&(t.push("\x1B[0m"),e.push(t.join("")));r<n.length;r++){const i=n[r];i instanceof Symbol||e.push(i)}return e},Qd=ls?Jd:Xd,pu=(...n)=>{console.log(...Qd(n)),tp.forEach(t=>t.print(n))},tp=new Set,Ql=[Ha,Va,ps,Fa];let Us=0,tc=kn();const ep=n=>{const t=Ql[Us],e=ou("log"),r=e!==null&&(e==="*"||e==="true"||new RegExp(e,"gi").test(n));return Us=(Us+1)%Ql.length,n+=": ",r?(...i)=>{const o=kn(),s=o-tc;tc=o,pu(t,n,Gi,...i.map(c=>typeof c=="string"||typeof c=="symbol"?c:JSON.stringify(c)),t," +"+s+"ms")}:Ud},gu=n=>({[Symbol.iterator](){return this},next:n}),np=(n,t)=>gu(()=>{let e;do e=n.next();while(!e.done&&!t(e.value));return e}),Fs=(n,t)=>gu(()=>{const{done:e,value:r}=n.next();return{done:e,value:e?void 0:t(r)}});class Ka{constructor(t,e){this.clock=t,this.len=e}}class ei{constructor(){this.clients=new Map}}const dr=(n,t,e)=>t.clients.forEach((r,i)=>{const o=n.doc.store.clients.get(i);for(let s=0;s<r.length;s++){const c=r[s];Ru(n,o,c.clock,c.len,e)}}),rp=(n,t)=>{let e=0,r=n.length-1;for(;e<=r;){const i=wn((e+r)/2),o=n[i],s=o.clock;if(s<=t){if(t<s+o.len)return i;e=i+1}else r=i-1}return null},gs=(n,t)=>{const e=n.clients.get(t.client);return e!==void 0&&rp(e,t.clock)!==null},Wa=n=>{n.clients.forEach(t=>{t.sort((i,o)=>i.clock-o.clock);let e,r;for(e=1,r=1;e<t.length;e++){const i=t[r-1],o=t[e];i.clock+i.len>=o.clock?i.len=wr(i.len,o.clock+o.len-i.clock):(r<e&&(t[r]=o),r++)}t.length=r})},fa=n=>{const t=new ei;for(let e=0;e<n.length;e++)n[e].clients.forEach((r,i)=>{if(!t.clients.has(i)){const o=r.slice();for(let s=e+1;s<n.length;s++)Bd(o,n[s].clients.get(i)||[]);t.clients.set(i,o)}});return Wa(t),t},Ti=(n,t,e,r)=>{He(n.clients,t,()=>[]).push(new Ka(e,r))},yu=()=>new ei,ip=n=>{const t=yu();return n.clients.forEach((e,r)=>{const i=[];for(let o=0;o<e.length;o++){const s=e[o];if(s.deleted){const c=s.id.clock;let a=s.length;if(o+1<e.length)for(let y=e[o+1];o+1<e.length&&y.deleted;y=e[++o+1])a+=y.length;i.push(new Ka(c,a))}}i.length>0&&t.clients.set(r,i)}),t},ni=(n,t)=>{St(n.restEncoder,t.clients.size),t.clients.forEach((e,r)=>{n.resetDsCurVal(),St(n.restEncoder,r);const i=e.length;St(n.restEncoder,i);for(let o=0;o<i;o++){const s=e[o];n.writeDsClock(s.clock),n.writeDsLen(s.len)}})},Ga=n=>{const t=new ei,e=Tt(n.restDecoder);for(let r=0;r<e;r++){n.resetDsCurVal();const i=Tt(n.restDecoder),o=Tt(n.restDecoder);if(o>0){const s=He(t.clients,i,()=>[]);for(let c=0;c<o;c++)s.push(new Ka(n.readDsClock(),n.readDsLen()))}}return t},ec=(n,t,e)=>{const r=new ei,i=Tt(n.restDecoder);for(let o=0;o<i;o++){n.resetDsCurVal();const s=Tt(n.restDecoder),c=Tt(n.restDecoder),a=e.clients.get(s)||[],y=ce(e,s);for(let g=0;g<c;g++){const u=n.readDsClock(),l=u+n.readDsLen();if(u<y){y<l&&Ti(r,s,y,l-y);let f=xn(a,u),h=a[f];for(!h.deleted&&h.id.clock<u&&(a.splice(f+1,0,Wo(t,h,u-h.id.clock)),f++);f<a.length&&(h=a[f++],h.id.clock<l);)h.deleted||(l<h.id.clock+h.length&&a.splice(f,0,Wo(t,h,l-h.id.clock)),h.delete(t))}else Ti(r,s,u,l-u)}}if(r.clients.size>0){const o=new pr;return St(o.restEncoder,0),ni(o,r),o.toUint8Array()}return null},vu=du;class ri extends ti{constructor({guid:t=qa(),collectionid:e=null,gc:r=!0,gcFilter:i=()=>!0,meta:o=null,autoLoad:s=!1,shouldLoad:c=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=vu(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new Ou,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=s,this.meta=o,this.isLoaded=!1,this.whenLoaded=hs(a=>{this.on("load",()=>{this.isLoaded=!0,a(this)})})}load(){const t=this._item;t!==null&&!this.shouldLoad&&Vt(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map(t=>t.guid))}transact(t,e=null){Vt(this,t,e)}get(t,e=_e){const r=He(this.share,t,()=>{const o=new e;return o._integrate(this,null),o}),i=r.constructor;if(e!==_e&&i!==e)if(i===_e){const o=new e;o._map=r._map,r._map.forEach(s=>{for(;s!==null;s=s.left)s.parent=o}),o._start=r._start;for(let s=o._start;s!==null;s=s.right)s.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,$n)}getText(t=""){return this.get(t,Fn)}getMap(t=""){return this.get(t,En)}getXmlFragment(t=""){return this.get(t,gr)}toJSON(){const t={};return this.share.forEach((e,r)=>{t[r]=e.toJSON()}),t}destroy(){fu(this.subdocs).forEach(e=>e.destroy());const t=this._item;if(t!==null){this._item=null;const e=t.content;e.doc=new ri({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,Vt(t.parent.doc,r=>{const i=e.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}}class mu{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return Tt(this.restDecoder)}readDsLen(){return Tt(this.restDecoder)}}class bu extends mu{readLeftID(){return Nt(Tt(this.restDecoder),Tt(this.restDecoder))}readRightID(){return Nt(Tt(this.restDecoder),Tt(this.restDecoder))}readClient(){return Tt(this.restDecoder)}readInfo(){return hr(this.restDecoder)}readString(){return Bn(this.restDecoder)}readParentInfo(){return Tt(this.restDecoder)===1}readTypeRef(){return Tt(this.restDecoder)}readLen(){return Tt(this.restDecoder)}readAny(){return Fr(this.restDecoder)}readBuf(){return Cd(ye(this.restDecoder))}readJSON(){return JSON.parse(Bn(this.restDecoder))}readKey(){return Bn(this.restDecoder)}}class op{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Tt(this.restDecoder),this.dsCurrVal}readDsLen(){const t=Tt(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class zr extends op{constructor(t){super(t),this.keys=[],Tt(t),this.keyClockDecoder=new $s(ye(t)),this.clientDecoder=new Co(ye(t)),this.leftClockDecoder=new $s(ye(t)),this.rightClockDecoder=new $s(ye(t)),this.infoDecoder=new Kl(ye(t),hr),this.stringDecoder=new _d(ye(t)),this.parentInfoDecoder=new Kl(ye(t),hr),this.typeRefDecoder=new Co(ye(t)),this.lenDecoder=new Co(ye(t))}readLeftID(){return new Br(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Br(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return Fr(this.restDecoder)}readBuf(){return ye(this.restDecoder)}readJSON(){return Fr(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class _u{constructor(){this.restEncoder=me()}toUint8Array(){return Qt(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){St(this.restEncoder,t)}writeDsLen(t){St(this.restEncoder,t)}}class Yi extends _u{writeLeftID(t){St(this.restEncoder,t.client),St(this.restEncoder,t.clock)}writeRightID(t){St(this.restEncoder,t.client),St(this.restEncoder,t.clock)}writeClient(t){St(this.restEncoder,t)}writeInfo(t){Ai(this.restEncoder,t)}writeString(t){vn(this.restEncoder,t)}writeParentInfo(t){St(this.restEncoder,t?1:0)}writeTypeRef(t){St(this.restEncoder,t)}writeLen(t){St(this.restEncoder,t)}writeAny(t){Hr(this.restEncoder,t)}writeBuf(t){ne(this.restEncoder,t)}writeJSON(t){vn(this.restEncoder,JSON.stringify(t))}writeKey(t){vn(this.restEncoder,t)}}class wu{constructor(){this.restEncoder=me(),this.dsCurrVal=0}toUint8Array(){return Qt(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,St(this.restEncoder,e)}writeDsLen(t){t===0&&en(),St(this.restEncoder,t-1),this.dsCurrVal+=t}}class pr extends wu{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new js,this.clientEncoder=new Ao,this.leftClockEncoder=new js,this.rightClockEncoder=new js,this.infoEncoder=new Gl(Ai),this.stringEncoder=new Md,this.parentInfoEncoder=new Gl(Ai),this.typeRefEncoder=new Ao,this.lenEncoder=new Ao}toUint8Array(){const t=me();return St(t,0),ne(t,this.keyClockEncoder.toUint8Array()),ne(t,this.clientEncoder.toUint8Array()),ne(t,this.leftClockEncoder.toUint8Array()),ne(t,this.rightClockEncoder.toUint8Array()),ne(t,Qt(this.infoEncoder)),ne(t,this.stringEncoder.toUint8Array()),ne(t,Qt(this.parentInfoEncoder)),ne(t,this.typeRefEncoder.toUint8Array()),ne(t,this.lenEncoder.toUint8Array()),fs(t,Qt(this.restEncoder)),Qt(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Hr(this.restEncoder,t)}writeBuf(t){ne(this.restEncoder,t)}writeJSON(t){Hr(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const sp=(n,t,e,r)=>{r=wr(r,t[0].id.clock);const i=xn(t,r);St(n.restEncoder,t.length-i),n.writeClient(e),St(n.restEncoder,r);const o=t[i];o.write(n,r-o.id.clock);for(let s=i+1;s<t.length;s++)t[s].write(n,0)},Ya=(n,t,e)=>{const r=new Map;e.forEach((i,o)=>{ce(t,o)>i&&r.set(o,i)}),ys(t).forEach((i,o)=>{e.has(o)||r.set(o,0)}),St(n.restEncoder,r.size),Array.from(r.entries()).sort((i,o)=>o[0]-i[0]).forEach(([i,o])=>{sp(n,t.clients.get(i),i,o)})},ap=(n,t)=>{const e=yn(),r=Tt(n.restDecoder);for(let i=0;i<r;i++){const o=Tt(n.restDecoder),s=new Array(o),c=n.readClient();let a=Tt(n.restDecoder);e.set(c,{i:0,refs:s});for(let y=0;y<o;y++){const g=n.readInfo();switch(cs&g){case 0:{const u=n.readLen();s[y]=new qe(Nt(c,a),u),a+=u;break}case 10:{const u=Tt(n.restDecoder);s[y]=new Ue(Nt(c,a),u),a+=u;break}default:{const u=(g&(Mn|$e))===0,l=new Wt(Nt(c,a),null,(g&$e)===$e?n.readLeftID():null,null,(g&Mn)===Mn?n.readRightID():null,u?n.readParentInfo()?t.get(n.readString()):n.readLeftID():null,u&&(g&Ci)===Ci?n.readString():null,Qu(n,g));s[y]=l,a+=l.length}}}}return e},lp=(n,t,e)=>{const r=[];let i=Array.from(e.keys()).sort((f,h)=>f-h);if(i.length===0)return null;const o=()=>{if(i.length===0)return null;let f=e.get(i[i.length-1]);for(;f.refs.length===f.i;)if(i.pop(),i.length>0)f=e.get(i[i.length-1]);else return null;return f};let s=o();if(s===null&&r.length===0)return null;const c=new Ou,a=new Map,y=(f,h)=>{const m=a.get(f);(m==null||m>h)&&a.set(f,h)};let g=s.refs[s.i++];const u=new Map,l=()=>{for(const f of r){const h=f.id.client,m=e.get(h);m?(m.i--,c.clients.set(h,m.refs.slice(m.i)),e.delete(h),m.i=0,m.refs=[]):c.clients.set(h,[f]),i=i.filter(k=>k!==h)}r.length=0};for(;;){if(g.constructor!==Ue){const h=He(u,g.id.client,()=>ce(t,g.id.client))-g.id.clock;if(h<0)r.push(g),y(g.id.client,g.id.clock-1),l();else{const m=g.getMissing(n,t);if(m!==null){r.push(g);const k=e.get(m)||{refs:[],i:0};if(k.refs.length===k.i)y(m,ce(t,m)),l();else{g=k.refs[k.i++];continue}}else(h===0||h<g.length)&&(g.integrate(n,h),u.set(g.id.client,g.id.clock+g.length))}}if(r.length>0)g=r.pop();else if(s!==null&&s.i<s.refs.length)g=s.refs[s.i++];else{if(s=o(),s===null)break;g=s.refs[s.i++]}}if(c.clients.size>0){const f=new pr;return Ya(f,c,new Map),St(f.restEncoder,0),{missing:a,update:f.toUint8Array()}}return null},cp=(n,t)=>Ya(n,t.doc.store,t.beforeState),up=(n,t,e,r=new zr(n))=>Vt(t,i=>{i.local=!1;let o=!1;const s=i.doc,c=s.store,a=ap(r,s),y=lp(i,c,a),g=c.pendingStructs;if(g){for(const[l,f]of g.missing)if(f<ce(c,l)){o=!0;break}if(y){for(const[l,f]of y.missing){const h=g.missing.get(l);(h==null||h>f)&&g.missing.set(l,f)}g.update=Uo([g.update,y.update])}}else c.pendingStructs=y;const u=ec(r,i,c);if(c.pendingDs){const l=new zr(On(c.pendingDs));Tt(l.restDecoder);const f=ec(l,i,c);u&&f?c.pendingDs=Uo([u,f]):c.pendingDs=u||f}else c.pendingDs=u;if(o){const l=c.pendingStructs.update;c.pendingStructs=null,ku(i.doc,l)}},e,!1),ku=(n,t,e,r=zr)=>{const i=On(t);up(i,n,e,new r(i))},xu=(n,t,e)=>ku(n,t,e,bu),fp=(n,t,e=new Map)=>{Ya(n,t.store,e),ni(n,ip(t.store))},hp=(n,t=new Uint8Array([0]),e=new pr)=>{const r=Eu(t);fp(e,n,r);const i=[e.toUint8Array()];if(n.store.pendingDs&&i.push(n.store.pendingDs),n.store.pendingStructs&&i.push(Pp(n.store.pendingStructs.update,t)),i.length>1){if(e.constructor===Yi)return Lp(i.map((o,s)=>s===0?o:Ip(o)));if(e.constructor===pr)return Uo(i)}return i[0]},Za=(n,t)=>hp(n,t,new Yi),dp=n=>{const t=new Map,e=Tt(n.restDecoder);for(let r=0;r<e;r++){const i=Tt(n.restDecoder),o=Tt(n.restDecoder);t.set(i,o)}return t},Eu=n=>dp(new mu(On(n))),Su=(n,t)=>(St(n.restEncoder,t.size),Array.from(t.entries()).sort((e,r)=>r[0]-e[0]).forEach(([e,r])=>{St(n.restEncoder,e),St(n.restEncoder,r)}),n),pp=(n,t)=>Su(n,ys(t.store)),gp=(n,t=new wu)=>(n instanceof Map?Su(t,n):pp(t,n),t.toUint8Array()),yp=n=>gp(n,new _u);class vp{constructor(){this.l=[]}}const nc=()=>new vp,rc=(n,t)=>n.l.push(t),ic=(n,t)=>{const e=n.l,r=e.length;n.l=e.filter(i=>t!==i),r===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Cu=(n,t,e)=>ja(n.l,[t,e]);class Br{constructor(t,e){this.client=t,this.clock=e}}const po=(n,t)=>n===t||n!==null&&t!==null&&n.client===t.client&&n.clock===t.clock,Nt=(n,t)=>new Br(n,t),Au=n=>{for(const[t,e]of n.doc.share.entries())if(e===n)return t;throw en()},qo=(n,t)=>{for(;t!==null;){if(t.parent===n)return!0;t=t.parent._item}return!1};class mp{constructor(t,e,r,i=0){this.type=t,this.tname=e,this.item=r,this.assoc=i}}class bp{constructor(t,e,r=0){this.type=t,this.index=e,this.assoc=r}}const _p=(n,t,e=0)=>new bp(n,t,e),go=(n,t,e)=>{let r=null,i=null;return n._item===null?i=Au(n):r=Nt(n._item.id.client,n._item.id.clock),new mp(r,i,t,e)},oc=(n,t,e=0)=>{let r=n._start;if(e<0){if(t===0)return go(n,null,e);t--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>t)return go(n,Nt(r.id.client,r.id.clock+t),e);t-=r.length}if(r.right===null&&e<0)return go(n,r.lastId,e);r=r.right}return go(n,null,e)},yo=(n,t)=>{const e=t.store,r=n.item,i=n.type,o=n.tname,s=n.assoc;let c=null,a=0;if(r!==null){if(ce(e,r.client)<=r.clock)return null;const y=pa(e,r),g=y.item;if(!(g instanceof Wt))return null;if(c=g.parent,c._item===null||!c._item.deleted){a=g.deleted||!g.countable?0:y.diff+(s>=0?0:1);let u=g.left;for(;u!==null;)!u.deleted&&u.countable&&(a+=u.length),u=u.left}}else{if(o!==null)c=t.get(o);else if(i!==null){if(ce(e,i.client)<=i.clock)return null;const{item:y}=pa(e,i);if(y instanceof Wt&&y.content instanceof Tn)c=y.content.type;else return null}else throw en();s>=0?a=c._length:a=0}return _p(c,a,n.assoc)};class wp{constructor(t,e){this.ds=t,this.sv=e}}const kp=(n,t)=>new wp(n,t);kp(yu(),new Map);const pi=(n,t)=>t===void 0?!n.deleted:t.sv.has(n.id.client)&&(t.sv.get(n.id.client)||0)>n.id.clock&&!gs(t.ds,n.id),Oo=(n,t)=>{const e=He(n.meta,Oo,Oi),r=n.doc.store;e.has(t)||(t.sv.forEach((i,o)=>{i<ce(r,o)&&Te(n,Nt(o,i))}),dr(n,t.ds,i=>{}),e.add(t))};class Ou{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const ys=n=>{const t=new Map;return n.clients.forEach((e,r)=>{const i=e[e.length-1];t.set(r,i.id.clock+i.length)}),t},ce=(n,t)=>{const e=n.clients.get(t);if(e===void 0)return 0;const r=e[e.length-1];return r.id.clock+r.length},Tu=(n,t)=>{let e=n.clients.get(t.id.client);if(e===void 0)e=[],n.clients.set(t.id.client,e);else{const r=e[e.length-1];if(r.id.clock+r.length!==t.id.clock)throw en()}e.push(t)},xn=(n,t)=>{let e=0,r=n.length-1,i=n[r],o=i.id.clock;if(o===t)return r;let s=wn(t/(o+i.length-1)*r);for(;e<=r;){if(i=n[s],o=i.id.clock,o<=t){if(t<o+i.length)return s;e=s+1}else r=s-1;s=wn((e+r)/2)}throw en()},xp=(n,t)=>{const e=n.clients.get(t.client);return e[xn(e,t.clock)]},To=xp,ha=(n,t,e)=>{const r=xn(t,e),i=t[r];return i.id.clock<e&&i instanceof Wt?(t.splice(r+1,0,Wo(n,i,e-i.id.clock)),r+1):r},Te=(n,t)=>{const e=n.doc.store.clients.get(t.client);return e[ha(n,e,t.clock)]},sc=(n,t,e)=>{const r=t.clients.get(e.client),i=xn(r,e.clock),o=r[i];return e.clock!==o.id.clock+o.length-1&&o.constructor!==qe&&r.splice(i+1,0,Wo(n,o,e.clock-o.id.clock+1)),o},Ep=(n,t,e)=>{const r=n.clients.get(t.id.client);r[xn(r,t.id.clock)]=e},Ru=(n,t,e,r,i)=>{if(r===0)return;const o=e+r;let s=ha(n,t,e),c;do c=t[s++],o<c.id.clock+c.length&&ha(n,t,o),i(c);while(s<t.length&&t[s].id.clock<o)};class Sp{constructor(t,e,r){this.doc=t,this.deleteSet=new ei,this.beforeState=ys(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const ac=(n,t)=>t.deleteSet.clients.size===0&&!rd(t.afterState,(e,r)=>t.beforeState.get(r)!==e)?!1:(Wa(t.deleteSet),cp(n,t),ni(n,t.deleteSet),!0),lc=(n,t,e)=>{const r=t._item;(r===null||r.id.clock<(n.beforeState.get(r.id.client)||0)&&!r.deleted)&&He(n.changed,t,Oi).add(e)},Ro=(n,t)=>{const e=n[t-1],r=n[t];e.deleted===r.deleted&&e.constructor===r.constructor&&e.mergeWith(r)&&(n.splice(t,1),r instanceof Wt&&r.parentSub!==null&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,e))},Cp=(n,t,e)=>{for(const[r,i]of n.clients.entries()){const o=t.clients.get(r);for(let s=i.length-1;s>=0;s--){const c=i[s],a=c.clock+c.len;for(let y=xn(o,c.clock),g=o[y];y<o.length&&g.id.clock<a;g=o[++y]){const u=o[y];if(c.clock+c.len<=u.id.clock)break;u instanceof Wt&&u.deleted&&!u.keep&&e(u)&&u.gc(t,!1)}}}},Ap=(n,t)=>{n.clients.forEach((e,r)=>{const i=t.clients.get(r);for(let o=e.length-1;o>=0;o--){const s=e[o],c=Pa(i.length-1,1+xn(i,s.clock+s.len-1));for(let a=c,y=i[a];a>0&&y.id.clock>=s.clock;y=i[--a])Ro(i,a)}})},Lu=(n,t)=>{if(t<n.length){const e=n[t],r=e.doc,i=r.store,o=e.deleteSet,s=e._mergeStructs;try{Wa(o),e.afterState=ys(e.doc.store),r._transaction=null,r.emit("beforeObserverCalls",[e,r]);const c=[];e.changed.forEach((a,y)=>c.push(()=>{(y._item===null||!y._item.deleted)&&y._callObserver(e,a)})),c.push(()=>{e.changedParentTypes.forEach((a,y)=>c.push(()=>{(y._item===null||!y._item.deleted)&&(a=a.filter(g=>g.target._item===null||!g.target._item.deleted),a.forEach(g=>{g.currentTarget=y}),a.sort((g,u)=>g.path.length-u.path.length),Cu(y._dEH,a,e))})),c.push(()=>r.emit("afterTransaction",[e,r]))}),ja(c,[])}finally{r.gc&&Cp(o,i,r.gcFilter),Ap(o,i),e.afterState.forEach((g,u)=>{const l=e.beforeState.get(u)||0;if(l!==g){const f=i.clients.get(u),h=wr(xn(f,l),1);for(let m=f.length-1;m>=h;m--)Ro(f,m)}});for(let g=0;g<s.length;g++){const{client:u,clock:l}=s[g].id,f=i.clients.get(u),h=xn(f,l);h+1<f.length&&Ro(f,h+1),h>0&&Ro(f,h)}if(!e.local&&e.afterState.get(r.clientID)!==e.beforeState.get(r.clientID)&&(pu(ps,Be,"[yjs] ",er,za,"Changed the client-id because another client seems to be using it."),r.clientID=vu()),r.emit("afterTransactionCleanup",[e,r]),r._observers.has("update")){const g=new Yi;ac(g,e)&&r.emit("update",[g.toUint8Array(),e.origin,r,e])}if(r._observers.has("updateV2")){const g=new pr;ac(g,e)&&r.emit("updateV2",[g.toUint8Array(),e.origin,r,e])}const{subdocsAdded:c,subdocsLoaded:a,subdocsRemoved:y}=e;(c.size>0||y.size>0||a.size>0)&&(c.forEach(g=>{g.clientID=r.clientID,g.collectionid==null&&(g.collectionid=r.collectionid),r.subdocs.add(g)}),y.forEach(g=>r.subdocs.delete(g)),r.emit("subdocs",[{loaded:a,added:c,removed:y},r,e]),y.forEach(g=>g.destroy())),n.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,n])):Lu(n,t+1)}}},Vt=(n,t,e=null,r=!0)=>{const i=n._transactionCleanups;let o=!1;n._transaction===null&&(o=!0,n._transaction=new Sp(n,e,r),i.push(n._transaction),i.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{t(n._transaction)}finally{o&&i[0]===n._transaction&&Lu(i,0)}};class Op{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const cc=(n,t,e)=>{dr(n,e.deletions,r=>{r instanceof Wt&&t.scope.some(i=>qo(i,r))&&il(r,!1)})},uc=(n,t,e)=>{let r=null,i=null;const o=n.doc,s=n.scope;if(Vt(o,c=>{for(;t.length>0&&r===null;){const a=o.store,y=t.pop(),g=new Set,u=[];let l=!1;dr(c,y.insertions,f=>{if(f instanceof Wt){if(f.redone!==null){let{item:h,diff:m}=pa(a,f.id);m>0&&(h=Te(c,Nt(h.id.client,h.id.clock+m))),f=h}!f.deleted&&s.some(h=>qo(h,f))&&u.push(f)}}),dr(c,y.deletions,f=>{f instanceof Wt&&s.some(h=>qo(h,f))&&!gs(y.insertions,f.id)&&g.add(f)}),g.forEach(f=>{l=Ju(c,f,g,y.insertions,n.ignoreRemoteMapChanges)!==null||l});for(let f=u.length-1;f>=0;f--){const h=u[f];n.deleteFilter(h)&&(h.delete(c),l=!0)}r=l?y:null}c.changed.forEach((a,y)=>{a.has(null)&&y._searchMarker&&(y._searchMarker.length=0)}),i=c},n),r!=null){const c=i.changedParentTypes;n.emit("stack-item-popped",[{stackItem:r,type:e,changedParentTypes:c},n])}return r};class Tp extends ti{constructor(t,{captureTimeout:e=500,captureTransaction:r=a=>!0,deleteFilter:i=()=>!0,trackedOrigins:o=new Set([null]),ignoreRemoteMapChanges:s=!1,doc:c=Xl(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.addToScope(t),this.deleteFilter=i,o.add(this),this.trackedOrigins=o,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=c,this.lastChange=0,this.ignoreRemoteMapChanges=s,this.afterTransactionHandler=a=>{if(!this.captureTransaction(a)||!this.scope.some(k=>a.changedParentTypes.has(k))||!this.trackedOrigins.has(a.origin)&&(!a.origin||!this.trackedOrigins.has(a.origin.constructor)))return;const y=this.undoing,g=this.redoing,u=y?this.redoStack:this.undoStack;y?this.stopCapturing():g||this.clear(!1,!0);const l=new ei;a.afterState.forEach((k,b)=>{const v=a.beforeState.get(b)||0,d=k-v;d>0&&Ti(l,b,v,d)});const f=kn();let h=!1;if(f-this.lastChange<e&&u.length>0&&!y&&!g){const k=u[u.length-1];k.deletions=fa([k.deletions,a.deleteSet]),k.insertions=fa([k.insertions,l])}else u.push(new Op(a.deleteSet,l)),h=!0;!y&&!g&&(this.lastChange=f),dr(a,a.deleteSet,k=>{k instanceof Wt&&this.scope.some(b=>qo(b,k))&&il(k,!0)});const m=[{stackItem:u[u.length-1],origin:a.origin,type:y?"redo":"undo",changedParentTypes:a.changedParentTypes},this];h?this.emit("stack-item-added",m):this.emit("stack-item-updated",m)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=Xl(t)?t:[t],t.forEach(e=>{this.scope.every(r=>r!==e)&&this.scope.push(e)})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(r=>{t&&(this.undoStack.forEach(i=>cc(r,this,i)),this.undoStack=[]),e&&(this.redoStack.forEach(i=>cc(r,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=uc(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=uc(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*Rp(n){const t=Tt(n.restDecoder);for(let e=0;e<t;e++){const r=Tt(n.restDecoder),i=n.readClient();let o=Tt(n.restDecoder);for(let s=0;s<r;s++){const c=n.readInfo();if(c===10){const a=Tt(n.restDecoder);yield new Ue(Nt(i,o),a),o+=a}else if((cs&c)!==0){const a=(c&(Mn|$e))===0,y=new Wt(Nt(i,o),null,(c&$e)===$e?n.readLeftID():null,null,(c&Mn)===Mn?n.readRightID():null,a?n.readParentInfo()?n.readString():n.readLeftID():null,a&&(c&Ci)===Ci?n.readString():null,Qu(n,c));yield y,o+=y.length}else{const a=n.readLen();yield new qe(Nt(i,o),a),o+=a}}}}class Xa{constructor(t,e){this.gen=Rp(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ue);return this.curr}}class Ja{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Lp=n=>Uo(n,bu,Yi),Np=(n,t)=>{if(n.constructor===qe){const{client:e,clock:r}=n.id;return new qe(Nt(e,r+t),n.length-t)}else if(n.constructor===Ue){const{client:e,clock:r}=n.id;return new Ue(Nt(e,r+t),n.length-t)}else{const e=n,{client:r,clock:i}=e.id;return new Wt(Nt(r,i+t),null,Nt(r,i+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},Uo=(n,t=zr,e=pr)=>{if(n.length===1)return n[0];const r=n.map(g=>new t(On(g)));let i=r.map(g=>new Xa(g,!0)),o=null;const s=new e,c=new Ja(s);for(;i=i.filter(l=>l.curr!==null),i.sort((l,f)=>{if(l.curr.id.client===f.curr.id.client){const h=l.curr.id.clock-f.curr.id.clock;return h===0?l.curr.constructor===f.curr.constructor?0:l.curr.constructor===Ue?1:-1:h}else return f.curr.id.client-l.curr.id.client}),i.length!==0;){const g=i[0],u=g.curr.id.client;if(o!==null){let l=g.curr,f=!1;for(;l!==null&&l.id.clock+l.length<=o.struct.id.clock+o.struct.length&&l.id.client>=o.struct.id.client;)l=g.next(),f=!0;if(l===null||l.id.client!==u||f&&l.id.clock>o.struct.id.clock+o.struct.length)continue;if(u!==o.struct.id.client)Jn(c,o.struct,o.offset),o={struct:l,offset:0},g.next();else if(o.struct.id.clock+o.struct.length<l.id.clock)if(o.struct.constructor===Ue)o.struct.length=l.id.clock+l.length-o.struct.id.clock;else{Jn(c,o.struct,o.offset);const h=l.id.clock-o.struct.id.clock-o.struct.length;o={struct:new Ue(Nt(u,o.struct.id.clock+o.struct.length),h),offset:0}}else{const h=o.struct.id.clock+o.struct.length-l.id.clock;h>0&&(o.struct.constructor===Ue?o.struct.length-=h:l=Np(l,h)),o.struct.mergeWith(l)||(Jn(c,o.struct,o.offset),o={struct:l,offset:0},g.next())}}else o={struct:g.curr,offset:0},g.next();for(let l=g.curr;l!==null&&l.id.client===u&&l.id.clock===o.struct.id.clock+o.struct.length&&l.constructor!==Ue;l=g.next())Jn(c,o.struct,o.offset),o={struct:l,offset:0}}o!==null&&(Jn(c,o.struct,o.offset),o=null),Qa(c);const a=r.map(g=>Ga(g)),y=fa(a);return ni(s,y),s.toUint8Array()},Pp=(n,t,e=zr,r=pr)=>{const i=Eu(t),o=new r,s=new Ja(o),c=new e(On(n)),a=new Xa(c,!1);for(;a.curr;){const g=a.curr,u=g.id.client,l=i.get(u)||0;if(a.curr.constructor===Ue){a.next();continue}if(g.id.clock+g.length>l)for(Jn(s,g,wr(l-g.id.clock,0)),a.next();a.curr&&a.curr.id.client===u;)Jn(s,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===u&&a.curr.id.clock+a.curr.length<=l;)a.next()}Qa(s);const y=Ga(c);return ni(o,y),o.toUint8Array()},Nu=n=>{n.written>0&&(n.clientStructs.push({written:n.written,restEncoder:Qt(n.encoder.restEncoder)}),n.encoder.restEncoder=me(),n.written=0)},Jn=(n,t,e)=>{n.written>0&&n.currClient!==t.id.client&&Nu(n),n.written===0&&(n.currClient=t.id.client,n.encoder.writeClient(t.id.client),St(n.encoder.restEncoder,t.id.clock+e)),t.write(n.encoder,e),n.written++},Qa=n=>{Nu(n);const t=n.encoder.restEncoder;St(t,n.clientStructs.length);for(let e=0;e<n.clientStructs.length;e++){const r=n.clientStructs[e];St(t,r.written),fs(t,r.restEncoder)}},Dp=(n,t,e)=>{const r=new t(On(n)),i=new Xa(r,!1),o=new e,s=new Ja(o);for(let a=i.curr;a!==null;a=i.next())Jn(s,a,0);Qa(s);const c=Ga(r);return ni(o,c),o.toUint8Array()},Ip=n=>Dp(n,zr,Yi);class vs{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null}get path(){return Mp(this.currentTarget,this.target)}deletes(t){return gs(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(i=>{if(i!==null){const o=e._map.get(i);let s,c;if(this.adds(o)){let a=o.left;for(;a!==null&&this.adds(a);)a=a.left;if(this.deletes(o))if(a!==null&&this.deletes(a))s="delete",c=qs(a.content.getContent());else return;else a!==null&&this.deletes(a)?(s="update",c=qs(a.content.getContent())):(s="add",c=void 0)}else if(this.deletes(o))s="delete",c=qs(o.content.getContent());else return;t.set(i,{action:s,oldValue:c})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){const e=this.target,r=Oi(),i=Oi(),o=[];if(t={added:r,deleted:i,delta:o,keys:this.keys},this.transaction.changed.get(e).has(null)){let c=null;const a=()=>{c&&o.push(c)};for(let y=e._start;y!==null;y=y.right)y.deleted?this.deletes(y)&&!this.adds(y)&&((c===null||c.delete===void 0)&&(a(),c={delete:0}),c.delete+=y.length,i.add(y)):this.adds(y)?((c===null||c.insert===void 0)&&(a(),c={insert:[]}),c.insert=c.insert.concat(y.content.getContent()),r.add(y)):((c===null||c.retain===void 0)&&(a(),c={retain:0}),c.retain+=y.length);c!==null&&c.retain===void 0&&a()}this._changes=t}return t}}const Mp=(n,t)=>{const e=[];for(;t._item!==null&&t!==n;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||r++,i=i.right;e.unshift(r)}t=t._item.parent}return e},Pu=80;let tl=0;class Bp{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=tl++}}const $p=n=>{n.timestamp=tl++},Du=(n,t,e)=>{n.p.marker=!1,n.p=t,t.marker=!0,n.index=e,n.timestamp=tl++},jp=(n,t,e)=>{if(n.length>=Pu){const r=n.reduce((i,o)=>i.timestamp<o.timestamp?i:o);return Du(r,t,e),r}else{const r=new Bp(t,e);return n.push(r),r}},ms=(n,t)=>{if(n._start===null||t===0||n._searchMarker===null)return null;const e=n._searchMarker.length===0?null:n._searchMarker.reduce((o,s)=>So(t-o.index)<So(t-s.index)?o:s);let r=n._start,i=0;for(e!==null&&(r=e.p,i=e.index,$p(e));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return e!==null&&So(e.index-i)<r.parent.length/Pu?(Du(e,r,i),e):jp(n._searchMarker,r,i)},Ri=(n,t,e)=>{for(let r=n.length-1;r>=0;r--){const i=n[r];if(e>0){let o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(i.index-=o.length);if(o===null||o.marker===!0){n.splice(r,1);continue}i.p=o,o.marker=!0}(t<i.index||e>0&&t===i.index)&&(i.index=wr(t,i.index+e))}},bs=(n,t,e)=>{const r=n,i=t.changedParentTypes;for(;He(i,n,()=>[]).push(e),n._item!==null;)n=n._item.parent;Cu(r._eH,e,t)};class _e{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=nc(),this._dEH=nc(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw mn()}clone(){throw mn()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){rc(this._eH,t)}observeDeep(t){rc(this._dEH,t)}unobserve(t){ic(this._eH,t)}unobserveDeep(t){ic(this._dEH,t)}toJSON(){}}const Iu=(n,t,e)=>{t<0&&(t=n._length+t),e<0&&(e=n._length+e);let r=e-t;const i=[];let o=n._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){const s=o.content.getContent();if(s.length<=t)t-=s.length;else{for(let c=t;c<s.length&&r>0;c++)i.push(s[c]),r--;t=0}}o=o.right}return i},Mu=n=>{const t=[];let e=n._start;for(;e!==null;){if(e.countable&&!e.deleted){const r=e.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}e=e.right}return t},Li=(n,t)=>{let e=0,r=n._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let o=0;o<i.length;o++)t(i[o],e++,n)}r=r.right}},Bu=(n,t)=>{const e=[];return Li(n,(r,i)=>{e.push(t(r,i,n))}),e},qp=n=>{let t=n._start,e=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),r=0,t=t.right}const i=e[r++];return e.length<=r&&(e=null),{done:!1,value:i}}}},$u=(n,t)=>{const e=ms(n,t);let r=n._start;for(e!==null&&(r=e.p,t-=e.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Fo=(n,t,e,r)=>{let i=e;const o=n.doc,s=o.clientID,c=o.store,a=e===null?t._start:e.right;let y=[];const g=()=>{y.length>0&&(i=new Wt(Nt(s,ce(c,s)),i,i&&i.lastId,a,a&&a.id,t,null,new yr(y)),i.integrate(n,0),y=[])};r.forEach(u=>{if(u===null)y.push(u);else switch(u.constructor){case Number:case Object:case Boolean:case Array:case String:y.push(u);break;default:switch(g(),u.constructor){case Uint8Array:case ArrayBuffer:i=new Wt(Nt(s,ce(c,s)),i,i&&i.lastId,a,a&&a.id,t,null,new Zi(new Uint8Array(u))),i.integrate(n,0);break;case ri:i=new Wt(Nt(s,ce(c,s)),i,i&&i.lastId,a,a&&a.id,t,null,new Xi(u)),i.integrate(n,0);break;default:if(u instanceof _e)i=new Wt(Nt(s,ce(c,s)),i,i&&i.lastId,a,a&&a.id,t,null,new Tn(u)),i.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),g()},ju=kr("Length exceeded!"),qu=(n,t,e,r)=>{if(e>t._length)throw ju;if(e===0)return t._searchMarker&&Ri(t._searchMarker,e,r.length),Fo(n,t,null,r);const i=e,o=ms(t,e);let s=t._start;for(o!==null&&(s=o.p,e-=o.index,e===0&&(s=s.prev,e+=s&&s.countable&&!s.deleted?s.length:0));s!==null;s=s.right)if(!s.deleted&&s.countable){if(e<=s.length){e<s.length&&Te(n,Nt(s.id.client,s.id.clock+e));break}e-=s.length}return t._searchMarker&&Ri(t._searchMarker,i,r.length),Fo(n,t,s,r)},Up=(n,t,e)=>{let i=(t._searchMarker||[]).reduce((o,s)=>s.index>o.index?s:o,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return Fo(n,t,i,e)},Uu=(n,t,e,r)=>{if(r===0)return;const i=e,o=r,s=ms(t,e);let c=t._start;for(s!==null&&(c=s.p,e-=s.index);c!==null&&e>0;c=c.right)!c.deleted&&c.countable&&(e<c.length&&Te(n,Nt(c.id.client,c.id.clock+e)),e-=c.length);for(;r>0&&c!==null;)c.deleted||(r<c.length&&Te(n,Nt(c.id.client,c.id.clock+r)),c.delete(n),r-=c.length),c=c.right;if(r>0)throw ju;t._searchMarker&&Ri(t._searchMarker,i,-o+r)},Ho=(n,t,e)=>{const r=t._map.get(e);r!==void 0&&r.delete(n)},el=(n,t,e,r)=>{const i=t._map.get(e)||null,o=n.doc,s=o.clientID;let c;if(r==null)c=new yr([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c=new yr([r]);break;case Uint8Array:c=new Zi(r);break;case ri:c=new Xi(r);break;default:if(r instanceof _e)c=new Tn(r);else throw new Error("Unexpected content type")}new Wt(Nt(s,ce(o.store,s)),i,i&&i.lastId,null,null,t,e,c).integrate(n,0)},nl=(n,t)=>{const e=n._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},Fu=n=>{const t={};return n._map.forEach((e,r)=>{e.deleted||(t[r]=e.content.getContent()[e.length-1])}),t},Hu=(n,t)=>{const e=n._map.get(t);return e!==void 0&&!e.deleted},vo=n=>np(n.entries(),t=>!t[1].deleted);class zu extends vs{constructor(t,e){super(t,e),this._transaction=e}}class $n extends _e{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new $n;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new $n}clone(){const t=new $n;return t.insert(0,this.toArray().map(e=>e instanceof _e?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),bs(this,t,new zu(this,t))}insert(t,e){this.doc!==null?Vt(this.doc,r=>{qu(r,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?Vt(this.doc,e=>{Up(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?Vt(this.doc,r=>{Uu(r,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return $u(this,t)}toArray(){return Mu(this)}slice(t=0,e=this.length){return Iu(this,t,e)}toJSON(){return this.map(t=>t instanceof _e?t.toJSON():t)}map(t){return Bu(this,t)}forEach(t){Li(this,t)}[Symbol.iterator](){return qp(this)}_write(t){t.writeTypeRef(lg)}}const Fp=n=>new $n;class Vu extends vs{constructor(t,e,r){super(t,e),this.keysChanged=r}}class En extends _e{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new En}clone(){const t=new En;return this.forEach((e,r)=>{t.set(r,e instanceof _e?e.clone():e)}),t}_callObserver(t,e){bs(this,t,new Vu(this,t,e))}toJSON(){const t={};return this._map.forEach((e,r)=>{if(!e.deleted){const i=e.content.getContent()[e.length-1];t[r]=i instanceof _e?i.toJSON():i}}),t}get size(){return[...vo(this._map)].length}keys(){return Fs(vo(this._map),t=>t[0])}values(){return Fs(vo(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return Fs(vo(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){const e={};return this._map.forEach((r,i)=>{r.deleted||t(r.content.getContent()[r.length-1],i,this)}),e}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Vt(this.doc,e=>{Ho(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?Vt(this.doc,r=>{el(r,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return nl(this,t)}has(t){return Hu(this,t)}clear(){this.doc!==null?Vt(this.doc,t=>{this.forEach(function(e,r,i){Ho(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(cg)}}const Hp=n=>new En,tr=(n,t)=>n===t||typeof n=="object"&&typeof t=="object"&&n&&t&&qd(n,t);class da{constructor(t,e,r,i){this.left=t,this.right=e,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&en(),this.right.content.constructor){case he:this.right.deleted||ii(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const fc=(n,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case he:t.right.deleted||ii(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&Te(n,Nt(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},mo=(n,t,e)=>{const r=new Map,i=ms(t,e);if(i){const o=new da(i.p.left,i.p,i.index,r);return fc(n,o,e-i.index)}else{const o=new da(null,t._start,0,r);return fc(n,o,e)}},Ku=(n,t,e,r)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===he&&tr(r.get(e.right.content.key),e.right.content.value));)e.right.deleted||r.delete(e.right.content.key),e.forward();const i=n.doc,o=i.clientID;r.forEach((s,c)=>{const a=e.left,y=e.right,g=new Wt(Nt(o,ce(i.store,o)),a,a&&a.lastId,y,y&&y.id,t,null,new he(c,s));g.integrate(n,0),e.right=g,e.forward()})},ii=(n,t)=>{const{key:e,value:r}=t;r===null?n.delete(e):n.set(e,r)},Wu=(n,t)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===he&&tr(t[n.right.content.key]||null,n.right.content.value)))break;n.forward()}},Gu=(n,t,e,r)=>{const i=n.doc,o=i.clientID,s=new Map;for(const c in r){const a=r[c],y=e.currentAttributes.get(c)||null;if(!tr(y,a)){s.set(c,y);const{left:g,right:u}=e;e.right=new Wt(Nt(o,ce(i.store,o)),g,g&&g.lastId,u,u&&u.id,t,null,new he(c,a)),e.right.integrate(n,0),e.forward()}}return s},Hs=(n,t,e,r,i)=>{e.currentAttributes.forEach((l,f)=>{i[f]===void 0&&(i[f]=null)});const o=n.doc,s=o.clientID;Wu(e,i);const c=Gu(n,t,e,i),a=r.constructor===String?new Sn(r):r instanceof _e?new Tn(r):new Er(r);let{left:y,right:g,index:u}=e;t._searchMarker&&Ri(t._searchMarker,e.index,a.getLength()),g=new Wt(Nt(s,ce(o.store,s)),y,y&&y.lastId,g,g&&g.id,t,null,a),g.integrate(n,0),e.right=g,e.index=u,e.forward(),Ku(n,t,e,c)},hc=(n,t,e,r,i)=>{const o=n.doc,s=o.clientID;Wu(e,i);const c=Gu(n,t,e,i);t:for(;e.right!==null&&(r>0||c.size>0&&(e.right.deleted||e.right.content.constructor===he));){if(!e.right.deleted)switch(e.right.content.constructor){case he:{const{key:a,value:y}=e.right.content,g=i[a];if(g!==void 0){if(tr(g,y))c.delete(a);else{if(r===0)break t;c.set(a,y)}e.right.delete(n)}else e.currentAttributes.set(a,y);break}default:r<e.right.length&&Te(n,Nt(e.right.id.client,e.right.id.clock+r)),r-=e.right.length;break}e.forward()}if(r>0){let a="";for(;r>0;r--)a+=`
`;e.right=new Wt(Nt(s,ce(o.store,s)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new Sn(a)),e.right.integrate(n,0),e.forward()}Ku(n,t,e,c)},Yu=(n,t,e,r,i)=>{let o=e;const s=$o(i);for(;o&&(!o.countable||o.deleted);)!o.deleted&&o.content.constructor===he&&ii(s,o.content),o=o.right;let c=0,a=!1;for(;t!==o;){if(e===t&&(a=!0),!t.deleted){const y=t.content;switch(y.constructor){case he:{const{key:g,value:u}=y;((s.get(g)||null)!==u||(r.get(g)||null)===u)&&(t.delete(n),c++,!a&&(i.get(g)||null)===u&&(r.get(g)||null)!==u&&i.delete(g));break}}}t=t.right}return c},zp=(n,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===he){const r=t.content.key;e.has(r)?t.delete(n):e.add(r)}t=t.left}},Vp=n=>{let t=0;return Vt(n.doc,e=>{let r=n._start,i=n._start,o=yn();const s=$o(o);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case he:ii(s,i.content);break;default:t+=Yu(e,r,i,o,s),o=$o(s),r=i;break}i=i.right}}),t},dc=(n,t,e)=>{const r=e,i=$o(t.currentAttributes),o=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Tn:case Er:case Sn:e<t.right.length&&Te(n,Nt(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(n);break}t.forward()}o&&Yu(n,o,t.right,i,t.currentAttributes);const s=(t.left||t.right).parent;return s._searchMarker&&Ri(s._searchMarker,t.index,-r+e),t};class Zu extends vs{constructor(t,e,r){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,e=[];Vt(t,r=>{const i=new Map,o=new Map;let s=this.target._start,c=null;const a={};let y="",g=0,u=0;const l=()=>{if(c!==null){let f;switch(c){case"delete":f={delete:u},u=0;break;case"insert":f={insert:y},i.size>0&&(f.attributes={},i.forEach((h,m)=>{h!==null&&(f.attributes[m]=h)})),y="";break;case"retain":if(f={retain:g},Object.keys(a).length>0){f.attributes={};for(const h in a)f.attributes[h]=a[h]}g=0;break}e.push(f),c=null}};for(;s!==null;){switch(s.content.constructor){case Tn:case Er:this.adds(s)?this.deletes(s)||(l(),c="insert",y=s.content.getContent()[0],l()):this.deletes(s)?(c!=="delete"&&(l(),c="delete"),u+=1):s.deleted||(c!=="retain"&&(l(),c="retain"),g+=1);break;case Sn:this.adds(s)?this.deletes(s)||(c!=="insert"&&(l(),c="insert"),y+=s.content.str):this.deletes(s)?(c!=="delete"&&(l(),c="delete"),u+=s.length):s.deleted||(c!=="retain"&&(l(),c="retain"),g+=s.length);break;case he:{const{key:f,value:h}=s.content;if(this.adds(s)){if(!this.deletes(s)){const m=i.get(f)||null;tr(m,h)?h!==null&&s.delete(r):(c==="retain"&&l(),tr(h,o.get(f)||null)?delete a[f]:a[f]=h)}}else if(this.deletes(s)){o.set(f,h);const m=i.get(f)||null;tr(m,h)||(c==="retain"&&l(),a[f]=m)}else if(!s.deleted){o.set(f,h);const m=a[f];m!==void 0&&(tr(m,h)?m!==null&&s.delete(r):(c==="retain"&&l(),h===null?delete a[f]:a[f]=h))}s.deleted||(c==="insert"&&l(),ii(i,s.content));break}}s=s.right}for(l();e.length>0;){const f=e[e.length-1];if(f.retain!==void 0&&f.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}}class Fn extends _e{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Fn}clone(){const t=new Fn;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const r=new Zu(this,t,e),i=t.doc;if(bs(this,t,r),!t.local){let o=!1;for(const[s,c]of t.afterState.entries()){const a=t.beforeState.get(s)||0;if(c!==a&&(Ru(t,i.store.clients.get(s),a,c,y=>{!y.deleted&&y.content.constructor===he&&(o=!0)}),o))break}o||dr(t,t.deleteSet,s=>{s instanceof qe||o||s.parent===this&&s.content.constructor===he&&(o=!0)}),Vt(i,s=>{o?Vp(this):dr(s,s.deleteSet,c=>{c instanceof qe||c.parent===this&&zp(s,c)})})}}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===Sn&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?Vt(this.doc,r=>{const i=new da(null,this._start,0,new Map);for(let o=0;o<t.length;o++){const s=t[o];if(s.insert!==void 0){const c=!e&&typeof s.insert=="string"&&o===t.length-1&&i.right===null&&s.insert.slice(-1)===`
`?s.insert.slice(0,-1):s.insert;(typeof c!="string"||c.length>0)&&Hs(r,this,i,c,s.attributes||{})}else s.retain!==void 0?hc(r,this,i,s.retain,s.attributes||{}):s.delete!==void 0&&dc(r,i,s.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,r){const i=[],o=new Map,s=this.doc;let c="",a=this._start;function y(){if(c.length>0){const g={};let u=!1;o.forEach((f,h)=>{u=!0,g[h]=f});const l={insert:c};u&&(l.attributes=g),i.push(l),c=""}}return Vt(s,g=>{for(t&&Oo(g,t),e&&Oo(g,e);a!==null;){if(pi(a,t)||e!==void 0&&pi(a,e))switch(a.content.constructor){case Sn:{const u=o.get("ychange");t!==void 0&&!pi(a,t)?(u===void 0||u.user!==a.id.client||u.state!=="removed")&&(y(),o.set("ychange",r?r("removed",a.id):{type:"removed"})):e!==void 0&&!pi(a,e)?(u===void 0||u.user!==a.id.client||u.state!=="added")&&(y(),o.set("ychange",r?r("added",a.id):{type:"added"})):u!==void 0&&(y(),o.delete("ychange")),c+=a.content.str;break}case Tn:case Er:{y();const u={insert:a.content.getContent()[0]};if(o.size>0){const l={};u.attributes=l,o.forEach((f,h)=>{l[h]=f})}i.push(u);break}case he:pi(a,t)&&(y(),ii(o,a.content));break}a=a.right}y()},Oo),i}insert(t,e,r){if(e.length<=0)return;const i=this.doc;i!==null?Vt(i,o=>{const s=mo(o,this,t);r||(r={},s.currentAttributes.forEach((c,a)=>{r[a]=c})),Hs(o,this,s,e,r)}):this._pending.push(()=>this.insert(t,e,r))}insertEmbed(t,e,r={}){const i=this.doc;i!==null?Vt(i,o=>{const s=mo(o,this,t);Hs(o,this,s,e,r)}):this._pending.push(()=>this.insertEmbed(t,e,r))}delete(t,e){if(e===0)return;const r=this.doc;r!==null?Vt(r,i=>{dc(i,mo(i,this,t),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,r){if(e===0)return;const i=this.doc;i!==null?Vt(i,o=>{const s=mo(o,this,t);s.right!==null&&hc(o,this,s,e,r)}):this._pending.push(()=>this.format(t,e,r))}removeAttribute(t){this.doc!==null?Vt(this.doc,e=>{Ho(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?Vt(this.doc,r=>{el(r,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return nl(this,t)}getAttributes(t){return Fu(this)}_write(t){t.writeTypeRef(ug)}}const Kp=n=>new Fn;class zs{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===Ni||e.constructor===gr)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class gr extends _e{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new gr}clone(){const t=new gr;return t.insert(0,this.toArray().map(e=>e instanceof _e?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new zs(this,t)}querySelector(t){t=t.toUpperCase();const r=new zs(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),Array.from(new zs(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){bs(this,t,new Yp(this,e,t))}toString(){return Bu(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},r){const i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),Li(this,o=>{i.insertBefore(o.toDOM(t,e,r),null)}),i}insert(t,e){this.doc!==null?Vt(this.doc,r=>{qu(r,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)Vt(this.doc,r=>{const i=t&&t instanceof _e?t._item:t;Fo(r,this,i,e)});else{const r=this._prelimContent,i=t===null?0:r.findIndex(o=>o===t)+1;if(i===0&&t!==null)throw kr("Reference item not found");r.splice(i,0,...e)}}delete(t,e=1){this.doc!==null?Vt(this.doc,r=>{Uu(r,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return Mu(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return $u(this,t)}slice(t=0,e=this.length){return Iu(this,t,e)}forEach(t){Li(this,t)}_write(t){t.writeTypeRef(hg)}}const Wp=n=>new gr;class Ni extends gr{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Ni(this.nodeName)}clone(){const t=new Ni(this.nodeName),e=this.getAttributes();for(const r in e)t.setAttribute(r,e[r]);return t.insert(0,this.toArray().map(r=>r instanceof _e?r.clone():r)),t}toString(){const t=this.getAttributes(),e=[],r=[];for(const c in t)r.push(c);r.sort();const i=r.length;for(let c=0;c<i;c++){const a=r[c];e.push(a+'="'+t[a]+'"')}const o=this.nodeName.toLocaleLowerCase(),s=e.length>0?" "+e.join(" "):"";return`<${o}${s}>${super.toString()}</${o}>`}removeAttribute(t){this.doc!==null?Vt(this.doc,e=>{Ho(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?Vt(this.doc,r=>{el(r,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return nl(this,t)}hasAttribute(t){return Hu(this,t)}getAttributes(t){return Fu(this)}toDOM(t=document,e={},r){const i=t.createElement(this.nodeName),o=this.getAttributes();for(const s in o)i.setAttribute(s,o[s]);return Li(this,s=>{i.appendChild(s.toDOM(t,e,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(fg),t.writeKey(this.nodeName)}}const Gp=n=>new Ni(n.readKey());class Yp extends vs{constructor(t,e,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class zo extends En{constructor(t){super(),this.hookName=t}_copy(){return new zo(this.hookName)}clone(){const t=new zo(this.hookName);return this.forEach((e,r)=>{t.set(r,e)}),t}toDOM(t=document,e={},r){const i=e[this.hookName];let o;return i!==void 0?o=i.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(t){t.writeTypeRef(dg),t.writeKey(this.hookName)}}const Zp=n=>new zo(n.readKey());class Vo extends Fn{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Vo}clone(){const t=new Vo;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,r){const i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const e=[];for(const i in t.attributes){const o=[];for(const s in t.attributes[i])o.push({key:s,value:t.attributes[i][s]});o.sort((s,c)=>s.key<c.key?-1:1),e.push({nodeName:i,attrs:o})}e.sort((i,o)=>i.nodeName<o.nodeName?-1:1);let r="";for(let i=0;i<e.length;i++){const o=e[i];r+=`<${o.nodeName}`;for(let s=0;s<o.attrs.length;s++){const c=o.attrs[s];r+=` ${c.key}="${c.value}"`}r+=">"}r+=t.insert;for(let i=e.length-1;i>=0;i--)r+=`</${e[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(pg)}}const Xp=n=>new Vo;class rl{constructor(t,e){this.id=t,this.length=e}get deleted(){throw mn()}mergeWith(t){return!1}write(t,e,r){throw mn()}integrate(t,e){throw mn()}}const Jp=0;class qe extends rl{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),Tu(t.doc.store,this)}write(t,e){t.writeInfo(Jp),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Zi{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Zi(this.content)}splice(t){throw mn()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const Qp=n=>new Zi(n.readBuf());class Pi{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Pi(this.len)}splice(t){const e=new Pi(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){Ti(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const tg=n=>new Pi(n.readLen()),Xu=(n,t)=>new ri({guid:n,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Xi{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Xi(Xu(this.doc.guid,this.opts))}splice(t){throw mn()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const eg=n=>new Xi(Xu(n.readString(),n.readAny()));class Er{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Er(this.embed)}splice(t){throw mn()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const ng=n=>new Er(n.readJSON());class he{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new he(this.key,this.value)}splice(t){throw mn()}mergeWith(t){return!1}integrate(t,e){e.parent._searchMarker=null}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const rg=n=>new he(n.readKey(),n.readJSON());class Ko{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ko(this.arr)}splice(t){const e=new Ko(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const r=this.arr.length;t.writeLen(r-e);for(let i=e;i<r;i++){const o=this.arr[i];t.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const ig=n=>{const t=n.readLen(),e=[];for(let r=0;r<t;r++){const i=n.readString();i==="undefined"?e.push(void 0):e.push(JSON.parse(i))}return new Ko(e)};class yr{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new yr(this.arr)}splice(t){const e=new yr(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const r=this.arr.length;t.writeLen(r-e);for(let i=e;i<r;i++){const o=this.arr[i];t.writeAny(o)}}getRef(){return 8}}const og=n=>{const t=n.readLen(),e=[];for(let r=0;r<t;r++)e.push(n.readAny());return new yr(e)};class Sn{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Sn(this.str)}splice(t){const e=new Sn(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}}const sg=n=>new Sn(n.readString()),ag=[Fp,Hp,Kp,Gp,Wp,Zp,Xp],lg=0,cg=1,ug=2,fg=3,hg=4,dg=5,pg=6;class Tn{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Tn(this.type._copy())}splice(t){throw mn()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(r=>{r.deleted?t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const gg=n=>new Tn(ag[n.readTypeRef()](n)),pa=(n,t)=>{let e=t,r=0,i;do r>0&&(e=Nt(e.client,e.clock+r)),i=To(n,e),r=e.clock-i.id.clock,e=i.redone;while(e!==null&&i instanceof Wt);return{item:i,diff:r}},il=(n,t)=>{for(;n!==null&&n.keep!==t;)n.keep=t,n=n.parent._item},Wo=(n,t,e)=>{const{client:r,clock:i}=t.id,o=new Wt(Nt(r,i+e),t,Nt(r,i+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),t.redone!==null&&(o.redone=Nt(t.redone.client,t.redone.clock+e)),t.right=o,o.right!==null&&(o.right.left=o),n._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),t.length=e,o},Ju=(n,t,e,r,i)=>{const o=n.doc,s=o.store,c=o.clientID,a=t.redone;if(a!==null)return Te(n,a);let y=t.parent._item,g=null,u;if(y!==null&&y.deleted===!0){if(y.redone===null&&(!e.has(y)||Ju(n,y,e,r,i)===null))return null;for(;y.redone!==null;)y=Te(n,y.redone)}const l=y===null?t.parent:y.content.type;if(t.parentSub===null){for(g=t.left,u=t;g!==null;){let k=g;for(;k!==null&&k.parent._item!==y;)k=k.redone===null?null:Te(n,k.redone);if(k!==null&&k.parent._item===y){g=k;break}g=g.left}for(;u!==null;){let k=u;for(;k!==null&&k.parent._item!==y;)k=k.redone===null?null:Te(n,k.redone);if(k!==null&&k.parent._item===y){u=k;break}u=u.right}}else if(u=null,t.right&&!i){for(g=t;g!==null&&g.right!==null&&gs(r,g.right.id);)g=g.right;for(;g!==null&&g.redone!==null;)g=Te(n,g.redone);if(g&&g.right!==null)return null}else g=l._map.get(t.parentSub)||null;const f=ce(s,c),h=Nt(c,f),m=new Wt(h,g,g&&g.lastId,u,u&&u.id,l,t.parentSub,t.content.copy());return t.redone=h,il(m,!0),m.integrate(n,0),m};class Wt extends rl{constructor(t,e,r,i,o,s,c,a){super(t,a.getLength()),this.origin=r,this.left=e,this.right=i,this.rightOrigin=o,this.parent=s,this.parentSub=c,this.redone=null,this.content=a,this.info=this.content.isCountable()?Vl:0}set marker(t){(this.info&Bs)>0!==t&&(this.info^=Bs)}get marker(){return(this.info&Bs)>0}get keep(){return(this.info&zl)>0}set keep(t){this.keep!==t&&(this.info^=zl)}get countable(){return(this.info&Vl)>0}get deleted(){return(this.info&Ms)>0}set deleted(t){this.deleted!==t&&(this.info^=Ms)}markDeleted(){this.info|=Ms}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ce(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ce(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Br&&this.id.client!==this.parent.client&&this.parent.clock>=ce(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=sc(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Te(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===qe||this.right&&this.right.constructor===qe)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===Wt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Wt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Br){const r=To(e,this.parent);r.constructor===qe?this.parent=null:this.parent=r.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=sc(t,t.doc.store,Nt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const o=new Set,s=new Set;for(;i!==null&&i!==this.right;){if(s.add(i),o.add(i),po(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,o.clear();else if(po(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&s.has(To(t.doc.store,i.origin)))o.has(To(t.doc.store,i.origin))||(r=i,o.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Tu(t.doc.store,this),this.content.integrate(t,this),lc(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new qe(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:Nt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&po(t.origin,this.lastId)&&this.right===t&&po(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),Ti(t.deleteSet,this.id.client,this.id.clock,this.length),lc(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw en();this.content.gc(t),e?Ep(t,this,new qe(this.id,this.length)):this.content=new Pi(this.length)}write(t,e){const r=e>0?Nt(this.id.client,this.id.clock+e-1):this.origin,i=this.rightOrigin,o=this.parentSub,s=this.content.getRef()&cs|(r===null?0:$e)|(i===null?0:Mn)|(o===null?0:Ci);if(t.writeInfo(s),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){const c=this.parent;if(c._item!==void 0){const a=c._item;if(a===null){const y=Au(c);t.writeParentInfo(!0),t.writeString(y)}else t.writeParentInfo(!1),t.writeLeftID(a.id)}else c.constructor===String?(t.writeParentInfo(!0),t.writeString(c)):c.constructor===Br?(t.writeParentInfo(!1),t.writeLeftID(c)):en();o!==null&&t.writeString(o)}this.content.write(t,e)}}const Qu=(n,t)=>yg[t&cs](n),yg=[()=>{en()},tg,ig,Qp,sg,ng,rg,gg,og,eg,()=>{en()}],vg=10;class Ue extends rl{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){en()}write(t,e){t.writeInfo(vg),St(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},ef="__ $YJS$ __";tf[ef]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");tf[ef]=!0;const Vs=3e4;class ol extends ti{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const e=kn();this.getLocalState()!==null&&Vs/2<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,o)=>{o!==this.clientID&&Vs<=e-i.lastUpdated&&this.states.has(o)&&r.push(o)}),r.length>0&&ga(this,r,"timeout")},wn(Vs/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const e=this.clientID,r=this.meta.get(e),i=r===void 0?0:r.clock+1,o=this.states.get(e);t===null?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:i,lastUpdated:kn()});const s=[],c=[],a=[],y=[];t===null?y.push(e):o==null?t!=null&&s.push(e):(c.push(e),_i(o,t)||a.push(e)),(s.length>0||a.length>0||y.length>0)&&this.emit("change",[{added:s,updated:a,removed:y},"local"]),this.emit("update",[{added:s,updated:c,removed:y},"local"])}setLocalStateField(t,e){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:e})}getStates(){return this.states}}const ga=(n,t,e)=>{const r=[];for(let i=0;i<t.length;i++){const o=t[i];if(n.states.has(o)){if(n.states.delete(o),o===n.clientID){const s=n.meta.get(o);n.meta.set(o,{clock:s.clock+1,lastUpdated:kn()})}r.push(o)}}r.length>0&&(n.emit("change",[{added:[],updated:[],removed:r},e]),n.emit("update",[{added:[],updated:[],removed:r},e]))},Go=(n,t,e=n.states)=>{const r=t.length,i=me();St(i,r);for(let o=0;o<r;o++){const s=t[o],c=e.get(s)||null,a=n.meta.get(s).clock;St(i,s),St(i,a),vn(i,JSON.stringify(c))}return Qt(i)},mg=(n,t,e)=>{const r=On(t),i=kn(),o=[],s=[],c=[],a=[],y=Tt(r);for(let g=0;g<y;g++){const u=Tt(r);let l=Tt(r);const f=JSON.parse(Bn(r)),h=n.meta.get(u),m=n.states.get(u),k=h===void 0?0:h.clock;(k<l||k===l&&f===null&&n.states.has(u))&&(f===null?u===n.clientID&&n.getLocalState()!=null?l++:n.states.delete(u):n.states.set(u,f),n.meta.set(u,{clock:l,lastUpdated:i}),h===void 0&&f!==null?o.push(u):h!==void 0&&f===null?a.push(u):f!==null&&(_i(f,m)||c.push(u),s.push(u)))}(o.length>0||c.length>0||a.length>0)&&n.emit("change",[{added:o,updated:c,removed:a},e]),(o.length>0||s.length>0||a.length>0)&&n.emit("update",[{added:o,updated:s,removed:a},e])};function bg(n){return{dispose:()=>{n.forEach(t=>{try{t.dispose()}catch(e){console.error(e)}}),n.length=0}}}class le{constructor(){this.emitting=!1,this.callbacks=[],this.disposables=[]}static fromEvent(t,e,r){const i=new le,o=s=>{i.emit(s)};return t.addEventListener(e,o,r),i.disposables.push({dispose:()=>{t.removeEventListener(e,o)}}),i}filter(t){const e=new le;return e.disposables.push({dispose:()=>this.dispose()}),this.on(r=>{t(r)&&e.emit(r)}),e}on(t){if(this.emitting){const e=[...this.callbacks,t];this.callbacks=e}else this.callbacks.push(t);return{dispose:()=>{if(this.emitting)this.callbacks=this.callbacks.filter(e=>e!==t);else{const e=this.callbacks.indexOf(t);e>-1&&this.callbacks.splice(e,1)}}}}once(t){let e;const r=i=>{t(i),e&&e()};e=this.on(r).dispose}unshift(t){if(this.emitting){const e=[t,...this.callbacks];this.callbacks=e}else this.callbacks.unshift(t);return{dispose:()=>{if(this.emitting)this.callbacks=this.callbacks.filter(e=>e!==t);else{const e=this.callbacks.indexOf(t);e>-1&&this.callbacks.splice(e,1)}}}}emit(t){const e=this.emitting;this.emitting=!0,this.callbacks.forEach(r=>{try{r(t)}catch(i){console.error(i)}}),this.emitting=e}pipe(t){return this.callbacks.push(e=>t.emit(e)),this}dispose(){bg(this.disposables).dispose(),this.callbacks.length=0}toDispose(t){return t.push(this),this}}class _g{constructor(t,e){this.signals={update:new le},this._onAwarenessChange=r=>{const{added:i,removed:o,updated:s}=r,c=this.awareness.getStates();i.forEach(a=>{this.signals.update.emit({id:a,type:"add",state:c.get(a)})}),s.forEach(a=>{this.signals.update.emit({id:a,type:"update",state:c.get(a)})}),o.forEach(a=>{this.signals.update.emit({id:a,type:"remove"})})},this._onAwarenessMessage=r=>{r.id===this.awareness.clientID?this.updateLocalCursor():this._resetRemoteCursor()},this.space=t,this.awareness=e,this.awareness.on("change",this._onAwarenessChange),this.signals.update.on(this._onAwarenessMessage)}setLocalCursor(t){this.awareness.setLocalStateField("cursor",t)}getLocalCursor(){const e=this.awareness.getStates().get(this.awareness.clientID);return e==null?void 0:e.cursor}getStates(){return this.awareness.getStates()}_resetRemoteCursor(){this.space.richTextAdapters.forEach(t=>t.quillCursors.clearCursors()),this.getStates().forEach((t,e)=>{if(e!==this.awareness.clientID&&t.cursor){const r=yo(t.cursor.anchor,this.space.doc),i=yo(t.cursor.focus,this.space.doc),o=this.space.richTextAdapters.get(t.cursor.id||"");if(r&&i&&o){const s=t.user||{},c=s.color||"#ffa500",a=s.name||"other";o.quillCursors.createCursor(e.toString(),a,c),o.quillCursors.moveCursor(e.toString(),{index:r.index,length:i.index-r.index})}}})}updateLocalCursor(){const t=this.space.awareness.getLocalCursor();if(!t)return;const e=yo(t.anchor,this.space.doc),r=yo(t.focus,this.space.doc);if(e&&r){const i=this.space.richTextAdapters.get(t.id||"");i==null||i.quill.setSelection(e.index,r.index-e.index)}}destroy(){this.awareness&&(this.awareness.off("change",this._onAwarenessChange),this.signals.update.dispose())}}class Sr{constructor(t,e){this.propsUpdated=new le,this.childrenUpdated=new le,this.childMap=new Map,this.space=t,this.id=e.id,this.children=[]}firstChild(){const t=this.children;return t!=null&&t.length?t[0]:null}lastChild(){return this.children.length?this.children[this.children.length-1].lastChild():this}block2html(t,e,r,i,o){var a;return`${((a=this.text)==null?void 0:a.sliceToDelta(i||0,o)).reduce((y,g)=>y+this._deltaLeaf2Html(g),"")}${t}`}block2Text(t,e,r){var o;return`${(((o=this.text)==null?void 0:o.toString())||"").slice(e||0,r)}${t}`}_deltaLeaf2Html(t){let e=t.insert;const r=t.attributes;return r&&(r.code&&(e=`<code>${e}</code>`),r.bold&&(e=`<strong>${e}</strong>`),r.italic&&(e=`<em>${e}</em>`),r.underline&&(e=`<u>${e}</u>`),r.strikethrough&&(e=`<s>${e}</s>`),r.link&&(e=`<a href='${r.link}'>${e}</a>`)),e}dispose(){this.propsUpdated.dispose(),this.childrenUpdated.dispose()}}const Je="PrelimText does not support ";class Yo{constructor(t,e){this.ready=!1,this.type=t,this.index=e}get length(){return 0}clone(){throw new Error(Je+"clone")}insert(){throw new Error(Je+"insert")}insertList(){throw new Error(Je+"insertList")}split(){throw new Error(Je+"split")}join(){throw new Error(Je+"join")}clear(){throw new Error(Je+"clear")}delete(){throw new Error(Je+"delete")}replace(){throw new Error(Je+"replace")}format(){throw new Error(Je+"format")}applyDelta(){throw new Error(Je+"applyDelta")}sliceToDelta(){throw new Error(Je+"sliceToDelta")}}class jn{constructor(t,e){this._shouldTransact=!0,this._space=t,typeof e=="string"?this._yText=new Fn(e):this._yText=e}static fromDelta(t,e){const r=new jn(t,"");return r.applyDelta(e),r}get length(){return this._yText.length}_transact(t){const{_space:e,_shouldTransact:r}=this;r?e.transact(t):t()}clone(){return new jn(this._space,this._yText.clone())}split(t){return[new Yo("splitLeft",t),new Yo("splitRight",t)]}insert(t,e,r){this._transact(()=>{this._yText.insert(e,t,r),this._yText.meta={split:!0}})}insertList(t,e){this._transact(()=>{for(let r=t.length-1;r>=0;r--)this._yText.insert(e,t[r].insert||"",t[r].attributes);this._yText.meta={split:!0}})}join(t){this._transact(()=>{const r=t._yText.toDelta();r.splice(0,0,{retain:this._yText.length}),this._yText.applyDelta(r),this._yText.meta={join:!0}})}format(t,e,r){this._transact(()=>{this._yText.format(t,e,r),this._yText.meta={format:!0}})}delete(t,e){this._transact(()=>{this._yText.delete(t,e),this._yText.meta={delete:!0}})}replace(t,e,r,i){this._transact(()=>{this._yText.delete(t,e),this._yText.insert(t,r,i),this._yText.meta={replace:!0}})}clear(){this._transact(()=>{this._yText.delete(0,this._yText.length),this._yText.meta={clear:!0}})}applyDelta(t){this._transact(()=>{this._yText.applyDelta(t)})}toDelta(){var t;return((t=this._yText)==null?void 0:t.toDelta())||[]}sliceToDelta(t,e){if(e&&t>=e)return[];const r=this.toDelta();if(t<1&&!e)return r;const i=[];if(r&&r instanceof Array){let o=0;for(let s=0;s<r.length;s++){const c=r[s];let a=c.insert||"";const y=a.length;if(e&&o+y>e&&(a=a.slice(0,e-o)),o+y>t&&i.length===0&&(a=a.slice(t-o)),o+y>t&&i.length===0?i.push({...c,insert:a}):i.length>0&&i.push(c),e&&o+y>e)break;o=o+y}}return i}toString(){var t;return((t=this._yText)==null?void 0:t.toString())||""}}class wg{constructor(t,e,r){this._yObserver=o=>{var g,u;const c=!(o.transaction.origin===this.doc.clientID),a=!!((g=o.target)!=null&&g.meta);if(c||a){const l=o.delta,f=[];for(let h=0;h<l.length;h++){const m=l[h];m.insert!==void 0?f.push(Object.assign({},m,{attributes:Object.assign({},this._negatedUsedFormats,m.attributes||{})})):f.push(m)}this.quill.updateContents(f,this.doc.clientID),(u=o.target)!=null&&u.meta&&delete o.target.meta}},this._quillObserver=(o,s,c,a)=>{const{yText:y}=this;if(s&&s.ops){const g=s.ops;g.forEach(u=>{if(u.attributes!==void 0)for(const l in u.attributes)this._negatedUsedFormats[l]===void 0&&(this._negatedUsedFormats[l]=!1)}),a==="user"&&this.space.transact(()=>{y.applyDelta(g)})}},this.space=t,this.yText=e,this.doc=t.doc,this.quill=r,this.awareness=t.awareness;const i=r.getModule("cursors")||null;this.quillCursors=i,this._negatedUsedFormats={},this.yText.observe(this._yObserver),r.setContents(e.toDelta(),this),r.on("editor-change",this._quillObserver)}getCursor(){const t=this.quill.getSelection();if(!t)return null;const e=oc(this.yText,t.index),r=oc(this.yText,t.index+t.length);return{anchor:e,focus:r}}destroy(){this.yText.unobserve(this._yObserver),this.quill.off("editor-change",this._quillObserver)}}const nf=new Set(["id","flavour","children"]);function kg(n){return n!==Object(n)}function xg(n){if(n==null)throw new Error("val does not exist")}function Eg(n,t){if(!t.includes(n.flavour))throw new Error(`model flavour ${n.flavour} is not allowed`)}function rf(n,t){return t.includes(n.flavour)}function Sg(n,t){!Array.isArray(t.children)||t.children.forEach(e=>{if(!n.has(e.id))throw new Error("Invalid child id: "+e.id)})}function Cg(n,t){n.set("sys:id",t.id),n.set("sys:flavour",t.flavour);const e=new $n;n.set("sys:children",e),Array.isArray(t.children)&&t.children.forEach(r=>e.push([r.id]))}function pc(n,t,e){var r,i,o;Object.keys(t).forEach(s=>{if(!(nf.has(s)||e.has(s))&&s!=="text"){if(!kg(t[s]))throw new Error("Only top level primitives are supported for now");t[s]!==void 0&&n.set("prop:"+s,t[s])}}),t.flavour==="affine:paragraph"&&!t.type&&!n.has("prop:type")&&n.set("prop:type","text"),t.flavour==="affine:list"&&!n.has("prop:type")&&n.set("prop:type",(r=t.type)!=null?r:"bulleted"),t.flavour==="affine:list"&&!n.has("prop:checked")&&n.set("prop:checked",(i=t.checked)!=null?i:!1),t.flavour==="affine:group"&&!n.has("prop:xywh")&&n.set("prop:xywh",(o=t.xywh)!=null?o:"[0,0,720,480]")}function Ag(n,t,e){if(!!e){if(e instanceof jn){t.set("prop:text",e._yText);return}if(e instanceof Yo){const r=n.values(),i=r.next().value,o=r.next().value,s=r.next().value;if(!o.ready)throw new Error("PrelimText left is not ready");if(o.type!=="splitLeft"||s.type!=="splitRight"||s!==e)throw new Error("Unmatched text entity");const c=i._yText;c.meta={split:!0};const a=c.clone();t.set("prop:text",a),a.delete(0,s.index),c.delete(s.index,c.length-s.index),n.clear()}}}function Og(n){const t={};return Object.keys(n).forEach(e=>{n[e]&&(t[e.replace("sys:","")]=n[e])}),Object.keys(n).forEach(e=>{if(nf.has(e))return;const r=e.replace("prop:","");t[r]=n[e]}),t}const Tg=()=>{let n=0;return function(){return(n++).toString()}},sl=()=>qa(),Rg=typeof window<"u";function gc(n){return new Map(n.map((t,e)=>[t,e]))}class Lg{constructor(t,e,r=sl){this.richTextAdapters=new Map,this.signals={historyUpdated:new le,rootAdded:new le,rootDeleted:new le,textUpdated:new le,updated:new le},this._root=null,this._flavourMap=new Map,this._blockMap=new Map,this._splitSet=new Set,this._ignoredKeys=new Set(Object.keys(new Sr(this,{}))),this._historyAddObserver=s=>{Rg&&s.stackItem.meta.set("cursor-location",this.awareness.getLocalCursor()),this._historyObserver()},this._historyPopObserver=s=>{const c=s.stackItem.meta.get("cursor-location");!c||(this.awareness.setLocalCursor(c),this._historyObserver())},this._historyObserver=()=>{this.signals.historyUpdated.emit()},this.doc=t,this._idGenerator=r;const i=e!=null?e:new ol(this.doc);this.awareness=new _g(this,i);const o=s=>{for(const c of s)this._handleYEvent(c);this.signals.updated.emit()};this._yBlocks.observeDeep(o),this._history=new Tp([this._yBlocks],{trackedOrigins:new Set([this.doc.clientID]),doc:this.doc}),this._history.on("stack-cleared",this._historyObserver),this._history.on("stack-item-added",this._historyAddObserver),this._history.on("stack-item-popped",this._historyPopObserver),this._history.on("stack-item-updated",this._historyObserver)}get _yBlocks(){return this.doc.getMap("page0")}get root(){return this._root}get isEmpty(){return this._yBlocks.size===0}get canUndo(){return this._history.canUndo()}get canRedo(){return this._history.canRedo()}undo(){this._history.undo()}redo(){this._history.redo()}captureSync(){this._history.stopCapturing()}resetHistory(){this._history.clear()}transact(t){this.doc.transact(t,this.doc.clientID)}register(t){return Object.keys(t).forEach(e=>{this._flavourMap.set(e,t[e])}),this}getBlockById(t){var e;return(e=this._blockMap.get(t))!=null?e:null}getParentById(t,e){if(t===e.id)return null;const r=this._blockMap.get(t);if(!r)return null;for(const[i]of r.childMap){if(i===e.id)return r;const o=this.getParentById(i,e);if(o!==null)return o}return null}getParent(t){return this._root?this.getParentById(this._root.id,t):null}getPreviousSibling(t){var i,o;const e=this.getParent(t),r=(i=e==null?void 0:e.children.indexOf(t))!=null?i:-1;return(o=e==null?void 0:e.children[r-1])!=null?o:null}getNextSibling(t){var i,o;const e=this.getParent(t),r=(i=e==null?void 0:e.children.indexOf(t))!=null?i:-1;return r===-1?null:(o=e==null?void 0:e.children[r+1])!=null?o:null}addBlock(t,e,r){if(!t.flavour)throw new Error("Block props must contain flavour");const i={...t},o=this._idGenerator();return i.id=o,this.transact(()=>{var a,y;const s=new En;Sg(this._yBlocks,i),Cg(s,i),pc(s,i,this._ignoredKeys),Ag(this._splitSet,s,i.text),typeof e=="string"&&(e=this._blockMap.get(e));const c=(y=e==null?void 0:e.id)!=null?y:(a=this._root)==null?void 0:a.id;if(c){const u=this._yBlocks.get(c).get("sys:children"),l=r!=null?r:u.length;u.insert(l,[o])}this._yBlocks.set(o,s)}),o}updateBlockById(t,e){const r=this._blockMap.get(t);this.updateBlock(r,e)}updateBlock(t,e){const r=this._yBlocks.get(t.id);this.transact(()=>{e.text instanceof Yo?e.text.ready=!0:e.text instanceof jn&&(t.text=e.text,r.set("prop:text",e.text._yText)),pc(r,e,this._ignoredKeys)})}deleteBlockById(t){const e=this._blockMap.get(t);this.deleteBlock(e)}deleteBlock(t){var i;const e=this.getParent(t),r=(i=e==null?void 0:e.children.indexOf(t))!=null?i:-1;r>-1&&(e==null||e.children.splice(e.children.indexOf(t),1)),this.transact(()=>{if(this._yBlocks.delete(t.id),t.dispose(),e){const s=this._yBlocks.get(e.id).get("sys:children");r>-1&&s.delete(r,1)}})}get Text(){return jn}attachRichText(t,e){const i=this._getYBlock(t).get("prop:text");if(!i)throw new Error(`Block "${t}" does not have text`);const o=new wg(this,i,e);this.richTextAdapters.set(t,o),e.on("selection-change",()=>{const s=o.getCursor();!s||this.awareness.setLocalCursor({...s,id:t})})}detachRichText(t){const e=this.richTextAdapters.get(t);e==null||e.destroy(),this.richTextAdapters.delete(t)}markTextSplit(t,e,r){this._splitSet.add(t).add(e).add(r)}_getYBlock(t){const e=this._yBlocks.get(t);if(!e)throw new Error(`Block with id ${t} does not exist`);return e}_createBlockModel(t){const e=this._flavourMap.get(t.flavour);if(!e)throw new Error(`Block flavour ${t.flavour} is not registered`);return new e(this,t)}_handleYBlockAdd(t,e){const r=this._getYBlock(e),i=this._blockMap.size===0,o=r.toJSON(),s=Og(o),c=this._createBlockModel({...s,id:e});this._blockMap.set(s.id,c),rf(c,["affine:paragraph","affine:list"])&&!r.get("prop:text")&&this.transact(()=>r.set("prop:text",new Fn));const a=r.get("prop:text"),y=new jn(this,a);c.text=y;const g=r.get("sys:children");if(g instanceof $n&&(c.childMap=gc(g),g.forEach(u=>{const l=c.childMap.get(u);if(Number.isInteger(l)){this._blockMap.has(u)||(t.add(u),this._handleYBlockAdd(t,u));const h=this._blockMap.get(u);c.children[l]=h}})),i)this._root=c,this.signals.rootAdded.emit(c);else{const u=this.getParent(c),l=u==null?void 0:u.childMap.get(c.id);u&&l!==void 0&&(u.children[l]=c,u.childrenUpdated.emit())}}_handleYBlockDelete(t){this._blockMap.get(t)===this._root&&this.signals.rootDeleted.emit(t),this._blockMap.delete(t)}_handleYBlockUpdate(t){const e=t.target.get("sys:id"),r=this.getBlockById(e);if(!r)return;const i={};for(const o of t.keysChanged)o!=="prop:text"&&(i[o.replace("prop:","")]=t.target.get(o));Object.assign(r,i),r.propsUpdated.emit()}_handleYEvent(t){if(t.target===this._yBlocks){const e=new Set;t.keys.forEach((r,i)=>{if(r.action==="add"){if(e.has(i))return;e.add(i),this._handleYBlockAdd(e,i)}else r.action==="delete"&&this._handleYBlockDelete(i)})}else if(t.target.parent===this._yBlocks)t instanceof Zu?this.signals.textUpdated.emit(t):t instanceof Vu&&this._handleYBlockUpdate(t);else if(t.target.parent instanceof En&&t.target.parent.has("sys:id")&&t instanceof zu){const e=t.target.parent.get("sys:id"),r=this._blockMap.get(e);if(!r)throw new Error(`Block with id ${e} does not exist`);if(t.path[t.path.length-1]==="sys:children"){const o=t.target.toArray();r.children=o.map(s=>this._blockMap.get(s)),r.childMap=gc(t.target),r.childrenUpdated.emit()}}}}const ya=Symbol.for("react.test.json"),Ng=n=>!(typeof n!="object"||n===null),Pg=["sys:id","sys:flavour","sys:children"],of=(n,t)=>{var s;if(!Ng(n))throw new Error("Failed to parse doc record! Invalid data.");const e=n[t];if(!e)throw new Error(`Failed to parse doc record! Node not found! id: ${t}.`);const r=e["sys:flavour"],i=e["sys:children"],o=Object.fromEntries(Object.entries(e).filter(([c])=>!Pg.includes(c)));return"prop:text"in o&&(o["prop:text"]=Mg(o["prop:text"])),{$$typeof:ya,type:r,props:o,children:(s=i==null?void 0:i.map(c=>of(n,c)))!=null?s:[]}},Dg=n=>{const t={};return n.share.forEach((e,r)=>{e instanceof En?t[r]=sf(e):t[r]=e.toJSON()}),t},sf=n=>{const t={};return n.forEach((e,r)=>{e instanceof En?t[r]=sf(e):e instanceof Fn?t[r]=Ig(e):e instanceof $n||e instanceof _e?t[r]=e.toJSON():t[r]=e}),t},Ig=n=>n.toDelta(),Mg=n=>{if(!!n.length)return n.length===1&&!n[0].attributes?n[0].insert:{$$typeof:ya,type:"",props:{},children:n==null?void 0:n.map(({insert:t,attributes:e})=>({$$typeof:ya,type:"text",props:{insert:t,...e}}))}},Bg="virgo-default";class $g{constructor({room:t=Bg,providers:e=[],awareness:r,idGenerator:i}={}){this.doc=new ri,this.providers=[],this.spaces=new Map,this.awareness=r!=null?r:new ol(this.doc),this.idGenerator=i!=null?i:sl,this.providers=e.map(o=>new o(t,this.doc,{awareness:this.awareness}))}getSpace(t){return this.spaces.get(t)}createSpace(t){return this.spaces.set(t,new Lg(this.doc,this.awareness,this.idGenerator)),this.getSpace(t)}serializeDoc(){return Dg(this.doc)}toJSXElement(t="0"){const e=this.serializeDoc();if(!("page0"in e))throw new Error("Failed to convert to JSX: 'page0' not found");return e.page0[t]?of(e.page0,t):null}}const jg=1200,qg=2500,Zo=3e4,va=n=>{if(n.shouldConnect&&n.ws===null){const t=new WebSocket(n.url),e=n.binaryType;let r=null;e&&(t.binaryType=e),n.ws=t,n.connecting=!0,n.connected=!1,t.onmessage=s=>{n.lastMessageReceived=kn();const c=s.data,a=typeof c=="string"?JSON.parse(c):c;a&&a.type==="pong"&&(clearTimeout(r),r=setTimeout(o,Zo/2)),n.emit("message",[a,n])};const i=s=>{n.ws!==null&&(n.ws=null,n.connecting=!1,n.connected?(n.connected=!1,n.emit("disconnect",[{type:"disconnect",error:s},n])):n.unsuccessfulReconnects++,setTimeout(va,Pa(ud(n.unsuccessfulReconnects+1)*jg,qg),n)),clearTimeout(r)},o=()=>{n.ws===t&&n.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=s=>i(s),t.onopen=()=>{n.lastMessageReceived=kn(),n.connecting=!1,n.connected=!0,n.unsuccessfulReconnects=0,n.emit("connect",[{type:"connect"},n]),r=setTimeout(o,Zo/2)}}};class Ug extends ti{constructor(t,{binaryType:e}={}){super(),this.url=t,this.ws=null,this.binaryType=e||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Zo<kn()-this.lastMessageReceived&&this.ws.close()},Zo/2),va(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&va(this)}}const Fg=new Map;class Hg{constructor(t){this.room=t,this.onmessage=null,od(e=>e.key===t&&this.onmessage!==null&&this.onmessage({data:uu(e.newValue||"")}))}postMessage(t){ru.setItem(this.room,cu(wd(t)))}}const zg=typeof BroadcastChannel>"u"?Hg:BroadcastChannel,al=n=>He(Fg,n,()=>{const t=new Set,e=new zg(n);return e.onmessage=r=>t.forEach(i=>i(r.data,"broadcastchannel")),{bc:e,subs:t}}),Vg=(n,t)=>al(n).subs.add(t),Kg=(n,t)=>al(n).subs.delete(t),Wg=(n,t,e=null)=>{const r=al(n);r.bc.postMessage(t),r.subs.forEach(i=>i(t,e))},af=()=>{let n=!0;return(t,e)=>{if(n){n=!1;try{t()}finally{n=!0}}else e!==void 0&&e()}};var Qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function bo(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var cf={exports:{}};(function(n,t){(function(e){n.exports=e()})(function(){var e=Math.floor,r=Math.abs,i=Math.pow;return function(){function o(s,c,a){function y(l,f){if(!c[l]){if(!s[l]){var h=typeof bo=="function"&&bo;if(!f&&h)return h(l,!0);if(g)return g(l,!0);var m=new Error("Cannot find module '"+l+"'");throw m.code="MODULE_NOT_FOUND",m}var k=c[l]={exports:{}};s[l][0].call(k.exports,function(b){var v=s[l][1][b];return y(v||b)},k,k.exports,o,s,c,a)}return c[l].exports}for(var g=typeof bo=="function"&&bo,u=0;u<a.length;u++)y(a[u]);return y}return o}()({1:[function(o,s,c){function a(p){var w=p.length;if(0<w%4)throw new Error("Invalid string. Length must be a multiple of 4");var E=p.indexOf("=");E===-1&&(E=w);var x=E===w?0:4-E%4;return[E,x]}function y(p,w,E){return 3*(w+E)/4-E}function g(p){var w,E,x=a(p),O=x[0],L=x[1],S=new k(y(p,O,L)),C=0,T=0<L?O-4:O;for(E=0;E<T;E+=4)w=m[p.charCodeAt(E)]<<18|m[p.charCodeAt(E+1)]<<12|m[p.charCodeAt(E+2)]<<6|m[p.charCodeAt(E+3)],S[C++]=255&w>>16,S[C++]=255&w>>8,S[C++]=255&w;return L===2&&(w=m[p.charCodeAt(E)]<<2|m[p.charCodeAt(E+1)]>>4,S[C++]=255&w),L===1&&(w=m[p.charCodeAt(E)]<<10|m[p.charCodeAt(E+1)]<<4|m[p.charCodeAt(E+2)]>>2,S[C++]=255&w>>8,S[C++]=255&w),S}function u(p){return h[63&p>>18]+h[63&p>>12]+h[63&p>>6]+h[63&p]}function l(p,w,E){for(var x,O=[],L=w;L<E;L+=3)x=(16711680&p[L]<<16)+(65280&p[L+1]<<8)+(255&p[L+2]),O.push(u(x));return O.join("")}function f(p){for(var w,E=p.length,x=E%3,O=[],L=16383,S=0,C=E-x;S<C;S+=L)O.push(l(p,S,S+L>C?C:S+L));return x===1?(w=p[E-1],O.push(h[w>>2]+h[63&w<<4]+"==")):x===2&&(w=(p[E-2]<<8)+p[E-1],O.push(h[w>>10]+h[63&w>>4]+h[63&w<<2]+"=")),O.join("")}c.byteLength=function(p){var w=a(p),E=w[0],x=w[1];return 3*(E+x)/4-x},c.toByteArray=g,c.fromByteArray=f;for(var h=[],m=[],k=typeof Uint8Array>"u"?Array:Uint8Array,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=0,d=b.length;v<d;++v)h[v]=b[v],m[b.charCodeAt(v)]=v;m[45]=62,m[95]=63},{}],2:[function(){},{}],3:[function(o,s,c){(function(){(function(){var a=String.fromCharCode,y=Math.min;function g(_){if(2147483647<_)throw new RangeError('The value "'+_+'" is invalid for option "size"');var A=new Uint8Array(_);return A.__proto__=u.prototype,A}function u(_,A,R){if(typeof _=="number"){if(typeof A=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(_)}return l(_,A,R)}function l(_,A,R){if(typeof _=="string")return k(_,A);if(ArrayBuffer.isView(_))return b(_);if(_==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(I(_,ArrayBuffer)||_&&I(_.buffer,ArrayBuffer))return v(_,A,R);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var z=_.valueOf&&_.valueOf();if(z!=null&&z!==_)return u.from(z,A,R);var Y=d(_);if(Y)return Y;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return u.from(_[Symbol.toPrimitive]("string"),A,R);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}function f(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(0>_)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function h(_,A,R){return f(_),0>=_||A===void 0?g(_):typeof R=="string"?g(_).fill(A,R):g(_).fill(A)}function m(_){return f(_),g(0>_?0:0|p(_))}function k(_,A){if((typeof A!="string"||A==="")&&(A="utf8"),!u.isEncoding(A))throw new TypeError("Unknown encoding: "+A);var R=0|w(_,A),z=g(R),Y=z.write(_,A);return Y!==R&&(z=z.slice(0,Y)),z}function b(_){for(var A=0>_.length?0:0|p(_.length),R=g(A),z=0;z<A;z+=1)R[z]=255&_[z];return R}function v(_,A,R){if(0>A||_.byteLength<A)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<A+(R||0))throw new RangeError('"length" is outside of buffer bounds');var z;return z=A===void 0&&R===void 0?new Uint8Array(_):R===void 0?new Uint8Array(_,A):new Uint8Array(_,A,R),z.__proto__=u.prototype,z}function d(_){if(u.isBuffer(_)){var A=0|p(_.length),R=g(A);return R.length===0||_.copy(R,0,0,A),R}return _.length===void 0?_.type==="Buffer"&&Array.isArray(_.data)?b(_.data):void 0:typeof _.length!="number"||U(_.length)?g(0):b(_)}function p(_){if(_>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|_}function w(_,A){if(u.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||I(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);var R=_.length,z=2<arguments.length&&arguments[2]===!0;if(!z&&R===0)return 0;for(var Y=!1;;)switch(A){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":return st(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*R;case"hex":return R>>>1;case"base64":return pt(_).length;default:if(Y)return z?-1:st(_).length;A=(""+A).toLowerCase(),Y=!0}}function E(_,A,R){var z=!1;if((A===void 0||0>A)&&(A=0),A>this.length||((R===void 0||R>this.length)&&(R=this.length),0>=R)||(R>>>=0,A>>>=0,R<=A))return"";for(_||(_="utf8");;)switch(_){case"hex":return B(this,A,R);case"utf8":case"utf-8":return G(this,A,R);case"ascii":return K(this,A,R);case"latin1":case"binary":return V(this,A,R);case"base64":return F(this,A,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,A,R);default:if(z)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),z=!0}}function x(_,A,R){var z=_[A];_[A]=_[R],_[R]=z}function O(_,A,R,z,Y){if(_.length===0)return-1;if(typeof R=="string"?(z=R,R=0):2147483647<R?R=2147483647:-2147483648>R&&(R=-2147483648),R=+R,U(R)&&(R=Y?0:_.length-1),0>R&&(R=_.length+R),R>=_.length){if(Y)return-1;R=_.length-1}else if(0>R)if(Y)R=0;else return-1;if(typeof A=="string"&&(A=u.from(A,z)),u.isBuffer(A))return A.length===0?-1:L(_,A,R,z,Y);if(typeof A=="number")return A&=255,typeof Uint8Array.prototype.indexOf=="function"?Y?Uint8Array.prototype.indexOf.call(_,A,R):Uint8Array.prototype.lastIndexOf.call(_,A,R):L(_,[A],R,z,Y);throw new TypeError("val must be string, number or Buffer")}function L(_,A,R,z,Y){function tt(xe,re){return ut===1?xe[re]:xe.readUInt16BE(re*ut)}var ut=1,bt=_.length,mt=A.length;if(z!==void 0&&(z=(z+"").toLowerCase(),z==="ucs2"||z==="ucs-2"||z==="utf16le"||z==="utf-16le")){if(2>_.length||2>A.length)return-1;ut=2,bt/=2,mt/=2,R/=2}var yt;if(Y){var ot=-1;for(yt=R;yt<bt;yt++)if(tt(_,yt)!==tt(A,ot===-1?0:yt-ot))ot!==-1&&(yt-=yt-ot),ot=-1;else if(ot===-1&&(ot=yt),yt-ot+1===mt)return ot*ut}else for(R+mt>bt&&(R=bt-mt),yt=R;0<=yt;yt--){for(var Et=!0,te=0;te<mt;te++)if(tt(_,yt+te)!==tt(A,te)){Et=!1;break}if(Et)return yt}return-1}function S(_,A,R,z){R=+R||0;var Y=_.length-R;z?(z=+z,z>Y&&(z=Y)):z=Y;var tt=A.length;z>tt/2&&(z=tt/2);for(var ut,bt=0;bt<z;++bt){if(ut=parseInt(A.substr(2*bt,2),16),U(ut))return bt;_[R+bt]=ut}return bt}function C(_,A,R,z){return gt(st(A,_.length-R),_,R,z)}function T(_,A,R,z){return gt(ct(A),_,R,z)}function N(_,A,R,z){return T(_,A,R,z)}function D(_,A,R,z){return gt(pt(A),_,R,z)}function M(_,A,R,z){return gt(vt(A,_.length-R),_,R,z)}function F(_,A,R){return A===0&&R===_.length?W.fromByteArray(_):W.fromByteArray(_.slice(A,R))}function G(_,A,R){R=y(_.length,R);for(var z=[],Y=A;Y<R;){var tt=_[Y],ut=null,bt=239<tt?4:223<tt?3:191<tt?2:1;if(Y+bt<=R){var mt,yt,ot,Et;bt===1?128>tt&&(ut=tt):bt===2?(mt=_[Y+1],(192&mt)==128&&(Et=(31&tt)<<6|63&mt,127<Et&&(ut=Et))):bt===3?(mt=_[Y+1],yt=_[Y+2],(192&mt)==128&&(192&yt)==128&&(Et=(15&tt)<<12|(63&mt)<<6|63&yt,2047<Et&&(55296>Et||57343<Et)&&(ut=Et))):bt===4&&(mt=_[Y+1],yt=_[Y+2],ot=_[Y+3],(192&mt)==128&&(192&yt)==128&&(192&ot)==128&&(Et=(15&tt)<<18|(63&mt)<<12|(63&yt)<<6|63&ot,65535<Et&&1114112>Et&&(ut=Et)))}ut===null?(ut=65533,bt=1):65535<ut&&(ut-=65536,z.push(55296|1023&ut>>>10),ut=56320|1023&ut),z.push(ut),Y+=bt}return nt(z)}function nt(_){var A=_.length;if(A<=4096)return a.apply(String,_);for(var R="",z=0;z<A;)R+=a.apply(String,_.slice(z,z+=4096));return R}function K(_,A,R){var z="";R=y(_.length,R);for(var Y=A;Y<R;++Y)z+=a(127&_[Y]);return z}function V(_,A,R){var z="";R=y(_.length,R);for(var Y=A;Y<R;++Y)z+=a(_[Y]);return z}function B(_,A,R){var z=_.length;(!A||0>A)&&(A=0),(!R||0>R||R>z)&&(R=z);for(var Y="",tt=A;tt<R;++tt)Y+=rt(_[tt]);return Y}function H(_,A,R){for(var z=_.slice(A,R),Y="",tt=0;tt<z.length;tt+=2)Y+=a(z[tt]+256*z[tt+1]);return Y}function $(_,A,R){if(_%1!=0||0>_)throw new RangeError("offset is not uint");if(_+A>R)throw new RangeError("Trying to access beyond buffer length")}function J(_,A,R,z,Y,tt){if(!u.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(A>Y||A<tt)throw new RangeError('"value" argument is out of bounds');if(R+z>_.length)throw new RangeError("Index out of range")}function X(_,A,R,z){if(R+z>_.length)throw new RangeError("Index out of range");if(0>R)throw new RangeError("Index out of range")}function j(_,A,R,z,Y){return A=+A,R>>>=0,Y||X(_,A,R,4),q.write(_,A,R,z,23,4),R+4}function Z(_,A,R,z,Y){return A=+A,R>>>=0,Y||X(_,A,R,8),q.write(_,A,R,z,52,8),R+8}function et(_){if(_=_.split("=")[0],_=_.trim().replace(P,""),2>_.length)return"";for(;_.length%4!=0;)_+="=";return _}function rt(_){return 16>_?"0"+_.toString(16):_.toString(16)}function st(_,A){A=A||1/0;for(var R,z=_.length,Y=null,tt=[],ut=0;ut<z;++ut){if(R=_.charCodeAt(ut),55295<R&&57344>R){if(!Y){if(56319<R){-1<(A-=3)&&tt.push(239,191,189);continue}else if(ut+1===z){-1<(A-=3)&&tt.push(239,191,189);continue}Y=R;continue}if(56320>R){-1<(A-=3)&&tt.push(239,191,189),Y=R;continue}R=(Y-55296<<10|R-56320)+65536}else Y&&-1<(A-=3)&&tt.push(239,191,189);if(Y=null,128>R){if(0>(A-=1))break;tt.push(R)}else if(2048>R){if(0>(A-=2))break;tt.push(192|R>>6,128|63&R)}else if(65536>R){if(0>(A-=3))break;tt.push(224|R>>12,128|63&R>>6,128|63&R)}else if(1114112>R){if(0>(A-=4))break;tt.push(240|R>>18,128|63&R>>12,128|63&R>>6,128|63&R)}else throw new Error("Invalid code point")}return tt}function ct(_){for(var A=[],R=0;R<_.length;++R)A.push(255&_.charCodeAt(R));return A}function vt(_,A){for(var R,z,Y,tt=[],ut=0;ut<_.length&&!(0>(A-=2));++ut)R=_.charCodeAt(ut),z=R>>8,Y=R%256,tt.push(Y),tt.push(z);return tt}function pt(_){return W.toByteArray(et(_))}function gt(_,A,R,z){for(var Y=0;Y<z&&!(Y+R>=A.length||Y>=_.length);++Y)A[Y+R]=_[Y];return Y}function I(_,A){return _ instanceof A||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===A.name}function U(_){return _!==_}var W=o("base64-js"),q=o("ieee754");c.Buffer=u,c.SlowBuffer=function(_){return+_!=_&&(_=0),u.alloc(+_)},c.INSPECT_MAX_BYTES=50,c.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=function(){try{var _=new Uint8Array(1);return _.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},_.foo()===42}catch{return!1}}(),u.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(_,A,R){return l(_,A,R)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(_,A,R){return h(_,A,R)},u.allocUnsafe=function(_){return m(_)},u.allocUnsafeSlow=function(_){return m(_)},u.isBuffer=function(_){return _!=null&&_._isBuffer===!0&&_!==u.prototype},u.compare=function(_,A){if(I(_,Uint8Array)&&(_=u.from(_,_.offset,_.byteLength)),I(A,Uint8Array)&&(A=u.from(A,A.offset,A.byteLength)),!u.isBuffer(_)||!u.isBuffer(A))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(_===A)return 0;for(var R=_.length,z=A.length,Y=0,tt=y(R,z);Y<tt;++Y)if(_[Y]!==A[Y]){R=_[Y],z=A[Y];break}return R<z?-1:z<R?1:0},u.isEncoding=function(_){switch((_+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(_,A){if(!Array.isArray(_))throw new TypeError('"list" argument must be an Array of Buffers');if(_.length===0)return u.alloc(0);var R;if(A===void 0)for(A=0,R=0;R<_.length;++R)A+=_[R].length;var z=u.allocUnsafe(A),Y=0;for(R=0;R<_.length;++R){var tt=_[R];if(I(tt,Uint8Array)&&(tt=u.from(tt)),!u.isBuffer(tt))throw new TypeError('"list" argument must be an Array of Buffers');tt.copy(z,Y),Y+=tt.length}return z},u.byteLength=w,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var _=this.length;if(_%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var A=0;A<_;A+=2)x(this,A,A+1);return this},u.prototype.swap32=function(){var _=this.length;if(_%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var A=0;A<_;A+=4)x(this,A,A+3),x(this,A+1,A+2);return this},u.prototype.swap64=function(){var _=this.length;if(_%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var A=0;A<_;A+=8)x(this,A,A+7),x(this,A+1,A+6),x(this,A+2,A+5),x(this,A+3,A+4);return this},u.prototype.toString=function(){var _=this.length;return _===0?"":arguments.length===0?G(this,0,_):E.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(_){if(!u.isBuffer(_))throw new TypeError("Argument must be a Buffer");return this===_||u.compare(this,_)===0},u.prototype.inspect=function(){var _="",A=c.INSPECT_MAX_BYTES;return _=this.toString("hex",0,A).replace(/(.{2})/g,"$1 ").trim(),this.length>A&&(_+=" ... "),"<Buffer "+_+">"},u.prototype.compare=function(_,A,R,z,Y){if(I(_,Uint8Array)&&(_=u.from(_,_.offset,_.byteLength)),!u.isBuffer(_))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof _);if(A===void 0&&(A=0),R===void 0&&(R=_?_.length:0),z===void 0&&(z=0),Y===void 0&&(Y=this.length),0>A||R>_.length||0>z||Y>this.length)throw new RangeError("out of range index");if(z>=Y&&A>=R)return 0;if(z>=Y)return-1;if(A>=R)return 1;if(A>>>=0,R>>>=0,z>>>=0,Y>>>=0,this===_)return 0;for(var tt=Y-z,ut=R-A,bt=y(tt,ut),mt=this.slice(z,Y),yt=_.slice(A,R),ot=0;ot<bt;++ot)if(mt[ot]!==yt[ot]){tt=mt[ot],ut=yt[ot];break}return tt<ut?-1:ut<tt?1:0},u.prototype.includes=function(_,A,R){return this.indexOf(_,A,R)!==-1},u.prototype.indexOf=function(_,A,R){return O(this,_,A,R,!0)},u.prototype.lastIndexOf=function(_,A,R){return O(this,_,A,R,!1)},u.prototype.write=function(_,A,R,z){if(A===void 0)z="utf8",R=this.length,A=0;else if(R===void 0&&typeof A=="string")z=A,R=this.length,A=0;else if(isFinite(A))A>>>=0,isFinite(R)?(R>>>=0,z===void 0&&(z="utf8")):(z=R,R=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Y=this.length-A;if((R===void 0||R>Y)&&(R=Y),0<_.length&&(0>R||0>A)||A>this.length)throw new RangeError("Attempt to write outside buffer bounds");z||(z="utf8");for(var tt=!1;;)switch(z){case"hex":return S(this,_,A,R);case"utf8":case"utf-8":return C(this,_,A,R);case"ascii":return T(this,_,A,R);case"latin1":case"binary":return N(this,_,A,R);case"base64":return D(this,_,A,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,_,A,R);default:if(tt)throw new TypeError("Unknown encoding: "+z);z=(""+z).toLowerCase(),tt=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(_,A){var R=this.length;_=~~_,A=A===void 0?R:~~A,0>_?(_+=R,0>_&&(_=0)):_>R&&(_=R),0>A?(A+=R,0>A&&(A=0)):A>R&&(A=R),A<_&&(A=_);var z=this.subarray(_,A);return z.__proto__=u.prototype,z},u.prototype.readUIntLE=function(_,A,R){_>>>=0,A>>>=0,R||$(_,A,this.length);for(var z=this[_],Y=1,tt=0;++tt<A&&(Y*=256);)z+=this[_+tt]*Y;return z},u.prototype.readUIntBE=function(_,A,R){_>>>=0,A>>>=0,R||$(_,A,this.length);for(var z=this[_+--A],Y=1;0<A&&(Y*=256);)z+=this[_+--A]*Y;return z},u.prototype.readUInt8=function(_,A){return _>>>=0,A||$(_,1,this.length),this[_]},u.prototype.readUInt16LE=function(_,A){return _>>>=0,A||$(_,2,this.length),this[_]|this[_+1]<<8},u.prototype.readUInt16BE=function(_,A){return _>>>=0,A||$(_,2,this.length),this[_]<<8|this[_+1]},u.prototype.readUInt32LE=function(_,A){return _>>>=0,A||$(_,4,this.length),(this[_]|this[_+1]<<8|this[_+2]<<16)+16777216*this[_+3]},u.prototype.readUInt32BE=function(_,A){return _>>>=0,A||$(_,4,this.length),16777216*this[_]+(this[_+1]<<16|this[_+2]<<8|this[_+3])},u.prototype.readIntLE=function(_,A,R){_>>>=0,A>>>=0,R||$(_,A,this.length);for(var z=this[_],Y=1,tt=0;++tt<A&&(Y*=256);)z+=this[_+tt]*Y;return Y*=128,z>=Y&&(z-=i(2,8*A)),z},u.prototype.readIntBE=function(_,A,R){_>>>=0,A>>>=0,R||$(_,A,this.length);for(var z=A,Y=1,tt=this[_+--z];0<z&&(Y*=256);)tt+=this[_+--z]*Y;return Y*=128,tt>=Y&&(tt-=i(2,8*A)),tt},u.prototype.readInt8=function(_,A){return _>>>=0,A||$(_,1,this.length),128&this[_]?-1*(255-this[_]+1):this[_]},u.prototype.readInt16LE=function(_,A){_>>>=0,A||$(_,2,this.length);var R=this[_]|this[_+1]<<8;return 32768&R?4294901760|R:R},u.prototype.readInt16BE=function(_,A){_>>>=0,A||$(_,2,this.length);var R=this[_+1]|this[_]<<8;return 32768&R?4294901760|R:R},u.prototype.readInt32LE=function(_,A){return _>>>=0,A||$(_,4,this.length),this[_]|this[_+1]<<8|this[_+2]<<16|this[_+3]<<24},u.prototype.readInt32BE=function(_,A){return _>>>=0,A||$(_,4,this.length),this[_]<<24|this[_+1]<<16|this[_+2]<<8|this[_+3]},u.prototype.readFloatLE=function(_,A){return _>>>=0,A||$(_,4,this.length),q.read(this,_,!0,23,4)},u.prototype.readFloatBE=function(_,A){return _>>>=0,A||$(_,4,this.length),q.read(this,_,!1,23,4)},u.prototype.readDoubleLE=function(_,A){return _>>>=0,A||$(_,8,this.length),q.read(this,_,!0,52,8)},u.prototype.readDoubleBE=function(_,A){return _>>>=0,A||$(_,8,this.length),q.read(this,_,!1,52,8)},u.prototype.writeUIntLE=function(_,A,R,z){if(_=+_,A>>>=0,R>>>=0,!z){var Y=i(2,8*R)-1;J(this,_,A,R,Y,0)}var tt=1,ut=0;for(this[A]=255&_;++ut<R&&(tt*=256);)this[A+ut]=255&_/tt;return A+R},u.prototype.writeUIntBE=function(_,A,R,z){if(_=+_,A>>>=0,R>>>=0,!z){var Y=i(2,8*R)-1;J(this,_,A,R,Y,0)}var tt=R-1,ut=1;for(this[A+tt]=255&_;0<=--tt&&(ut*=256);)this[A+tt]=255&_/ut;return A+R},u.prototype.writeUInt8=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,1,255,0),this[A]=255&_,A+1},u.prototype.writeUInt16LE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,2,65535,0),this[A]=255&_,this[A+1]=_>>>8,A+2},u.prototype.writeUInt16BE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,2,65535,0),this[A]=_>>>8,this[A+1]=255&_,A+2},u.prototype.writeUInt32LE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,4,4294967295,0),this[A+3]=_>>>24,this[A+2]=_>>>16,this[A+1]=_>>>8,this[A]=255&_,A+4},u.prototype.writeUInt32BE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,4,4294967295,0),this[A]=_>>>24,this[A+1]=_>>>16,this[A+2]=_>>>8,this[A+3]=255&_,A+4},u.prototype.writeIntLE=function(_,A,R,z){if(_=+_,A>>>=0,!z){var Y=i(2,8*R-1);J(this,_,A,R,Y-1,-Y)}var tt=0,ut=1,bt=0;for(this[A]=255&_;++tt<R&&(ut*=256);)0>_&&bt===0&&this[A+tt-1]!==0&&(bt=1),this[A+tt]=255&(_/ut>>0)-bt;return A+R},u.prototype.writeIntBE=function(_,A,R,z){if(_=+_,A>>>=0,!z){var Y=i(2,8*R-1);J(this,_,A,R,Y-1,-Y)}var tt=R-1,ut=1,bt=0;for(this[A+tt]=255&_;0<=--tt&&(ut*=256);)0>_&&bt===0&&this[A+tt+1]!==0&&(bt=1),this[A+tt]=255&(_/ut>>0)-bt;return A+R},u.prototype.writeInt8=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,1,127,-128),0>_&&(_=255+_+1),this[A]=255&_,A+1},u.prototype.writeInt16LE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,2,32767,-32768),this[A]=255&_,this[A+1]=_>>>8,A+2},u.prototype.writeInt16BE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,2,32767,-32768),this[A]=_>>>8,this[A+1]=255&_,A+2},u.prototype.writeInt32LE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,4,2147483647,-2147483648),this[A]=255&_,this[A+1]=_>>>8,this[A+2]=_>>>16,this[A+3]=_>>>24,A+4},u.prototype.writeInt32BE=function(_,A,R){return _=+_,A>>>=0,R||J(this,_,A,4,2147483647,-2147483648),0>_&&(_=4294967295+_+1),this[A]=_>>>24,this[A+1]=_>>>16,this[A+2]=_>>>8,this[A+3]=255&_,A+4},u.prototype.writeFloatLE=function(_,A,R){return j(this,_,A,!0,R)},u.prototype.writeFloatBE=function(_,A,R){return j(this,_,A,!1,R)},u.prototype.writeDoubleLE=function(_,A,R){return Z(this,_,A,!0,R)},u.prototype.writeDoubleBE=function(_,A,R){return Z(this,_,A,!1,R)},u.prototype.copy=function(_,A,R,z){if(!u.isBuffer(_))throw new TypeError("argument should be a Buffer");if(R||(R=0),z||z===0||(z=this.length),A>=_.length&&(A=_.length),A||(A=0),0<z&&z<R&&(z=R),z===R||_.length===0||this.length===0)return 0;if(0>A)throw new RangeError("targetStart out of bounds");if(0>R||R>=this.length)throw new RangeError("Index out of range");if(0>z)throw new RangeError("sourceEnd out of bounds");z>this.length&&(z=this.length),_.length-A<z-R&&(z=_.length-A+R);var Y=z-R;if(this===_&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(A,R,z);else if(this===_&&R<A&&A<z)for(var tt=Y-1;0<=tt;--tt)_[tt+A]=this[tt+R];else Uint8Array.prototype.set.call(_,this.subarray(R,z),A);return Y},u.prototype.fill=function(_,A,R,z){if(typeof _=="string"){if(typeof A=="string"?(z=A,A=0,R=this.length):typeof R=="string"&&(z=R,R=this.length),z!==void 0&&typeof z!="string")throw new TypeError("encoding must be a string");if(typeof z=="string"&&!u.isEncoding(z))throw new TypeError("Unknown encoding: "+z);if(_.length===1){var Y=_.charCodeAt(0);(z==="utf8"&&128>Y||z==="latin1")&&(_=Y)}}else typeof _=="number"&&(_&=255);if(0>A||this.length<A||this.length<R)throw new RangeError("Out of range index");if(R<=A)return this;A>>>=0,R=R===void 0?this.length:R>>>0,_||(_=0);var tt;if(typeof _=="number")for(tt=A;tt<R;++tt)this[tt]=_;else{var ut=u.isBuffer(_)?_:u.from(_,z),bt=ut.length;if(bt===0)throw new TypeError('The value "'+_+'" is invalid for argument "value"');for(tt=0;tt<R-A;++tt)this[tt+A]=ut[tt%bt]}return this};var P=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,o("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(o,s,c){(function(a){(function(){function y(){let u;try{u=c.storage.getItem("debug")}catch{}return!u&&typeof a<"u"&&"env"in a&&(u=a.env.DEBUG),u}c.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;u.splice(1,0,l,"color: inherit");let f=0,h=0;u[0].replace(/%[a-zA-Z%]/g,m=>{m==="%%"||(f++,m==="%c"&&(h=f))}),u.splice(h,0,l)},c.save=function(u){try{u?c.storage.setItem("debug",u):c.storage.removeItem("debug")}catch{}},c.load=y,c.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},c.storage=function(){try{return localStorage}catch{}}(),c.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),c.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],c.log=console.debug||console.log||(()=>{}),s.exports=o("./common")(c);const{formatters:g}=s.exports;g.j=function(u){try{return JSON.stringify(u)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}}).call(this)}).call(this,o("_process"))},{"./common":5,_process:12}],5:[function(o,s){s.exports=function(c){function a(u){function l(...m){if(!l.enabled)return;const k=l,b=+new Date,v=b-(f||b);k.diff=v,k.prev=f,k.curr=b,f=b,m[0]=a.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let d=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(w,E)=>{if(w==="%%")return"%";d++;const x=a.formatters[E];if(typeof x=="function"){const O=m[d];w=x.call(k,O),m.splice(d,1),d--}return w}),a.formatArgs.call(k,m),(k.log||a.log).apply(k,m)}let f,h=null;return l.namespace=u,l.useColors=a.useColors(),l.color=a.selectColor(u),l.extend=y,l.destroy=a.destroy,Object.defineProperty(l,"enabled",{enumerable:!0,configurable:!1,get:()=>h===null?a.enabled(u):h,set:m=>{h=m}}),typeof a.init=="function"&&a.init(l),l}function y(u,l){const f=a(this.namespace+(typeof l>"u"?":":l)+u);return f.log=this.log,f}function g(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(u){return u instanceof Error?u.stack||u.message:u},a.disable=function(){const u=[...a.names.map(g),...a.skips.map(g).map(l=>"-"+l)].join(",");return a.enable(""),u},a.enable=function(u){a.save(u),a.names=[],a.skips=[];let l;const f=(typeof u=="string"?u:"").split(/[\s,]+/),h=f.length;for(l=0;l<h;l++)f[l]&&(u=f[l].replace(/\*/g,".*?"),u[0]==="-"?a.skips.push(new RegExp("^"+u.substr(1)+"$")):a.names.push(new RegExp("^"+u+"$")))},a.enabled=function(u){if(u[u.length-1]==="*")return!0;let l,f;for(l=0,f=a.skips.length;l<f;l++)if(a.skips[l].test(u))return!1;for(l=0,f=a.names.length;l<f;l++)if(a.names[l].test(u))return!0;return!1},a.humanize=o("ms"),a.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(c).forEach(u=>{a[u]=c[u]}),a.names=[],a.skips=[],a.formatters={},a.selectColor=function(u){let l=0;for(let f=0;f<u.length;f++)l=(l<<5)-l+u.charCodeAt(f),l|=0;return a.colors[r(l)%a.colors.length]},a.enable(a.load()),a}},{ms:11}],6:[function(o,s){function c(a,y){for(const g in y)Object.defineProperty(a,g,{value:y[g],enumerable:!0,configurable:!0});return a}s.exports=function(a,y,g){if(!a||typeof a=="string")throw new TypeError("Please pass an Error to err-code");g||(g={}),typeof y=="object"&&(g=y,y=""),y&&(g.code=y);try{return c(a,g)}catch{g.message=a.message,g.stack=a.stack;const l=function(){};return l.prototype=Object.create(Object.getPrototypeOf(a)),c(new l,g)}}},{}],7:[function(o,s){function c(S){console&&console.warn&&console.warn(S)}function a(){a.init.call(this)}function y(S){if(typeof S!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof S)}function g(S){return S._maxListeners===void 0?a.defaultMaxListeners:S._maxListeners}function u(S,C,T,N){var D,M,F;if(y(T),M=S._events,M===void 0?(M=S._events=Object.create(null),S._eventsCount=0):(M.newListener!==void 0&&(S.emit("newListener",C,T.listener?T.listener:T),M=S._events),F=M[C]),F===void 0)F=M[C]=T,++S._eventsCount;else if(typeof F=="function"?F=M[C]=N?[T,F]:[F,T]:N?F.unshift(T):F.push(T),D=g(S),0<D&&F.length>D&&!F.warned){F.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+(C+" listeners added. Use emitter.setMaxListeners() to increase limit"));G.name="MaxListenersExceededWarning",G.emitter=S,G.type=C,G.count=F.length,c(G)}return S}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(S,C,T){var N={fired:!1,wrapFn:void 0,target:S,type:C,listener:T},D=l.bind(N);return D.listener=T,N.wrapFn=D,D}function h(S,C,T){var N=S._events;if(N===void 0)return[];var D=N[C];return D===void 0?[]:typeof D=="function"?T?[D.listener||D]:[D]:T?v(D):k(D,D.length)}function m(S){var C=this._events;if(C!==void 0){var T=C[S];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}function k(S,C){for(var T=Array(C),N=0;N<C;++N)T[N]=S[N];return T}function b(S,C){for(;C+1<S.length;C++)S[C]=S[C+1];S.pop()}function v(S){for(var C=Array(S.length),T=0;T<C.length;++T)C[T]=S[T].listener||S[T];return C}function d(S,C,T){typeof S.on=="function"&&p(S,"error",C,T)}function p(S,C,T,N){if(typeof S.on=="function")N.once?S.once(C,T):S.on(C,T);else if(typeof S.addEventListener=="function")S.addEventListener(C,function D(M){N.once&&S.removeEventListener(C,D),T(M)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof S)}var w,E=typeof Reflect=="object"?Reflect:null,x=E&&typeof E.apply=="function"?E.apply:function(S,C,T){return Function.prototype.apply.call(S,C,T)};w=E&&typeof E.ownKeys=="function"?E.ownKeys:Object.getOwnPropertySymbols?function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:function(S){return Object.getOwnPropertyNames(S)};var O=Number.isNaN||function(S){return S!==S};s.exports=a,s.exports.once=function(S,C){return new Promise(function(T,N){function D(F){S.removeListener(C,M),N(F)}function M(){typeof S.removeListener=="function"&&S.removeListener("error",D),T([].slice.call(arguments))}p(S,C,M,{once:!0}),C!=="error"&&d(S,D,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var L=10;Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return L},set:function(S){if(typeof S!="number"||0>S||O(S))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+S+".");L=S}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(S){if(typeof S!="number"||0>S||O(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this},a.prototype.getMaxListeners=function(){return g(this)},a.prototype.emit=function(S){for(var C=[],T=1;T<arguments.length;T++)C.push(arguments[T]);var N=S==="error",D=this._events;if(D!==void 0)N=N&&D.error===void 0;else if(!N)return!1;if(N){var M;if(0<C.length&&(M=C[0]),M instanceof Error)throw M;var F=new Error("Unhandled error."+(M?" ("+M.message+")":""));throw F.context=M,F}var G=D[S];if(G===void 0)return!1;if(typeof G=="function")x(G,this,C);else for(var nt=G.length,K=k(G,nt),T=0;T<nt;++T)x(K[T],this,C);return!0},a.prototype.addListener=function(S,C){return u(this,S,C,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(S,C){return u(this,S,C,!0)},a.prototype.once=function(S,C){return y(C),this.on(S,f(this,S,C)),this},a.prototype.prependOnceListener=function(S,C){return y(C),this.prependListener(S,f(this,S,C)),this},a.prototype.removeListener=function(S,C){var T,N,D,M,F;if(y(C),N=this._events,N===void 0)return this;if(T=N[S],T===void 0)return this;if(T===C||T.listener===C)--this._eventsCount==0?this._events=Object.create(null):(delete N[S],N.removeListener&&this.emit("removeListener",S,T.listener||C));else if(typeof T!="function"){for(D=-1,M=T.length-1;0<=M;M--)if(T[M]===C||T[M].listener===C){F=T[M].listener,D=M;break}if(0>D)return this;D===0?T.shift():b(T,D),T.length===1&&(N[S]=T[0]),N.removeListener!==void 0&&this.emit("removeListener",S,F||C)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(S){var C,T,N;if(T=this._events,T===void 0)return this;if(T.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):T[S]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete T[S]),this;if(arguments.length===0){var D,M=Object.keys(T);for(N=0;N<M.length;++N)D=M[N],D!=="removeListener"&&this.removeAllListeners(D);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(C=T[S],typeof C=="function")this.removeListener(S,C);else if(C!==void 0)for(N=C.length-1;0<=N;N--)this.removeListener(S,C[N]);return this},a.prototype.listeners=function(S){return h(this,S,!0)},a.prototype.rawListeners=function(S){return h(this,S,!1)},a.listenerCount=function(S,C){return typeof S.listenerCount=="function"?S.listenerCount(C):m.call(S,C)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return 0<this._eventsCount?w(this._events):[]}},{}],8:[function(o,s){s.exports=function(){if(typeof globalThis>"u")return null;var c={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return c.RTCPeerConnection?c:null}},{}],9:[function(o,s,c){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */c.read=function(a,y,g,u,l){var f,h,m=8*l-u-1,k=(1<<m)-1,b=k>>1,v=-7,d=g?l-1:0,p=g?-1:1,w=a[y+d];for(d+=p,f=w&(1<<-v)-1,w>>=-v,v+=m;0<v;f=256*f+a[y+d],d+=p,v-=8);for(h=f&(1<<-v)-1,f>>=-v,v+=u;0<v;h=256*h+a[y+d],d+=p,v-=8);if(f===0)f=1-b;else{if(f===k)return h?NaN:(w?-1:1)*(1/0);h+=i(2,u),f-=b}return(w?-1:1)*h*i(2,f-u)},c.write=function(a,y,g,u,l,f){var h,m,k,b=Math.LN2,v=Math.log,d=8*f-l-1,p=(1<<d)-1,w=p>>1,E=l===23?i(2,-24)-i(2,-77):0,x=u?0:f-1,O=u?1:-1,L=0>y||y===0&&0>1/y?1:0;for(y=r(y),isNaN(y)||y===1/0?(m=isNaN(y)?1:0,h=p):(h=e(v(y)/b),1>y*(k=i(2,-h))&&(h--,k*=2),y+=1<=h+w?E/k:E*i(2,1-w),2<=y*k&&(h++,k/=2),h+w>=p?(m=0,h=p):1<=h+w?(m=(y*k-1)*i(2,l),h+=w):(m=y*i(2,w-1)*i(2,l),h=0));8<=l;a[g+x]=255&m,x+=O,m/=256,l-=8);for(h=h<<l|m,d+=l;0<d;a[g+x]=255&h,x+=O,h/=256,d-=8);a[g+x-O]|=128*L}},{}],10:[function(o,s){s.exports=typeof Object.create=="function"?function(c,a){a&&(c.super_=a,c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}))}:function(c,a){if(a){c.super_=a;var y=function(){};y.prototype=a.prototype,c.prototype=new y,c.prototype.constructor=c}}},{}],11:[function(o,s){var c=Math.round;function a(l){if(l+="",!(100<l.length)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(f){var h=parseFloat(f[1]),m=(f[2]||"ms").toLowerCase();return m==="years"||m==="year"||m==="yrs"||m==="yr"||m==="y"?315576e5*h:m==="weeks"||m==="week"||m==="w"?6048e5*h:m==="days"||m==="day"||m==="d"?864e5*h:m==="hours"||m==="hour"||m==="hrs"||m==="hr"||m==="h"?36e5*h:m==="minutes"||m==="minute"||m==="mins"||m==="min"||m==="m"?6e4*h:m==="seconds"||m==="second"||m==="secs"||m==="sec"||m==="s"?1e3*h:m==="milliseconds"||m==="millisecond"||m==="msecs"||m==="msec"||m==="ms"?h:void 0}}}function y(l){var f=r(l);return 864e5<=f?c(l/864e5)+"d":36e5<=f?c(l/36e5)+"h":6e4<=f?c(l/6e4)+"m":1e3<=f?c(l/1e3)+"s":l+"ms"}function g(l){var f=r(l);return 864e5<=f?u(l,f,864e5,"day"):36e5<=f?u(l,f,36e5,"hour"):6e4<=f?u(l,f,6e4,"minute"):1e3<=f?u(l,f,1e3,"second"):l+" ms"}function u(l,f,h,m){return c(l/h)+" "+m+(f>=1.5*h?"s":"")}s.exports=function(l,f){f=f||{};var h=typeof l;if(h=="string"&&0<l.length)return a(l);if(h==="number"&&isFinite(l))return f.long?g(l):y(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))}},{}],12:[function(o,s){function c(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function y(E){if(m===setTimeout)return setTimeout(E,0);if((m===c||!m)&&setTimeout)return m=setTimeout,setTimeout(E,0);try{return m(E,0)}catch{try{return m.call(null,E,0)}catch{return m.call(this,E,0)}}}function g(E){if(k===clearTimeout)return clearTimeout(E);if((k===a||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(E);try{return k(E)}catch{try{return k.call(null,E)}catch{return k.call(this,E)}}}function u(){p&&v&&(p=!1,v.length?d=v.concat(d):w=-1,d.length&&l())}function l(){if(!p){var E=y(u);p=!0;for(var x=d.length;x;){for(v=d,d=[];++w<x;)v&&v[w].run();w=-1,x=d.length}v=null,p=!1,g(E)}}function f(E,x){this.fun=E,this.array=x}function h(){}var m,k,b=s.exports={};(function(){try{m=typeof setTimeout=="function"?setTimeout:c}catch{m=c}try{k=typeof clearTimeout=="function"?clearTimeout:a}catch{k=a}})();var v,d=[],p=!1,w=-1;b.nextTick=function(E){var x=Array(arguments.length-1);if(1<arguments.length)for(var O=1;O<arguments.length;O++)x[O-1]=arguments[O];d.push(new f(E,x)),d.length!==1||p||y(l)},f.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=h,b.addListener=h,b.once=h,b.off=h,b.removeListener=h,b.removeAllListeners=h,b.emit=h,b.prependListener=h,b.prependOnceListener=h,b.listeners=function(){return[]},b.binding=function(){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],13:[function(o,s){(function(c){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let a;s.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?c:window):y=>(a||(a=Promise.resolve())).then(y).catch(g=>setTimeout(()=>{throw g},0))}).call(this)}).call(this,typeof Qe>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Qe)},{}],14:[function(o,s){(function(c,a){(function(){var y=o("safe-buffer").Buffer,g=a.crypto||a.msCrypto;s.exports=g&&g.getRandomValues?function(u,l){if(u>4294967295)throw new RangeError("requested too many random bytes");var f=y.allocUnsafe(u);if(0<u)if(65536<u)for(var h=0;h<u;h+=65536)g.getRandomValues(f.slice(h,h+65536));else g.getRandomValues(f);return typeof l=="function"?c.nextTick(function(){l(null,f)}):f}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,o("_process"),typeof Qe>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Qe)},{_process:12,"safe-buffer":30}],15:[function(o,s){function c(h,m){h.prototype=Object.create(m.prototype),h.prototype.constructor=h,h.__proto__=m}function a(h,m,k){function b(d,p,w){return typeof m=="string"?m:m(d,p,w)}k||(k=Error);var v=function(d){function p(w,E,x){return d.call(this,b(w,E,x))||this}return c(p,d),p}(k);v.prototype.name=k.name,v.prototype.code=h,f[h]=v}function y(h,m){if(Array.isArray(h)){var k=h.length;return h=h.map(function(b){return b+""}),2<k?"one of ".concat(m," ").concat(h.slice(0,k-1).join(", "),", or ")+h[k-1]:k===2?"one of ".concat(m," ").concat(h[0]," or ").concat(h[1]):"of ".concat(m," ").concat(h[0])}return"of ".concat(m," ").concat(h+"")}function g(h,m,k){return h.substr(!k||0>k?0:+k,m.length)===m}function u(h,m,k){return(k===void 0||k>h.length)&&(k=h.length),h.substring(k-m.length,k)===m}function l(h,m,k){return typeof k!="number"&&(k=0),!(k+m.length>h.length)&&h.indexOf(m,k)!==-1}var f={};a("ERR_INVALID_OPT_VALUE",function(h,m){return'The value "'+m+'" is invalid for option "'+h+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(h,m,k){var b;typeof m=="string"&&g(m,"not ")?(b="must not be",m=m.replace(/^not /,"")):b="must be";var v;if(u(h," argument"))v="The ".concat(h," ").concat(b," ").concat(y(m,"type"));else{var d=l(h,".")?"property":"argument";v='The "'.concat(h,'" ').concat(d," ").concat(b," ").concat(y(m,"type"))}return v+=". Received type ".concat(typeof k),v},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(h){return"The "+h+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(h){return"Cannot call "+h+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(h){return"Unknown encoding: "+h},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),s.exports.codes=f},{}],16:[function(o,s){(function(c){(function(){function a(b){return this instanceof a?(l.call(this,b),f.call(this,b),this.allowHalfOpen=!0,void(b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",y))))):new a(b)}function y(){this._writableState.ended||c.nextTick(g,this)}function g(b){b.end()}var u=Object.keys||function(b){var v=[];for(var d in b)v.push(d);return v};s.exports=a;var l=o("./_stream_readable"),f=o("./_stream_writable");o("inherits")(a,l);for(var h,m=u(f.prototype),k=0;k<m.length;k++)h=m[k],a.prototype[h]||(a.prototype[h]=f.prototype[h]);Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=b,this._writableState.destroyed=b)}})}).call(this)}).call(this,o("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(o,s){function c(y){return this instanceof c?void a.call(this,y):new c(y)}s.exports=c;var a=o("./_stream_transform");o("inherits")(c,a),c.prototype._transform=function(y,g,u){u(null,y)}},{"./_stream_transform":19,inherits:10}],18:[function(o,s){(function(c,a){(function(){function y(P){return H.from(P)}function g(P){return H.isBuffer(P)||P instanceof $}function u(P,_,A){return typeof P.prependListener=="function"?P.prependListener(_,A):void(P._events&&P._events[_]?Array.isArray(P._events[_])?P._events[_].unshift(A):P._events[_]=[A,P._events[_]]:P.on(_,A))}function l(P,_,A){nt=nt||o("./_stream_duplex"),P=P||{},typeof A!="boolean"&&(A=_ instanceof nt),this.objectMode=!!P.objectMode,A&&(this.objectMode=this.objectMode||!!P.readableObjectMode),this.highWaterMark=ct(this,P,"readableHighWaterMark",A),this.buffer=new et,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=P.emitClose!==!1,this.autoDestroy=!!P.autoDestroy,this.destroyed=!1,this.defaultEncoding=P.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,P.encoding&&(!X&&(X=o("string_decoder/").StringDecoder),this.decoder=new X(P.encoding),this.encoding=P.encoding)}function f(P){if(nt=nt||o("./_stream_duplex"),!(this instanceof f))return new f(P);var _=this instanceof nt;this._readableState=new l(P,this,_),this.readable=!0,P&&(typeof P.read=="function"&&(this._read=P.read),typeof P.destroy=="function"&&(this._destroy=P.destroy)),B.call(this)}function h(P,_,A,R,z){K("readableAddChunk",_);var Y=P._readableState;if(_===null)Y.reading=!1,d(P,Y);else{var tt;if(z||(tt=k(Y,_)),tt)W(P,tt);else if(!(Y.objectMode||_&&0<_.length))R||(Y.reading=!1,E(P,Y));else if(typeof _=="string"||Y.objectMode||Object.getPrototypeOf(_)===H.prototype||(_=y(_)),R)Y.endEmitted?W(P,new U):m(P,Y,_,!0);else if(Y.ended)W(P,new gt);else{if(Y.destroyed)return!1;Y.reading=!1,Y.decoder&&!A?(_=Y.decoder.write(_),Y.objectMode||_.length!==0?m(P,Y,_,!1):E(P,Y)):m(P,Y,_,!1)}}return!Y.ended&&(Y.length<Y.highWaterMark||Y.length===0)}function m(P,_,A,R){_.flowing&&_.length===0&&!_.sync?(_.awaitDrain=0,P.emit("data",A)):(_.length+=_.objectMode?1:A.length,R?_.buffer.unshift(A):_.buffer.push(A),_.needReadable&&p(P)),E(P,_)}function k(P,_){var A;return g(_)||typeof _=="string"||_===void 0||P.objectMode||(A=new pt("chunk",["string","Buffer","Uint8Array"],_)),A}function b(P){return 1073741824<=P?P=1073741824:(P--,P|=P>>>1,P|=P>>>2,P|=P>>>4,P|=P>>>8,P|=P>>>16,P++),P}function v(P,_){return 0>=P||_.length===0&&_.ended?0:_.objectMode?1:P===P?(P>_.highWaterMark&&(_.highWaterMark=b(P)),P<=_.length?P:_.ended?_.length:(_.needReadable=!0,0)):_.flowing&&_.length?_.buffer.head.data.length:_.length}function d(P,_){if(K("onEofChunk"),!_.ended){if(_.decoder){var A=_.decoder.end();A&&A.length&&(_.buffer.push(A),_.length+=_.objectMode?1:A.length)}_.ended=!0,_.sync?p(P):(_.needReadable=!1,!_.emittedReadable&&(_.emittedReadable=!0,w(P)))}}function p(P){var _=P._readableState;K("emitReadable",_.needReadable,_.emittedReadable),_.needReadable=!1,_.emittedReadable||(K("emitReadable",_.flowing),_.emittedReadable=!0,c.nextTick(w,P))}function w(P){var _=P._readableState;K("emitReadable_",_.destroyed,_.length,_.ended),!_.destroyed&&(_.length||_.ended)&&(P.emit("readable"),_.emittedReadable=!1),_.needReadable=!_.flowing&&!_.ended&&_.length<=_.highWaterMark,N(P)}function E(P,_){_.readingMore||(_.readingMore=!0,c.nextTick(x,P,_))}function x(P,_){for(;!_.reading&&!_.ended&&(_.length<_.highWaterMark||_.flowing&&_.length===0);){var A=_.length;if(K("maybeReadMore read 0"),P.read(0),A===_.length)break}_.readingMore=!1}function O(P){return function(){var _=P._readableState;K("pipeOnDrain",_.awaitDrain),_.awaitDrain&&_.awaitDrain--,_.awaitDrain===0&&V(P,"data")&&(_.flowing=!0,N(P))}}function L(P){var _=P._readableState;_.readableListening=0<P.listenerCount("readable"),_.resumeScheduled&&!_.paused?_.flowing=!0:0<P.listenerCount("data")&&P.resume()}function S(P){K("readable nexttick read 0"),P.read(0)}function C(P,_){_.resumeScheduled||(_.resumeScheduled=!0,c.nextTick(T,P,_))}function T(P,_){K("resume",_.reading),_.reading||P.read(0),_.resumeScheduled=!1,P.emit("resume"),N(P),_.flowing&&!_.reading&&P.read(0)}function N(P){var _=P._readableState;for(K("flow",_.flowing);_.flowing&&P.read()!==null;);}function D(P,_){if(_.length===0)return null;var A;return _.objectMode?A=_.buffer.shift():!P||P>=_.length?(A=_.decoder?_.buffer.join(""):_.buffer.length===1?_.buffer.first():_.buffer.concat(_.length),_.buffer.clear()):A=_.buffer.consume(P,_.decoder),A}function M(P){var _=P._readableState;K("endReadable",_.endEmitted),_.endEmitted||(_.ended=!0,c.nextTick(F,_,P))}function F(P,_){if(K("endReadableNT",P.endEmitted,P.length),!P.endEmitted&&P.length===0&&(P.endEmitted=!0,_.readable=!1,_.emit("end"),P.autoDestroy)){var A=_._writableState;(!A||A.autoDestroy&&A.finished)&&_.destroy()}}function G(P,_){for(var A=0,R=P.length;A<R;A++)if(P[A]===_)return A;return-1}s.exports=f;var nt;f.ReadableState=l;var K;o("events").EventEmitter;var V=function(P,_){return P.listeners(_).length},B=o("./internal/streams/stream"),H=o("buffer").Buffer,$=a.Uint8Array||function(){},J=o("util");K=J&&J.debuglog?J.debuglog("stream"):function(){};var X,j,Z,et=o("./internal/streams/buffer_list"),rt=o("./internal/streams/destroy"),st=o("./internal/streams/state"),ct=st.getHighWaterMark,vt=o("../errors").codes,pt=vt.ERR_INVALID_ARG_TYPE,gt=vt.ERR_STREAM_PUSH_AFTER_EOF,I=vt.ERR_METHOD_NOT_IMPLEMENTED,U=vt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("inherits")(f,B);var W=rt.errorOrDestroy,q=["error","close","destroy","pause","resume"];Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(P){this._readableState&&(this._readableState.destroyed=P)}}),f.prototype.destroy=rt.destroy,f.prototype._undestroy=rt.undestroy,f.prototype._destroy=function(P,_){_(P)},f.prototype.push=function(P,_){var A,R=this._readableState;return R.objectMode?A=!0:typeof P=="string"&&(_=_||R.defaultEncoding,_!==R.encoding&&(P=H.from(P,_),_=""),A=!0),h(this,P,_,!1,A)},f.prototype.unshift=function(P){return h(this,P,null,!0,!1)},f.prototype.isPaused=function(){return this._readableState.flowing===!1},f.prototype.setEncoding=function(P){X||(X=o("string_decoder/").StringDecoder);var _=new X(P);this._readableState.decoder=_,this._readableState.encoding=this._readableState.decoder.encoding;for(var A=this._readableState.buffer.head,R="";A!==null;)R+=_.write(A.data),A=A.next;return this._readableState.buffer.clear(),R!==""&&this._readableState.buffer.push(R),this._readableState.length=R.length,this},f.prototype.read=function(P){K("read",P),P=parseInt(P,10);var _=this._readableState,A=P;if(P!==0&&(_.emittedReadable=!1),P===0&&_.needReadable&&((_.highWaterMark===0?0<_.length:_.length>=_.highWaterMark)||_.ended))return K("read: emitReadable",_.length,_.ended),_.length===0&&_.ended?M(this):p(this),null;if(P=v(P,_),P===0&&_.ended)return _.length===0&&M(this),null;var R=_.needReadable;K("need readable",R),(_.length===0||_.length-P<_.highWaterMark)&&(R=!0,K("length less than watermark",R)),_.ended||_.reading?(R=!1,K("reading or ended",R)):R&&(K("do read"),_.reading=!0,_.sync=!0,_.length===0&&(_.needReadable=!0),this._read(_.highWaterMark),_.sync=!1,!_.reading&&(P=v(A,_)));var z;return z=0<P?D(P,_):null,z===null?(_.needReadable=_.length<=_.highWaterMark,P=0):(_.length-=P,_.awaitDrain=0),_.length===0&&(!_.ended&&(_.needReadable=!0),A!==P&&_.ended&&M(this)),z!==null&&this.emit("data",z),z},f.prototype._read=function(){W(this,new I("_read()"))},f.prototype.pipe=function(P,_){function A(de,fe){K("onunpipe"),de===yt&&fe&&fe.hasUnpiped===!1&&(fe.hasUnpiped=!0,z())}function R(){K("onend"),P.end()}function z(){K("cleanup"),P.removeListener("close",ut),P.removeListener("finish",bt),P.removeListener("drain",xe),P.removeListener("error",tt),P.removeListener("unpipe",A),yt.removeListener("end",R),yt.removeListener("end",mt),yt.removeListener("data",Y),re=!0,ot.awaitDrain&&(!P._writableState||P._writableState.needDrain)&&xe()}function Y(de){K("ondata");var fe=P.write(de);K("dest.write",fe),fe===!1&&((ot.pipesCount===1&&ot.pipes===P||1<ot.pipesCount&&G(ot.pipes,P)!==-1)&&!re&&(K("false write response, pause",ot.awaitDrain),ot.awaitDrain++),yt.pause())}function tt(de){K("onerror",de),mt(),P.removeListener("error",tt),V(P,"error")===0&&W(P,de)}function ut(){P.removeListener("finish",bt),mt()}function bt(){K("onfinish"),P.removeListener("close",ut),mt()}function mt(){K("unpipe"),yt.unpipe(P)}var yt=this,ot=this._readableState;switch(ot.pipesCount){case 0:ot.pipes=P;break;case 1:ot.pipes=[ot.pipes,P];break;default:ot.pipes.push(P)}ot.pipesCount+=1,K("pipe count=%d opts=%j",ot.pipesCount,_);var Et=(!_||_.end!==!1)&&P!==c.stdout&&P!==c.stderr,te=Et?R:mt;ot.endEmitted?c.nextTick(te):yt.once("end",te),P.on("unpipe",A);var xe=O(yt);P.on("drain",xe);var re=!1;return yt.on("data",Y),u(P,"error",tt),P.once("close",ut),P.once("finish",bt),P.emit("pipe",yt),ot.flowing||(K("pipe resume"),yt.resume()),P},f.prototype.unpipe=function(P){var _=this._readableState,A={hasUnpiped:!1};if(_.pipesCount===0)return this;if(_.pipesCount===1)return P&&P!==_.pipes?this:(P||(P=_.pipes),_.pipes=null,_.pipesCount=0,_.flowing=!1,P&&P.emit("unpipe",this,A),this);if(!P){var R=_.pipes,z=_.pipesCount;_.pipes=null,_.pipesCount=0,_.flowing=!1;for(var Y=0;Y<z;Y++)R[Y].emit("unpipe",this,{hasUnpiped:!1});return this}var tt=G(_.pipes,P);return tt===-1?this:(_.pipes.splice(tt,1),_.pipesCount-=1,_.pipesCount===1&&(_.pipes=_.pipes[0]),P.emit("unpipe",this,A),this)},f.prototype.on=function(P,_){var A=B.prototype.on.call(this,P,_),R=this._readableState;return P==="data"?(R.readableListening=0<this.listenerCount("readable"),R.flowing!==!1&&this.resume()):P=="readable"&&!R.endEmitted&&!R.readableListening&&(R.readableListening=R.needReadable=!0,R.flowing=!1,R.emittedReadable=!1,K("on readable",R.length,R.reading),R.length?p(this):!R.reading&&c.nextTick(S,this)),A},f.prototype.addListener=f.prototype.on,f.prototype.removeListener=function(P,_){var A=B.prototype.removeListener.call(this,P,_);return P==="readable"&&c.nextTick(L,this),A},f.prototype.removeAllListeners=function(P){var _=B.prototype.removeAllListeners.apply(this,arguments);return(P==="readable"||P===void 0)&&c.nextTick(L,this),_},f.prototype.resume=function(){var P=this._readableState;return P.flowing||(K("resume"),P.flowing=!P.readableListening,C(this,P)),P.paused=!1,this},f.prototype.pause=function(){return K("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(K("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},f.prototype.wrap=function(P){var _=this,A=this._readableState,R=!1;for(var z in P.on("end",function(){if(K("wrapped end"),A.decoder&&!A.ended){var tt=A.decoder.end();tt&&tt.length&&_.push(tt)}_.push(null)}),P.on("data",function(tt){if(K("wrapped data"),A.decoder&&(tt=A.decoder.write(tt)),!(A.objectMode&&tt==null)&&(A.objectMode||tt&&tt.length)){var ut=_.push(tt);ut||(R=!0,P.pause())}}),P)this[z]===void 0&&typeof P[z]=="function"&&(this[z]=function(tt){return function(){return P[tt].apply(P,arguments)}}(z));for(var Y=0;Y<q.length;Y++)P.on(q[Y],this.emit.bind(this,q[Y]));return this._read=function(tt){K("wrapped _read",tt),R&&(R=!1,P.resume())},this},typeof Symbol=="function"&&(f.prototype[Symbol.asyncIterator]=function(){return j===void 0&&(j=o("./internal/streams/async_iterator")),j(this)}),Object.defineProperty(f.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(f.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(f.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(P){this._readableState&&(this._readableState.flowing=P)}}),f._fromList=D,Object.defineProperty(f.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(f.from=function(P,_){return Z===void 0&&(Z=o("./internal/streams/from")),Z(f,P,_)})}).call(this)}).call(this,o("_process"),typeof Qe>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Qe)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(o,s){function c(b,v){var d=this._transformState;d.transforming=!1;var p=d.writecb;if(p===null)return this.emit("error",new f);d.writechunk=null,d.writecb=null,v!=null&&this.push(v),p(b);var w=this._readableState;w.reading=!1,(w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}function a(b){return this instanceof a?(k.call(this,b),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),void this.on("prefinish",y)):new a(b)}function y(){var b=this;typeof this._flush!="function"||this._readableState.destroyed?g(this,null,null):this._flush(function(v,d){g(b,v,d)})}function g(b,v,d){if(v)return b.emit("error",v);if(d!=null&&b.push(d),b._writableState.length)throw new m;if(b._transformState.transforming)throw new h;return b.push(null)}s.exports=a;var u=o("../errors").codes,l=u.ERR_METHOD_NOT_IMPLEMENTED,f=u.ERR_MULTIPLE_CALLBACK,h=u.ERR_TRANSFORM_ALREADY_TRANSFORMING,m=u.ERR_TRANSFORM_WITH_LENGTH_0,k=o("./_stream_duplex");o("inherits")(a,k),a.prototype.push=function(b,v){return this._transformState.needTransform=!1,k.prototype.push.call(this,b,v)},a.prototype._transform=function(b,v,d){d(new l("_transform()"))},a.prototype._write=function(b,v,d){var p=this._transformState;if(p.writecb=d,p.writechunk=b,p.writeencoding=v,!p.transforming){var w=this._readableState;(p.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},a.prototype._read=function(){var b=this._transformState;b.writechunk===null||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))},a.prototype._destroy=function(b,v){k.prototype._destroy.call(this,b,function(d){v(d)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(o,s){(function(c,a){(function(){function y(I){var U=this;this.next=null,this.entry=null,this.finish=function(){M(U,I)}}function g(I){return K.from(I)}function u(I){return K.isBuffer(I)||I instanceof V}function l(){}function f(I,U,W){F=F||o("./_stream_duplex"),I=I||{},typeof W!="boolean"&&(W=U instanceof F),this.objectMode=!!I.objectMode,W&&(this.objectMode=this.objectMode||!!I.writableObjectMode),this.highWaterMark=$(this,I,"writableHighWaterMark",W),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var q=I.decodeStrings===!1;this.decodeStrings=!q,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(P){E(U,P)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new y(this)}function h(I){F=F||o("./_stream_duplex");var U=this instanceof F;return U||gt.call(h,this)?(this._writableState=new f(I,this,U),this.writable=!0,I&&(typeof I.write=="function"&&(this._write=I.write),typeof I.writev=="function"&&(this._writev=I.writev),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.final=="function"&&(this._final=I.final)),void nt.call(this)):new h(I)}function m(I,U){var W=new ct;pt(I,W),c.nextTick(U,W)}function k(I,U,W,q){var P;return W===null?P=new st:typeof W!="string"&&!U.objectMode&&(P=new X("chunk",["string","Buffer"],W)),!P||(pt(I,P),c.nextTick(q,P),!1)}function b(I,U,W){return I.objectMode||I.decodeStrings===!1||typeof U!="string"||(U=K.from(U,W)),U}function v(I,U,W,q,P,_){if(!W){var A=b(U,q,P);q!==A&&(W=!0,P="buffer",q=A)}var R=U.objectMode?1:q.length;U.length+=R;var z=U.length<U.highWaterMark;if(z||(U.needDrain=!0),U.writing||U.corked){var Y=U.lastBufferedRequest;U.lastBufferedRequest={chunk:q,encoding:P,isBuf:W,callback:_,next:null},Y?Y.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else d(I,U,!1,R,q,P,_);return z}function d(I,U,W,q,P,_,A){U.writelen=q,U.writecb=A,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new rt("write")):W?I._writev(P,U.onwrite):I._write(P,_,U.onwrite),U.sync=!1}function p(I,U,W,q,P){--U.pendingcb,W?(c.nextTick(P,q),c.nextTick(N,I,U),I._writableState.errorEmitted=!0,pt(I,q)):(P(q),I._writableState.errorEmitted=!0,pt(I,q),N(I,U))}function w(I){I.writing=!1,I.writecb=null,I.length-=I.writelen,I.writelen=0}function E(I,U){var W=I._writableState,q=W.sync,P=W.writecb;if(typeof P!="function")throw new Z;if(w(W),U)p(I,W,q,U,P);else{var _=S(W)||I.destroyed;_||W.corked||W.bufferProcessing||!W.bufferedRequest||L(I,W),q?c.nextTick(x,I,W,_,P):x(I,W,_,P)}}function x(I,U,W,q){W||O(I,U),U.pendingcb--,q(),N(I,U)}function O(I,U){U.length===0&&U.needDrain&&(U.needDrain=!1,I.emit("drain"))}function L(I,U){U.bufferProcessing=!0;var W=U.bufferedRequest;if(I._writev&&W&&W.next){var q=U.bufferedRequestCount,P=Array(q),_=U.corkedRequestsFree;_.entry=W;for(var A=0,R=!0;W;)P[A]=W,W.isBuf||(R=!1),W=W.next,A+=1;P.allBuffers=R,d(I,U,!0,U.length,P,"",_.finish),U.pendingcb++,U.lastBufferedRequest=null,_.next?(U.corkedRequestsFree=_.next,_.next=null):U.corkedRequestsFree=new y(U),U.bufferedRequestCount=0}else{for(;W;){var z=W.chunk,Y=W.encoding,tt=W.callback,ut=U.objectMode?1:z.length;if(d(I,U,!1,ut,z,Y,tt),W=W.next,U.bufferedRequestCount--,U.writing)break}W===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=W,U.bufferProcessing=!1}function S(I){return I.ending&&I.length===0&&I.bufferedRequest===null&&!I.finished&&!I.writing}function C(I,U){I._final(function(W){U.pendingcb--,W&&pt(I,W),U.prefinished=!0,I.emit("prefinish"),N(I,U)})}function T(I,U){U.prefinished||U.finalCalled||(typeof I._final!="function"||U.destroyed?(U.prefinished=!0,I.emit("prefinish")):(U.pendingcb++,U.finalCalled=!0,c.nextTick(C,I,U)))}function N(I,U){var W=S(U);if(W&&(T(I,U),U.pendingcb===0&&(U.finished=!0,I.emit("finish"),U.autoDestroy))){var q=I._readableState;(!q||q.autoDestroy&&q.endEmitted)&&I.destroy()}return W}function D(I,U,W){U.ending=!0,N(I,U),W&&(U.finished?c.nextTick(W):I.once("finish",W)),U.ended=!0,I.writable=!1}function M(I,U,W){var q=I.entry;for(I.entry=null;q;){var P=q.callback;U.pendingcb--,P(W),q=q.next}U.corkedRequestsFree.next=I}s.exports=h;var F;h.WritableState=f;var G={deprecate:o("util-deprecate")},nt=o("./internal/streams/stream"),K=o("buffer").Buffer,V=a.Uint8Array||function(){},B=o("./internal/streams/destroy"),H=o("./internal/streams/state"),$=H.getHighWaterMark,J=o("../errors").codes,X=J.ERR_INVALID_ARG_TYPE,j=J.ERR_METHOD_NOT_IMPLEMENTED,Z=J.ERR_MULTIPLE_CALLBACK,et=J.ERR_STREAM_CANNOT_PIPE,rt=J.ERR_STREAM_DESTROYED,st=J.ERR_STREAM_NULL_VALUES,ct=J.ERR_STREAM_WRITE_AFTER_END,vt=J.ERR_UNKNOWN_ENCODING,pt=B.errorOrDestroy;o("inherits")(h,nt),f.prototype.getBuffer=function(){for(var I=this.bufferedRequest,U=[];I;)U.push(I),I=I.next;return U},function(){try{Object.defineProperty(f.prototype,"buffer",{get:G.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var gt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(gt=Function.prototype[Symbol.hasInstance],Object.defineProperty(h,Symbol.hasInstance,{value:function(I){return!!gt.call(this,I)||this===h&&I&&I._writableState instanceof f}})):gt=function(I){return I instanceof this},h.prototype.pipe=function(){pt(this,new et)},h.prototype.write=function(I,U,W){var q=this._writableState,P=!1,_=!q.objectMode&&u(I);return _&&!K.isBuffer(I)&&(I=g(I)),typeof U=="function"&&(W=U,U=null),_?U="buffer":!U&&(U=q.defaultEncoding),typeof W!="function"&&(W=l),q.ending?m(this,W):(_||k(this,q,I,W))&&(q.pendingcb++,P=v(this,q,_,I,U,W)),P},h.prototype.cork=function(){this._writableState.corked++},h.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,!I.writing&&!I.corked&&!I.bufferProcessing&&I.bufferedRequest&&L(this,I))},h.prototype.setDefaultEncoding=function(I){if(typeof I=="string"&&(I=I.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((I+"").toLowerCase())))throw new vt(I);return this._writableState.defaultEncoding=I,this},Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),h.prototype._write=function(I,U,W){W(new j("_write()"))},h.prototype._writev=null,h.prototype.end=function(I,U,W){var q=this._writableState;return typeof I=="function"?(W=I,I=null,U=null):typeof U=="function"&&(W=U,U=null),I!=null&&this.write(I,U),q.corked&&(q.corked=1,this.uncork()),q.ending||D(this,q,W),this},Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(I){this._writableState&&(this._writableState.destroyed=I)}}),h.prototype.destroy=B.destroy,h.prototype._undestroy=B.undestroy,h.prototype._destroy=function(I,U){U(I)}}).call(this)}).call(this,o("_process"),typeof Qe>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Qe)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(o,s){(function(c){(function(){function a(O,L,S){return L in O?Object.defineProperty(O,L,{value:S,enumerable:!0,configurable:!0,writable:!0}):O[L]=S,O}function y(O,L){return{value:O,done:L}}function g(O){var L=O[m];if(L!==null){var S=O[w].read();S!==null&&(O[d]=null,O[m]=null,O[k]=null,L(y(S,!1)))}}function u(O){c.nextTick(g,O)}function l(O,L){return function(S,C){O.then(function(){return L[v]?void S(y(void 0,!0)):void L[p](S,C)},C)}}var f,h=o("./end-of-stream"),m=Symbol("lastResolve"),k=Symbol("lastReject"),b=Symbol("error"),v=Symbol("ended"),d=Symbol("lastPromise"),p=Symbol("handlePromise"),w=Symbol("stream"),E=Object.getPrototypeOf(function(){}),x=Object.setPrototypeOf((f={get stream(){return this[w]},next:function(){var O=this,L=this[b];if(L!==null)return Promise.reject(L);if(this[v])return Promise.resolve(y(void 0,!0));if(this[w].destroyed)return new Promise(function(N,D){c.nextTick(function(){O[b]?D(O[b]):N(y(void 0,!0))})});var S,C=this[d];if(C)S=new Promise(l(C,this));else{var T=this[w].read();if(T!==null)return Promise.resolve(y(T,!1));S=new Promise(this[p])}return this[d]=S,S}},a(f,Symbol.asyncIterator,function(){return this}),a(f,"return",function(){var O=this;return new Promise(function(L,S){O[w].destroy(null,function(C){return C?void S(C):void L(y(void 0,!0))})})}),f),E);s.exports=function(O){var L,S=Object.create(x,(L={},a(L,w,{value:O,writable:!0}),a(L,m,{value:null,writable:!0}),a(L,k,{value:null,writable:!0}),a(L,b,{value:null,writable:!0}),a(L,v,{value:O._readableState.endEmitted,writable:!0}),a(L,p,{value:function(C,T){var N=S[w].read();N?(S[d]=null,S[m]=null,S[k]=null,C(y(N,!1))):(S[m]=C,S[k]=T)},writable:!0}),L));return S[d]=null,h(O,function(C){if(C&&C.code!=="ERR_STREAM_PREMATURE_CLOSE"){var T=S[k];return T!==null&&(S[d]=null,S[m]=null,S[k]=null,T(C)),void(S[b]=C)}var N=S[m];N!==null&&(S[d]=null,S[m]=null,S[k]=null,N(y(void 0,!0))),S[v]=!0}),O.on("readable",u.bind(null,S)),S}}).call(this)}).call(this,o("_process"))},{"./end-of-stream":24,_process:12}],22:[function(o,s){function c(d,p){var w=Object.keys(d);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(d);p&&(E=E.filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable})),w.push.apply(w,E)}return w}function a(d){for(var p,w=1;w<arguments.length;w++)p=arguments[w]==null?{}:arguments[w],w%2?c(Object(p),!0).forEach(function(E){y(d,E,p[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):c(Object(p)).forEach(function(E){Object.defineProperty(d,E,Object.getOwnPropertyDescriptor(p,E))});return d}function y(d,p,w){return p in d?Object.defineProperty(d,p,{value:w,enumerable:!0,configurable:!0,writable:!0}):d[p]=w,d}function g(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function u(d,p){for(var w,E=0;E<p.length;E++)w=p[E],w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(d,w.key,w)}function l(d,p,w){return p&&u(d.prototype,p),w&&u(d,w),d}function f(d,p,w){m.prototype.copy.call(d,p,w)}var h=o("buffer"),m=h.Buffer,k=o("util"),b=k.inspect,v=b&&b.custom||"inspect";s.exports=function(){function d(){g(this,d),this.head=null,this.tail=null,this.length=0}return l(d,[{key:"push",value:function(p){var w={data:p,next:null};0<this.length?this.tail.next=w:this.head=w,this.tail=w,++this.length}},{key:"unshift",value:function(p){var w={data:p,next:this.head};this.length===0&&(this.tail=w),this.head=w,++this.length}},{key:"shift",value:function(){if(this.length!==0){var p=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,p}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(p){if(this.length===0)return"";for(var w=this.head,E=""+w.data;w=w.next;)E+=p+w.data;return E}},{key:"concat",value:function(p){if(this.length===0)return m.alloc(0);for(var w=m.allocUnsafe(p>>>0),E=this.head,x=0;E;)f(E.data,w,x),x+=E.data.length,E=E.next;return w}},{key:"consume",value:function(p,w){var E;return p<this.head.data.length?(E=this.head.data.slice(0,p),this.head.data=this.head.data.slice(p)):p===this.head.data.length?E=this.shift():E=w?this._getString(p):this._getBuffer(p),E}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(p){var w=this.head,E=1,x=w.data;for(p-=x.length;w=w.next;){var O=w.data,L=p>O.length?O.length:p;if(x+=L===O.length?O:O.slice(0,p),p-=L,p===0){L===O.length?(++E,this.head=w.next?w.next:this.tail=null):(this.head=w,w.data=O.slice(L));break}++E}return this.length-=E,x}},{key:"_getBuffer",value:function(p){var w=m.allocUnsafe(p),E=this.head,x=1;for(E.data.copy(w),p-=E.data.length;E=E.next;){var O=E.data,L=p>O.length?O.length:p;if(O.copy(w,w.length-p,0,L),p-=L,p===0){L===O.length?(++x,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=O.slice(L));break}++x}return this.length-=x,w}},{key:v,value:function(p,w){return b(this,a({},w,{depth:0,customInspect:!1}))}}]),d}()},{buffer:3,util:2}],23:[function(o,s){(function(c){(function(){function a(u,l){g(u,l),y(u)}function y(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function g(u,l){u.emit("error",l)}s.exports={destroy:function(u,l){var f=this,h=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return h||m?(l?l(u):u&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,c.nextTick(g,this,u)):c.nextTick(g,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,function(k){!l&&k?f._writableState?f._writableState.errorEmitted?c.nextTick(y,f):(f._writableState.errorEmitted=!0,c.nextTick(a,f,k)):c.nextTick(a,f,k):l?(c.nextTick(y,f),l(k)):c.nextTick(y,f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,l){var f=u._readableState,h=u._writableState;f&&f.autoDestroy||h&&h.autoDestroy?u.destroy(l):u.emit("error",l)}}}).call(this)}).call(this,o("_process"))},{_process:12}],24:[function(o,s){function c(l){var f=!1;return function(){if(!f){f=!0;for(var h=arguments.length,m=Array(h),k=0;k<h;k++)m[k]=arguments[k];l.apply(this,m)}}}function a(){}function y(l){return l.setHeader&&typeof l.abort=="function"}function g(l,f,h){if(typeof f=="function")return g(l,null,f);f||(f={}),h=c(h||a);var m=f.readable||f.readable!==!1&&l.readable,k=f.writable||f.writable!==!1&&l.writable,b=function(){l.writable||d()},v=l._writableState&&l._writableState.finished,d=function(){k=!1,v=!0,m||h.call(l)},p=l._readableState&&l._readableState.endEmitted,w=function(){m=!1,p=!0,k||h.call(l)},E=function(L){h.call(l,L)},x=function(){var L;return m&&!p?(l._readableState&&l._readableState.ended||(L=new u),h.call(l,L)):k&&!v?(l._writableState&&l._writableState.ended||(L=new u),h.call(l,L)):void 0},O=function(){l.req.on("finish",d)};return y(l)?(l.on("complete",d),l.on("abort",x),l.req?O():l.on("request",O)):k&&!l._writableState&&(l.on("end",b),l.on("close",b)),l.on("end",w),l.on("finish",d),f.error!==!1&&l.on("error",E),l.on("close",x),function(){l.removeListener("complete",d),l.removeListener("abort",x),l.removeListener("request",O),l.req&&l.req.removeListener("finish",d),l.removeListener("end",b),l.removeListener("close",b),l.removeListener("finish",d),l.removeListener("end",w),l.removeListener("error",E),l.removeListener("close",x)}}var u=o("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;s.exports=g},{"../../../errors":15}],25:[function(o,s){s.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(o,s){function c(v){var d=!1;return function(){d||(d=!0,v.apply(void 0,arguments))}}function a(v){if(v)throw v}function y(v){return v.setHeader&&typeof v.abort=="function"}function g(v,d,p,w){w=c(w);var E=!1;v.on("close",function(){E=!0}),h===void 0&&(h=o("./end-of-stream")),h(v,{readable:d,writable:p},function(O){return O?w(O):(E=!0,void w())});var x=!1;return function(O){if(!E)return x?void 0:(x=!0,y(v)?v.abort():typeof v.destroy=="function"?v.destroy():void w(O||new b("pipe")))}}function u(v){v()}function l(v,d){return v.pipe(d)}function f(v){return v.length&&typeof v[v.length-1]=="function"?v.pop():a}var h,m=o("../../../errors").codes,k=m.ERR_MISSING_ARGS,b=m.ERR_STREAM_DESTROYED;s.exports=function(){for(var v=arguments.length,d=Array(v),p=0;p<v;p++)d[p]=arguments[p];var w=f(d);if(Array.isArray(d[0])&&(d=d[0]),2>d.length)throw new k("streams");var E,x=d.map(function(O,L){var S=L<d.length-1;return g(O,S,0<L,function(C){E||(E=C),C&&x.forEach(u),S||(x.forEach(u),w(E))})});return d.reduce(l)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(o,s){function c(y,g,u){return y.highWaterMark==null?g?y[u]:null:y.highWaterMark}var a=o("../../../errors").codes.ERR_INVALID_OPT_VALUE;s.exports={getHighWaterMark:function(y,g,u,l){var f=c(g,l,u);if(f!=null){if(!(isFinite(f)&&e(f)===f)||0>f){var h=l?u:"highWaterMark";throw new a(h,f)}return e(f)}return y.objectMode?16:16384}}},{"../../../errors":15}],28:[function(o,s){s.exports=o("events").EventEmitter},{events:7}],29:[function(o,s,c){c=s.exports=o("./lib/_stream_readable.js"),c.Stream=c,c.Readable=c,c.Writable=o("./lib/_stream_writable.js"),c.Duplex=o("./lib/_stream_duplex.js"),c.Transform=o("./lib/_stream_transform.js"),c.PassThrough=o("./lib/_stream_passthrough.js"),c.finished=o("./lib/internal/streams/end-of-stream.js"),c.pipeline=o("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(o,s,c){function a(l,f){for(var h in l)f[h]=l[h]}function y(l,f,h){return u(l,f,h)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var g=o("buffer"),u=g.Buffer;u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?s.exports=g:(a(g,c),c.Buffer=y),y.prototype=Object.create(u.prototype),a(u,y),y.from=function(l,f,h){if(typeof l=="number")throw new TypeError("Argument must not be a number");return u(l,f,h)},y.alloc=function(l,f,h){if(typeof l!="number")throw new TypeError("Argument must be a number");var m=u(l);return f===void 0?m.fill(0):typeof h=="string"?m.fill(f,h):m.fill(f),m},y.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return u(l)},y.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return g.SlowBuffer(l)}},{buffer:3}],31:[function(o,s,c){function a(x){if(!x)return"utf8";for(var O;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(O)return;x=(""+x).toLowerCase(),O=!0}}function y(x){var O=a(x);if(typeof O!="string"&&(w.isEncoding===E||!E(x)))throw new Error("Unknown encoding: "+x);return O||x}function g(x){this.encoding=y(x);var O;switch(this.encoding){case"utf16le":this.text=m,this.end=k,O=4;break;case"utf8":this.fillLast=h,O=4;break;case"base64":this.text=b,this.end=v,O=3;break;default:return this.write=d,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(O)}function u(x){return 127>=x?0:x>>5==6?2:x>>4==14?3:x>>3==30?4:x>>6==2?-1:-2}function l(x,O,L){var S=O.length-1;if(S<L)return 0;var C=u(O[S]);return 0<=C?(0<C&&(x.lastNeed=C-1),C):--S<L||C===-2?0:(C=u(O[S]),0<=C?(0<C&&(x.lastNeed=C-2),C):--S<L||C===-2?0:(C=u(O[S]),0<=C?(0<C&&(C===2?C=0:x.lastNeed=C-3),C):0))}function f(x,O){if((192&O[0])!=128)return x.lastNeed=0,"\uFFFD";if(1<x.lastNeed&&1<O.length){if((192&O[1])!=128)return x.lastNeed=1,"\uFFFD";if(2<x.lastNeed&&2<O.length&&(192&O[2])!=128)return x.lastNeed=2,"\uFFFD"}}function h(x){var O=this.lastTotal-this.lastNeed,L=f(this,x);return L===void 0?this.lastNeed<=x.length?(x.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(x.copy(this.lastChar,O,0,x.length),void(this.lastNeed-=x.length)):L}function m(x,O){if((x.length-O)%2==0){var L=x.toString("utf16le",O);if(L){var S=L.charCodeAt(L.length-1);if(55296<=S&&56319>=S)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],L.slice(0,-1)}return L}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",O,x.length-1)}function k(x){var O=x&&x.length?this.write(x):"";if(this.lastNeed){var L=this.lastTotal-this.lastNeed;return O+this.lastChar.toString("utf16le",0,L)}return O}function b(x,O){var L=(x.length-O)%3;return L==0?x.toString("base64",O):(this.lastNeed=3-L,this.lastTotal=3,L==1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",O,x.length-L))}function v(x){var O=x&&x.length?this.write(x):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function d(x){return x.toString(this.encoding)}function p(x){return x&&x.length?this.write(x):""}var w=o("safe-buffer").Buffer,E=w.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};c.StringDecoder=g,g.prototype.write=function(x){if(x.length===0)return"";var O,L;if(this.lastNeed){if(O=this.fillLast(x),O===void 0)return"";L=this.lastNeed,this.lastNeed=0}else L=0;return L<x.length?O?O+this.text(x,L):this.text(x,L):O||""},g.prototype.end=function(x){var O=x&&x.length?this.write(x):"";return this.lastNeed?O+"\uFFFD":O},g.prototype.text=function(x,O){var L=l(this,x,O);if(!this.lastNeed)return x.toString("utf8",O);this.lastTotal=L;var S=x.length-(L-this.lastNeed);return x.copy(this.lastChar,0,S),x.toString("utf8",O,S)},g.prototype.fillLast=function(x){return this.lastNeed<=x.length?(x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),void(this.lastNeed-=x.length))}},{"safe-buffer":30}],32:[function(o,s){(function(c){(function(){function a(y){try{if(!c.localStorage)return!1}catch{return!1}var g=c.localStorage[y];return g!=null&&(g+"").toLowerCase()==="true"}s.exports=function(y,g){function u(){if(!l){if(a("throwDeprecation"))throw new Error(g);a("traceDeprecation")?console.trace(g):console.warn(g),l=!0}return y.apply(this,arguments)}if(a("noDeprecation"))return y;var l=!1;return u}}).call(this)}).call(this,typeof Qe>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Qe)},{}],"/":[function(o,s){function c(v){return v.replace(/a=ice-options:trickle\s\n/g,"")}function a(v){console.warn(v)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const y=o("debug")("simple-peer"),g=o("get-browser-rtc"),u=o("randombytes"),l=o("readable-stream"),f=o("queue-microtask"),h=o("err-code"),{Buffer:m}=o("buffer"),k=65536;class b extends l.Duplex{constructor(d){if(d=Object.assign({allowHalfOpen:!1},d),super(d),this._id=u(4).toString("hex").slice(0,7),this._debug("new peer %o",d),this.channelName=d.initiator?d.channelName||u(20).toString("hex"):null,this.initiator=d.initiator||!1,this.channelConfig=d.channelConfig||b.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},b.config,d.config),this.offerOptions=d.offerOptions||{},this.answerOptions=d.answerOptions||{},this.sdpTransform=d.sdpTransform||(p=>p),this.streams=d.streams||(d.stream?[d.stream]:[]),this.trickle=d.trickle===void 0||d.trickle,this.allowHalfTrickle=d.allowHalfTrickle!==void 0&&d.allowHalfTrickle,this.iceCompleteTimeout=d.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=d.wrtc&&typeof d.wrtc=="object"?d.wrtc:g(),!this._wrtc)throw h(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(p){return void this.destroy(h(p,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=p=>{this._onIceCandidate(p)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(p=>{this.destroy(h(p,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=p=>{this._setupData(p)},this.streams&&this.streams.forEach(p=>{this.addStream(p)}),this._pc.ontrack=p=>{this._onTrack(p)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(d){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof d=="string")try{d=JSON.parse(d)}catch{d={}}this._debug("signal()"),d.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),d.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(d.transceiverRequest.kind,d.transceiverRequest.init)),d.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(d.candidate):this._pendingCandidates.push(d.candidate)),d.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(d)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(p=>{this._addIceCandidate(p)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(p=>{this.destroy(h(p,"ERR_SET_REMOTE_DESCRIPTION"))}),d.sdp||d.candidate||d.renegotiate||d.transceiverRequest||this.destroy(h(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(d){const p=new this._wrtc.RTCIceCandidate(d);this._pc.addIceCandidate(p).catch(w=>{!p.address||p.address.endsWith(".local")?a("Ignoring unsupported ICE candidate."):this.destroy(h(w,"ERR_ADD_ICE_CANDIDATE"))})}send(d){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(d)}}addTransceiver(d,p){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(d,p),this._needsNegotiation()}catch(w){this.destroy(h(w,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:d,init:p}})}}addStream(d){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),d.getTracks().forEach(p=>{this.addTrack(p,d)})}}addTrack(d,p){if(this.destroying)return;if(this.destroyed)throw h(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const w=this._senderMap.get(d)||new Map;let E=w.get(p);if(!E)E=this._pc.addTrack(d,p),w.set(p,E),this._senderMap.set(d,w),this._needsNegotiation();else throw E.removed?h(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):h(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(d,p,w){if(this.destroying)return;if(this.destroyed)throw h(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const E=this._senderMap.get(d),x=E?E.get(w):null;if(!x)throw h(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");p&&this._senderMap.set(p,E),x.replaceTrack==null?this.destroy(h(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):x.replaceTrack(p)}removeTrack(d,p){if(this.destroying)return;if(this.destroyed)throw h(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const w=this._senderMap.get(d),E=w?w.get(p):null;if(!E)throw h(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{E.removed=!0,this._pc.removeTrack(E)}catch(x){x.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(E):this.destroy(h(x,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(d){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),d.getTracks().forEach(p=>{this.removeTrack(p,d)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,f(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(d){this._destroy(d,()=>{})}_destroy(d,p){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",d&&(d.message||d)),f(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",d&&(d.message||d)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,d&&this.emit("error",d),this.emit("close"),p()}))}_setupData(d){if(!d.channel)return this.destroy(h(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=d.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=k),this.channelName=this._channel.label,this._channel.onmessage=w=>{this._onChannelMessage(w)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=w=>{const E=w.error instanceof Error?w.error:new Error(`Datachannel error: ${w.message} ${w.filename}:${w.lineno}:${w.colno}`);this.destroy(h(E,"ERR_DATA_CHANNEL"))};let p=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(p&&this._onChannelClose(),p=!0):p=!1},5e3)}_read(){}_write(d,p,w){if(this.destroyed)return w(h(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(d)}catch(E){return this.destroy(h(E,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>k?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=w):w(null)}else this._debug("write before connect"),this._chunk=d,this._cb=w}_onFinish(){if(!this.destroyed){const d=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?d():this.once("connect",d)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(d=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(d.sdp=c(d.sdp)),d.sdp=this.sdpTransform(d.sdp);const p=()=>{if(!this.destroyed){const w=this._pc.localDescription||d;this._debug("signal"),this.emit("signal",{type:w.type,sdp:w.sdp})}};this._pc.setLocalDescription(d).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?p():this.once("_iceComplete",p))}).catch(w=>{this.destroy(h(w,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(d=>{this.destroy(h(d,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(d=>{d.mid||!d.sender.track||d.requested||(d.requested=!0,this.addTransceiver(d.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(d=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(d.sdp=c(d.sdp)),d.sdp=this.sdpTransform(d.sdp);const p=()=>{if(!this.destroyed){const w=this._pc.localDescription||d;this._debug("signal"),this.emit("signal",{type:w.type,sdp:w.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(d).then(()=>{this.destroyed||(this.trickle||this._iceComplete?p():this.once("_iceComplete",p))}).catch(w=>{this.destroy(h(w,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(d=>{this.destroy(h(d,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(h(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const d=this._pc.iceConnectionState,p=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",d,p),this.emit("iceStateChange",d,p),(d==="connected"||d==="completed")&&(this._pcReady=!0,this._maybeReady()),d==="failed"&&this.destroy(h(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),d==="closed"&&this.destroy(h(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(d){const p=w=>(Object.prototype.toString.call(w.values)==="[object Array]"&&w.values.forEach(E=>{Object.assign(w,E)}),w);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(w=>{const E=[];w.forEach(x=>{E.push(p(x))}),d(null,E)},w=>d(w)):0<this._pc.getStats.length?this._pc.getStats(w=>{if(this.destroyed)return;const E=[];w.result().forEach(x=>{const O={};x.names().forEach(L=>{O[L]=x.stat(L)}),O.id=x.id,O.type=x.type,O.timestamp=x.timestamp,E.push(p(O))}),d(null,E)},w=>d(w)):d(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const d=()=>{this.destroyed||this.getStats((p,w)=>{if(this.destroyed)return;p&&(w=[]);const E={},x={},O={};let L=!1;w.forEach(C=>{(C.type==="remotecandidate"||C.type==="remote-candidate")&&(E[C.id]=C),(C.type==="localcandidate"||C.type==="local-candidate")&&(x[C.id]=C),(C.type==="candidatepair"||C.type==="candidate-pair")&&(O[C.id]=C)});const S=C=>{L=!0;let T=x[C.localCandidateId];T&&(T.ip||T.address)?(this.localAddress=T.ip||T.address,this.localPort=+T.port):T&&T.ipAddress?(this.localAddress=T.ipAddress,this.localPort=+T.portNumber):typeof C.googLocalAddress=="string"&&(T=C.googLocalAddress.split(":"),this.localAddress=T[0],this.localPort=+T[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let N=E[C.remoteCandidateId];N&&(N.ip||N.address)?(this.remoteAddress=N.ip||N.address,this.remotePort=+N.port):N&&N.ipAddress?(this.remoteAddress=N.ipAddress,this.remotePort=+N.portNumber):typeof C.googRemoteAddress=="string"&&(N=C.googRemoteAddress.split(":"),this.remoteAddress=N[0],this.remotePort=+N[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(w.forEach(C=>{C.type==="transport"&&C.selectedCandidatePairId&&S(O[C.selectedCandidatePairId]),(C.type==="googCandidatePair"&&C.googActiveConnection==="true"||(C.type==="candidatepair"||C.type==="candidate-pair")&&C.selected)&&S(C)}),!L&&(!Object.keys(O).length||Object.keys(x).length))return void setTimeout(d,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(T){return this.destroy(h(T,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const C=this._cb;this._cb=null,C(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};d()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>k)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(d=>{this._pc.removeTrack(d),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(d){this.destroyed||(d.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:d.candidate.candidate,sdpMLineIndex:d.candidate.sdpMLineIndex,sdpMid:d.candidate.sdpMid}}):!d.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),d.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(d){if(this.destroyed)return;let p=d.data;p instanceof ArrayBuffer&&(p=m.from(p)),this.push(p)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const d=this._cb;this._cb=null,d(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(d){this.destroyed||d.streams.forEach(p=>{this._debug("on track"),this.emit("track",d.track,p),this._remoteTracks.push({track:d.track,stream:p}),this._remoteStreams.some(w=>w.id===p.id)||(this._remoteStreams.push(p),f(()=>{this._debug("on stream"),this.emit("stream",p)}))})}_debug(){const d=[].slice.call(arguments);d[0]="["+this._id+"] "+d[0],y.apply(null,d)}}b.WEBRTC_SUPPORT=!!g(),b.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},b.channelConfig={},s.exports=b},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(cf);const Gg=cf.exports,ll=0,cl=1,uf=2,ff=(n,t)=>{St(n,ll);const e=yp(t);ne(n,e)},hf=(n,t,e)=>{St(n,cl),ne(n,Za(t,e))},Yg=(n,t,e)=>hf(t,e,ye(n)),df=(n,t,e)=>{try{xu(t,ye(n),e)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Zg=(n,t)=>{St(n,uf),ne(n,t)},Xg=df,Jg=(n,t,e,r)=>{const i=Tt(n);switch(i){case ll:Yg(n,t,e);break;case cl:df(n,e,r);break;case uf:Xg(n,e,r);break;default:throw new Error("Unknown message type")}return i},Qg=(n,t)=>{const e=la(n).buffer,r=la(t).buffer;return crypto.subtle.importKey("raw",e,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},pf=(n,t)=>{if(!t)return Ua(n);const e=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:e},t,n).then(r=>{const i=me();return vn(i,"AES-GCM"),ne(i,e),ne(i,new Uint8Array(r)),Qt(i)})},ty=(n,t)=>{const e=me();return Hr(e,n),pf(Qt(e),t)},gf=(n,t)=>{if(!t)return Ua(n);const e=On(n);Bn(e)!=="AES-GCM"&&Kd(kr("Unknown encryption algorithm"));const i=ye(e),o=ye(e);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},t,o).then(s=>new Uint8Array(s))},ey=(n,t)=>gf(n,t).then(e=>Fr(On(new Uint8Array(e)))),tn=ep("y-webrtc"),$r=0,yf=3,Di=1,ul=4,Xo=new Map,ur=new Map,vf=n=>{let t=!0;n.webrtcConns.forEach(e=>{e.synced||(t=!1)}),(!t&&n.synced||t&&!n.synced)&&(n.synced=t,n.provider.emit("synced",[{synced:t}]),tn("synced ",Be,n.name,er," with all peers"))},mf=(n,t,e)=>{const r=On(t),i=me(),o=Tt(r);if(n===void 0)return null;const s=n.awareness,c=n.doc;let a=!1;switch(o){case $r:{St(i,$r);const y=Jg(r,i,c,n);y===cl&&!n.synced&&e(),y===ll&&(a=!0);break}case yf:St(i,Di),ne(i,Go(s,Array.from(s.getStates().keys()))),a=!0;break;case Di:mg(s,ye(r),n);break;case ul:{const y=hr(r)===1,g=Bn(r);if(g!==n.peerId&&(n.bcConns.has(g)&&!y||!n.bcConns.has(g)&&y)){const u=[],l=[];y?(n.bcConns.add(g),l.push(g)):(n.bcConns.delete(g),u.push(g)),n.provider.emit("peers",[{added:l,removed:u,webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}]),bf(n)}break}default:return console.error("Unable to compute message"),i}return a?i:null},ny=(n,t)=>{const e=n.room;return tn("received message from ",Be,n.remotePeerId,ds," (",e.name,")",er,Gi),mf(e,t,()=>{n.synced=!0,tn("synced ",Be,e.name,er," with ",Be,n.remotePeerId),vf(e)})},Ks=(n,t)=>{tn("send message to ",Be,n.remotePeerId,er,ds," (",n.room.name,")",Gi);try{n.peer.send(Qt(t))}catch{}},ry=(n,t)=>{tn("broadcast message in ",Be,n.name,er),n.webrtcConns.forEach(e=>{try{e.peer.send(t)}catch{}})};class yc{constructor(t,e,r,i){tn("establishing connection to ",Be,r),this.room=i,this.remotePeerId=r,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Gg({initiator:e,...i.provider.peerOpts}),this.peer.on("signal",o=>{fl(t,i,{to:r,from:i.peerId,type:"signal",signal:o})}),this.peer.on("connect",()=>{tn("connected to ",Be,r),this.connected=!0;const s=i.provider.doc,c=i.awareness,a=me();St(a,$r),ff(a,s),Ks(this,a);const y=c.getStates();if(y.size>0){const g=me();St(g,Di),ne(g,Go(c,Array.from(y.keys()))),Ks(this,g)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),vf(i),this.peer.destroy(),tn("closed connection to ",Be,r),ma(i)}),this.peer.on("error",o=>{tn("Error in connection to ",Be,r,": ",o),ma(i)}),this.peer.on("data",o=>{const s=ny(this,o);s!==null&&Ks(this,s)})}destroy(){this.peer.destroy()}}const Xn=(n,t)=>pf(t,n.key).then(e=>n.mux(()=>Wg(n.name,e))),vc=(n,t)=>{n.bcconnected&&Xn(n,t),ry(n,t)},ma=n=>{Xo.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[n.name]}),n.webrtcConns.size<n.provider.maxConns&&fl(t,n,{type:"announce",from:n.peerId}))})},bf=n=>{if(n.provider.filterBcConns){const t=me();St(t,ul),Ai(t,1),vn(t,n.peerId),Xn(n,Qt(t))}};class iy{constructor(t,e,r,i){this.peerId=qa(),this.doc=t,this.awareness=e.awareness,this.provider=e,this.synced=!1,this.name=r,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=af(),this.bcconnected=!1,this._bcSubscriber=o=>gf(new Uint8Array(o),i).then(s=>this.mux(()=>{const c=mf(this,s,()=>{});c&&Xn(this,Qt(c))})),this._docUpdateHandler=(o,s)=>{const c=me();St(c,$r),Zg(c,o),vc(this,Qt(c))},this._awarenessUpdateHandler=({added:o,updated:s,removed:c},a)=>{const y=o.concat(s).concat(c),g=me();St(g,Di),ne(g,Go(this.awareness,y)),vc(this,Qt(g))},this._beforeUnloadHandler=()=>{ga(this.awareness,[t.clientID],"window unload"),ur.forEach(o=>{o.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),ma(this);const t=this.name;Vg(t,this._bcSubscriber),this.bcconnected=!0,bf(this);const e=me();St(e,$r),ff(e,this.doc),Xn(this,Qt(e));const r=me();St(r,$r),hf(r,this.doc),Xn(this,Qt(r));const i=me();St(i,yf),Xn(this,Qt(i));const o=me();St(o,Di),ne(o,Go(this.awareness,[this.doc.clientID])),Xn(this,Qt(o))}disconnect(){Xo.forEach(e=>{e.connected&&e.send({type:"unsubscribe",topics:[this.name]})}),ga(this.awareness,[this.doc.clientID],"disconnect");const t=me();St(t,ul),Ai(t,0),vn(t,this.peerId),Xn(this,Qt(t)),Kg(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(e=>e.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const oy=(n,t,e,r)=>{if(ur.has(e))throw kr(`A Yjs Doc connected to room "${e}" already exists!`);const i=new iy(n,t,e,r);return ur.set(e,i),i},fl=(n,t,e)=>{t.key?ty(e,t.key).then(r=>{n.send({type:"publish",topic:t.name,data:cu(r)})}):n.send({type:"publish",topic:t.name,data:e})};class sy extends Ug{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{tn(`connected (${t})`);const e=Array.from(ur.keys());this.send({type:"subscribe",topics:e}),ur.forEach(r=>fl(this,r,{type:"announce",from:r.peerId}))}),this.on("message",e=>{switch(e.type){case"publish":{const r=e.topic,i=ur.get(r);if(i==null||typeof r!="string")return;const o=s=>{const c=i.webrtcConns,a=i.peerId;if(s==null||s.from===a||s.to!==void 0&&s.to!==a||i.bcConns.has(s.from))return;const y=c.has(s.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[s.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(s.type){case"announce":c.size<i.provider.maxConns&&(He(c,s.from,()=>new yc(this,!0,s.from,i)),y());break;case"signal":s.to===a&&(He(c,s.from,()=>new yc(this,!1,s.from,i)).peer.signal(s.signal),y());break}};i.key?typeof e.data=="string"&&ey(uu(e.data),i.key).then(o):o(e.data)}}}),this.on("disconnect",()=>tn(`disconnect (${t})`))}}class ay extends ti{constructor(t,e,{signaling:r=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:i=null,awareness:o=new ol(e),maxConns:s=20+wn(zd()*15),filterBcConns:c=!0,peerOpts:a={}}={}){super(),this.roomName=t,this.doc=e,this.filterBcConns=c,this.awareness=o,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=s,this.peerOpts=a,this.key=i?Qg(i,t):Ua(null),this.room=null,this.key.then(y=>{this.room=oy(e,this,t,y),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),e.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const e=He(Xo,t,()=>new sy(t));this.signalingConns.push(e),e.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),Xo.delete(t.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),ur.delete(this.roomName)}),super.destroy()}}const Cr=n=>hs((t,e)=>{n.onerror=r=>e(new Error(r.target.error)),n.onblocked=()=>location.reload(),n.onsuccess=r=>t(r.target.result)}),ly=(n,t)=>hs((e,r)=>{const i=indexedDB.open(n);i.onupgradeneeded=o=>t(o.target.result),i.onerror=o=>r(kr(o.target.error)),i.onblocked=()=>location.reload(),i.onsuccess=o=>{const s=o.target.result;s.onversionchange=()=>{s.close()},typeof addEventListener<"u"&&addEventListener("unload",()=>s.close()),e(s)}}),cy=n=>Cr(indexedDB.deleteDatabase(n)),uy=(n,t)=>t.forEach(e=>n.createObjectStore.apply(n,e)),yi=(n,t,e="readwrite")=>{const r=n.transaction(t,e);return t.map(i=>my(r,i))},_f=(n,t)=>Cr(n.count(t)),fy=(n,t)=>Cr(n.get(t)),wf=(n,t)=>Cr(n.delete(t)),hy=(n,t,e)=>Cr(n.put(t,e)),ba=(n,t)=>Cr(n.add(t)),dy=(n,t)=>Cr(n.getAll(t)),py=(n,t,e)=>{let r=null;return vy(n,t,i=>(r=i,!1),e).then(()=>r)},gy=(n,t=null)=>py(n,t,"prev"),yy=(n,t)=>hs((e,r)=>{n.onerror=r,n.onsuccess=i=>{const o=i.target.result;if(o===null||t(o)===!1)return e();o.continue()}}),vy=(n,t,e,r="next")=>yy(n.openKeyCursor(t,r),i=>e(i.key)),my=(n,t)=>n.objectStore(t),by=(n,t)=>IDBKeyRange.upperBound(n,t),_y=(n,t)=>IDBKeyRange.lowerBound(n,t),Ws="custom",kf="updates",xf=500,Ef=n=>{const[t]=yi(n.db,[kf]);return dy(t,_y(n._dbref,!1)).then(e=>Vt(n.doc,()=>{e.forEach(r=>xu(n.doc,r))},n,!1)).then(()=>gy(t).then(e=>{n._dbref=e+1})).then(()=>_f(t).then(e=>{n._dbsize=e})).then(()=>t)},wy=(n,t=!0)=>Ef(n).then(e=>{(t||n._dbsize>=xf)&&ba(e,Za(n.doc)).then(()=>wf(e,by(n._dbref,!0))).then(()=>_f(e).then(r=>{n._dbsize=r}))});class ky extends ti{constructor(t,e){super(),this.doc=e,this.name=t,this._mux=af(),this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=ly(t,r=>uy(r,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=this._db.then(r=>{this.db=r;const i=Za(e);return Ef(this).then(o=>ba(o,i)).then(()=>this._destroyed?this:(this.emit("synced",[this]),this.synced=!0,this))}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(r,i)=>{if(this.db&&i!==this){const[o]=yi(this.db,[kf]);ba(o,r),++this._dbsize>=xf&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{wy(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},e.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),e.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(t=>{t.close()})}clearData(){return this.destroy().then(()=>{cy(this.name)})}get(t){return this._db.then(e=>{const[r]=yi(e,[Ws],"readonly");return fy(r,t)})}set(t,e){return this._db.then(r=>{const[i]=yi(r,[Ws]);return hy(i,e,t)})}del(t){return this._db.then(e=>{const[r]=yi(e,[Ws]);return wf(r,t)})}}class xy extends ay{constructor(t,e,r){var i;super(t,e,{awareness:(i=r==null?void 0:r.awareness)!=null?i:null,signaling:["ws://localhost:4444"]})}clearData(){return Promise.resolve()}}class mc extends ky{constructor(t,e,r){super(t,e)}connect(){}disconnect(){}clearData(){return Promise.resolve()}}const Sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Cf="__ $BLOCKSUITE_STORE$ __";Sf[Cf]===!0&&console.error("@blocksuite/store was already imported. This breaks constructor checks and will lead to issues!");Sf[Cf]=!0;var Ey=Object.defineProperty,Sy=Object.getOwnPropertyDescriptor,Ar=(n,t,e,r)=>{for(var i=r>1?void 0:r?Sy(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Ey(t,e,i),i};const Ie={undo:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M48.5 224H40c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H48.5z"
      />
    </svg>
  `,redo:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M463.5 224H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1c-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5z"
      />
    </svg>
  `,quote:ft`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 448 512"
      style="width: 11px;"
    >
      <path
        d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V320 288 216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H320c-35.3 0-64-28.7-64-64V320 288 216z"
      />
    </svg>
  `,ul:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"
      />
    </svg>
  `,ol:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
      <path
        d="M24 56c0-13.3 10.7-24 24-24H80c13.3 0 24 10.7 24 24V176h16c13.3 0 24 10.7 24 24s-10.7 24-24 24H40c-13.3 0-24-10.7-24-24s10.7-24 24-24H56V80H48C34.7 80 24 69.3 24 56zM86.7 341.2c-6.5-7.4-18.3-6.9-24 1.2L51.5 357.9c-7.7 10.8-22.7 13.3-33.5 5.6s-13.3-22.7-5.6-33.5l11.1-15.6c23.7-33.2 72.3-35.6 99.2-4.9c21.3 24.4 20.8 60.9-1.1 84.7L86.8 432H120c13.3 0 24 10.7 24 24s-10.7 24-24 24H32c-9.5 0-18.2-5.6-22-14.4s-2.1-18.9 4.3-25.9l72-78c5.3-5.8 5.4-14.6 .3-20.5zM224 64H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H224c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 160H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H224c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 160H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
  `,checklist:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
      <path
        d="M211.8 339.8C200.9 350.7 183.1 350.7 172.2 339.8L108.2 275.8C97.27 264.9 97.27 247.1 108.2 236.2C119.1 225.3 136.9 225.3 147.8 236.2L192 280.4L300.2 172.2C311.1 161.3 328.9 161.3 339.8 172.2C350.7 183.1 350.7 200.9 339.8 211.8L211.8 339.8zM0 96C0 60.65 28.65 32 64 32H384C419.3 32 448 60.65 448 96V416C448 451.3 419.3 480 384 480H64C28.65 480 0 451.3 0 416V96zM48 96V416C48 424.8 55.16 432 64 432H384C392.8 432 400 424.8 400 416V96C400 87.16 392.8 80 384 80H64C55.16 80 48 87.16 48 96z"
      />
    </svg>
  `,switchMode:ft`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 512 512"
      style="width: 12px;"
    >
      <path
        d="M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"
      />
    </svg>
  `,addGroup:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M32 119.4C12.9 108.4 0 87.7 0 64C0 28.7 28.7 0 64 0c23.7 0 44.4 12.9 55.4 32H328.6C339.6 12.9 360.3 0 384 0c35.3 0 64 28.7 64 64c0 23.7-12.9 44.4-32 55.4V232.6c19.1 11.1 32 31.7 32 55.4c0 35.3-28.7 64-64 64c-23.7 0-44.4-12.9-55.4-32H119.4c-11.1 19.1-31.7 32-55.4 32c-35.3 0-64-28.7-64-64c0-23.7 12.9-44.4 32-55.4V119.4zM119.4 96c-5.6 9.7-13.7 17.8-23.4 23.4V232.6c9.7 5.6 17.8 13.7 23.4 23.4H328.6c5.6-9.7 13.7-17.8 23.4-23.4V119.4c-9.7-5.6-17.8-13.7-23.4-23.4H119.4zm192 384c-11.1 19.1-31.7 32-55.4 32c-35.3 0-64-28.7-64-64c0-23.7 12.9-44.4 32-55.4V352h64v40.6c9.7 5.6 17.8 13.7 23.4 23.4H520.6c5.6-9.7 13.7-17.8 23.4-23.4V279.4c-9.7-5.6-17.8-13.7-23.4-23.4h-46c-5.4-15.4-14.6-28.9-26.5-39.6V192h72.6c11.1-19.1 31.7-32 55.4-32c35.3 0 64 28.7 64 64c0 23.7-12.9 44.4-32 55.4V392.6c19.1 11.1 32 31.7 32 55.4c0 35.3-28.7 64-64 64c-23.7 0-44.4-12.9-55.4-32H311.4z"
      />
    </svg>
  `,html:ft`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 384 512"
      style="width: 11px;"
    >
      <path
        d="M0 32l34.9 395.8L191.5 480l157.6-52.2L384 32H0zm308.2 127.9H124.4l4.1 49.4h175.6l-13.6 148.4-97.9 27v.3h-1.1l-98.7-27.3-6-75.8h47.7L138 320l53.5 14.5 53.7-14.5 6-62.2H84.3L71.5 112.2h241.1l-4.4 47.7z"
      />
    </svg>
  `,markdown:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M593.8 59.1H46.2C20.7 59.1 0 79.8 0 105.2v301.5c0 25.5 20.7 46.2 46.2 46.2h547.7c25.5 0 46.2-20.7 46.1-46.1V105.2c0-25.4-20.7-46.1-46.2-46.1zM338.5 360.6H277v-120l-61.5 76.9-61.5-76.9v120H92.3V151.4h61.5l61.5 76.9 61.5-76.9h61.5v209.2zm135.3 3.1L381.5 256H443V151.4h61.5V256H566z"
      />
    </svg>
  `,trash:ft`
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 448 512"
      style="width: 11px;"
    >
      <path
        d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"
      />
    </svg>
  `,connected:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M54.2 202.9C123.2 136.7 216.8 96 320 96s196.8 40.7 265.8 106.9c12.8 12.2 33 11.8 45.2-.9s11.8-33-.9-45.2C549.7 79.5 440.4 32 320 32S90.3 79.5 9.8 156.7C-2.9 169-3.3 189.2 8.9 202s32.5 13.2 45.2 .9zM320 256c56.8 0 108.6 21.1 148.2 56c13.3 11.7 33.5 10.4 45.2-2.8s10.4-33.5-2.8-45.2C459.8 219.2 393 192 320 192s-139.8 27.2-190.5 72c-13.3 11.7-14.5 31.9-2.8 45.2s31.9 14.5 45.2 2.8c39.5-34.9 91.3-56 148.2-56zm64 160c0-35.3-28.7-64-64-64s-64 28.7-64 64s28.7 64 64 64s64-28.7 64-64z"
      />
    </svg>
  `,disconnected:ft`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
      <path
        d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L440.6 320h73.8c34.2 0 93.7-28 93.7-64c0-35-59.5-64-93.7-64l-116.6 0L297.2 16.1C291.5 6.2 280.9 0 269.4 0H213.2c-10.6 0-18.3 10.2-15.4 20.4l40.3 140.9L38.8 5.1zm2.7 123.6C36 130.6 32 135.9 32 142c0 1.3 .2 2.6 .5 3.9L64 256 32.5 366.1c-.4 1.3-.5 2.6-.5 3.9c0 7.8 6.3 14 14 14H88c5 0 9.8-2.4 12.8-6.4L144 320H246.9l-49 171.6c-2.9 10.2 4.8 20.4 15.4 20.4l56.2 0c11.5 0 22.1-6.2 27.8-16.1l65.3-114.3L41.5 128.7z"
      />
    </svg>
  `};let Hn=class extends zt{constructor(){super(...arguments),this.connected=!0,this.canUndo=!1,this.canRedo=!1,this._mode="page"}_onToggleConnection(){}_convertToList(n){var s;const t=window.getSelection(),r=((s=t==null?void 0:t.focusNode)==null?void 0:s.parentElement).closest("[data-block-id]");if(!r)return;const{space:i}=r.host,o=i.getBlockById(r.model.id);vi(this.space,o,n,"")}_onDelete(){}_onSetParagraphType(n){var i,o;const t=window.getSelection(),r=(o=((i=t==null?void 0:t.focusNode)==null?void 0:i.parentElement).closest("paragraph-block"))==null?void 0:o.model;!r||(this.space.captureSync(),this.space.updateBlock(r,{type:n}))}_onSwitchMode(){this._mode=this._mode==="page"?"edgeless":"page";const n=Lo("affine.switch-mode",this._mode);window.dispatchEvent(n)}_onAddGroup(){const n=this.space.root;if(!n)return;const t=n.id;this.space.captureSync();const r=`[0,${n.children.length*60},720,480]`,i=this.space.addBlock({flavour:"affine:group",xywh:r},t);this.space.addBlock({flavour:"affine:paragraph"},i)}_onAddDataBase(){const n=this.space.root;if(!n)return;const t=n.id;this.space.captureSync();const e=this.space.addBlock({flavour:"affine:database"},t);for(let r=0;r<2;r++)this.space.addBlock({flavour:"affine:database-item"},e)}_onExportHtml(){this.contentParser.onExportHtml()}_onExportMarkDown(){this.contentParser.onExportMarkdown()}firstUpdated(){this.space.signals.historyUpdated.on(()=>{this.canUndo=this.space.canUndo,this.canRedo=this.space.canRedo})}render(){return ft`
      <div class="debug-menu">
        <button
          aria-label="undo"
          title="undo"
          .disabled=${!this.canUndo}
          tabindex="-1"
          @click=${()=>this.space.undo()}
        >
          ${Ie.undo}
        </button>
        <button
          aria-label="redo"
          title="redo"
          .disabled=${!this.canRedo}
          tabindex="-1"
          @click=${()=>this.space.redo()}
        >
          ${Ie.redo}
        </button>
        <button
          aria-label="heading-1"
          title="heading-1"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h1")}
        >
          𝐇𝟏
        </button>
        <button
          aria-label="heading-2"
          title="heading-2"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h2")}
        >
          𝐇𝟐
        </button>
        <button
          aria-label="heading-3"
          title="heading-3"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h3")}
        >
          𝐇𝟑
        </button>
        <button
          aria-label="heading-4"
          title="heading-4"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h4")}
        >
          𝐇𝟒
        </button>
        <button
          aria-label="heading-5"
          title="heading-5"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h5")}
        >
          𝐇𝟓
        </button>
        <button
          aria-label="heading-6"
          title="heading-6"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("h6")}
        >
          𝐇𝟔
        </button>
        <button
          aria-label="text"
          title="text"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("text")}
        >
          𝐓
        </button>
        <button
          aria-label="quote"
          title="quote"
          tabindex="-1"
          @click=${()=>this._onSetParagraphType("quote")}
        >
          ${Ie.quote}
        </button>
        <button
          aria-label="convert to bulleted list"
          title="convert to bulleted list"
          tabindex="-1"
          @click=${()=>this._convertToList("bulleted")}
        >
          ${Ie.ul}
        </button>
        <button
          aria-label="convert to numbered list"
          title="convert to numbered list"
          tabindex="-1"
          @click=${()=>this._convertToList("numbered")}
        >
          ${Ie.ol}
        </button>
        <button
          aria-label="convert to todo list"
          title="convert to todo list"
          tabindex="-1"
          @click=${()=>this._convertToList("todo")}
        >
          ${Ie.checklist}
        </button>
        <!--
        <button
          aria-label="delete"
          title="delete"
          disabled
          tabindex="-1"
          @click=${this._onDelete}
        >
          ❌
        </button>
        -->
        <button
          aria-label=${this.connected?"disconnect":"connect"}
          title=${this.connected?"disconnect":"connect"}
          tabindex="-1"
          @click=${this._onToggleConnection}
        >
          ${this.connected?Ie.connected:Ie.disconnected}
        </button>
        <button
          aria-label="switch mode"
          title="switch mode"
          tabindex="-1"
          @click=${this._onSwitchMode}
        >
          ${Ie.switchMode}
        </button>
        <button
          aria-label="add group"
          title="add group"
          tabindex="-1"
          @click=${this._onAddGroup}
        >
          ${Ie.addGroup}
        </button>
        <button
          aria-label="add database"
          title="add database"
          tabindex="-1"
          @click=${this._onAddDataBase}
        >
          D
        </button>
        <button
          aria-label="export markdown"
          title="export markdown"
          tabindex="-1"
          @click=${this._onExportMarkDown}
        >
          ${Ie.markdown}
        </button>
        <button
          aria-label="export html"
          title="export html"
          tabindex="-1"
          @click=${this._onExportHtml}
        >
          ${Ie.html}
        </button>
        <button aria-label="clear data" title="clear data" disabled>
          ${Ie.trash}
        </button>
      </div>
    `}};Hn.styles=Kt`
    .debug-menu {
      display: flex;
      flex-wrap: wrap;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000; /* for debug visibility */
    }
    .debug-menu > button {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-left: 2px;
      margin-top: 2px;
      width: 26px;
      height: 22px;
      border: 0;
      border-radius: 2px;
      background-color: var(--affine-border-color);
      color: var(--affine-text-color);
      transition: all 0.3s;
      cursor: pointer;
    }
    .debug-menu > button:hover {
      background-color: var(--affine-hover-background);
    }
    .debug-menu > button:disabled,
    .debug-menu > button:disabled:hover {
      opacity: 0.5;
      background-color: var(--affine-border-color);
      cursor: default;
    }
    .debug-menu > button path {
      fill: var(--affine-text-color);
    }
    .debug-menu > button > * {
      flex: 1;
    }
  `;Ar([xt()],Hn.prototype,"space",2);Ar([xt()],Hn.prototype,"contentParser",2);Ar([ke()],Hn.prototype,"connected",2);Ar([ke()],Hn.prototype,"canUndo",2);Ar([ke()],Hn.prototype,"canRedo",2);Ar([ke()],Hn.prototype,"_mode",2);Hn=Ar([Xt("debug-menu")],Hn);var Af={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(n,t){(function(r,i){n.exports=i()})(typeof self<"u"?self:Qe,function(){return function(e){var r={};function i(o){if(r[o])return r[o].exports;var s=r[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=r,i.d=function(o,s,c){i.o(o,s)||Object.defineProperty(o,s,{configurable:!1,enumerable:!0,get:c})},i.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(s,"a",s),s},i.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},i.p="",i(i.s=109)}([function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(17),s=i(18),c=i(19),a=i(45),y=i(46),g=i(47),u=i(48),l=i(49),f=i(12),h=i(32),m=i(33),k=i(31),b=i(1),v={Scope:b.Scope,create:b.create,find:b.find,query:b.query,register:b.register,Container:o.default,Format:s.default,Leaf:c.default,Embed:u.default,Scroll:a.default,Block:g.default,Inline:y.default,Text:l.default,Attributor:{Attribute:f.default,Class:h.default,Style:m.default,Store:k.default}};r.default=v},function(e,r,i){var o=this&&this.__extends||function(){var k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,v){b.__proto__=v}||function(b,v){for(var d in v)v.hasOwnProperty(d)&&(b[d]=v[d])};return function(b,v){k(b,v);function d(){this.constructor=b}b.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=function(k){o(b,k);function b(v){var d=this;return v="[Parchment] "+v,d=k.call(this,v)||this,d.message=v,d.name=d.constructor.name,d}return b}(Error);r.ParchmentError=s;var c={},a={},y={},g={};r.DATA_KEY="__blot";var u;(function(k){k[k.TYPE=3]="TYPE",k[k.LEVEL=12]="LEVEL",k[k.ATTRIBUTE=13]="ATTRIBUTE",k[k.BLOT=14]="BLOT",k[k.INLINE=7]="INLINE",k[k.BLOCK=11]="BLOCK",k[k.BLOCK_BLOT=10]="BLOCK_BLOT",k[k.INLINE_BLOT=6]="INLINE_BLOT",k[k.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",k[k.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",k[k.ANY=15]="ANY"})(u=r.Scope||(r.Scope={}));function l(k,b){var v=h(k);if(v==null)throw new s("Unable to create "+k+" blot");var d=v,p=k instanceof Node||k.nodeType===Node.TEXT_NODE?k:d.create(b);return new d(p,b)}r.create=l;function f(k,b){return b===void 0&&(b=!1),k==null?null:k[r.DATA_KEY]!=null?k[r.DATA_KEY].blot:b?f(k.parentNode,b):null}r.find=f;function h(k,b){b===void 0&&(b=u.ANY);var v;if(typeof k=="string")v=g[k]||c[k];else if(k instanceof Text||k.nodeType===Node.TEXT_NODE)v=g.text;else if(typeof k=="number")k&u.LEVEL&u.BLOCK?v=g.block:k&u.LEVEL&u.INLINE&&(v=g.inline);else if(k instanceof HTMLElement){var d=(k.getAttribute("class")||"").split(/\s+/);for(var p in d)if(v=a[d[p]],v)break;v=v||y[k.tagName]}return v==null?null:b&u.LEVEL&v.scope&&b&u.TYPE&v.scope?v:null}r.query=h;function m(){for(var k=[],b=0;b<arguments.length;b++)k[b]=arguments[b];if(k.length>1)return k.map(function(p){return m(p)});var v=k[0];if(typeof v.blotName!="string"&&typeof v.attrName!="string")throw new s("Invalid definition");if(v.blotName==="abstract")throw new s("Cannot register abstract class");if(g[v.blotName||v.attrName]=v,typeof v.keyName=="string")c[v.keyName]=v;else if(v.className!=null&&(a[v.className]=v),v.tagName!=null){Array.isArray(v.tagName)?v.tagName=v.tagName.map(function(p){return p.toUpperCase()}):v.tagName=v.tagName.toUpperCase();var d=Array.isArray(v.tagName)?v.tagName:[v.tagName];d.forEach(function(p){(y[p]==null||v.className==null)&&(y[p]=v)})}return v}r.register=m},function(e,r,i){var o=i(51),s=i(11),c=i(3),a=i(20),y=String.fromCharCode(0),g=function(u){Array.isArray(u)?this.ops=u:u!=null&&Array.isArray(u.ops)?this.ops=u.ops:this.ops=[]};g.prototype.insert=function(u,l){var f={};return u.length===0?this:(f.insert=u,l!=null&&typeof l=="object"&&Object.keys(l).length>0&&(f.attributes=l),this.push(f))},g.prototype.delete=function(u){return u<=0?this:this.push({delete:u})},g.prototype.retain=function(u,l){if(u<=0)return this;var f={retain:u};return l!=null&&typeof l=="object"&&Object.keys(l).length>0&&(f.attributes=l),this.push(f)},g.prototype.push=function(u){var l=this.ops.length,f=this.ops[l-1];if(u=c(!0,{},u),typeof f=="object"){if(typeof u.delete=="number"&&typeof f.delete=="number")return this.ops[l-1]={delete:f.delete+u.delete},this;if(typeof f.delete=="number"&&u.insert!=null&&(l-=1,f=this.ops[l-1],typeof f!="object"))return this.ops.unshift(u),this;if(s(u.attributes,f.attributes)){if(typeof u.insert=="string"&&typeof f.insert=="string")return this.ops[l-1]={insert:f.insert+u.insert},typeof u.attributes=="object"&&(this.ops[l-1].attributes=u.attributes),this;if(typeof u.retain=="number"&&typeof f.retain=="number")return this.ops[l-1]={retain:f.retain+u.retain},typeof u.attributes=="object"&&(this.ops[l-1].attributes=u.attributes),this}}return l===this.ops.length?this.ops.push(u):this.ops.splice(l,0,u),this},g.prototype.chop=function(){var u=this.ops[this.ops.length-1];return u&&u.retain&&!u.attributes&&this.ops.pop(),this},g.prototype.filter=function(u){return this.ops.filter(u)},g.prototype.forEach=function(u){this.ops.forEach(u)},g.prototype.map=function(u){return this.ops.map(u)},g.prototype.partition=function(u){var l=[],f=[];return this.forEach(function(h){var m=u(h)?l:f;m.push(h)}),[l,f]},g.prototype.reduce=function(u,l){return this.ops.reduce(u,l)},g.prototype.changeLength=function(){return this.reduce(function(u,l){return l.insert?u+a.length(l):l.delete?u-l.delete:u},0)},g.prototype.length=function(){return this.reduce(function(u,l){return u+a.length(l)},0)},g.prototype.slice=function(u,l){u=u||0,typeof l!="number"&&(l=1/0);for(var f=[],h=a.iterator(this.ops),m=0;m<l&&h.hasNext();){var k;m<u?k=h.next(u-m):(k=h.next(l-m),f.push(k)),m+=a.length(k)}return new g(f)},g.prototype.compose=function(u){var l=a.iterator(this.ops),f=a.iterator(u.ops),h=[],m=f.peek();if(m!=null&&typeof m.retain=="number"&&m.attributes==null){for(var k=m.retain;l.peekType()==="insert"&&l.peekLength()<=k;)k-=l.peekLength(),h.push(l.next());m.retain-k>0&&f.next(m.retain-k)}for(var b=new g(h);l.hasNext()||f.hasNext();)if(f.peekType()==="insert")b.push(f.next());else if(l.peekType()==="delete")b.push(l.next());else{var v=Math.min(l.peekLength(),f.peekLength()),d=l.next(v),p=f.next(v);if(typeof p.retain=="number"){var w={};typeof d.retain=="number"?w.retain=v:w.insert=d.insert;var E=a.attributes.compose(d.attributes,p.attributes,typeof d.retain=="number");if(E&&(w.attributes=E),b.push(w),!f.hasNext()&&s(b.ops[b.ops.length-1],w)){var x=new g(l.rest());return b.concat(x).chop()}}else typeof p.delete=="number"&&typeof d.retain=="number"&&b.push(p)}return b.chop()},g.prototype.concat=function(u){var l=new g(this.ops.slice());return u.ops.length>0&&(l.push(u.ops[0]),l.ops=l.ops.concat(u.ops.slice(1))),l},g.prototype.diff=function(u,l){if(this.ops===u.ops)return new g;var f=[this,u].map(function(v){return v.map(function(d){if(d.insert!=null)return typeof d.insert=="string"?d.insert:y;var p=v===u?"on":"with";throw new Error("diff() called "+p+" non-document")}).join("")}),h=new g,m=o(f[0],f[1],l),k=a.iterator(this.ops),b=a.iterator(u.ops);return m.forEach(function(v){for(var d=v[1].length;d>0;){var p=0;switch(v[0]){case o.INSERT:p=Math.min(b.peekLength(),d),h.push(b.next(p));break;case o.DELETE:p=Math.min(d,k.peekLength()),k.next(p),h.delete(p);break;case o.EQUAL:p=Math.min(k.peekLength(),b.peekLength(),d);var w=k.next(p),E=b.next(p);s(w.insert,E.insert)?h.retain(p,a.attributes.diff(w.attributes,E.attributes)):h.push(E).delete(p);break}d-=p}}),h.chop()},g.prototype.eachLine=function(u,l){l=l||`
`;for(var f=a.iterator(this.ops),h=new g,m=0;f.hasNext();){if(f.peekType()!=="insert")return;var k=f.peek(),b=a.length(k)-f.peekLength(),v=typeof k.insert=="string"?k.insert.indexOf(l,b)-b:-1;if(v<0)h.push(f.next());else if(v>0)h.push(f.next(v));else{if(u(h,f.next(1).attributes||{},m)===!1)return;m+=1,h=new g}}h.length()>0&&u(h,{},m)},g.prototype.transform=function(u,l){if(l=!!l,typeof u=="number")return this.transformPosition(u,l);for(var f=a.iterator(this.ops),h=a.iterator(u.ops),m=new g;f.hasNext()||h.hasNext();)if(f.peekType()==="insert"&&(l||h.peekType()!=="insert"))m.retain(a.length(f.next()));else if(h.peekType()==="insert")m.push(h.next());else{var k=Math.min(f.peekLength(),h.peekLength()),b=f.next(k),v=h.next(k);if(b.delete)continue;v.delete?m.push(v):m.retain(k,a.attributes.transform(b.attributes,v.attributes,l))}return m.chop()},g.prototype.transformPosition=function(u,l){l=!!l;for(var f=a.iterator(this.ops),h=0;f.hasNext()&&h<=u;){var m=f.peekLength(),k=f.peekType();if(f.next(),k==="delete"){u-=Math.min(m,u-h);continue}else k==="insert"&&(h<u||!l)&&(u+=m);h+=m}return u},e.exports=g},function(e,r){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=Object.defineProperty,c=Object.getOwnPropertyDescriptor,a=function(f){return typeof Array.isArray=="function"?Array.isArray(f):o.call(f)==="[object Array]"},y=function(f){if(!f||o.call(f)!=="[object Object]")return!1;var h=i.call(f,"constructor"),m=f.constructor&&f.constructor.prototype&&i.call(f.constructor.prototype,"isPrototypeOf");if(f.constructor&&!h&&!m)return!1;var k;for(k in f);return typeof k>"u"||i.call(f,k)},g=function(f,h){s&&h.name==="__proto__"?s(f,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):f[h.name]=h.newValue},u=function(f,h){if(h==="__proto__")if(i.call(f,h)){if(c)return c(f,h).value}else return;return f[h]};e.exports=function l(){var f,h,m,k,b,v,d=arguments[0],p=1,w=arguments.length,E=!1;for(typeof d=="boolean"&&(E=d,d=arguments[1]||{},p=2),(d==null||typeof d!="object"&&typeof d!="function")&&(d={});p<w;++p)if(f=arguments[p],f!=null)for(h in f)m=u(d,h),k=u(f,h),d!==k&&(E&&k&&(y(k)||(b=a(k)))?(b?(b=!1,v=m&&a(m)?m:[]):v=m&&y(m)?m:{},g(d,{name:h,newValue:l(E,v,k)})):typeof k<"u"&&g(d,{name:h,newValue:k}));return d}},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BlockEmbed=r.bubbleFormats=void 0;var o=function(){function C(T,N){for(var D=0;D<N.length;D++){var M=N[D];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(T,M.key,M)}}return function(T,N,D){return N&&C(T.prototype,N),D&&C(T,D),T}}(),s=function C(T,N,D){T===null&&(T=Function.prototype);var M=Object.getOwnPropertyDescriptor(T,N);if(M===void 0){var F=Object.getPrototypeOf(T);return F===null?void 0:C(F,N,D)}else{if("value"in M)return M.value;var G=M.get;return G===void 0?void 0:G.call(D)}},c=i(3),a=d(c),y=i(2),g=d(y),u=i(0),l=d(u),f=i(16),h=d(f),m=i(6),k=d(m),b=i(7),v=d(b);function d(C){return C&&C.__esModule?C:{default:C}}function p(C,T){if(!(C instanceof T))throw new TypeError("Cannot call a class as a function")}function w(C,T){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:C}function E(C,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);C.prototype=Object.create(T&&T.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(C,T):C.__proto__=T)}var x=1,O=function(C){E(T,C);function T(){return p(this,T),w(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return o(T,[{key:"attach",value:function(){s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"attach",this).call(this),this.attributes=new l.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new g.default().insert(this.value(),(0,a.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(D,M){var F=l.default.query(D,l.default.Scope.BLOCK_ATTRIBUTE);F!=null&&this.attributes.attribute(F,M)}},{key:"formatAt",value:function(D,M,F,G){this.format(F,G)}},{key:"insertAt",value:function(D,M,F){if(typeof M=="string"&&M.endsWith(`
`)){var G=l.default.create(L.blotName);this.parent.insertBefore(G,D===0?this:this.next),G.insertAt(0,M.slice(0,-1))}else s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertAt",this).call(this,D,M,F)}}]),T}(l.default.Embed);O.scope=l.default.Scope.BLOCK_BLOT;var L=function(C){E(T,C);function T(N){p(this,T);var D=w(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,N));return D.cache={},D}return o(T,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(l.default.Leaf).reduce(function(D,M){return M.length()===0?D:D.insert(M.value(),S(M))},new g.default).insert(`
`,S(this))),this.cache.delta}},{key:"deleteAt",value:function(D,M){s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"deleteAt",this).call(this,D,M),this.cache={}}},{key:"formatAt",value:function(D,M,F,G){M<=0||(l.default.query(F,l.default.Scope.BLOCK)?D+M===this.length()&&this.format(F,G):s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"formatAt",this).call(this,D,Math.min(M,this.length()-D-1),F,G),this.cache={})}},{key:"insertAt",value:function(D,M,F){if(F!=null)return s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertAt",this).call(this,D,M,F);if(M.length!==0){var G=M.split(`
`),nt=G.shift();nt.length>0&&(D<this.length()-1||this.children.tail==null?s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertAt",this).call(this,Math.min(D,this.length()-1),nt):this.children.tail.insertAt(this.children.tail.length(),nt),this.cache={});var K=this;G.reduce(function(V,B){return K=K.split(V,!0),K.insertAt(0,B),B.length},D+nt.length)}}},{key:"insertBefore",value:function(D,M){var F=this.children.head;s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertBefore",this).call(this,D,M),F instanceof h.default&&F.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"length",this).call(this)+x),this.cache.length}},{key:"moveChildren",value:function(D,M){s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"moveChildren",this).call(this,D,M),this.cache={}}},{key:"optimize",value:function(D){s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"optimize",this).call(this,D),this.cache={}}},{key:"path",value:function(D){return s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"path",this).call(this,D,!0)}},{key:"removeChild",value:function(D){s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"removeChild",this).call(this,D),this.cache={}}},{key:"split",value:function(D){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(M&&(D===0||D>=this.length()-x)){var F=this.clone();return D===0?(this.parent.insertBefore(F,this),this):(this.parent.insertBefore(F,this.next),F)}else{var G=s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"split",this).call(this,D,M);return this.cache={},G}}}]),T}(l.default.Block);L.blotName="block",L.tagName="P",L.defaultChild="break",L.allowedChildren=[k.default,l.default.Embed,v.default];function S(C){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return C==null||(typeof C.formats=="function"&&(T=(0,a.default)(T,C.formats())),C.parent==null||C.parent.blotName=="scroll"||C.parent.statics.scope!==C.statics.scope)?T:S(C.parent,T)}r.bubbleFormats=S,r.BlockEmbed=O,r.default=L},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.overload=r.expandConfig=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},s=function(){function K(V,B){var H=[],$=!0,J=!1,X=void 0;try{for(var j=V[Symbol.iterator](),Z;!($=(Z=j.next()).done)&&(H.push(Z.value),!(B&&H.length===B));$=!0);}catch(et){J=!0,X=et}finally{try{!$&&j.return&&j.return()}finally{if(J)throw X}}return H}return function(V,B){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return K(V,B);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function K(V,B){for(var H=0;H<B.length;H++){var $=B[H];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(V,$.key,$)}}return function(V,B,H){return B&&K(V.prototype,B),H&&K(V,H),V}}();i(50);var a=i(2),y=S(a),g=i(14),u=S(g),l=i(8),f=S(l),h=i(9),m=S(h),k=i(0),b=S(k),v=i(15),d=S(v),p=i(3),w=S(p),E=i(10),x=S(E),O=i(34),L=S(O);function S(K){return K&&K.__esModule?K:{default:K}}function C(K,V,B){return V in K?Object.defineProperty(K,V,{value:B,enumerable:!0,configurable:!0,writable:!0}):K[V]=B,K}function T(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")}var N=(0,x.default)("quill"),D=function(){c(K,null,[{key:"debug",value:function(B){B===!0&&(B="log"),x.default.level(B)}},{key:"find",value:function(B){return B.__quill||b.default.find(B)}},{key:"import",value:function(B){return this.imports[B]==null&&N.error("Cannot import "+B+". Are you sure it was registered?"),this.imports[B]}},{key:"register",value:function(B,H){var $=this,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof B!="string"){var X=B.attrName||B.blotName;typeof X=="string"?this.register("formats/"+X,B,H):Object.keys(B).forEach(function(j){$.register(j,B[j],H)})}else this.imports[B]!=null&&!J&&N.warn("Overwriting "+B+" with",H),this.imports[B]=H,(B.startsWith("blots/")||B.startsWith("formats/"))&&H.blotName!=="abstract"?b.default.register(H):B.startsWith("modules")&&typeof H.register=="function"&&H.register()}}]);function K(V){var B=this,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(T(this,K),this.options=M(V,H),this.container=this.options.container,this.container==null)return N.error("Invalid Quill container",V);this.options.debug&&K.debug(this.options.debug);var $=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new f.default,this.scroll=b.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new u.default(this.scroll),this.selection=new d.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(f.default.events.EDITOR_CHANGE,function(X){X===f.default.events.TEXT_CHANGE&&B.root.classList.toggle("ql-blank",B.editor.isBlank())}),this.emitter.on(f.default.events.SCROLL_UPDATE,function(X,j){var Z=B.selection.lastRange,et=Z&&Z.length===0?Z.index:void 0;F.call(B,function(){return B.editor.update(null,j,et)},X)});var J=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+$+"<p><br></p></div>");this.setContents(J),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return c(K,[{key:"addContainer",value:function(B){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof B=="string"){var $=B;B=document.createElement("div"),B.classList.add($)}return this.container.insertBefore(B,H),B}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(B,H,$){var J=this,X=G(B,H,$),j=s(X,4);return B=j[0],H=j[1],$=j[3],F.call(this,function(){return J.editor.deleteText(B,H)},$,B,-1*H)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(B),this.container.classList.toggle("ql-disabled",!B)}},{key:"focus",value:function(){var B=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=B,this.scrollIntoView()}},{key:"format",value:function(B,H){var $=this,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:f.default.sources.API;return F.call(this,function(){var X=$.getSelection(!0),j=new y.default;if(X==null)return j;if(b.default.query(B,b.default.Scope.BLOCK))j=$.editor.formatLine(X.index,X.length,C({},B,H));else{if(X.length===0)return $.selection.format(B,H),j;j=$.editor.formatText(X.index,X.length,C({},B,H))}return $.setSelection(X,f.default.sources.SILENT),j},J)}},{key:"formatLine",value:function(B,H,$,J,X){var j=this,Z=void 0,et=G(B,H,$,J,X),rt=s(et,4);return B=rt[0],H=rt[1],Z=rt[2],X=rt[3],F.call(this,function(){return j.editor.formatLine(B,H,Z)},X,B,0)}},{key:"formatText",value:function(B,H,$,J,X){var j=this,Z=void 0,et=G(B,H,$,J,X),rt=s(et,4);return B=rt[0],H=rt[1],Z=rt[2],X=rt[3],F.call(this,function(){return j.editor.formatText(B,H,Z)},X,B,0)}},{key:"getBounds",value:function(B){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=void 0;typeof B=="number"?$=this.selection.getBounds(B,H):$=this.selection.getBounds(B.index,B.length);var J=this.container.getBoundingClientRect();return{bottom:$.bottom-J.top,height:$.height,left:$.left-J.left,right:$.right-J.left,top:$.top-J.top,width:$.width}}},{key:"getContents",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-B,$=G(B,H),J=s($,2);return B=J[0],H=J[1],this.editor.getContents(B,H)}},{key:"getFormat",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof B=="number"?this.editor.getFormat(B,H):this.editor.getFormat(B.index,B.length)}},{key:"getIndex",value:function(B){return B.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(B){return this.scroll.leaf(B)}},{key:"getLine",value:function(B){return this.scroll.line(B)}},{key:"getLines",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof B!="number"?this.scroll.lines(B.index,B.length):this.scroll.lines(B,H)}},{key:"getModule",value:function(B){return this.theme.modules[B]}},{key:"getSelection",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return B&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-B,$=G(B,H),J=s($,2);return B=J[0],H=J[1],this.editor.getText(B,H)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(B,H,$){var J=this,X=arguments.length>3&&arguments[3]!==void 0?arguments[3]:K.sources.API;return F.call(this,function(){return J.editor.insertEmbed(B,H,$)},X,B)}},{key:"insertText",value:function(B,H,$,J,X){var j=this,Z=void 0,et=G(B,0,$,J,X),rt=s(et,4);return B=rt[0],Z=rt[2],X=rt[3],F.call(this,function(){return j.editor.insertText(B,H,Z)},X,B,H.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(B,H,$){this.clipboard.dangerouslyPasteHTML(B,H,$)}},{key:"removeFormat",value:function(B,H,$){var J=this,X=G(B,H,$),j=s(X,4);return B=j[0],H=j[1],$=j[3],F.call(this,function(){return J.editor.removeFormat(B,H)},$,B)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(B){var H=this,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f.default.sources.API;return F.call(this,function(){B=new y.default(B);var J=H.getLength(),X=H.editor.deleteText(0,J),j=H.editor.applyDelta(B),Z=j.ops[j.ops.length-1];Z!=null&&typeof Z.insert=="string"&&Z.insert[Z.insert.length-1]===`
`&&(H.editor.deleteText(H.getLength()-1,1),j.delete(1));var et=X.compose(j);return et},$)}},{key:"setSelection",value:function(B,H,$){if(B==null)this.selection.setRange(null,H||K.sources.API);else{var J=G(B,H,$),X=s(J,4);B=X[0],H=X[1],$=X[3],this.selection.setRange(new v.Range(B,H),$),$!==f.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(B){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f.default.sources.API,$=new y.default().insert(B);return this.setContents($,H)}},{key:"update",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f.default.sources.USER,H=this.scroll.update(B);return this.selection.update(B),H}},{key:"updateContents",value:function(B){var H=this,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f.default.sources.API;return F.call(this,function(){return B=new y.default(B),H.editor.applyDelta(B,$)},$,!0)}}]),K}();D.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},D.events=f.default.events,D.sources=f.default.sources,D.version="1.3.7",D.imports={delta:y.default,parchment:b.default,"core/module":m.default,"core/theme":L.default};function M(K,V){if(V=(0,w.default)(!0,{container:K,modules:{clipboard:!0,keyboard:!0,history:!0}},V),!V.theme||V.theme===D.DEFAULTS.theme)V.theme=L.default;else if(V.theme=D.import("themes/"+V.theme),V.theme==null)throw new Error("Invalid theme "+V.theme+". Did you register it?");var B=(0,w.default)(!0,{},V.theme.DEFAULTS);[B,V].forEach(function(J){J.modules=J.modules||{},Object.keys(J.modules).forEach(function(X){J.modules[X]===!0&&(J.modules[X]={})})});var H=Object.keys(B.modules).concat(Object.keys(V.modules)),$=H.reduce(function(J,X){var j=D.import("modules/"+X);return j==null?N.error("Cannot load "+X+" module. Are you sure you registered it?"):J[X]=j.DEFAULTS||{},J},{});return V.modules!=null&&V.modules.toolbar&&V.modules.toolbar.constructor!==Object&&(V.modules.toolbar={container:V.modules.toolbar}),V=(0,w.default)(!0,{},D.DEFAULTS,{modules:$},B,V),["bounds","container","scrollingContainer"].forEach(function(J){typeof V[J]=="string"&&(V[J]=document.querySelector(V[J]))}),V.modules=Object.keys(V.modules).reduce(function(J,X){return V.modules[X]&&(J[X]=V.modules[X]),J},{}),V}function F(K,V,B,H){if(this.options.strict&&!this.isEnabled()&&V===f.default.sources.USER)return new y.default;var $=B==null?null:this.getSelection(),J=this.editor.delta,X=K();if($!=null&&(B===!0&&(B=$.index),H==null?$=nt($,X,V):H!==0&&($=nt($,B,H,V)),this.setSelection($,f.default.sources.SILENT)),X.length()>0){var j,Z=[f.default.events.TEXT_CHANGE,X,J,V];if((j=this.emitter).emit.apply(j,[f.default.events.EDITOR_CHANGE].concat(Z)),V!==f.default.sources.SILENT){var et;(et=this.emitter).emit.apply(et,Z)}}return X}function G(K,V,B,H,$){var J={};return typeof K.index=="number"&&typeof K.length=="number"?typeof V!="number"?($=H,H=B,B=V,V=K.length,K=K.index):(V=K.length,K=K.index):typeof V!="number"&&($=H,H=B,B=V,V=0),(typeof B>"u"?"undefined":o(B))==="object"?(J=B,$=H):typeof B=="string"&&(H!=null?J[B]=H:$=B),$=$||f.default.sources.API,[K,V,J,$]}function nt(K,V,B,H){if(K==null)return null;var $=void 0,J=void 0;if(V instanceof y.default){var X=[K.index,K.index+K.length].map(function(rt){return V.transformPosition(rt,H!==f.default.sources.USER)}),j=s(X,2);$=j[0],J=j[1]}else{var Z=[K.index,K.index+K.length].map(function(rt){return rt<V||rt===V&&H===f.default.sources.USER?rt:B>=0?rt+B:Math.max(V,rt+B)}),et=s(Z,2);$=et[0],J=et[1]}return new v.Range($,J-$)}r.expandConfig=M,r.overload=G,r.default=D},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function k(b,v){for(var d=0;d<v.length;d++){var p=v[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,v,d){return v&&k(b.prototype,v),d&&k(b,d),b}}(),s=function k(b,v,d){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,v);if(p===void 0){var w=Object.getPrototypeOf(b);return w===null?void 0:k(w,v,d)}else{if("value"in p)return p.value;var E=p.get;return E===void 0?void 0:E.call(d)}},c=i(7),a=u(c),y=i(0),g=u(y);function u(k){return k&&k.__esModule?k:{default:k}}function l(k,b){if(!(k instanceof b))throw new TypeError("Cannot call a class as a function")}function f(k,b){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:k}function h(k,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);k.prototype=Object.create(b&&b.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(k,b):k.__proto__=b)}var m=function(k){h(b,k);function b(){return l(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"formatAt",value:function(d,p,w,E){if(b.compare(this.statics.blotName,w)<0&&g.default.query(w,g.default.Scope.BLOT)){var x=this.isolate(d,p);E&&x.wrap(w,E)}else s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"formatAt",this).call(this,d,p,w,E)}},{key:"optimize",value:function(d){if(s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,d),this.parent instanceof b&&b.compare(this.statics.blotName,this.parent.statics.blotName)>0){var p=this.parent.isolate(this.offset(),this.length());this.moveChildren(p),p.wrap(this)}}}],[{key:"compare",value:function(d,p){var w=b.order.indexOf(d),E=b.order.indexOf(p);return w>=0||E>=0?w-E:d===p?0:d<p?-1:1}}]),b}(g.default.Inline);m.allowedChildren=[m,g.default.Embed,a.default],m.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],r.default=m},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function a(l,f){if(!(l instanceof f))throw new TypeError("Cannot call a class as a function")}function y(l,f){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:l}function g(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);l.prototype=Object.create(f&&f.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(l,f):l.__proto__=f)}var u=function(l){g(f,l);function f(){return a(this,f),y(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return f}(s.default.Text);r.default=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function v(d,p){for(var w=0;w<p.length;w++){var E=p[w];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(d,E.key,E)}}return function(d,p,w){return p&&v(d.prototype,p),w&&v(d,w),d}}(),s=function v(d,p,w){d===null&&(d=Function.prototype);var E=Object.getOwnPropertyDescriptor(d,p);if(E===void 0){var x=Object.getPrototypeOf(d);return x===null?void 0:v(x,p,w)}else{if("value"in E)return E.value;var O=E.get;return O===void 0?void 0:O.call(w)}},c=i(54),a=u(c),y=i(10),g=u(y);function u(v){return v&&v.__esModule?v:{default:v}}function l(v,d){if(!(v instanceof d))throw new TypeError("Cannot call a class as a function")}function f(v,d){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:v}function h(v,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);v.prototype=Object.create(d&&d.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(v,d):v.__proto__=d)}var m=(0,g.default)("quill:events"),k=["selectionchange","mousedown","mouseup","click"];k.forEach(function(v){document.addEventListener(v,function(){for(var d=arguments.length,p=Array(d),w=0;w<d;w++)p[w]=arguments[w];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(E){if(E.__quill&&E.__quill.emitter){var x;(x=E.__quill.emitter).handleDOM.apply(x,p)}})})});var b=function(v){h(d,v);function d(){l(this,d);var p=f(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));return p.listeners={},p.on("error",m.error),p}return o(d,[{key:"emit",value:function(){m.log.apply(m,arguments),s(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(w){for(var E=arguments.length,x=Array(E>1?E-1:0),O=1;O<E;O++)x[O-1]=arguments[O];(this.listeners[w.type]||[]).forEach(function(L){var S=L.node,C=L.handler;(w.target===S||S.contains(w.target))&&C.apply(void 0,[w].concat(x))})}},{key:"listenDOM",value:function(w,E,x){this.listeners[w]||(this.listeners[w]=[]),this.listeners[w].push({node:E,handler:x})}}]),d}(a.default);b.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.sources={API:"api",SILENT:"silent",USER:"user"},r.default=b},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});function o(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function")}var s=function c(a){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o(this,c),this.quill=a,this.options=y};s.DEFAULTS={},r.default=s},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=["error","warn","log","info"],s="warn";function c(y){if(o.indexOf(y)<=o.indexOf(s)){for(var g,u=arguments.length,l=Array(u>1?u-1:0),f=1;f<u;f++)l[f-1]=arguments[f];(g=console)[y].apply(g,l)}}function a(y){return o.reduce(function(g,u){return g[u]=c.bind(console,u,y),g},{})}c.level=a.level=function(y){s=y},r.default=a},function(e,r,i){var o=Array.prototype.slice,s=i(52),c=i(53),a=e.exports=function(l,f,h){return h||(h={}),l===f?!0:l instanceof Date&&f instanceof Date?l.getTime()===f.getTime():!l||!f||typeof l!="object"&&typeof f!="object"?h.strict?l===f:l==f:u(l,f,h)};function y(l){return l==null}function g(l){return!(!l||typeof l!="object"||typeof l.length!="number"||typeof l.copy!="function"||typeof l.slice!="function"||l.length>0&&typeof l[0]!="number")}function u(l,f,h){var m,k;if(y(l)||y(f)||l.prototype!==f.prototype)return!1;if(c(l))return c(f)?(l=o.call(l),f=o.call(f),a(l,f,h)):!1;if(g(l)){if(!g(f)||l.length!==f.length)return!1;for(m=0;m<l.length;m++)if(l[m]!==f[m])return!1;return!0}try{var b=s(l),v=s(f)}catch{return!1}if(b.length!=v.length)return!1;for(b.sort(),v.sort(),m=b.length-1;m>=0;m--)if(b[m]!=v[m])return!1;for(m=b.length-1;m>=0;m--)if(k=b[m],!a(l[k],f[k],h))return!1;return typeof l==typeof f}},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),s=function(){function c(a,y,g){g===void 0&&(g={}),this.attrName=a,this.keyName=y;var u=o.Scope.TYPE&o.Scope.ATTRIBUTE;g.scope!=null?this.scope=g.scope&o.Scope.LEVEL|u:this.scope=o.Scope.ATTRIBUTE,g.whitelist!=null&&(this.whitelist=g.whitelist)}return c.keys=function(a){return[].map.call(a.attributes,function(y){return y.name})},c.prototype.add=function(a,y){return this.canAdd(a,y)?(a.setAttribute(this.keyName,y),!0):!1},c.prototype.canAdd=function(a,y){var g=o.query(a,o.Scope.BLOT&(this.scope|o.Scope.TYPE));return g==null?!1:this.whitelist==null?!0:typeof y=="string"?this.whitelist.indexOf(y.replace(/["']/g,""))>-1:this.whitelist.indexOf(y)>-1},c.prototype.remove=function(a){a.removeAttribute(this.keyName)},c.prototype.value=function(a){var y=a.getAttribute(this.keyName);return this.canAdd(a,y)&&y?y:""},c}();r.default=s},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Code=void 0;var o=function(){function O(L,S){var C=[],T=!0,N=!1,D=void 0;try{for(var M=L[Symbol.iterator](),F;!(T=(F=M.next()).done)&&(C.push(F.value),!(S&&C.length===S));T=!0);}catch(G){N=!0,D=G}finally{try{!T&&M.return&&M.return()}finally{if(N)throw D}}return C}return function(L,S){if(Array.isArray(L))return L;if(Symbol.iterator in Object(L))return O(L,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function O(L,S){for(var C=0;C<S.length;C++){var T=S[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(L,T.key,T)}}return function(L,S,C){return S&&O(L.prototype,S),C&&O(L,C),L}}(),c=function O(L,S,C){L===null&&(L=Function.prototype);var T=Object.getOwnPropertyDescriptor(L,S);if(T===void 0){var N=Object.getPrototypeOf(L);return N===null?void 0:O(N,S,C)}else{if("value"in T)return T.value;var D=T.get;return D===void 0?void 0:D.call(C)}},a=i(2),y=v(a),g=i(0),u=v(g),l=i(4),f=v(l),h=i(6),m=v(h),k=i(7),b=v(k);function v(O){return O&&O.__esModule?O:{default:O}}function d(O,L){if(!(O instanceof L))throw new TypeError("Cannot call a class as a function")}function p(O,L){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L&&(typeof L=="object"||typeof L=="function")?L:O}function w(O,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof L);O.prototype=Object.create(L&&L.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),L&&(Object.setPrototypeOf?Object.setPrototypeOf(O,L):O.__proto__=L)}var E=function(O){w(L,O);function L(){return d(this,L),p(this,(L.__proto__||Object.getPrototypeOf(L)).apply(this,arguments))}return L}(m.default);E.blotName="code",E.tagName="CODE";var x=function(O){w(L,O);function L(){return d(this,L),p(this,(L.__proto__||Object.getPrototypeOf(L)).apply(this,arguments))}return s(L,[{key:"delta",value:function(){var C=this,T=this.domNode.textContent;return T.endsWith(`
`)&&(T=T.slice(0,-1)),T.split(`
`).reduce(function(N,D){return N.insert(D).insert(`
`,C.formats())},new y.default)}},{key:"format",value:function(C,T){if(!(C===this.statics.blotName&&T)){var N=this.descendant(b.default,this.length()-1),D=o(N,1),M=D[0];M!=null&&M.deleteAt(M.length()-1,1),c(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"format",this).call(this,C,T)}}},{key:"formatAt",value:function(C,T,N,D){if(T!==0&&!(u.default.query(N,u.default.Scope.BLOCK)==null||N===this.statics.blotName&&D===this.statics.formats(this.domNode))){var M=this.newlineIndex(C);if(!(M<0||M>=C+T)){var F=this.newlineIndex(C,!0)+1,G=M-F+1,nt=this.isolate(F,G),K=nt.next;nt.format(N,D),K instanceof L&&K.formatAt(0,C-F+T-G,N,D)}}}},{key:"insertAt",value:function(C,T,N){if(N==null){var D=this.descendant(b.default,C),M=o(D,2),F=M[0],G=M[1];F.insertAt(G,T)}}},{key:"length",value:function(){var C=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?C:C+1}},{key:"newlineIndex",value:function(C){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(T)return this.domNode.textContent.slice(0,C).lastIndexOf(`
`);var N=this.domNode.textContent.slice(C).indexOf(`
`);return N>-1?C+N:-1}},{key:"optimize",value:function(C){this.domNode.textContent.endsWith(`
`)||this.appendChild(u.default.create("text",`
`)),c(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"optimize",this).call(this,C);var T=this.next;T!=null&&T.prev===this&&T.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===T.statics.formats(T.domNode)&&(T.optimize(C),T.moveChildren(this),T.remove())}},{key:"replace",value:function(C){c(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"replace",this).call(this,C),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(T){var N=u.default.find(T);N==null?T.parentNode.removeChild(T):N instanceof u.default.Embed?N.remove():N.unwrap()})}}],[{key:"create",value:function(C){var T=c(L.__proto__||Object.getPrototypeOf(L),"create",this).call(this,C);return T.setAttribute("spellcheck",!1),T}},{key:"formats",value:function(){return!0}}]),L}(f.default);x.blotName="code-block",x.tagName="PRE",x.TAB="  ",r.Code=E,r.default=x},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},s=function(){function K(V,B){var H=[],$=!0,J=!1,X=void 0;try{for(var j=V[Symbol.iterator](),Z;!($=(Z=j.next()).done)&&(H.push(Z.value),!(B&&H.length===B));$=!0);}catch(et){J=!0,X=et}finally{try{!$&&j.return&&j.return()}finally{if(J)throw X}}return H}return function(V,B){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return K(V,B);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function K(V,B){for(var H=0;H<B.length;H++){var $=B[H];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(V,$.key,$)}}return function(V,B,H){return B&&K(V.prototype,B),H&&K(V,H),V}}(),a=i(2),y=T(a),g=i(20),u=T(g),l=i(0),f=T(l),h=i(13),m=T(h),k=i(24),b=T(k),v=i(4),d=T(v),p=i(16),w=T(p),E=i(21),x=T(E),O=i(11),L=T(O),S=i(3),C=T(S);function T(K){return K&&K.__esModule?K:{default:K}}function N(K,V,B){return V in K?Object.defineProperty(K,V,{value:B,enumerable:!0,configurable:!0,writable:!0}):K[V]=B,K}function D(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")}var M=/^[ -~]*$/,F=function(){function K(V){D(this,K),this.scroll=V,this.delta=this.getDelta()}return c(K,[{key:"applyDelta",value:function(B){var H=this,$=!1;this.scroll.update();var J=this.scroll.length();return this.scroll.batchStart(),B=nt(B),B.reduce(function(X,j){var Z=j.retain||j.delete||j.insert.length||1,et=j.attributes||{};if(j.insert!=null){if(typeof j.insert=="string"){var rt=j.insert;rt.endsWith(`
`)&&$&&($=!1,rt=rt.slice(0,-1)),X>=J&&!rt.endsWith(`
`)&&($=!0),H.scroll.insertAt(X,rt);var st=H.scroll.line(X),ct=s(st,2),vt=ct[0],pt=ct[1],gt=(0,C.default)({},(0,v.bubbleFormats)(vt));if(vt instanceof d.default){var I=vt.descendant(f.default.Leaf,pt),U=s(I,1),W=U[0];gt=(0,C.default)(gt,(0,v.bubbleFormats)(W))}et=u.default.attributes.diff(gt,et)||{}}else if(o(j.insert)==="object"){var q=Object.keys(j.insert)[0];if(q==null)return X;H.scroll.insertAt(X,q,j.insert[q])}J+=Z}return Object.keys(et).forEach(function(P){H.scroll.formatAt(X,Z,P,et[P])}),X+Z},0),B.reduce(function(X,j){return typeof j.delete=="number"?(H.scroll.deleteAt(X,j.delete),X):X+(j.retain||j.insert.length||1)},0),this.scroll.batchEnd(),this.update(B)}},{key:"deleteText",value:function(B,H){return this.scroll.deleteAt(B,H),this.update(new y.default().retain(B).delete(H))}},{key:"formatLine",value:function(B,H){var $=this,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(J).forEach(function(X){if(!($.scroll.whitelist!=null&&!$.scroll.whitelist[X])){var j=$.scroll.lines(B,Math.max(H,1)),Z=H;j.forEach(function(et){var rt=et.length();if(!(et instanceof m.default))et.format(X,J[X]);else{var st=B-et.offset($.scroll),ct=et.newlineIndex(st+Z)-st+1;et.formatAt(st,ct,X,J[X])}Z-=rt})}}),this.scroll.optimize(),this.update(new y.default().retain(B).retain(H,(0,x.default)(J)))}},{key:"formatText",value:function(B,H){var $=this,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(J).forEach(function(X){$.scroll.formatAt(B,H,X,J[X])}),this.update(new y.default().retain(B).retain(H,(0,x.default)(J)))}},{key:"getContents",value:function(B,H){return this.delta.slice(B,B+H)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(B,H){return B.concat(H.delta())},new y.default)}},{key:"getFormat",value:function(B){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=[],J=[];H===0?this.scroll.path(B).forEach(function(j){var Z=s(j,1),et=Z[0];et instanceof d.default?$.push(et):et instanceof f.default.Leaf&&J.push(et)}):($=this.scroll.lines(B,H),J=this.scroll.descendants(f.default.Leaf,B,H));var X=[$,J].map(function(j){if(j.length===0)return{};for(var Z=(0,v.bubbleFormats)(j.shift());Object.keys(Z).length>0;){var et=j.shift();if(et==null)return Z;Z=G((0,v.bubbleFormats)(et),Z)}return Z});return C.default.apply(C.default,X)}},{key:"getText",value:function(B,H){return this.getContents(B,H).filter(function($){return typeof $.insert=="string"}).map(function($){return $.insert}).join("")}},{key:"insertEmbed",value:function(B,H,$){return this.scroll.insertAt(B,H,$),this.update(new y.default().retain(B).insert(N({},H,$)))}},{key:"insertText",value:function(B,H){var $=this,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return H=H.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(B,H),Object.keys(J).forEach(function(X){$.scroll.formatAt(B,H.length,X,J[X])}),this.update(new y.default().retain(B).insert(H,(0,x.default)(J)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var B=this.scroll.children.head;return B.statics.blotName!==d.default.blotName||B.children.length>1?!1:B.children.head instanceof w.default}},{key:"removeFormat",value:function(B,H){var $=this.getText(B,H),J=this.scroll.line(B+H),X=s(J,2),j=X[0],Z=X[1],et=0,rt=new y.default;j!=null&&(j instanceof m.default?et=j.newlineIndex(Z)-Z+1:et=j.length()-Z,rt=j.delta().slice(Z,Z+et-1).insert(`
`));var st=this.getContents(B,H+et),ct=st.diff(new y.default().insert($).concat(rt)),vt=new y.default().retain(B).concat(ct);return this.applyDelta(vt)}},{key:"update",value:function(B){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,J=this.delta;if(H.length===1&&H[0].type==="characterData"&&H[0].target.data.match(M)&&f.default.find(H[0].target)){var X=f.default.find(H[0].target),j=(0,v.bubbleFormats)(X),Z=X.offset(this.scroll),et=H[0].oldValue.replace(b.default.CONTENTS,""),rt=new y.default().insert(et),st=new y.default().insert(X.value()),ct=new y.default().retain(Z).concat(rt.diff(st,$));B=ct.reduce(function(vt,pt){return pt.insert?vt.insert(pt.insert,j):vt.push(pt)},new y.default),this.delta=J.compose(B)}else this.delta=this.getDelta(),(!B||!(0,L.default)(J.compose(B),this.delta))&&(B=J.diff(this.delta,$));return B}}]),K}();function G(K,V){return Object.keys(V).reduce(function(B,H){return K[H]==null||(V[H]===K[H]?B[H]=V[H]:Array.isArray(V[H])?V[H].indexOf(K[H])<0&&(B[H]=V[H].concat([K[H]])):B[H]=[V[H],K[H]]),B},{})}function nt(K){return K.reduce(function(V,B){if(B.insert===1){var H=(0,x.default)(B.attributes);return delete H.image,V.insert({image:B.attributes.image},H)}if(B.attributes!=null&&(B.attributes.list===!0||B.attributes.bullet===!0)&&(B=(0,x.default)(B),B.attributes.list?B.attributes.list="ordered":(B.attributes.list="bullet",delete B.attributes.bullet)),typeof B.insert=="string"){var $=B.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return V.insert($,B.attributes)}return V.push(B)},new y.default)}r.default=F},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Range=void 0;var o=function(){function O(L,S){var C=[],T=!0,N=!1,D=void 0;try{for(var M=L[Symbol.iterator](),F;!(T=(F=M.next()).done)&&(C.push(F.value),!(S&&C.length===S));T=!0);}catch(G){N=!0,D=G}finally{try{!T&&M.return&&M.return()}finally{if(N)throw D}}return C}return function(L,S){if(Array.isArray(L))return L;if(Symbol.iterator in Object(L))return O(L,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function O(L,S){for(var C=0;C<S.length;C++){var T=S[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(L,T.key,T)}}return function(L,S,C){return S&&O(L.prototype,S),C&&O(L,C),L}}(),c=i(0),a=b(c),y=i(21),g=b(y),u=i(11),l=b(u),f=i(8),h=b(f),m=i(10),k=b(m);function b(O){return O&&O.__esModule?O:{default:O}}function v(O){if(Array.isArray(O)){for(var L=0,S=Array(O.length);L<O.length;L++)S[L]=O[L];return S}else return Array.from(O)}function d(O,L){if(!(O instanceof L))throw new TypeError("Cannot call a class as a function")}var p=(0,k.default)("quill:selection"),w=function O(L){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;d(this,O),this.index=L,this.length=S},E=function(){function O(L,S){var C=this;d(this,O),this.emitter=S,this.scroll=L,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=a.default.create("cursor",this),this.lastRange=this.savedRange=new w(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){C.mouseDown||setTimeout(C.update.bind(C,h.default.sources.USER),1)}),this.emitter.on(h.default.events.EDITOR_CHANGE,function(T,N){T===h.default.events.TEXT_CHANGE&&N.length()>0&&C.update(h.default.sources.SILENT)}),this.emitter.on(h.default.events.SCROLL_BEFORE_UPDATE,function(){if(!!C.hasFocus()){var T=C.getNativeRange();T!=null&&T.start.node!==C.cursor.textNode&&C.emitter.once(h.default.events.SCROLL_UPDATE,function(){try{C.setNativeRange(T.start.node,T.start.offset,T.end.node,T.end.offset)}catch{}})}}),this.emitter.on(h.default.events.SCROLL_OPTIMIZE,function(T,N){if(N.range){var D=N.range,M=D.startNode,F=D.startOffset,G=D.endNode,nt=D.endOffset;C.setNativeRange(M,F,G,nt)}}),this.update(h.default.sources.SILENT)}return s(O,[{key:"handleComposition",value:function(){var S=this;this.root.addEventListener("compositionstart",function(){S.composing=!0}),this.root.addEventListener("compositionend",function(){if(S.composing=!1,S.cursor.parent){var C=S.cursor.restore();if(!C)return;setTimeout(function(){S.setNativeRange(C.startNode,C.startOffset,C.endNode,C.endOffset)},1)}})}},{key:"handleDragging",value:function(){var S=this;this.emitter.listenDOM("mousedown",document.body,function(){S.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){S.mouseDown=!1,S.update(h.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(S,C){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[S])){this.scroll.update();var T=this.getNativeRange();if(!(T==null||!T.native.collapsed||a.default.query(S,a.default.Scope.BLOCK))){if(T.start.node!==this.cursor.textNode){var N=a.default.find(T.start.node,!1);if(N==null)return;if(N instanceof a.default.Leaf){var D=N.split(T.start.offset);N.parent.insertBefore(this.cursor,D)}else N.insertBefore(this.cursor,T.start.node);this.cursor.attach()}this.cursor.format(S,C),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(S){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=this.scroll.length();S=Math.min(S,T-1),C=Math.min(S+C,T-1)-S;var N=void 0,D=this.scroll.leaf(S),M=o(D,2),F=M[0],G=M[1];if(F==null)return null;var nt=F.position(G,!0),K=o(nt,2);N=K[0],G=K[1];var V=document.createRange();if(C>0){V.setStart(N,G);var B=this.scroll.leaf(S+C),H=o(B,2);if(F=H[0],G=H[1],F==null)return null;var $=F.position(G,!0),J=o($,2);return N=J[0],G=J[1],V.setEnd(N,G),V.getBoundingClientRect()}else{var X="left",j=void 0;return N instanceof Text?(G<N.data.length?(V.setStart(N,G),V.setEnd(N,G+1)):(V.setStart(N,G-1),V.setEnd(N,G),X="right"),j=V.getBoundingClientRect()):(j=F.domNode.getBoundingClientRect(),G>0&&(X="right")),{bottom:j.top+j.height,height:j.height,left:j[X],right:j[X],top:j.top,width:0}}}},{key:"getNativeRange",value:function(){var S=document.getSelection();if(S==null||S.rangeCount<=0)return null;var C=S.getRangeAt(0);if(C==null)return null;var T=this.normalizeNative(C);return p.info("getNativeRange",T),T}},{key:"getRange",value:function(){var S=this.getNativeRange();if(S==null)return[null,null];var C=this.normalizedToRange(S);return[C,S]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(S){var C=this,T=[[S.start.node,S.start.offset]];S.native.collapsed||T.push([S.end.node,S.end.offset]);var N=T.map(function(F){var G=o(F,2),nt=G[0],K=G[1],V=a.default.find(nt,!0),B=V.offset(C.scroll);return K===0?B:V instanceof a.default.Container?B+V.length():B+V.index(nt,K)}),D=Math.min(Math.max.apply(Math,v(N)),this.scroll.length()-1),M=Math.min.apply(Math,[D].concat(v(N)));return new w(M,D-M)}},{key:"normalizeNative",value:function(S){if(!x(this.root,S.startContainer)||!S.collapsed&&!x(this.root,S.endContainer))return null;var C={start:{node:S.startContainer,offset:S.startOffset},end:{node:S.endContainer,offset:S.endOffset},native:S};return[C.start,C.end].forEach(function(T){for(var N=T.node,D=T.offset;!(N instanceof Text)&&N.childNodes.length>0;)if(N.childNodes.length>D)N=N.childNodes[D],D=0;else if(N.childNodes.length===D)N=N.lastChild,D=N instanceof Text?N.data.length:N.childNodes.length+1;else break;T.node=N,T.offset=D}),C}},{key:"rangeToNative",value:function(S){var C=this,T=S.collapsed?[S.index]:[S.index,S.index+S.length],N=[],D=this.scroll.length();return T.forEach(function(M,F){M=Math.min(D-1,M);var G=void 0,nt=C.scroll.leaf(M),K=o(nt,2),V=K[0],B=K[1],H=V.position(B,F!==0),$=o(H,2);G=$[0],B=$[1],N.push(G,B)}),N.length<2&&(N=N.concat(N)),N}},{key:"scrollIntoView",value:function(S){var C=this.lastRange;if(C!=null){var T=this.getBounds(C.index,C.length);if(T!=null){var N=this.scroll.length()-1,D=this.scroll.line(Math.min(C.index,N)),M=o(D,1),F=M[0],G=F;if(C.length>0){var nt=this.scroll.line(Math.min(C.index+C.length,N)),K=o(nt,1);G=K[0]}if(!(F==null||G==null)){var V=S.getBoundingClientRect();T.top<V.top?S.scrollTop-=V.top-T.top:T.bottom>V.bottom&&(S.scrollTop+=T.bottom-V.bottom)}}}}},{key:"setNativeRange",value:function(S,C){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S,N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:C,D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(p.info("setNativeRange",S,C,T,N),!(S!=null&&(this.root.parentNode==null||S.parentNode==null||T.parentNode==null))){var M=document.getSelection();if(M!=null)if(S!=null){this.hasFocus()||this.root.focus();var F=(this.getNativeRange()||{}).native;if(F==null||D||S!==F.startContainer||C!==F.startOffset||T!==F.endContainer||N!==F.endOffset){S.tagName=="BR"&&(C=[].indexOf.call(S.parentNode.childNodes,S),S=S.parentNode),T.tagName=="BR"&&(N=[].indexOf.call(T.parentNode.childNodes,T),T=T.parentNode);var G=document.createRange();G.setStart(S,C),G.setEnd(T,N),M.removeAllRanges(),M.addRange(G)}}else M.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(S){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h.default.sources.API;if(typeof C=="string"&&(T=C,C=!1),p.info("setRange",S),S!=null){var N=this.rangeToNative(S);this.setNativeRange.apply(this,v(N).concat([C]))}else this.setNativeRange(null);this.update(T)}},{key:"update",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h.default.sources.USER,C=this.lastRange,T=this.getRange(),N=o(T,2),D=N[0],M=N[1];if(this.lastRange=D,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,l.default)(C,this.lastRange)){var F;!this.composing&&M!=null&&M.native.collapsed&&M.start.node!==this.cursor.textNode&&this.cursor.restore();var G=[h.default.events.SELECTION_CHANGE,(0,g.default)(this.lastRange),(0,g.default)(C),S];if((F=this.emitter).emit.apply(F,[h.default.events.EDITOR_CHANGE].concat(G)),S!==h.default.sources.SILENT){var nt;(nt=this.emitter).emit.apply(nt,G)}}}}]),O}();function x(O,L){try{L.parentNode}catch{return!1}return L instanceof Text&&(L=L.parentNode),O.contains(L)}r.Range=w,r.default=E},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,k){for(var b=0;b<k.length;b++){var v=k[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,k,b){return k&&h(m.prototype,k),b&&h(m,b),m}}(),s=function h(m,k,b){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,k);if(v===void 0){var d=Object.getPrototypeOf(m);return d===null?void 0:h(d,k,b)}else{if("value"in v)return v.value;var p=v.get;return p===void 0?void 0:p.call(b)}},c=i(0),a=y(c);function y(h){return h&&h.__esModule?h:{default:h}}function g(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function u(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=function(h){l(m,h);function m(){return g(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return o(m,[{key:"insertInto",value:function(b,v){b.children.length===0?s(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"insertInto",this).call(this,b,v):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),m}(a.default.Embed);f.blotName="break",f.tagName="BR",r.default=f},function(e,r,i){var o=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,f){l.__proto__=f}||function(l,f){for(var h in f)f.hasOwnProperty(h)&&(l[h]=f[h])};return function(l,f){u(l,f);function h(){this.constructor=l}l.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(44),c=i(30),a=i(1),y=function(u){o(l,u);function l(f){var h=u.call(this,f)||this;return h.build(),h}return l.prototype.appendChild=function(f){this.insertBefore(f)},l.prototype.attach=function(){u.prototype.attach.call(this),this.children.forEach(function(f){f.attach()})},l.prototype.build=function(){var f=this;this.children=new s.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(h){try{var m=g(h);f.insertBefore(m,f.children.head||void 0)}catch(k){if(k instanceof a.ParchmentError)return;throw k}})},l.prototype.deleteAt=function(f,h){if(f===0&&h===this.length())return this.remove();this.children.forEachAt(f,h,function(m,k,b){m.deleteAt(k,b)})},l.prototype.descendant=function(f,h){var m=this.children.find(h),k=m[0],b=m[1];return f.blotName==null&&f(k)||f.blotName!=null&&k instanceof f?[k,b]:k instanceof l?k.descendant(f,b):[null,-1]},l.prototype.descendants=function(f,h,m){h===void 0&&(h=0),m===void 0&&(m=Number.MAX_VALUE);var k=[],b=m;return this.children.forEachAt(h,m,function(v,d,p){(f.blotName==null&&f(v)||f.blotName!=null&&v instanceof f)&&k.push(v),v instanceof l&&(k=k.concat(v.descendants(f,d,b))),b-=p}),k},l.prototype.detach=function(){this.children.forEach(function(f){f.detach()}),u.prototype.detach.call(this)},l.prototype.formatAt=function(f,h,m,k){this.children.forEachAt(f,h,function(b,v,d){b.formatAt(v,d,m,k)})},l.prototype.insertAt=function(f,h,m){var k=this.children.find(f),b=k[0],v=k[1];if(b)b.insertAt(v,h,m);else{var d=m==null?a.create("text",h):a.create(h,m);this.appendChild(d)}},l.prototype.insertBefore=function(f,h){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(m){return f instanceof m}))throw new a.ParchmentError("Cannot insert "+f.statics.blotName+" into "+this.statics.blotName);f.insertInto(this,h)},l.prototype.length=function(){return this.children.reduce(function(f,h){return f+h.length()},0)},l.prototype.moveChildren=function(f,h){this.children.forEach(function(m){f.insertBefore(m,h)})},l.prototype.optimize=function(f){if(u.prototype.optimize.call(this,f),this.children.length===0)if(this.statics.defaultChild!=null){var h=a.create(this.statics.defaultChild);this.appendChild(h),h.optimize(f)}else this.remove()},l.prototype.path=function(f,h){h===void 0&&(h=!1);var m=this.children.find(f,h),k=m[0],b=m[1],v=[[this,f]];return k instanceof l?v.concat(k.path(b,h)):(k!=null&&v.push([k,b]),v)},l.prototype.removeChild=function(f){this.children.remove(f)},l.prototype.replace=function(f){f instanceof l&&f.moveChildren(this),u.prototype.replace.call(this,f)},l.prototype.split=function(f,h){if(h===void 0&&(h=!1),!h){if(f===0)return this;if(f===this.length())return this.next}var m=this.clone();return this.parent.insertBefore(m,this.next),this.children.forEachAt(f,this.length(),function(k,b,v){k=k.split(b,h),m.appendChild(k)}),m},l.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},l.prototype.update=function(f,h){var m=this,k=[],b=[];f.forEach(function(v){v.target===m.domNode&&v.type==="childList"&&(k.push.apply(k,v.addedNodes),b.push.apply(b,v.removedNodes))}),b.forEach(function(v){if(!(v.parentNode!=null&&v.tagName!=="IFRAME"&&document.body.compareDocumentPosition(v)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var d=a.find(v);d!=null&&(d.domNode.parentNode==null||d.domNode.parentNode===m.domNode)&&d.detach()}}),k.filter(function(v){return v.parentNode==m.domNode}).sort(function(v,d){return v===d?0:v.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(v){var d=null;v.nextSibling!=null&&(d=a.find(v.nextSibling));var p=g(v);(p.next!=d||p.next==null)&&(p.parent!=null&&p.parent.removeChild(m),m.insertBefore(p,d||void 0))})},l}(c.default);function g(u){var l=a.find(u);if(l==null)try{l=a.create(u)}catch{l=a.create(a.Scope.INLINE),[].slice.call(u.childNodes).forEach(function(h){l.domNode.appendChild(h)}),u.parentNode&&u.parentNode.replaceChild(l.domNode,u),l.attach()}return l}r.default=y},function(e,r,i){var o=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,f){l.__proto__=f}||function(l,f){for(var h in f)f.hasOwnProperty(h)&&(l[h]=f[h])};return function(l,f){u(l,f);function h(){this.constructor=l}l.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(12),c=i(31),a=i(17),y=i(1),g=function(u){o(l,u);function l(f){var h=u.call(this,f)||this;return h.attributes=new c.default(h.domNode),h}return l.formats=function(f){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return f.tagName.toLowerCase()},l.prototype.format=function(f,h){var m=y.query(f);m instanceof s.default?this.attributes.attribute(m,h):h&&m!=null&&(f!==this.statics.blotName||this.formats()[f]!==h)&&this.replaceWith(f,h)},l.prototype.formats=function(){var f=this.attributes.values(),h=this.statics.formats(this.domNode);return h!=null&&(f[this.statics.blotName]=h),f},l.prototype.replaceWith=function(f,h){var m=u.prototype.replaceWith.call(this,f,h);return this.attributes.copy(m),m},l.prototype.update=function(f,h){var m=this;u.prototype.update.call(this,f,h),f.some(function(k){return k.target===m.domNode&&k.type==="attributes"})&&this.attributes.build()},l.prototype.wrap=function(f,h){var m=u.prototype.wrap.call(this,f,h);return m instanceof l&&m.statics.scope===this.statics.scope&&this.attributes.move(m),m},l}(a.default);r.default=g},function(e,r,i){var o=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,u){g.__proto__=u}||function(g,u){for(var l in u)u.hasOwnProperty(l)&&(g[l]=u[l])};return function(g,u){y(g,u);function l(){this.constructor=g}g.prototype=u===null?Object.create(u):(l.prototype=u.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(30),c=i(1),a=function(y){o(g,y);function g(){return y!==null&&y.apply(this,arguments)||this}return g.value=function(u){return!0},g.prototype.index=function(u,l){return this.domNode===u||this.domNode.compareDocumentPosition(u)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(l,1):-1},g.prototype.position=function(u,l){var f=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return u>0&&(f+=1),[this.parent.domNode,f]},g.prototype.value=function(){var u;return u={},u[this.statics.blotName]=this.statics.value(this.domNode)||!0,u},g.scope=c.Scope.INLINE_BLOT,g}(s.default);r.default=a},function(e,r,i){var o=i(11),s=i(3),c={attributes:{compose:function(y,g,u){typeof y!="object"&&(y={}),typeof g!="object"&&(g={});var l=s(!0,{},g);u||(l=Object.keys(l).reduce(function(h,m){return l[m]!=null&&(h[m]=l[m]),h},{}));for(var f in y)y[f]!==void 0&&g[f]===void 0&&(l[f]=y[f]);return Object.keys(l).length>0?l:void 0},diff:function(y,g){typeof y!="object"&&(y={}),typeof g!="object"&&(g={});var u=Object.keys(y).concat(Object.keys(g)).reduce(function(l,f){return o(y[f],g[f])||(l[f]=g[f]===void 0?null:g[f]),l},{});return Object.keys(u).length>0?u:void 0},transform:function(y,g,u){if(typeof y!="object")return g;if(typeof g=="object"){if(!u)return g;var l=Object.keys(g).reduce(function(f,h){return y[h]===void 0&&(f[h]=g[h]),f},{});return Object.keys(l).length>0?l:void 0}}},iterator:function(y){return new a(y)},length:function(y){return typeof y.delete=="number"?y.delete:typeof y.retain=="number"?y.retain:typeof y.insert=="string"?y.insert.length:1}};function a(y){this.ops=y,this.index=0,this.offset=0}a.prototype.hasNext=function(){return this.peekLength()<1/0},a.prototype.next=function(y){y||(y=1/0);var g=this.ops[this.index];if(g){var u=this.offset,l=c.length(g);if(y>=l-u?(y=l-u,this.index+=1,this.offset=0):this.offset+=y,typeof g.delete=="number")return{delete:y};var f={};return g.attributes&&(f.attributes=g.attributes),typeof g.retain=="number"?f.retain=y:typeof g.insert=="string"?f.insert=g.insert.substr(u,y):f.insert=g.insert,f}else return{retain:1/0}},a.prototype.peek=function(){return this.ops[this.index]},a.prototype.peekLength=function(){return this.ops[this.index]?c.length(this.ops[this.index])-this.offset:1/0},a.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},a.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var y=this.offset,g=this.index,u=this.next(),l=this.ops.slice(this.index);return this.offset=y,this.index=g,[u].concat(l)}else return[]},e.exports=c},function(e,r){var i=function(){function o(m,k){return k!=null&&m instanceof k}var s;try{s=Map}catch{s=function(){}}var c;try{c=Set}catch{c=function(){}}var a;try{a=Promise}catch{a=function(){}}function y(m,k,b,v,d){typeof k=="object"&&(b=k.depth,v=k.prototype,d=k.includeNonEnumerable,k=k.circular);var p=[],w=[],E=typeof Buffer<"u";typeof k>"u"&&(k=!0),typeof b>"u"&&(b=1/0);function x(O,L){if(O===null)return null;if(L===0)return O;var S,C;if(typeof O!="object")return O;if(o(O,s))S=new s;else if(o(O,c))S=new c;else if(o(O,a))S=new a(function(V,B){O.then(function(H){V(x(H,L-1))},function(H){B(x(H,L-1))})});else if(y.__isArray(O))S=[];else if(y.__isRegExp(O))S=new RegExp(O.source,h(O)),O.lastIndex&&(S.lastIndex=O.lastIndex);else if(y.__isDate(O))S=new Date(O.getTime());else{if(E&&Buffer.isBuffer(O))return Buffer.allocUnsafe?S=Buffer.allocUnsafe(O.length):S=new Buffer(O.length),O.copy(S),S;o(O,Error)?S=Object.create(O):typeof v>"u"?(C=Object.getPrototypeOf(O),S=Object.create(C)):(S=Object.create(v),C=v)}if(k){var T=p.indexOf(O);if(T!=-1)return w[T];p.push(O),w.push(S)}o(O,s)&&O.forEach(function(V,B){var H=x(B,L-1),$=x(V,L-1);S.set(H,$)}),o(O,c)&&O.forEach(function(V){var B=x(V,L-1);S.add(B)});for(var N in O){var D;C&&(D=Object.getOwnPropertyDescriptor(C,N)),!(D&&D.set==null)&&(S[N]=x(O[N],L-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(O),N=0;N<M.length;N++){var F=M[N],G=Object.getOwnPropertyDescriptor(O,F);G&&!G.enumerable&&!d||(S[F]=x(O[F],L-1),G.enumerable||Object.defineProperty(S,F,{enumerable:!1}))}if(d)for(var nt=Object.getOwnPropertyNames(O),N=0;N<nt.length;N++){var K=nt[N],G=Object.getOwnPropertyDescriptor(O,K);G&&G.enumerable||(S[K]=x(O[K],L-1),Object.defineProperty(S,K,{enumerable:!1}))}return S}return x(m,b)}y.clonePrototype=function(k){if(k===null)return null;var b=function(){};return b.prototype=k,new b};function g(m){return Object.prototype.toString.call(m)}y.__objToStr=g;function u(m){return typeof m=="object"&&g(m)==="[object Date]"}y.__isDate=u;function l(m){return typeof m=="object"&&g(m)==="[object Array]"}y.__isArray=l;function f(m){return typeof m=="object"&&g(m)==="[object RegExp]"}y.__isRegExp=f;function h(m){var k="";return m.global&&(k+="g"),m.ignoreCase&&(k+="i"),m.multiline&&(k+="m"),k}return y.__getRegExpFlags=h,y}();typeof e=="object"&&e.exports&&(e.exports=i)},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function S(C,T){var N=[],D=!0,M=!1,F=void 0;try{for(var G=C[Symbol.iterator](),nt;!(D=(nt=G.next()).done)&&(N.push(nt.value),!(T&&N.length===T));D=!0);}catch(K){M=!0,F=K}finally{try{!D&&G.return&&G.return()}finally{if(M)throw F}}return N}return function(C,T){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return S(C,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function S(C,T){for(var N=0;N<T.length;N++){var D=T[N];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(C,D.key,D)}}return function(C,T,N){return T&&S(C.prototype,T),N&&S(C,N),C}}(),c=function S(C,T,N){C===null&&(C=Function.prototype);var D=Object.getOwnPropertyDescriptor(C,T);if(D===void 0){var M=Object.getPrototypeOf(C);return M===null?void 0:S(M,T,N)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(N)}},a=i(0),y=p(a),g=i(8),u=p(g),l=i(4),f=p(l),h=i(16),m=p(h),k=i(13),b=p(k),v=i(25),d=p(v);function p(S){return S&&S.__esModule?S:{default:S}}function w(S,C){if(!(S instanceof C))throw new TypeError("Cannot call a class as a function")}function E(S,C){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:S}function x(S,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);S.prototype=Object.create(C&&C.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(S,C):S.__proto__=C)}function O(S){return S instanceof f.default||S instanceof l.BlockEmbed}var L=function(S){x(C,S);function C(T,N){w(this,C);var D=E(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,T));return D.emitter=N.emitter,Array.isArray(N.whitelist)&&(D.whitelist=N.whitelist.reduce(function(M,F){return M[F]=!0,M},{})),D.domNode.addEventListener("DOMNodeInserted",function(){}),D.optimize(),D.enable(),D}return s(C,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(N,D){var M=this.line(N),F=o(M,2),G=F[0],nt=F[1],K=this.line(N+D),V=o(K,1),B=V[0];if(c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"deleteAt",this).call(this,N,D),B!=null&&G!==B&&nt>0){if(G instanceof l.BlockEmbed||B instanceof l.BlockEmbed){this.optimize();return}if(G instanceof b.default){var H=G.newlineIndex(G.length(),!0);if(H>-1&&(G=G.split(H+1),G===B)){this.optimize();return}}else if(B instanceof b.default){var $=B.newlineIndex(0);$>-1&&B.split($+1)}var J=B.children.head instanceof m.default?null:B.children.head;G.moveChildren(B,J),G.remove()}this.optimize()}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",N)}},{key:"formatAt",value:function(N,D,M,F){this.whitelist!=null&&!this.whitelist[M]||(c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"formatAt",this).call(this,N,D,M,F),this.optimize())}},{key:"insertAt",value:function(N,D,M){if(!(M!=null&&this.whitelist!=null&&!this.whitelist[D])){if(N>=this.length())if(M==null||y.default.query(D,y.default.Scope.BLOCK)==null){var F=y.default.create(this.statics.defaultChild);this.appendChild(F),M==null&&D.endsWith(`
`)&&(D=D.slice(0,-1)),F.insertAt(0,D,M)}else{var G=y.default.create(D,M);this.appendChild(G)}else c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertAt",this).call(this,N,D,M);this.optimize()}}},{key:"insertBefore",value:function(N,D){if(N.statics.scope===y.default.Scope.INLINE_BLOT){var M=y.default.create(this.statics.defaultChild);M.appendChild(N),N=M}c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertBefore",this).call(this,N,D)}},{key:"leaf",value:function(N){return this.path(N).pop()||[null,-1]}},{key:"line",value:function(N){return N===this.length()?this.line(N-1):this.descendant(O,N)}},{key:"lines",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,M=function F(G,nt,K){var V=[],B=K;return G.children.forEachAt(nt,K,function(H,$,J){O(H)?V.push(H):H instanceof y.default.Container&&(V=V.concat(F(H,$,B))),B-=J}),V};return M(this,N,D)}},{key:"optimize",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"optimize",this).call(this,N,D),N.length>0&&this.emitter.emit(u.default.events.SCROLL_OPTIMIZE,N,D))}},{key:"path",value:function(N){return c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"path",this).call(this,N).slice(1)}},{key:"update",value:function(N){if(this.batch!==!0){var D=u.default.sources.USER;typeof N=="string"&&(D=N),Array.isArray(N)||(N=this.observer.takeRecords()),N.length>0&&this.emitter.emit(u.default.events.SCROLL_BEFORE_UPDATE,D,N),c(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"update",this).call(this,N.concat([])),N.length>0&&this.emitter.emit(u.default.events.SCROLL_UPDATE,D,N)}}}]),C}(y.default.Scroll);L.blotName="scroll",L.className="ql-editor",L.tagName="DIV",L.defaultChild="block",L.allowedChildren=[f.default,l.BlockEmbed,d.default],r.default=L},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SHORTKEY=r.default=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},s=function(){function j(Z,et){var rt=[],st=!0,ct=!1,vt=void 0;try{for(var pt=Z[Symbol.iterator](),gt;!(st=(gt=pt.next()).done)&&(rt.push(gt.value),!(et&&rt.length===et));st=!0);}catch(I){ct=!0,vt=I}finally{try{!st&&pt.return&&pt.return()}finally{if(ct)throw vt}}return rt}return function(Z,et){if(Array.isArray(Z))return Z;if(Symbol.iterator in Object(Z))return j(Z,et);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function j(Z,et){for(var rt=0;rt<et.length;rt++){var st=et[rt];st.enumerable=st.enumerable||!1,st.configurable=!0,"value"in st&&(st.writable=!0),Object.defineProperty(Z,st.key,st)}}return function(Z,et,rt){return et&&j(Z.prototype,et),rt&&j(Z,rt),Z}}(),a=i(21),y=S(a),g=i(11),u=S(g),l=i(3),f=S(l),h=i(2),m=S(h),k=i(20),b=S(k),v=i(0),d=S(v),p=i(5),w=S(p),E=i(10),x=S(E),O=i(9),L=S(O);function S(j){return j&&j.__esModule?j:{default:j}}function C(j,Z,et){return Z in j?Object.defineProperty(j,Z,{value:et,enumerable:!0,configurable:!0,writable:!0}):j[Z]=et,j}function T(j,Z){if(!(j instanceof Z))throw new TypeError("Cannot call a class as a function")}function N(j,Z){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Z&&(typeof Z=="object"||typeof Z=="function")?Z:j}function D(j,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Z);j.prototype=Object.create(Z&&Z.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),Z&&(Object.setPrototypeOf?Object.setPrototypeOf(j,Z):j.__proto__=Z)}var M=(0,x.default)("quill:keyboard"),F=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",G=function(j){D(Z,j),c(Z,null,[{key:"match",value:function(rt,st){return st=X(st),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ct){return!!st[ct]!==rt[ct]&&st[ct]!==null})?!1:st.key===(rt.which||rt.keyCode)}}]);function Z(et,rt){T(this,Z);var st=N(this,(Z.__proto__||Object.getPrototypeOf(Z)).call(this,et,rt));return st.bindings={},Object.keys(st.options.bindings).forEach(function(ct){ct==="list autofill"&&et.scroll.whitelist!=null&&!et.scroll.whitelist.list||st.options.bindings[ct]&&st.addBinding(st.options.bindings[ct])}),st.addBinding({key:Z.keys.ENTER,shiftKey:null},H),st.addBinding({key:Z.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(st.addBinding({key:Z.keys.BACKSPACE},{collapsed:!0},K),st.addBinding({key:Z.keys.DELETE},{collapsed:!0},V)):(st.addBinding({key:Z.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},K),st.addBinding({key:Z.keys.DELETE},{collapsed:!0,suffix:/^.?$/},V)),st.addBinding({key:Z.keys.BACKSPACE},{collapsed:!1},B),st.addBinding({key:Z.keys.DELETE},{collapsed:!1},B),st.addBinding({key:Z.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},K),st.listen(),st}return c(Z,[{key:"addBinding",value:function(rt){var st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},vt=X(rt);if(vt==null||vt.key==null)return M.warn("Attempted to add invalid keyboard binding",vt);typeof st=="function"&&(st={handler:st}),typeof ct=="function"&&(ct={handler:ct}),vt=(0,f.default)(vt,st,ct),this.bindings[vt.key]=this.bindings[vt.key]||[],this.bindings[vt.key].push(vt)}},{key:"listen",value:function(){var rt=this;this.quill.root.addEventListener("keydown",function(st){if(!st.defaultPrevented){var ct=st.which||st.keyCode,vt=(rt.bindings[ct]||[]).filter(function(ot){return Z.match(st,ot)});if(vt.length!==0){var pt=rt.quill.getSelection();if(!(pt==null||!rt.quill.hasFocus())){var gt=rt.quill.getLine(pt.index),I=s(gt,2),U=I[0],W=I[1],q=rt.quill.getLeaf(pt.index),P=s(q,2),_=P[0],A=P[1],R=pt.length===0?[_,A]:rt.quill.getLeaf(pt.index+pt.length),z=s(R,2),Y=z[0],tt=z[1],ut=_ instanceof d.default.Text?_.value().slice(0,A):"",bt=Y instanceof d.default.Text?Y.value().slice(tt):"",mt={collapsed:pt.length===0,empty:pt.length===0&&U.length()<=1,format:rt.quill.getFormat(pt),offset:W,prefix:ut,suffix:bt},yt=vt.some(function(ot){if(ot.collapsed!=null&&ot.collapsed!==mt.collapsed||ot.empty!=null&&ot.empty!==mt.empty||ot.offset!=null&&ot.offset!==mt.offset)return!1;if(Array.isArray(ot.format)){if(ot.format.every(function(Et){return mt.format[Et]==null}))return!1}else if(o(ot.format)==="object"&&!Object.keys(ot.format).every(function(Et){return ot.format[Et]===!0?mt.format[Et]!=null:ot.format[Et]===!1?mt.format[Et]==null:(0,u.default)(ot.format[Et],mt.format[Et])}))return!1;return ot.prefix!=null&&!ot.prefix.test(mt.prefix)||ot.suffix!=null&&!ot.suffix.test(mt.suffix)?!1:ot.handler.call(rt,pt,mt)!==!0});yt&&st.preventDefault()}}}})}}]),Z}(L.default);G.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},G.DEFAULTS={bindings:{bold:J("bold"),italic:J("italic"),underline:J("underline"),indent:{key:G.keys.TAB,format:["blockquote","indent","list"],handler:function(Z,et){if(et.collapsed&&et.offset!==0)return!0;this.quill.format("indent","+1",w.default.sources.USER)}},outdent:{key:G.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(Z,et){if(et.collapsed&&et.offset!==0)return!0;this.quill.format("indent","-1",w.default.sources.USER)}},"outdent backspace":{key:G.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(Z,et){et.format.indent!=null?this.quill.format("indent","-1",w.default.sources.USER):et.format.list!=null&&this.quill.format("list",!1,w.default.sources.USER)}},"indent code-block":$(!0),"outdent code-block":$(!1),"remove tab":{key:G.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(Z){this.quill.deleteText(Z.index-1,1,w.default.sources.USER)}},tab:{key:G.keys.TAB,handler:function(Z){this.quill.history.cutoff();var et=new m.default().retain(Z.index).delete(Z.length).insert("	");this.quill.updateContents(et,w.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Z.index+1,w.default.sources.SILENT)}},"list empty enter":{key:G.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(Z,et){this.quill.format("list",!1,w.default.sources.USER),et.format.indent&&this.quill.format("indent",!1,w.default.sources.USER)}},"checklist enter":{key:G.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(Z){var et=this.quill.getLine(Z.index),rt=s(et,2),st=rt[0],ct=rt[1],vt=(0,f.default)({},st.formats(),{list:"checked"}),pt=new m.default().retain(Z.index).insert(`
`,vt).retain(st.length()-ct-1).retain(1,{list:"unchecked"});this.quill.updateContents(pt,w.default.sources.USER),this.quill.setSelection(Z.index+1,w.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:G.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(Z,et){var rt=this.quill.getLine(Z.index),st=s(rt,2),ct=st[0],vt=st[1],pt=new m.default().retain(Z.index).insert(`
`,et.format).retain(ct.length()-vt-1).retain(1,{header:null});this.quill.updateContents(pt,w.default.sources.USER),this.quill.setSelection(Z.index+1,w.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(Z,et){var rt=et.prefix.length,st=this.quill.getLine(Z.index),ct=s(st,2),vt=ct[0],pt=ct[1];if(pt>rt)return!0;var gt=void 0;switch(et.prefix.trim()){case"[]":case"[ ]":gt="unchecked";break;case"[x]":gt="checked";break;case"-":case"*":gt="bullet";break;default:gt="ordered"}this.quill.insertText(Z.index," ",w.default.sources.USER),this.quill.history.cutoff();var I=new m.default().retain(Z.index-pt).delete(rt+1).retain(vt.length()-2-pt).retain(1,{list:gt});this.quill.updateContents(I,w.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Z.index-rt,w.default.sources.SILENT)}},"code exit":{key:G.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(Z){var et=this.quill.getLine(Z.index),rt=s(et,2),st=rt[0],ct=rt[1],vt=new m.default().retain(Z.index+st.length()-ct-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(vt,w.default.sources.USER)}},"embed left":nt(G.keys.LEFT,!1),"embed left shift":nt(G.keys.LEFT,!0),"embed right":nt(G.keys.RIGHT,!1),"embed right shift":nt(G.keys.RIGHT,!0)}};function nt(j,Z){var et,rt=j===G.keys.LEFT?"prefix":"suffix";return et={key:j,shiftKey:Z,altKey:null},C(et,rt,/^$/),C(et,"handler",function(ct){var vt=ct.index;j===G.keys.RIGHT&&(vt+=ct.length+1);var pt=this.quill.getLeaf(vt),gt=s(pt,1),I=gt[0];return I instanceof d.default.Embed?(j===G.keys.LEFT?Z?this.quill.setSelection(ct.index-1,ct.length+1,w.default.sources.USER):this.quill.setSelection(ct.index-1,w.default.sources.USER):Z?this.quill.setSelection(ct.index,ct.length+1,w.default.sources.USER):this.quill.setSelection(ct.index+ct.length+1,w.default.sources.USER),!1):!0}),et}function K(j,Z){if(!(j.index===0||this.quill.getLength()<=1)){var et=this.quill.getLine(j.index),rt=s(et,1),st=rt[0],ct={};if(Z.offset===0){var vt=this.quill.getLine(j.index-1),pt=s(vt,1),gt=pt[0];if(gt!=null&&gt.length()>1){var I=st.formats(),U=this.quill.getFormat(j.index-1,1);ct=b.default.attributes.diff(I,U)||{}}}var W=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(Z.prefix)?2:1;this.quill.deleteText(j.index-W,W,w.default.sources.USER),Object.keys(ct).length>0&&this.quill.formatLine(j.index-W,W,ct,w.default.sources.USER),this.quill.focus()}}function V(j,Z){var et=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(Z.suffix)?2:1;if(!(j.index>=this.quill.getLength()-et)){var rt={},st=0,ct=this.quill.getLine(j.index),vt=s(ct,1),pt=vt[0];if(Z.offset>=pt.length()-1){var gt=this.quill.getLine(j.index+1),I=s(gt,1),U=I[0];if(U){var W=pt.formats(),q=this.quill.getFormat(j.index,1);rt=b.default.attributes.diff(W,q)||{},st=U.length()}}this.quill.deleteText(j.index,et,w.default.sources.USER),Object.keys(rt).length>0&&this.quill.formatLine(j.index+st-1,et,rt,w.default.sources.USER)}}function B(j){var Z=this.quill.getLines(j),et={};if(Z.length>1){var rt=Z[0].formats(),st=Z[Z.length-1].formats();et=b.default.attributes.diff(st,rt)||{}}this.quill.deleteText(j,w.default.sources.USER),Object.keys(et).length>0&&this.quill.formatLine(j.index,1,et,w.default.sources.USER),this.quill.setSelection(j.index,w.default.sources.SILENT),this.quill.focus()}function H(j,Z){var et=this;j.length>0&&this.quill.scroll.deleteAt(j.index,j.length);var rt=Object.keys(Z.format).reduce(function(st,ct){return d.default.query(ct,d.default.Scope.BLOCK)&&!Array.isArray(Z.format[ct])&&(st[ct]=Z.format[ct]),st},{});this.quill.insertText(j.index,`
`,rt,w.default.sources.USER),this.quill.setSelection(j.index+1,w.default.sources.SILENT),this.quill.focus(),Object.keys(Z.format).forEach(function(st){rt[st]==null&&(Array.isArray(Z.format[st])||st!=="link"&&et.quill.format(st,Z.format[st],w.default.sources.USER))})}function $(j){return{key:G.keys.TAB,shiftKey:!j,format:{"code-block":!0},handler:function(et){var rt=d.default.query("code-block"),st=et.index,ct=et.length,vt=this.quill.scroll.descendant(rt,st),pt=s(vt,2),gt=pt[0],I=pt[1];if(gt!=null){var U=this.quill.getIndex(gt),W=gt.newlineIndex(I,!0)+1,q=gt.newlineIndex(U+I+ct),P=gt.domNode.textContent.slice(W,q).split(`
`);I=0,P.forEach(function(_,A){j?(gt.insertAt(W+I,rt.TAB),I+=rt.TAB.length,A===0?st+=rt.TAB.length:ct+=rt.TAB.length):_.startsWith(rt.TAB)&&(gt.deleteAt(W+I,rt.TAB.length),I-=rt.TAB.length,A===0?st-=rt.TAB.length:ct-=rt.TAB.length),I+=_.length+1}),this.quill.update(w.default.sources.USER),this.quill.setSelection(st,ct,w.default.sources.SILENT)}}}}function J(j){return{key:j[0].toUpperCase(),shortKey:!0,handler:function(et,rt){this.quill.format(j,!rt.format[j],w.default.sources.USER)}}}function X(j){if(typeof j=="string"||typeof j=="number")return X({key:j});if((typeof j>"u"?"undefined":o(j))==="object"&&(j=(0,y.default)(j,!1)),typeof j.key=="string")if(G.keys[j.key.toUpperCase()]!=null)j.key=G.keys[j.key.toUpperCase()];else if(j.key.length===1)j.key=j.key.toUpperCase().charCodeAt(0);else return null;return j.shortKey&&(j[F]=j.shortKey,delete j.shortKey),j}r.default=G,r.SHORTKEY=F},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function b(v,d){var p=[],w=!0,E=!1,x=void 0;try{for(var O=v[Symbol.iterator](),L;!(w=(L=O.next()).done)&&(p.push(L.value),!(d&&p.length===d));w=!0);}catch(S){E=!0,x=S}finally{try{!w&&O.return&&O.return()}finally{if(E)throw x}}return p}return function(v,d){if(Array.isArray(v))return v;if(Symbol.iterator in Object(v))return b(v,d);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function b(v,d,p){v===null&&(v=Function.prototype);var w=Object.getOwnPropertyDescriptor(v,d);if(w===void 0){var E=Object.getPrototypeOf(v);return E===null?void 0:b(E,d,p)}else{if("value"in w)return w.value;var x=w.get;return x===void 0?void 0:x.call(p)}},c=function(){function b(v,d){for(var p=0;p<d.length;p++){var w=d[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}return function(v,d,p){return d&&b(v.prototype,d),p&&b(v,p),v}}(),a=i(0),y=l(a),g=i(7),u=l(g);function l(b){return b&&b.__esModule?b:{default:b}}function f(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}function h(b,v){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:b}function m(b,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);b.prototype=Object.create(v&&v.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(b,v):b.__proto__=v)}var k=function(b){m(v,b),c(v,null,[{key:"value",value:function(){}}]);function v(d,p){f(this,v);var w=h(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,d));return w.selection=p,w.textNode=document.createTextNode(v.CONTENTS),w.domNode.appendChild(w.textNode),w._length=0,w}return c(v,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(p,w){if(this._length!==0)return s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"format",this).call(this,p,w);for(var E=this,x=0;E!=null&&E.statics.scope!==y.default.Scope.BLOCK_BLOT;)x+=E.offset(E.parent),E=E.parent;E!=null&&(this._length=v.CONTENTS.length,E.optimize(),E.formatAt(x,v.CONTENTS.length,p,w),this._length=0)}},{key:"index",value:function(p,w){return p===this.textNode?0:s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"index",this).call(this,p,w)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var p=this.textNode,w=this.selection.getNativeRange(),E=void 0,x=void 0,O=void 0;if(w!=null&&w.start.node===p&&w.end.node===p){var L=[p,w.start.offset,w.end.offset];E=L[0],x=L[1],O=L[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==v.CONTENTS){var S=this.textNode.data.split(v.CONTENTS).join("");this.next instanceof u.default?(E=this.next.domNode,this.next.insertAt(0,S),this.textNode.data=v.CONTENTS):(this.textNode.data=S,this.parent.insertBefore(y.default.create(this.textNode),this),this.textNode=document.createTextNode(v.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),x!=null){var C=[x,O].map(function(N){return Math.max(0,Math.min(E.data.length,N-1))}),T=o(C,2);return x=T[0],O=T[1],{startNode:E,startOffset:x,endNode:E,endOffset:O}}}}},{key:"update",value:function(p,w){var E=this;if(p.some(function(O){return O.type==="characterData"&&O.target===E.textNode})){var x=this.restore();x&&(w.range=x)}}},{key:"value",value:function(){return""}}]),v}(y.default.Embed);k.blotName="cursor",k.className="ql-cursor",k.tagName="span",k.CONTENTS="\uFEFF",r.default=k},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),s=y(o),c=i(4),a=y(c);function y(h){return h&&h.__esModule?h:{default:h}}function g(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function u(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=function(h){l(m,h);function m(){return g(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(s.default.Container);f.allowedChildren=[a.default,c.BlockEmbed,f],r.default=f},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.ColorStyle=r.ColorClass=r.ColorAttributor=void 0;var o=function(){function k(b,v){for(var d=0;d<v.length;d++){var p=v[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,v,d){return v&&k(b.prototype,v),d&&k(b,d),b}}(),s=function k(b,v,d){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,v);if(p===void 0){var w=Object.getPrototypeOf(b);return w===null?void 0:k(w,v,d)}else{if("value"in p)return p.value;var E=p.get;return E===void 0?void 0:E.call(d)}},c=i(0),a=y(c);function y(k){return k&&k.__esModule?k:{default:k}}function g(k,b){if(!(k instanceof b))throw new TypeError("Cannot call a class as a function")}function u(k,b){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:k}function l(k,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);k.prototype=Object.create(b&&b.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(k,b):k.__proto__=b)}var f=function(k){l(b,k);function b(){return g(this,b),u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"value",value:function(d){var p=s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,d);return p.startsWith("rgb(")?(p=p.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+p.split(",").map(function(w){return("00"+parseInt(w).toString(16)).slice(-2)}).join("")):p}}]),b}(a.default.Attributor.Style),h=new a.default.Attributor.Class("color","ql-color",{scope:a.default.Scope.INLINE}),m=new f("color","color",{scope:a.default.Scope.INLINE});r.ColorAttributor=f,r.ColorClass=h,r.ColorStyle=m},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.sanitize=r.default=void 0;var o=function(){function m(k,b){for(var v=0;v<b.length;v++){var d=b[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(k,d.key,d)}}return function(k,b,v){return b&&m(k.prototype,b),v&&m(k,v),k}}(),s=function m(k,b,v){k===null&&(k=Function.prototype);var d=Object.getOwnPropertyDescriptor(k,b);if(d===void 0){var p=Object.getPrototypeOf(k);return p===null?void 0:m(p,b,v)}else{if("value"in d)return d.value;var w=d.get;return w===void 0?void 0:w.call(v)}},c=i(6),a=y(c);function y(m){return m&&m.__esModule?m:{default:m}}function g(m,k){if(!(m instanceof k))throw new TypeError("Cannot call a class as a function")}function u(m,k){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:m}function l(m,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);m.prototype=Object.create(k&&k.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(m,k):m.__proto__=k)}var f=function(m){l(k,m);function k(){return g(this,k),u(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}return o(k,[{key:"format",value:function(v,d){if(v!==this.statics.blotName||!d)return s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"format",this).call(this,v,d);d=this.constructor.sanitize(d),this.domNode.setAttribute("href",d)}}],[{key:"create",value:function(v){var d=s(k.__proto__||Object.getPrototypeOf(k),"create",this).call(this,v);return v=this.sanitize(v),d.setAttribute("href",v),d.setAttribute("rel","noopener noreferrer"),d.setAttribute("target","_blank"),d}},{key:"formats",value:function(v){return v.getAttribute("href")}},{key:"sanitize",value:function(v){return h(v,this.PROTOCOL_WHITELIST)?v:this.SANITIZED_URL}}]),k}(a.default);f.blotName="link",f.tagName="A",f.SANITIZED_URL="about:blank",f.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function h(m,k){var b=document.createElement("a");b.href=m;var v=b.href.slice(0,b.href.indexOf(":"));return k.indexOf(v)>-1}r.default=f,r.sanitize=h},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},s=function(){function k(b,v){for(var d=0;d<v.length;d++){var p=v[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,v,d){return v&&k(b.prototype,v),d&&k(b,d),b}}(),c=i(23),a=u(c),y=i(107),g=u(y);function u(k){return k&&k.__esModule?k:{default:k}}function l(k,b){if(!(k instanceof b))throw new TypeError("Cannot call a class as a function")}var f=0;function h(k,b){k.setAttribute(b,k.getAttribute(b)!=="true")}var m=function(){function k(b){var v=this;l(this,k),this.select=b,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){v.togglePicker()}),this.label.addEventListener("keydown",function(d){switch(d.keyCode){case a.default.keys.ENTER:v.togglePicker();break;case a.default.keys.ESCAPE:v.escape(),d.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return s(k,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),h(this.label,"aria-expanded"),h(this.options,"aria-hidden")}},{key:"buildItem",value:function(v){var d=this,p=document.createElement("span");return p.tabIndex="0",p.setAttribute("role","button"),p.classList.add("ql-picker-item"),v.hasAttribute("value")&&p.setAttribute("data-value",v.getAttribute("value")),v.textContent&&p.setAttribute("data-label",v.textContent),p.addEventListener("click",function(){d.selectItem(p,!0)}),p.addEventListener("keydown",function(w){switch(w.keyCode){case a.default.keys.ENTER:d.selectItem(p,!0),w.preventDefault();break;case a.default.keys.ESCAPE:d.escape(),w.preventDefault();break}}),p}},{key:"buildLabel",value:function(){var v=document.createElement("span");return v.classList.add("ql-picker-label"),v.innerHTML=g.default,v.tabIndex="0",v.setAttribute("role","button"),v.setAttribute("aria-expanded","false"),this.container.appendChild(v),v}},{key:"buildOptions",value:function(){var v=this,d=document.createElement("span");d.classList.add("ql-picker-options"),d.setAttribute("aria-hidden","true"),d.tabIndex="-1",d.id="ql-picker-options-"+f,f+=1,this.label.setAttribute("aria-controls",d.id),this.options=d,[].slice.call(this.select.options).forEach(function(p){var w=v.buildItem(p);d.appendChild(w),p.selected===!0&&v.selectItem(w)}),this.container.appendChild(d)}},{key:"buildPicker",value:function(){var v=this;[].slice.call(this.select.attributes).forEach(function(d){v.container.setAttribute(d.name,d.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var v=this;this.close(),setTimeout(function(){return v.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=this.container.querySelector(".ql-selected");if(v!==p&&(p!=null&&p.classList.remove("ql-selected"),v!=null&&(v.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(v.parentNode.children,v),v.hasAttribute("data-value")?this.label.setAttribute("data-value",v.getAttribute("data-value")):this.label.removeAttribute("data-value"),v.hasAttribute("data-label")?this.label.setAttribute("data-label",v.getAttribute("data-label")):this.label.removeAttribute("data-label"),d))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":o(Event))==="object"){var w=document.createEvent("Event");w.initEvent("change",!0,!0),this.select.dispatchEvent(w)}this.close()}}},{key:"update",value:function(){var v=void 0;if(this.select.selectedIndex>-1){var d=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];v=this.select.options[this.select.selectedIndex],this.selectItem(d)}else this.selectItem(null);var p=v!=null&&v!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",p)}}]),k}();r.default=m},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),s=M(o),c=i(5),a=M(c),y=i(4),g=M(y),u=i(16),l=M(u),f=i(25),h=M(f),m=i(24),k=M(m),b=i(35),v=M(b),d=i(6),p=M(d),w=i(22),E=M(w),x=i(7),O=M(x),L=i(55),S=M(L),C=i(42),T=M(C),N=i(23),D=M(N);function M(F){return F&&F.__esModule?F:{default:F}}a.default.register({"blots/block":g.default,"blots/block/embed":y.BlockEmbed,"blots/break":l.default,"blots/container":h.default,"blots/cursor":k.default,"blots/embed":v.default,"blots/inline":p.default,"blots/scroll":E.default,"blots/text":O.default,"modules/clipboard":S.default,"modules/history":T.default,"modules/keyboard":D.default}),s.default.register(g.default,l.default,k.default,p.default,E.default,O.default),r.default=a.default},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),s=function(){function c(a){this.domNode=a,this.domNode[o.DATA_KEY]={blot:this}}return Object.defineProperty(c.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),c.create=function(a){if(this.tagName==null)throw new o.ParchmentError("Blot definition missing tagName");var y;return Array.isArray(this.tagName)?(typeof a=="string"&&(a=a.toUpperCase(),parseInt(a).toString()===a&&(a=parseInt(a))),typeof a=="number"?y=document.createElement(this.tagName[a-1]):this.tagName.indexOf(a)>-1?y=document.createElement(a):y=document.createElement(this.tagName[0])):y=document.createElement(this.tagName),this.className&&y.classList.add(this.className),y},c.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},c.prototype.clone=function(){var a=this.domNode.cloneNode(!1);return o.create(a)},c.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[o.DATA_KEY]},c.prototype.deleteAt=function(a,y){var g=this.isolate(a,y);g.remove()},c.prototype.formatAt=function(a,y,g,u){var l=this.isolate(a,y);if(o.query(g,o.Scope.BLOT)!=null&&u)l.wrap(g,u);else if(o.query(g,o.Scope.ATTRIBUTE)!=null){var f=o.create(this.statics.scope);l.wrap(f),f.format(g,u)}},c.prototype.insertAt=function(a,y,g){var u=g==null?o.create("text",y):o.create(y,g),l=this.split(a);this.parent.insertBefore(u,l)},c.prototype.insertInto=function(a,y){y===void 0&&(y=null),this.parent!=null&&this.parent.children.remove(this);var g=null;a.children.insertBefore(this,y),y!=null&&(g=y.domNode),(this.domNode.parentNode!=a.domNode||this.domNode.nextSibling!=g)&&a.domNode.insertBefore(this.domNode,g),this.parent=a,this.attach()},c.prototype.isolate=function(a,y){var g=this.split(a);return g.split(y),g},c.prototype.length=function(){return 1},c.prototype.offset=function(a){return a===void 0&&(a=this.parent),this.parent==null||this==a?0:this.parent.children.offset(this)+this.parent.offset(a)},c.prototype.optimize=function(a){this.domNode[o.DATA_KEY]!=null&&delete this.domNode[o.DATA_KEY].mutations},c.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},c.prototype.replace=function(a){a.parent!=null&&(a.parent.insertBefore(this,a.next),a.remove())},c.prototype.replaceWith=function(a,y){var g=typeof a=="string"?o.create(a,y):a;return g.replace(this),g},c.prototype.split=function(a,y){return a===0?this:this.next},c.prototype.update=function(a,y){},c.prototype.wrap=function(a,y){var g=typeof a=="string"?o.create(a,y):a;return this.parent!=null&&this.parent.insertBefore(g,this.next),g.appendChild(this),g},c.blotName="abstract",c}();r.default=s},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(12),s=i(32),c=i(33),a=i(1),y=function(){function g(u){this.attributes={},this.domNode=u,this.build()}return g.prototype.attribute=function(u,l){l?u.add(this.domNode,l)&&(u.value(this.domNode)!=null?this.attributes[u.attrName]=u:delete this.attributes[u.attrName]):(u.remove(this.domNode),delete this.attributes[u.attrName])},g.prototype.build=function(){var u=this;this.attributes={};var l=o.default.keys(this.domNode),f=s.default.keys(this.domNode),h=c.default.keys(this.domNode);l.concat(f).concat(h).forEach(function(m){var k=a.query(m,a.Scope.ATTRIBUTE);k instanceof o.default&&(u.attributes[k.attrName]=k)})},g.prototype.copy=function(u){var l=this;Object.keys(this.attributes).forEach(function(f){var h=l.attributes[f].value(l.domNode);u.format(f,h)})},g.prototype.move=function(u){var l=this;this.copy(u),Object.keys(this.attributes).forEach(function(f){l.attributes[f].remove(l.domNode)}),this.attributes={}},g.prototype.values=function(){var u=this;return Object.keys(this.attributes).reduce(function(l,f){return l[f]=u.attributes[f].value(u.domNode),l},{})},g}();r.default=y},function(e,r,i){var o=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,u){g.__proto__=u}||function(g,u){for(var l in u)u.hasOwnProperty(l)&&(g[l]=u[l])};return function(g,u){y(g,u);function l(){this.constructor=g}g.prototype=u===null?Object.create(u):(l.prototype=u.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(12);function c(y,g){var u=y.getAttribute("class")||"";return u.split(/\s+/).filter(function(l){return l.indexOf(g+"-")===0})}var a=function(y){o(g,y);function g(){return y!==null&&y.apply(this,arguments)||this}return g.keys=function(u){return(u.getAttribute("class")||"").split(/\s+/).map(function(l){return l.split("-").slice(0,-1).join("-")})},g.prototype.add=function(u,l){return this.canAdd(u,l)?(this.remove(u),u.classList.add(this.keyName+"-"+l),!0):!1},g.prototype.remove=function(u){var l=c(u,this.keyName);l.forEach(function(f){u.classList.remove(f)}),u.classList.length===0&&u.removeAttribute("class")},g.prototype.value=function(u){var l=c(u,this.keyName)[0]||"",f=l.slice(this.keyName.length+1);return this.canAdd(u,f)?f:""},g}(s.default);r.default=a},function(e,r,i){var o=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,u){g.__proto__=u}||function(g,u){for(var l in u)u.hasOwnProperty(l)&&(g[l]=u[l])};return function(g,u){y(g,u);function l(){this.constructor=g}g.prototype=u===null?Object.create(u):(l.prototype=u.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(12);function c(y){var g=y.split("-"),u=g.slice(1).map(function(l){return l[0].toUpperCase()+l.slice(1)}).join("");return g[0]+u}var a=function(y){o(g,y);function g(){return y!==null&&y.apply(this,arguments)||this}return g.keys=function(u){return(u.getAttribute("style")||"").split(";").map(function(l){var f=l.split(":");return f[0].trim()})},g.prototype.add=function(u,l){return this.canAdd(u,l)?(u.style[c(this.keyName)]=l,!0):!1},g.prototype.remove=function(u){u.style[c(this.keyName)]="",u.getAttribute("style")||u.removeAttribute("style")},g.prototype.value=function(u){var l=u.style[c(this.keyName)];return this.canAdd(u,l)?l:""},g}(s.default);r.default=a},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function a(y,g){for(var u=0;u<g.length;u++){var l=g[u];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(y,l.key,l)}}return function(y,g,u){return g&&a(y.prototype,g),u&&a(y,u),y}}();function s(a,y){if(!(a instanceof y))throw new TypeError("Cannot call a class as a function")}var c=function(){function a(y,g){s(this,a),this.quill=y,this.options=g,this.modules={}}return o(a,[{key:"init",value:function(){var g=this;Object.keys(this.options.modules).forEach(function(u){g.modules[u]==null&&g.addModule(u)})}},{key:"addModule",value:function(g){var u=this.quill.constructor.import("modules/"+g);return this.modules[g]=new u(this.quill,this.options.modules[g]||{}),this.modules[g]}}]),a}();c.DEFAULTS={modules:{}},c.themes={default:c},r.default=c},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function b(v,d){for(var p=0;p<d.length;p++){var w=d[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}return function(v,d,p){return d&&b(v.prototype,d),p&&b(v,p),v}}(),s=function b(v,d,p){v===null&&(v=Function.prototype);var w=Object.getOwnPropertyDescriptor(v,d);if(w===void 0){var E=Object.getPrototypeOf(v);return E===null?void 0:b(E,d,p)}else{if("value"in w)return w.value;var x=w.get;return x===void 0?void 0:x.call(p)}},c=i(0),a=u(c),y=i(7),g=u(y);function u(b){return b&&b.__esModule?b:{default:b}}function l(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}function f(b,v){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:b}function h(b,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);b.prototype=Object.create(v&&v.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(b,v):b.__proto__=v)}var m="\uFEFF",k=function(b){h(v,b);function v(d){l(this,v);var p=f(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,d));return p.contentNode=document.createElement("span"),p.contentNode.setAttribute("contenteditable",!1),[].slice.call(p.domNode.childNodes).forEach(function(w){p.contentNode.appendChild(w)}),p.leftGuard=document.createTextNode(m),p.rightGuard=document.createTextNode(m),p.domNode.appendChild(p.leftGuard),p.domNode.appendChild(p.contentNode),p.domNode.appendChild(p.rightGuard),p}return o(v,[{key:"index",value:function(p,w){return p===this.leftGuard?0:p===this.rightGuard?1:s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"index",this).call(this,p,w)}},{key:"restore",value:function(p){var w=void 0,E=void 0,x=p.data.split(m).join("");if(p===this.leftGuard)if(this.prev instanceof g.default){var O=this.prev.length();this.prev.insertAt(O,x),w={startNode:this.prev.domNode,startOffset:O+x.length}}else E=document.createTextNode(x),this.parent.insertBefore(a.default.create(E),this),w={startNode:E,startOffset:x.length};else p===this.rightGuard&&(this.next instanceof g.default?(this.next.insertAt(0,x),w={startNode:this.next.domNode,startOffset:x.length}):(E=document.createTextNode(x),this.parent.insertBefore(a.default.create(E),this.next),w={startNode:E,startOffset:x.length}));return p.data=m,w}},{key:"update",value:function(p,w){var E=this;p.forEach(function(x){if(x.type==="characterData"&&(x.target===E.leftGuard||x.target===E.rightGuard)){var O=E.restore(x.target);O&&(w.range=O)}})}}]),v}(a.default.Embed);r.default=k},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.AlignStyle=r.AlignClass=r.AlignAttribute=void 0;var o=i(0),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}var a={scope:s.default.Scope.BLOCK,whitelist:["right","center","justify"]},y=new s.default.Attributor.Attribute("align","align",a),g=new s.default.Attributor.Class("align","ql-align",a),u=new s.default.Attributor.Style("align","text-align",a);r.AlignAttribute=y,r.AlignClass=g,r.AlignStyle=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.BackgroundStyle=r.BackgroundClass=void 0;var o=i(0),s=a(o),c=i(26);function a(u){return u&&u.__esModule?u:{default:u}}var y=new s.default.Attributor.Class("background","ql-bg",{scope:s.default.Scope.INLINE}),g=new c.ColorAttributor("background","background-color",{scope:s.default.Scope.INLINE});r.BackgroundClass=y,r.BackgroundStyle=g},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.DirectionStyle=r.DirectionClass=r.DirectionAttribute=void 0;var o=i(0),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}var a={scope:s.default.Scope.BLOCK,whitelist:["rtl"]},y=new s.default.Attributor.Attribute("direction","dir",a),g=new s.default.Attributor.Class("direction","ql-direction",a),u=new s.default.Attributor.Style("direction","direction",a);r.DirectionAttribute=y,r.DirectionClass=g,r.DirectionStyle=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.FontClass=r.FontStyle=void 0;var o=function(){function b(v,d){for(var p=0;p<d.length;p++){var w=d[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}return function(v,d,p){return d&&b(v.prototype,d),p&&b(v,p),v}}(),s=function b(v,d,p){v===null&&(v=Function.prototype);var w=Object.getOwnPropertyDescriptor(v,d);if(w===void 0){var E=Object.getPrototypeOf(v);return E===null?void 0:b(E,d,p)}else{if("value"in w)return w.value;var x=w.get;return x===void 0?void 0:x.call(p)}},c=i(0),a=y(c);function y(b){return b&&b.__esModule?b:{default:b}}function g(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}function u(b,v){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:b}function l(b,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);b.prototype=Object.create(v&&v.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(b,v):b.__proto__=v)}var f={scope:a.default.Scope.INLINE,whitelist:["serif","monospace"]},h=new a.default.Attributor.Class("font","ql-font",f),m=function(b){l(v,b);function v(){return g(this,v),u(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return o(v,[{key:"value",value:function(p){return s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"value",this).call(this,p).replace(/["']/g,"")}}]),v}(a.default.Attributor.Style),k=new m("font","font-family",f);r.FontStyle=k,r.FontClass=h},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SizeStyle=r.SizeClass=void 0;var o=i(0),s=c(o);function c(g){return g&&g.__esModule?g:{default:g}}var a=new s.default.Attributor.Class("size","ql-size",{scope:s.default.Scope.INLINE,whitelist:["small","large","huge"]}),y=new s.default.Attributor.Style("size","font-size",{scope:s.default.Scope.INLINE,whitelist:["10px","18px","32px"]});r.SizeClass=a,r.SizeStyle=y},function(e,r,i){e.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.getLastChangeIndex=r.default=void 0;var o=function(){function d(p,w){for(var E=0;E<w.length;E++){var x=w[E];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,w,E){return w&&d(p.prototype,w),E&&d(p,E),p}}(),s=i(0),c=l(s),a=i(5),y=l(a),g=i(9),u=l(g);function l(d){return d&&d.__esModule?d:{default:d}}function f(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function h(d,p){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:d}function m(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(d,p):d.__proto__=p)}var k=function(d){m(p,d);function p(w,E){f(this,p);var x=h(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,w,E));return x.lastRecorded=0,x.ignoreChange=!1,x.clear(),x.quill.on(y.default.events.EDITOR_CHANGE,function(O,L,S,C){O!==y.default.events.TEXT_CHANGE||x.ignoreChange||(!x.options.userOnly||C===y.default.sources.USER?x.record(L,S):x.transform(L))}),x.quill.keyboard.addBinding({key:"Z",shortKey:!0},x.undo.bind(x)),x.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},x.redo.bind(x)),/Win/i.test(navigator.platform)&&x.quill.keyboard.addBinding({key:"Y",shortKey:!0},x.redo.bind(x)),x}return o(p,[{key:"change",value:function(E,x){if(this.stack[E].length!==0){var O=this.stack[E].pop();this.stack[x].push(O),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(O[E],y.default.sources.USER),this.ignoreChange=!1;var L=v(O[E]);this.quill.setSelection(L)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(E,x){if(E.ops.length!==0){this.stack.redo=[];var O=this.quill.getContents().diff(x),L=Date.now();if(this.lastRecorded+this.options.delay>L&&this.stack.undo.length>0){var S=this.stack.undo.pop();O=O.compose(S.undo),E=S.redo.compose(E)}else this.lastRecorded=L;this.stack.undo.push({redo:E,undo:O}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(E){this.stack.undo.forEach(function(x){x.undo=E.transform(x.undo,!0),x.redo=E.transform(x.redo,!0)}),this.stack.redo.forEach(function(x){x.undo=E.transform(x.undo,!0),x.redo=E.transform(x.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),p}(u.default);k.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function b(d){var p=d.ops[d.ops.length-1];return p==null?!1:p.insert!=null?typeof p.insert=="string"&&p.insert.endsWith(`
`):p.attributes!=null?Object.keys(p.attributes).some(function(w){return c.default.query(w,c.default.Scope.BLOCK)!=null}):!1}function v(d){var p=d.reduce(function(E,x){return E+=x.delete||0,E},0),w=d.length()-p;return b(d)&&(w-=1),w}r.default=k,r.getLastChangeIndex=v},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BaseTooltip=void 0;var o=function(){function H($,J){for(var X=0;X<J.length;X++){var j=J[X];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty($,j.key,j)}}return function($,J,X){return J&&H($.prototype,J),X&&H($,X),$}}(),s=function H($,J,X){$===null&&($=Function.prototype);var j=Object.getOwnPropertyDescriptor($,J);if(j===void 0){var Z=Object.getPrototypeOf($);return Z===null?void 0:H(Z,J,X)}else{if("value"in j)return j.value;var et=j.get;return et===void 0?void 0:et.call(X)}},c=i(3),a=L(c),y=i(2),g=L(y),u=i(8),l=L(u),f=i(23),h=L(f),m=i(34),k=L(m),b=i(59),v=L(b),d=i(60),p=L(d),w=i(28),E=L(w),x=i(61),O=L(x);function L(H){return H&&H.__esModule?H:{default:H}}function S(H,$){if(!(H instanceof $))throw new TypeError("Cannot call a class as a function")}function C(H,$){if(!H)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $&&(typeof $=="object"||typeof $=="function")?$:H}function T(H,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof $);H.prototype=Object.create($&&$.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),$&&(Object.setPrototypeOf?Object.setPrototypeOf(H,$):H.__proto__=$)}var N=[!1,"center","right","justify"],D=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],M=[!1,"serif","monospace"],F=["1","2","3",!1],G=["small",!1,"large","huge"],nt=function(H){T($,H);function $(J,X){S(this,$);var j=C(this,($.__proto__||Object.getPrototypeOf($)).call(this,J,X)),Z=function et(rt){if(!document.body.contains(J.root))return document.body.removeEventListener("click",et);j.tooltip!=null&&!j.tooltip.root.contains(rt.target)&&document.activeElement!==j.tooltip.textbox&&!j.quill.hasFocus()&&j.tooltip.hide(),j.pickers!=null&&j.pickers.forEach(function(st){st.container.contains(rt.target)||st.close()})};return J.emitter.listenDOM("click",document.body,Z),j}return o($,[{key:"addModule",value:function(X){var j=s($.prototype.__proto__||Object.getPrototypeOf($.prototype),"addModule",this).call(this,X);return X==="toolbar"&&this.extendToolbar(j),j}},{key:"buildButtons",value:function(X,j){X.forEach(function(Z){var et=Z.getAttribute("class")||"";et.split(/\s+/).forEach(function(rt){if(!!rt.startsWith("ql-")&&(rt=rt.slice(3),j[rt]!=null))if(rt==="direction")Z.innerHTML=j[rt][""]+j[rt].rtl;else if(typeof j[rt]=="string")Z.innerHTML=j[rt];else{var st=Z.value||"";st!=null&&j[rt][st]&&(Z.innerHTML=j[rt][st])}})})}},{key:"buildPickers",value:function(X,j){var Z=this;this.pickers=X.map(function(rt){if(rt.classList.contains("ql-align"))return rt.querySelector("option")==null&&B(rt,N),new p.default(rt,j.align);if(rt.classList.contains("ql-background")||rt.classList.contains("ql-color")){var st=rt.classList.contains("ql-background")?"background":"color";return rt.querySelector("option")==null&&B(rt,D,st==="background"?"#ffffff":"#000000"),new v.default(rt,j[st])}else return rt.querySelector("option")==null&&(rt.classList.contains("ql-font")?B(rt,M):rt.classList.contains("ql-header")?B(rt,F):rt.classList.contains("ql-size")&&B(rt,G)),new E.default(rt)});var et=function(){Z.pickers.forEach(function(st){st.update()})};this.quill.on(l.default.events.EDITOR_CHANGE,et)}}]),$}(k.default);nt.DEFAULTS=(0,a.default)(!0,{},k.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var $=this,J=this.container.querySelector("input.ql-image[type=file]");J==null&&(J=document.createElement("input"),J.setAttribute("type","file"),J.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),J.classList.add("ql-image"),J.addEventListener("change",function(){if(J.files!=null&&J.files[0]!=null){var X=new FileReader;X.onload=function(j){var Z=$.quill.getSelection(!0);$.quill.updateContents(new g.default().retain(Z.index).delete(Z.length).insert({image:j.target.result}),l.default.sources.USER),$.quill.setSelection(Z.index+1,l.default.sources.SILENT),J.value=""},X.readAsDataURL(J.files[0])}}),this.container.appendChild(J)),J.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var K=function(H){T($,H);function $(J,X){S(this,$);var j=C(this,($.__proto__||Object.getPrototypeOf($)).call(this,J,X));return j.textbox=j.root.querySelector('input[type="text"]'),j.listen(),j}return o($,[{key:"listen",value:function(){var X=this;this.textbox.addEventListener("keydown",function(j){h.default.match(j,"enter")?(X.save(),j.preventDefault()):h.default.match(j,"escape")&&(X.cancel(),j.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),j!=null?this.textbox.value=j:X!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+X)||""),this.root.setAttribute("data-mode",X)}},{key:"restoreFocus",value:function(){var X=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=X}},{key:"save",value:function(){var X=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var j=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",X,l.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",X,l.default.sources.USER)),this.quill.root.scrollTop=j;break}case"video":X=V(X);case"formula":{if(!X)break;var Z=this.quill.getSelection(!0);if(Z!=null){var et=Z.index+Z.length;this.quill.insertEmbed(et,this.root.getAttribute("data-mode"),X,l.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(et+1," ",l.default.sources.USER),this.quill.setSelection(et+2,l.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),$}(O.default);function V(H){var $=H.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||H.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return $?($[1]||"https")+"://www.youtube.com/embed/"+$[2]+"?showinfo=0":($=H.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?($[1]||"https")+"://player.vimeo.com/video/"+$[2]+"/":H}function B(H,$){var J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;$.forEach(function(X){var j=document.createElement("option");X===J?j.setAttribute("selected","selected"):j.setAttribute("value",X),H.appendChild(j)})}r.BaseTooltip=K,r.default=nt},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function s(){this.head=this.tail=null,this.length=0}return s.prototype.append=function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];this.insertBefore(c[0],null),c.length>1&&this.append.apply(this,c.slice(1))},s.prototype.contains=function(c){for(var a,y=this.iterator();a=y();)if(a===c)return!0;return!1},s.prototype.insertBefore=function(c,a){!c||(c.next=a,a!=null?(c.prev=a.prev,a.prev!=null&&(a.prev.next=c),a.prev=c,a===this.head&&(this.head=c)):this.tail!=null?(this.tail.next=c,c.prev=this.tail,this.tail=c):(c.prev=null,this.head=this.tail=c),this.length+=1)},s.prototype.offset=function(c){for(var a=0,y=this.head;y!=null;){if(y===c)return a;a+=y.length(),y=y.next}return-1},s.prototype.remove=function(c){!this.contains(c)||(c.prev!=null&&(c.prev.next=c.next),c.next!=null&&(c.next.prev=c.prev),c===this.head&&(this.head=c.next),c===this.tail&&(this.tail=c.prev),this.length-=1)},s.prototype.iterator=function(c){return c===void 0&&(c=this.head),function(){var a=c;return c!=null&&(c=c.next),a}},s.prototype.find=function(c,a){a===void 0&&(a=!1);for(var y,g=this.iterator();y=g();){var u=y.length();if(c<u||a&&c===u&&(y.next==null||y.next.length()!==0))return[y,c];c-=u}return[null,0]},s.prototype.forEach=function(c){for(var a,y=this.iterator();a=y();)c(a)},s.prototype.forEachAt=function(c,a,y){if(!(a<=0))for(var g=this.find(c),u=g[0],l=g[1],f,h=c-l,m=this.iterator(u);(f=m())&&h<c+a;){var k=f.length();c>h?y(f,c-h,Math.min(a,h+k-c)):y(f,0,Math.min(k,c+a-h)),h+=k}},s.prototype.map=function(c){return this.reduce(function(a,y){return a.push(c(y)),a},[])},s.prototype.reduce=function(c,a){for(var y,g=this.iterator();y=g();)a=c(a,y);return a},s}();r.default=o},function(e,r,i){var o=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,f){l.__proto__=f}||function(l,f){for(var h in f)f.hasOwnProperty(h)&&(l[h]=f[h])};return function(l,f){u(l,f);function h(){this.constructor=l}l.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(17),c=i(1),a={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},y=100,g=function(u){o(l,u);function l(f){var h=u.call(this,f)||this;return h.scroll=h,h.observer=new MutationObserver(function(m){h.update(m)}),h.observer.observe(h.domNode,a),h.attach(),h}return l.prototype.detach=function(){u.prototype.detach.call(this),this.observer.disconnect()},l.prototype.deleteAt=function(f,h){this.update(),f===0&&h===this.length()?this.children.forEach(function(m){m.remove()}):u.prototype.deleteAt.call(this,f,h)},l.prototype.formatAt=function(f,h,m,k){this.update(),u.prototype.formatAt.call(this,f,h,m,k)},l.prototype.insertAt=function(f,h,m){this.update(),u.prototype.insertAt.call(this,f,h,m)},l.prototype.optimize=function(f,h){var m=this;f===void 0&&(f=[]),h===void 0&&(h={}),u.prototype.optimize.call(this,h);for(var k=[].slice.call(this.observer.takeRecords());k.length>0;)f.push(k.pop());for(var b=function(w,E){E===void 0&&(E=!0),!(w==null||w===m)&&w.domNode.parentNode!=null&&(w.domNode[c.DATA_KEY].mutations==null&&(w.domNode[c.DATA_KEY].mutations=[]),E&&b(w.parent))},v=function(w){w.domNode[c.DATA_KEY]==null||w.domNode[c.DATA_KEY].mutations==null||(w instanceof s.default&&w.children.forEach(v),w.optimize(h))},d=f,p=0;d.length>0;p+=1){if(p>=y)throw new Error("[Parchment] Maximum optimize iterations reached");for(d.forEach(function(w){var E=c.find(w.target,!0);E!=null&&(E.domNode===w.target&&(w.type==="childList"?(b(c.find(w.previousSibling,!1)),[].forEach.call(w.addedNodes,function(x){var O=c.find(x,!1);b(O,!1),O instanceof s.default&&O.children.forEach(function(L){b(L,!1)})})):w.type==="attributes"&&b(E.prev)),b(E))}),this.children.forEach(v),d=[].slice.call(this.observer.takeRecords()),k=d.slice();k.length>0;)f.push(k.pop())}},l.prototype.update=function(f,h){var m=this;h===void 0&&(h={}),f=f||this.observer.takeRecords(),f.map(function(k){var b=c.find(k.target,!0);return b==null?null:b.domNode[c.DATA_KEY].mutations==null?(b.domNode[c.DATA_KEY].mutations=[k],b):(b.domNode[c.DATA_KEY].mutations.push(k),null)}).forEach(function(k){k==null||k===m||k.domNode[c.DATA_KEY]==null||k.update(k.domNode[c.DATA_KEY].mutations||[],h)}),this.domNode[c.DATA_KEY].mutations!=null&&u.prototype.update.call(this,this.domNode[c.DATA_KEY].mutations,h),this.optimize(f,h)},l.blotName="scroll",l.defaultChild="block",l.scope=c.Scope.BLOCK_BLOT,l.tagName="DIV",l}(s.default);r.default=g},function(e,r,i){var o=this&&this.__extends||function(){var g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,l){u.__proto__=l}||function(u,l){for(var f in l)l.hasOwnProperty(f)&&(u[f]=l[f])};return function(u,l){g(u,l);function f(){this.constructor=u}u.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(18),c=i(1);function a(g,u){if(Object.keys(g).length!==Object.keys(u).length)return!1;for(var l in g)if(g[l]!==u[l])return!1;return!0}var y=function(g){o(u,g);function u(){return g!==null&&g.apply(this,arguments)||this}return u.formats=function(l){if(l.tagName!==u.tagName)return g.formats.call(this,l)},u.prototype.format=function(l,f){var h=this;l===this.statics.blotName&&!f?(this.children.forEach(function(m){m instanceof s.default||(m=m.wrap(u.blotName,!0)),h.attributes.copy(m)}),this.unwrap()):g.prototype.format.call(this,l,f)},u.prototype.formatAt=function(l,f,h,m){if(this.formats()[h]!=null||c.query(h,c.Scope.ATTRIBUTE)){var k=this.isolate(l,f);k.format(h,m)}else g.prototype.formatAt.call(this,l,f,h,m)},u.prototype.optimize=function(l){g.prototype.optimize.call(this,l);var f=this.formats();if(Object.keys(f).length===0)return this.unwrap();var h=this.next;h instanceof u&&h.prev===this&&a(f,h.formats())&&(h.moveChildren(this),h.remove())},u.blotName="inline",u.scope=c.Scope.INLINE_BLOT,u.tagName="SPAN",u}(s.default);r.default=y},function(e,r,i){var o=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,u){g.__proto__=u}||function(g,u){for(var l in u)u.hasOwnProperty(l)&&(g[l]=u[l])};return function(g,u){y(g,u);function l(){this.constructor=g}g.prototype=u===null?Object.create(u):(l.prototype=u.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(18),c=i(1),a=function(y){o(g,y);function g(){return y!==null&&y.apply(this,arguments)||this}return g.formats=function(u){var l=c.query(g.blotName).tagName;if(u.tagName!==l)return y.formats.call(this,u)},g.prototype.format=function(u,l){c.query(u,c.Scope.BLOCK)!=null&&(u===this.statics.blotName&&!l?this.replaceWith(g.blotName):y.prototype.format.call(this,u,l))},g.prototype.formatAt=function(u,l,f,h){c.query(f,c.Scope.BLOCK)!=null?this.format(f,h):y.prototype.formatAt.call(this,u,l,f,h)},g.prototype.insertAt=function(u,l,f){if(f==null||c.query(l,c.Scope.INLINE)!=null)y.prototype.insertAt.call(this,u,l,f);else{var h=this.split(u),m=c.create(l,f);h.parent.insertBefore(m,h)}},g.prototype.update=function(u,l){navigator.userAgent.match(/Trident/)?this.build():y.prototype.update.call(this,u,l)},g.blotName="block",g.scope=c.Scope.BLOCK_BLOT,g.tagName="P",g}(s.default);r.default=a},function(e,r,i){var o=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var u in g)g.hasOwnProperty(u)&&(y[u]=g[u])};return function(y,g){a(y,g);function u(){this.constructor=y}y.prototype=g===null?Object.create(g):(u.prototype=g.prototype,new u)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(19),c=function(a){o(y,a);function y(){return a!==null&&a.apply(this,arguments)||this}return y.formats=function(g){},y.prototype.format=function(g,u){a.prototype.formatAt.call(this,0,this.length(),g,u)},y.prototype.formatAt=function(g,u,l,f){g===0&&u===this.length()?this.format(l,f):a.prototype.formatAt.call(this,g,u,l,f)},y.prototype.formats=function(){return this.statics.formats(this.domNode)},y}(s.default);r.default=c},function(e,r,i){var o=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,u){g.__proto__=u}||function(g,u){for(var l in u)u.hasOwnProperty(l)&&(g[l]=u[l])};return function(g,u){y(g,u);function l(){this.constructor=g}g.prototype=u===null?Object.create(u):(l.prototype=u.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=i(19),c=i(1),a=function(y){o(g,y);function g(u){var l=y.call(this,u)||this;return l.text=l.statics.value(l.domNode),l}return g.create=function(u){return document.createTextNode(u)},g.value=function(u){var l=u.data;return l.normalize&&(l=l.normalize()),l},g.prototype.deleteAt=function(u,l){this.domNode.data=this.text=this.text.slice(0,u)+this.text.slice(u+l)},g.prototype.index=function(u,l){return this.domNode===u?l:-1},g.prototype.insertAt=function(u,l,f){f==null?(this.text=this.text.slice(0,u)+l+this.text.slice(u),this.domNode.data=this.text):y.prototype.insertAt.call(this,u,l,f)},g.prototype.length=function(){return this.text.length},g.prototype.optimize=function(u){y.prototype.optimize.call(this,u),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof g&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},g.prototype.position=function(u,l){return[this.domNode,u]},g.prototype.split=function(u,l){if(l===void 0&&(l=!1),!l){if(u===0)return this;if(u===this.length())return this.next}var f=c.create(this.domNode.splitText(u));return this.parent.insertBefore(f,this.next),this.text=this.statics.value(this.domNode),f},g.prototype.update=function(u,l){var f=this;u.some(function(h){return h.type==="characterData"&&h.target===f.domNode})&&(this.text=this.statics.value(this.domNode))},g.prototype.value=function(){return this.text},g.blotName="text",g.scope=c.Scope.INLINE_BLOT,g}(s.default);r.default=a},function(e,r,i){var o=document.createElement("div");if(o.classList.toggle("test-class",!1),o.classList.contains("test-class")){var s=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(c,a){return arguments.length>1&&!this.contains(c)==!a?a:s.call(this,c)}}String.prototype.startsWith||(String.prototype.startsWith=function(c,a){return a=a||0,this.substr(a,c.length)===c}),String.prototype.endsWith||(String.prototype.endsWith=function(c,a){var y=this.toString();(typeof a!="number"||!isFinite(a)||Math.floor(a)!==a||a>y.length)&&(a=y.length),a-=c.length;var g=y.indexOf(c,a);return g!==-1&&g===a}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof a!="function")throw new TypeError("predicate must be a function");for(var y=Object(this),g=y.length>>>0,u=arguments[1],l,f=0;f<g;f++)if(l=y[f],a.call(u,l,f,y))return l}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(e,r){var i=-1,o=1,s=0;function c(p,w,E){if(p==w)return p?[[s,p]]:[];(E<0||p.length<E)&&(E=null);var x=u(p,w),O=p.substring(0,x);p=p.substring(x),w=w.substring(x),x=l(p,w);var L=p.substring(p.length-x);p=p.substring(0,p.length-x),w=w.substring(0,w.length-x);var S=a(p,w);return O&&S.unshift([s,O]),L&&S.push([s,L]),h(S),E!=null&&(S=b(S,E)),S=v(S),S}function a(p,w){var E;if(!p)return[[o,w]];if(!w)return[[i,p]];var x=p.length>w.length?p:w,O=p.length>w.length?w:p,L=x.indexOf(O);if(L!=-1)return E=[[o,x.substring(0,L)],[s,O],[o,x.substring(L+O.length)]],p.length>w.length&&(E[0][0]=E[2][0]=i),E;if(O.length==1)return[[i,p],[o,w]];var S=f(p,w);if(S){var C=S[0],T=S[1],N=S[2],D=S[3],M=S[4],F=c(C,N),G=c(T,D);return F.concat([[s,M]],G)}return y(p,w)}function y(p,w){for(var E=p.length,x=w.length,O=Math.ceil((E+x)/2),L=O,S=2*O,C=new Array(S),T=new Array(S),N=0;N<S;N++)C[N]=-1,T[N]=-1;C[L+1]=0,T[L+1]=0;for(var D=E-x,M=D%2!=0,F=0,G=0,nt=0,K=0,V=0;V<O;V++){for(var B=-V+F;B<=V-G;B+=2){var H=L+B,$;B==-V||B!=V&&C[H-1]<C[H+1]?$=C[H+1]:$=C[H-1]+1;for(var J=$-B;$<E&&J<x&&p.charAt($)==w.charAt(J);)$++,J++;if(C[H]=$,$>E)G+=2;else if(J>x)F+=2;else if(M){var X=L+D-B;if(X>=0&&X<S&&T[X]!=-1){var j=E-T[X];if($>=j)return g(p,w,$,J)}}}for(var Z=-V+nt;Z<=V-K;Z+=2){var X=L+Z,j;Z==-V||Z!=V&&T[X-1]<T[X+1]?j=T[X+1]:j=T[X-1]+1;for(var et=j-Z;j<E&&et<x&&p.charAt(E-j-1)==w.charAt(x-et-1);)j++,et++;if(T[X]=j,j>E)K+=2;else if(et>x)nt+=2;else if(!M){var H=L+D-Z;if(H>=0&&H<S&&C[H]!=-1){var $=C[H],J=L+$-H;if(j=E-j,$>=j)return g(p,w,$,J)}}}}return[[i,p],[o,w]]}function g(p,w,E,x){var O=p.substring(0,E),L=w.substring(0,x),S=p.substring(E),C=w.substring(x),T=c(O,L),N=c(S,C);return T.concat(N)}function u(p,w){if(!p||!w||p.charAt(0)!=w.charAt(0))return 0;for(var E=0,x=Math.min(p.length,w.length),O=x,L=0;E<O;)p.substring(L,O)==w.substring(L,O)?(E=O,L=E):x=O,O=Math.floor((x-E)/2+E);return O}function l(p,w){if(!p||!w||p.charAt(p.length-1)!=w.charAt(w.length-1))return 0;for(var E=0,x=Math.min(p.length,w.length),O=x,L=0;E<O;)p.substring(p.length-O,p.length-L)==w.substring(w.length-O,w.length-L)?(E=O,L=E):x=O,O=Math.floor((x-E)/2+E);return O}function f(p,w){var E=p.length>w.length?p:w,x=p.length>w.length?w:p;if(E.length<4||x.length*2<E.length)return null;function O(G,nt,K){for(var V=G.substring(K,K+Math.floor(G.length/4)),B=-1,H="",$,J,X,j;(B=nt.indexOf(V,B+1))!=-1;){var Z=u(G.substring(K),nt.substring(B)),et=l(G.substring(0,K),nt.substring(0,B));H.length<et+Z&&(H=nt.substring(B-et,B)+nt.substring(B,B+Z),$=G.substring(0,K-et),J=G.substring(K+Z),X=nt.substring(0,B-et),j=nt.substring(B+Z))}return H.length*2>=G.length?[$,J,X,j,H]:null}var L=O(E,x,Math.ceil(E.length/4)),S=O(E,x,Math.ceil(E.length/2)),C;if(!L&&!S)return null;S?L?C=L[4].length>S[4].length?L:S:C=S:C=L;var T,N,D,M;p.length>w.length?(T=C[0],N=C[1],D=C[2],M=C[3]):(D=C[0],M=C[1],T=C[2],N=C[3]);var F=C[4];return[T,N,D,M,F]}function h(p){p.push([s,""]);for(var w=0,E=0,x=0,O="",L="",S;w<p.length;)switch(p[w][0]){case o:x++,L+=p[w][1],w++;break;case i:E++,O+=p[w][1],w++;break;case s:E+x>1?(E!==0&&x!==0&&(S=u(L,O),S!==0&&(w-E-x>0&&p[w-E-x-1][0]==s?p[w-E-x-1][1]+=L.substring(0,S):(p.splice(0,0,[s,L.substring(0,S)]),w++),L=L.substring(S),O=O.substring(S)),S=l(L,O),S!==0&&(p[w][1]=L.substring(L.length-S)+p[w][1],L=L.substring(0,L.length-S),O=O.substring(0,O.length-S))),E===0?p.splice(w-x,E+x,[o,L]):x===0?p.splice(w-E,E+x,[i,O]):p.splice(w-E-x,E+x,[i,O],[o,L]),w=w-E-x+(E?1:0)+(x?1:0)+1):w!==0&&p[w-1][0]==s?(p[w-1][1]+=p[w][1],p.splice(w,1)):w++,x=0,E=0,O="",L="";break}p[p.length-1][1]===""&&p.pop();var C=!1;for(w=1;w<p.length-1;)p[w-1][0]==s&&p[w+1][0]==s&&(p[w][1].substring(p[w][1].length-p[w-1][1].length)==p[w-1][1]?(p[w][1]=p[w-1][1]+p[w][1].substring(0,p[w][1].length-p[w-1][1].length),p[w+1][1]=p[w-1][1]+p[w+1][1],p.splice(w-1,1),C=!0):p[w][1].substring(0,p[w+1][1].length)==p[w+1][1]&&(p[w-1][1]+=p[w+1][1],p[w][1]=p[w][1].substring(p[w+1][1].length)+p[w+1][1],p.splice(w+1,1),C=!0)),w++;C&&h(p)}var m=c;m.INSERT=o,m.DELETE=i,m.EQUAL=s,e.exports=m;function k(p,w){if(w===0)return[s,p];for(var E=0,x=0;x<p.length;x++){var O=p[x];if(O[0]===i||O[0]===s){var L=E+O[1].length;if(w===L)return[x+1,p];if(w<L){p=p.slice();var S=w-E,C=[O[0],O[1].slice(0,S)],T=[O[0],O[1].slice(S)];return p.splice(x,1,C,T),[x+1,p]}else E=L}}throw new Error("cursor_pos is out of bounds!")}function b(p,w){var E=k(p,w),x=E[1],O=E[0],L=x[O],S=x[O+1];if(L==null)return p;if(L[0]!==s)return p;if(S!=null&&L[1]+S[1]===S[1]+L[1])return x.splice(O,2,S,L),d(x,O,2);if(S!=null&&S[1].indexOf(L[1])===0){x.splice(O,2,[S[0],L[1]],[0,L[1]]);var C=S[1].slice(L[1].length);return C.length>0&&x.splice(O+2,0,[S[0],C]),d(x,O,3)}else return p}function v(p){for(var w=!1,E=function(S){return S.charCodeAt(0)>=56320&&S.charCodeAt(0)<=57343},x=function(S){return S.charCodeAt(S.length-1)>=55296&&S.charCodeAt(S.length-1)<=56319},O=2;O<p.length;O+=1)p[O-2][0]===s&&x(p[O-2][1])&&p[O-1][0]===i&&E(p[O-1][1])&&p[O][0]===o&&E(p[O][1])&&(w=!0,p[O-1][1]=p[O-2][1].slice(-1)+p[O-1][1],p[O][1]=p[O-2][1].slice(-1)+p[O][1],p[O-2][1]=p[O-2][1].slice(0,-1));if(!w)return p;for(var L=[],O=0;O<p.length;O+=1)p[O][1].length>0&&L.push(p[O]);return L}function d(p,w,E){for(var x=w+E-1;x>=0&&x>=w-1;x--)if(x+1<p.length){var O=p[x],L=p[x+1];O[0]===L[1]&&p.splice(x,2,[O[0],O[1]+L[1]])}return p}},function(e,r){r=e.exports=typeof Object.keys=="function"?Object.keys:i,r.shim=i;function i(o){var s=[];for(var c in o)s.push(c);return s}},function(e,r){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";r=e.exports=i?o:s,r.supported=o;function o(c){return Object.prototype.toString.call(c)=="[object Arguments]"}r.unsupported=s;function s(c){return c&&typeof c=="object"&&typeof c.length=="number"&&Object.prototype.hasOwnProperty.call(c,"callee")&&!Object.prototype.propertyIsEnumerable.call(c,"callee")||!1}},function(e,r){var i=Object.prototype.hasOwnProperty,o="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(o=!1));function c(y,g,u){this.fn=y,this.context=g,this.once=u||!1}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var g=[],u,l;if(this._eventsCount===0)return g;for(l in u=this._events)i.call(u,l)&&g.push(o?l.slice(1):l);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(u)):g},a.prototype.listeners=function(g,u){var l=o?o+g:g,f=this._events[l];if(u)return!!f;if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,k=new Array(m);h<m;h++)k[h]=f[h].fn;return k},a.prototype.emit=function(g,u,l,f,h,m){var k=o?o+g:g;if(!this._events[k])return!1;var b=this._events[k],v=arguments.length,d,p;if(b.fn){switch(b.once&&this.removeListener(g,b.fn,void 0,!0),v){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,u),!0;case 3:return b.fn.call(b.context,u,l),!0;case 4:return b.fn.call(b.context,u,l,f),!0;case 5:return b.fn.call(b.context,u,l,f,h),!0;case 6:return b.fn.call(b.context,u,l,f,h,m),!0}for(p=1,d=new Array(v-1);p<v;p++)d[p-1]=arguments[p];b.fn.apply(b.context,d)}else{var w=b.length,E;for(p=0;p<w;p++)switch(b[p].once&&this.removeListener(g,b[p].fn,void 0,!0),v){case 1:b[p].fn.call(b[p].context);break;case 2:b[p].fn.call(b[p].context,u);break;case 3:b[p].fn.call(b[p].context,u,l);break;case 4:b[p].fn.call(b[p].context,u,l,f);break;default:if(!d)for(E=1,d=new Array(v-1);E<v;E++)d[E-1]=arguments[E];b[p].fn.apply(b[p].context,d)}}return!0},a.prototype.on=function(g,u,l){var f=new c(u,l||this),h=o?o+g:g;return this._events[h]?this._events[h].fn?this._events[h]=[this._events[h],f]:this._events[h].push(f):(this._events[h]=f,this._eventsCount++),this},a.prototype.once=function(g,u,l){var f=new c(u,l||this,!0),h=o?o+g:g;return this._events[h]?this._events[h].fn?this._events[h]=[this._events[h],f]:this._events[h].push(f):(this._events[h]=f,this._eventsCount++),this},a.prototype.removeListener=function(g,u,l,f){var h=o?o+g:g;if(!this._events[h])return this;if(!u)return--this._eventsCount===0?this._events=new s:delete this._events[h],this;var m=this._events[h];if(m.fn)m.fn===u&&(!f||m.once)&&(!l||m.context===l)&&(--this._eventsCount===0?this._events=new s:delete this._events[h]);else{for(var k=0,b=[],v=m.length;k<v;k++)(m[k].fn!==u||f&&!m[k].once||l&&m[k].context!==l)&&b.push(m[k]);b.length?this._events[h]=b.length===1?b[0]:b:--this._eventsCount===0?this._events=new s:delete this._events[h]}return this},a.prototype.removeAllListeners=function(g){var u;return g?(u=o?o+g:g,this._events[u]&&(--this._eventsCount===0?this._events=new s:delete this._events[u])):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=o,a.EventEmitter=a,typeof e<"u"&&(e.exports=a)},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.matchText=r.matchSpacing=r.matchNewline=r.matchBlot=r.matchAttributor=r.default=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},s=function(){function q(P,_){var A=[],R=!0,z=!1,Y=void 0;try{for(var tt=P[Symbol.iterator](),ut;!(R=(ut=tt.next()).done)&&(A.push(ut.value),!(_&&A.length===_));R=!0);}catch(bt){z=!0,Y=bt}finally{try{!R&&tt.return&&tt.return()}finally{if(z)throw Y}}return A}return function(P,_){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return q(P,_);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function q(P,_){for(var A=0;A<_.length;A++){var R=_[A];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(P,R.key,R)}}return function(P,_,A){return _&&q(P.prototype,_),A&&q(P,A),P}}(),a=i(3),y=T(a),g=i(2),u=T(g),l=i(0),f=T(l),h=i(5),m=T(h),k=i(10),b=T(k),v=i(9),d=T(v),p=i(36),w=i(37),E=i(13),x=T(E),O=i(26),L=i(38),S=i(39),C=i(40);function T(q){return q&&q.__esModule?q:{default:q}}function N(q,P,_){return P in q?Object.defineProperty(q,P,{value:_,enumerable:!0,configurable:!0,writable:!0}):q[P]=_,q}function D(q,P){if(!(q instanceof P))throw new TypeError("Cannot call a class as a function")}function M(q,P){if(!q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:q}function F(q,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);q.prototype=Object.create(P&&P.prototype,{constructor:{value:q,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(q,P):q.__proto__=P)}var G=(0,b.default)("quill:clipboard"),nt="__ql-matcher",K=[[Node.TEXT_NODE,W],[Node.TEXT_NODE,gt],["br",ct],[Node.ELEMENT_NODE,gt],[Node.ELEMENT_NODE,st],[Node.ELEMENT_NODE,I],[Node.ELEMENT_NODE,rt],[Node.ELEMENT_NODE,U],["li",pt],["b",et.bind(et,"bold")],["i",et.bind(et,"italic")],["style",vt]],V=[p.AlignAttribute,L.DirectionAttribute].reduce(function(q,P){return q[P.keyName]=P,q},{}),B=[p.AlignStyle,w.BackgroundStyle,O.ColorStyle,L.DirectionStyle,S.FontStyle,C.SizeStyle].reduce(function(q,P){return q[P.keyName]=P,q},{}),H=function(q){F(P,q);function P(_,A){D(this,P);var R=M(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,_,A));return R.quill.root.addEventListener("paste",R.onPaste.bind(R)),R.container=R.quill.addContainer("ql-clipboard"),R.container.setAttribute("contenteditable",!0),R.container.setAttribute("tabindex",-1),R.matchers=[],K.concat(R.options.matchers).forEach(function(z){var Y=s(z,2),tt=Y[0],ut=Y[1];!A.matchVisual&&ut===I||R.addMatcher(tt,ut)}),R}return c(P,[{key:"addMatcher",value:function(A,R){this.matchers.push([A,R])}},{key:"convert",value:function(A){if(typeof A=="string")return this.container.innerHTML=A.replace(/\>\r?\n +\</g,"><"),this.convert();var R=this.quill.getFormat(this.quill.selection.savedRange.index);if(R[x.default.blotName]){var z=this.container.innerText;return this.container.innerHTML="",new u.default().insert(z,N({},x.default.blotName,R[x.default.blotName]))}var Y=this.prepareMatching(),tt=s(Y,2),ut=tt[0],bt=tt[1],mt=Z(this.container,ut,bt);return X(mt,`
`)&&mt.ops[mt.ops.length-1].attributes==null&&(mt=mt.compose(new u.default().retain(mt.length()-1).delete(1))),G.log("convert",this.container.innerHTML,mt),this.container.innerHTML="",mt}},{key:"dangerouslyPasteHTML",value:function(A,R){var z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.default.sources.API;if(typeof A=="string")this.quill.setContents(this.convert(A),R),this.quill.setSelection(0,m.default.sources.SILENT);else{var Y=this.convert(R);this.quill.updateContents(new u.default().retain(A).concat(Y),z),this.quill.setSelection(A+Y.length(),m.default.sources.SILENT)}}},{key:"onPaste",value:function(A){var R=this;if(!(A.defaultPrevented||!this.quill.isEnabled())){var z=this.quill.getSelection(),Y=new u.default().retain(z.index),tt=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(m.default.sources.SILENT),setTimeout(function(){Y=Y.concat(R.convert()).delete(z.length),R.quill.updateContents(Y,m.default.sources.USER),R.quill.setSelection(Y.length()-z.length,m.default.sources.SILENT),R.quill.scrollingContainer.scrollTop=tt,R.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var A=this,R=[],z=[];return this.matchers.forEach(function(Y){var tt=s(Y,2),ut=tt[0],bt=tt[1];switch(ut){case Node.TEXT_NODE:z.push(bt);break;case Node.ELEMENT_NODE:R.push(bt);break;default:[].forEach.call(A.container.querySelectorAll(ut),function(mt){mt[nt]=mt[nt]||[],mt[nt].push(bt)});break}}),[R,z]}}]),P}(d.default);H.DEFAULTS={matchers:[],matchVisual:!0};function $(q,P,_){return(typeof P>"u"?"undefined":o(P))==="object"?Object.keys(P).reduce(function(A,R){return $(A,R,P[R])},q):q.reduce(function(A,R){return R.attributes&&R.attributes[P]?A.push(R):A.insert(R.insert,(0,y.default)({},N({},P,_),R.attributes))},new u.default)}function J(q){if(q.nodeType!==Node.ELEMENT_NODE)return{};var P="__ql-computed-style";return q[P]||(q[P]=window.getComputedStyle(q))}function X(q,P){for(var _="",A=q.ops.length-1;A>=0&&_.length<P.length;--A){var R=q.ops[A];if(typeof R.insert!="string")break;_=R.insert+_}return _.slice(-1*P.length)===P}function j(q){if(q.childNodes.length===0)return!1;var P=J(q);return["block","list-item"].indexOf(P.display)>-1}function Z(q,P,_){return q.nodeType===q.TEXT_NODE?_.reduce(function(A,R){return R(q,A)},new u.default):q.nodeType===q.ELEMENT_NODE?[].reduce.call(q.childNodes||[],function(A,R){var z=Z(R,P,_);return R.nodeType===q.ELEMENT_NODE&&(z=P.reduce(function(Y,tt){return tt(R,Y)},z),z=(R[nt]||[]).reduce(function(Y,tt){return tt(R,Y)},z)),A.concat(z)},new u.default):new u.default}function et(q,P,_){return $(_,q,!0)}function rt(q,P){var _=f.default.Attributor.Attribute.keys(q),A=f.default.Attributor.Class.keys(q),R=f.default.Attributor.Style.keys(q),z={};return _.concat(A).concat(R).forEach(function(Y){var tt=f.default.query(Y,f.default.Scope.ATTRIBUTE);tt!=null&&(z[tt.attrName]=tt.value(q),z[tt.attrName])||(tt=V[Y],tt!=null&&(tt.attrName===Y||tt.keyName===Y)&&(z[tt.attrName]=tt.value(q)||void 0),tt=B[Y],tt!=null&&(tt.attrName===Y||tt.keyName===Y)&&(tt=B[Y],z[tt.attrName]=tt.value(q)||void 0))}),Object.keys(z).length>0&&(P=$(P,z)),P}function st(q,P){var _=f.default.query(q);if(_==null)return P;if(_.prototype instanceof f.default.Embed){var A={},R=_.value(q);R!=null&&(A[_.blotName]=R,P=new u.default().insert(A,_.formats(q)))}else typeof _.formats=="function"&&(P=$(P,_.blotName,_.formats(q)));return P}function ct(q,P){return X(P,`
`)||P.insert(`
`),P}function vt(){return new u.default}function pt(q,P){var _=f.default.query(q);if(_==null||_.blotName!=="list-item"||!X(P,`
`))return P;for(var A=-1,R=q.parentNode;!R.classList.contains("ql-clipboard");)(f.default.query(R)||{}).blotName==="list"&&(A+=1),R=R.parentNode;return A<=0?P:P.compose(new u.default().retain(P.length()-1).retain(1,{indent:A}))}function gt(q,P){return X(P,`
`)||(j(q)||P.length()>0&&q.nextSibling&&j(q.nextSibling))&&P.insert(`
`),P}function I(q,P){if(j(q)&&q.nextElementSibling!=null&&!X(P,`

`)){var _=q.offsetHeight+parseFloat(J(q).marginTop)+parseFloat(J(q).marginBottom);q.nextElementSibling.offsetTop>q.offsetTop+_*1.5&&P.insert(`
`)}return P}function U(q,P){var _={},A=q.style||{};return A.fontStyle&&J(q).fontStyle==="italic"&&(_.italic=!0),A.fontWeight&&(J(q).fontWeight.startsWith("bold")||parseInt(J(q).fontWeight)>=700)&&(_.bold=!0),Object.keys(_).length>0&&(P=$(P,_)),parseFloat(A.textIndent||0)>0&&(P=new u.default().insert("	").concat(P)),P}function W(q,P){var _=q.data;if(q.parentNode.tagName==="O:P")return P.insert(_.trim());if(_.trim().length===0&&q.parentNode.classList.contains("ql-clipboard"))return P;if(!J(q.parentNode).whiteSpace.startsWith("pre")){var A=function(z,Y){return Y=Y.replace(/[^\u00a0]/g,""),Y.length<1&&z?" ":Y};_=_.replace(/\r\n/g," ").replace(/\n/g," "),_=_.replace(/\s\s+/g,A.bind(A,!0)),(q.previousSibling==null&&j(q.parentNode)||q.previousSibling!=null&&j(q.previousSibling))&&(_=_.replace(/^\s+/,A.bind(A,!1))),(q.nextSibling==null&&j(q.parentNode)||q.nextSibling!=null&&j(q.nextSibling))&&(_=_.replace(/\s+$/,A.bind(A,!1)))}return P.insert(_)}r.default=H,r.matchAttributor=rt,r.matchBlot=st,r.matchNewline=gt,r.matchSpacing=I,r.matchText=W},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,k){for(var b=0;b<k.length;b++){var v=k[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,k,b){return k&&h(m.prototype,k),b&&h(m,b),m}}(),s=function h(m,k,b){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,k);if(v===void 0){var d=Object.getPrototypeOf(m);return d===null?void 0:h(d,k,b)}else{if("value"in v)return v.value;var p=v.get;return p===void 0?void 0:p.call(b)}},c=i(6),a=y(c);function y(h){return h&&h.__esModule?h:{default:h}}function g(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function u(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=function(h){l(m,h);function m(){return g(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return o(m,[{key:"optimize",value:function(b){s(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"optimize",this).call(this,b),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return s(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),m}(a.default);f.blotName="bold",f.tagName=["STRONG","B"],r.default=f},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.addControls=r.default=void 0;var o=function(){function C(T,N){var D=[],M=!0,F=!1,G=void 0;try{for(var nt=T[Symbol.iterator](),K;!(M=(K=nt.next()).done)&&(D.push(K.value),!(N&&D.length===N));M=!0);}catch(V){F=!0,G=V}finally{try{!M&&nt.return&&nt.return()}finally{if(F)throw G}}return D}return function(T,N){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return C(T,N);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function C(T,N){for(var D=0;D<N.length;D++){var M=N[D];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(T,M.key,M)}}return function(T,N,D){return N&&C(T.prototype,N),D&&C(T,D),T}}(),c=i(2),a=b(c),y=i(0),g=b(y),u=i(5),l=b(u),f=i(10),h=b(f),m=i(9),k=b(m);function b(C){return C&&C.__esModule?C:{default:C}}function v(C,T,N){return T in C?Object.defineProperty(C,T,{value:N,enumerable:!0,configurable:!0,writable:!0}):C[T]=N,C}function d(C,T){if(!(C instanceof T))throw new TypeError("Cannot call a class as a function")}function p(C,T){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:C}function w(C,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);C.prototype=Object.create(T&&T.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(C,T):C.__proto__=T)}var E=(0,h.default)("quill:toolbar"),x=function(C){w(T,C);function T(N,D){d(this,T);var M=p(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,N,D));if(Array.isArray(M.options.container)){var F=document.createElement("div");L(F,M.options.container),N.container.parentNode.insertBefore(F,N.container),M.container=F}else typeof M.options.container=="string"?M.container=document.querySelector(M.options.container):M.container=M.options.container;if(!(M.container instanceof HTMLElement)){var G;return G=E.error("Container required for toolbar",M.options),p(M,G)}return M.container.classList.add("ql-toolbar"),M.controls=[],M.handlers={},Object.keys(M.options.handlers).forEach(function(nt){M.addHandler(nt,M.options.handlers[nt])}),[].forEach.call(M.container.querySelectorAll("button, select"),function(nt){M.attach(nt)}),M.quill.on(l.default.events.EDITOR_CHANGE,function(nt,K){nt===l.default.events.SELECTION_CHANGE&&M.update(K)}),M.quill.on(l.default.events.SCROLL_OPTIMIZE,function(){var nt=M.quill.selection.getRange(),K=o(nt,1),V=K[0];M.update(V)}),M}return s(T,[{key:"addHandler",value:function(D,M){this.handlers[D]=M}},{key:"attach",value:function(D){var M=this,F=[].find.call(D.classList,function(nt){return nt.indexOf("ql-")===0});if(!!F){if(F=F.slice(3),D.tagName==="BUTTON"&&D.setAttribute("type","button"),this.handlers[F]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[F]==null){E.warn("ignoring attaching to disabled format",F,D);return}if(g.default.query(F)==null){E.warn("ignoring attaching to nonexistent format",F,D);return}}var G=D.tagName==="SELECT"?"change":"click";D.addEventListener(G,function(nt){var K=void 0;if(D.tagName==="SELECT"){if(D.selectedIndex<0)return;var V=D.options[D.selectedIndex];V.hasAttribute("selected")?K=!1:K=V.value||!1}else D.classList.contains("ql-active")?K=!1:K=D.value||!D.hasAttribute("value"),nt.preventDefault();M.quill.focus();var B=M.quill.selection.getRange(),H=o(B,1),$=H[0];if(M.handlers[F]!=null)M.handlers[F].call(M,K);else if(g.default.query(F).prototype instanceof g.default.Embed){if(K=prompt("Enter "+F),!K)return;M.quill.updateContents(new a.default().retain($.index).delete($.length).insert(v({},F,K)),l.default.sources.USER)}else M.quill.format(F,K,l.default.sources.USER);M.update($)}),this.controls.push([F,D])}}},{key:"update",value:function(D){var M=D==null?{}:this.quill.getFormat(D);this.controls.forEach(function(F){var G=o(F,2),nt=G[0],K=G[1];if(K.tagName==="SELECT"){var V=void 0;if(D==null)V=null;else if(M[nt]==null)V=K.querySelector("option[selected]");else if(!Array.isArray(M[nt])){var B=M[nt];typeof B=="string"&&(B=B.replace(/\"/g,'\\"')),V=K.querySelector('option[value="'+B+'"]')}V==null?(K.value="",K.selectedIndex=-1):V.selected=!0}else if(D==null)K.classList.remove("ql-active");else if(K.hasAttribute("value")){var H=M[nt]===K.getAttribute("value")||M[nt]!=null&&M[nt].toString()===K.getAttribute("value")||M[nt]==null&&!K.getAttribute("value");K.classList.toggle("ql-active",H)}else K.classList.toggle("ql-active",M[nt]!=null)})}}]),T}(k.default);x.DEFAULTS={};function O(C,T,N){var D=document.createElement("button");D.setAttribute("type","button"),D.classList.add("ql-"+T),N!=null&&(D.value=N),C.appendChild(D)}function L(C,T){Array.isArray(T[0])||(T=[T]),T.forEach(function(N){var D=document.createElement("span");D.classList.add("ql-formats"),N.forEach(function(M){if(typeof M=="string")O(D,M);else{var F=Object.keys(M)[0],G=M[F];Array.isArray(G)?S(D,F,G):O(D,F,G)}}),C.appendChild(D)})}function S(C,T,N){var D=document.createElement("select");D.classList.add("ql-"+T),N.forEach(function(M){var F=document.createElement("option");M!==!1?F.setAttribute("value",M):F.setAttribute("selected","selected"),D.appendChild(F)}),C.appendChild(D)}x.DEFAULTS={container:null,handlers:{clean:function(){var T=this,N=this.quill.getSelection();if(N!=null)if(N.length==0){var D=this.quill.getFormat();Object.keys(D).forEach(function(M){g.default.query(M,g.default.Scope.INLINE)!=null&&T.quill.format(M,!1)})}else this.quill.removeFormat(N,l.default.sources.USER)},direction:function(T){var N=this.quill.getFormat().align;T==="rtl"&&N==null?this.quill.format("align","right",l.default.sources.USER):!T&&N==="right"&&this.quill.format("align",!1,l.default.sources.USER),this.quill.format("direction",T,l.default.sources.USER)},indent:function(T){var N=this.quill.getSelection(),D=this.quill.getFormat(N),M=parseInt(D.indent||0);if(T==="+1"||T==="-1"){var F=T==="+1"?1:-1;D.direction==="rtl"&&(F*=-1),this.quill.format("indent",M+F,l.default.sources.USER)}},link:function(T){T===!0&&(T=prompt("Enter link URL:")),this.quill.format("link",T,l.default.sources.USER)},list:function(T){var N=this.quill.getSelection(),D=this.quill.getFormat(N);T==="check"?D.list==="checked"||D.list==="unchecked"?this.quill.format("list",!1,l.default.sources.USER):this.quill.format("list","unchecked",l.default.sources.USER):this.quill.format("list",T,l.default.sources.USER)}}},r.default=x,r.addControls=L},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,k){for(var b=0;b<k.length;b++){var v=k[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,k,b){return k&&h(m.prototype,k),b&&h(m,b),m}}(),s=function h(m,k,b){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,k);if(v===void 0){var d=Object.getPrototypeOf(m);return d===null?void 0:h(d,k,b)}else{if("value"in v)return v.value;var p=v.get;return p===void 0?void 0:p.call(b)}},c=i(28),a=y(c);function y(h){return h&&h.__esModule?h:{default:h}}function g(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function u(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=function(h){l(m,h);function m(k,b){g(this,m);var v=u(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,k));return v.label.innerHTML=b,v.container.classList.add("ql-color-picker"),[].slice.call(v.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(d){d.classList.add("ql-primary")}),v}return o(m,[{key:"buildItem",value:function(b){var v=s(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"buildItem",this).call(this,b);return v.style.backgroundColor=b.getAttribute("value")||"",v}},{key:"selectItem",value:function(b,v){s(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"selectItem",this).call(this,b,v);var d=this.label.querySelector(".ql-color-label"),p=b&&b.getAttribute("data-value")||"";d&&(d.tagName==="line"?d.style.stroke=p:d.style.fill=p)}}]),m}(a.default);r.default=f},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,k){for(var b=0;b<k.length;b++){var v=k[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,k,b){return k&&h(m.prototype,k),b&&h(m,b),m}}(),s=function h(m,k,b){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,k);if(v===void 0){var d=Object.getPrototypeOf(m);return d===null?void 0:h(d,k,b)}else{if("value"in v)return v.value;var p=v.get;return p===void 0?void 0:p.call(b)}},c=i(28),a=y(c);function y(h){return h&&h.__esModule?h:{default:h}}function g(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function u(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=function(h){l(m,h);function m(k,b){g(this,m);var v=u(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,k));return v.container.classList.add("ql-icon-picker"),[].forEach.call(v.container.querySelectorAll(".ql-picker-item"),function(d){d.innerHTML=b[d.getAttribute("data-value")||""]}),v.defaultItem=v.container.querySelector(".ql-selected"),v.selectItem(v.defaultItem),v}return o(m,[{key:"selectItem",value:function(b,v){s(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"selectItem",this).call(this,b,v),b=b||this.defaultItem,this.label.innerHTML=b.innerHTML}}]),m}(a.default);r.default=f},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function a(y,g){for(var u=0;u<g.length;u++){var l=g[u];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(y,l.key,l)}}return function(y,g,u){return g&&a(y.prototype,g),u&&a(y,u),y}}();function s(a,y){if(!(a instanceof y))throw new TypeError("Cannot call a class as a function")}var c=function(){function a(y,g){var u=this;s(this,a),this.quill=y,this.boundsContainer=g||document.body,this.root=y.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){u.root.style.marginTop=-1*u.quill.root.scrollTop+"px"}),this.hide()}return o(a,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(g){var u=g.left+g.width/2-this.root.offsetWidth/2,l=g.bottom+this.quill.root.scrollTop;this.root.style.left=u+"px",this.root.style.top=l+"px",this.root.classList.remove("ql-flip");var f=this.boundsContainer.getBoundingClientRect(),h=this.root.getBoundingClientRect(),m=0;if(h.right>f.right&&(m=f.right-h.right,this.root.style.left=u+m+"px"),h.left<f.left&&(m=f.left-h.left,this.root.style.left=u+m+"px"),h.bottom>f.bottom){var k=h.bottom-h.top,b=g.bottom-g.top+k;this.root.style.top=l-b+"px",this.root.classList.add("ql-flip")}return m}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),a}();r.default=c},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function S(C,T){var N=[],D=!0,M=!1,F=void 0;try{for(var G=C[Symbol.iterator](),nt;!(D=(nt=G.next()).done)&&(N.push(nt.value),!(T&&N.length===T));D=!0);}catch(K){M=!0,F=K}finally{try{!D&&G.return&&G.return()}finally{if(M)throw F}}return N}return function(C,T){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return S(C,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function S(C,T,N){C===null&&(C=Function.prototype);var D=Object.getOwnPropertyDescriptor(C,T);if(D===void 0){var M=Object.getPrototypeOf(C);return M===null?void 0:S(M,T,N)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(N)}},c=function(){function S(C,T){for(var N=0;N<T.length;N++){var D=T[N];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(C,D.key,D)}}return function(C,T,N){return T&&S(C.prototype,T),N&&S(C,N),C}}(),a=i(3),y=d(a),g=i(8),u=d(g),l=i(43),f=d(l),h=i(27),m=d(h),k=i(15),b=i(41),v=d(b);function d(S){return S&&S.__esModule?S:{default:S}}function p(S,C){if(!(S instanceof C))throw new TypeError("Cannot call a class as a function")}function w(S,C){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:S}function E(S,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);S.prototype=Object.create(C&&C.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(S,C):S.__proto__=C)}var x=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],O=function(S){E(C,S);function C(T,N){p(this,C),N.modules.toolbar!=null&&N.modules.toolbar.container==null&&(N.modules.toolbar.container=x);var D=w(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,T,N));return D.quill.container.classList.add("ql-snow"),D}return c(C,[{key:"extendToolbar",value:function(N){N.container.classList.add("ql-snow"),this.buildButtons([].slice.call(N.container.querySelectorAll("button")),v.default),this.buildPickers([].slice.call(N.container.querySelectorAll("select")),v.default),this.tooltip=new L(this.quill,this.options.bounds),N.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(D,M){N.handlers.link.call(N,!M.format.link)})}}]),C}(f.default);O.DEFAULTS=(0,y.default)(!0,{},f.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(C){if(C){var T=this.quill.getSelection();if(T==null||T.length==0)return;var N=this.quill.getText(T);/^\S+@\S+\.\S+$/.test(N)&&N.indexOf("mailto:")!==0&&(N="mailto:"+N);var D=this.quill.theme.tooltip;D.edit("link",N)}else this.quill.format("link",!1)}}}}});var L=function(S){E(C,S);function C(T,N){p(this,C);var D=w(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,T,N));return D.preview=D.root.querySelector("a.ql-preview"),D}return c(C,[{key:"listen",value:function(){var N=this;s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(D){N.root.classList.contains("ql-editing")?N.save():N.edit("link",N.preview.textContent),D.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(D){if(N.linkRange!=null){var M=N.linkRange;N.restoreFocus(),N.quill.formatText(M,"link",!1,u.default.sources.USER),delete N.linkRange}D.preventDefault(),N.hide()}),this.quill.on(u.default.events.SELECTION_CHANGE,function(D,M,F){if(D!=null){if(D.length===0&&F===u.default.sources.USER){var G=N.quill.scroll.descendant(m.default,D.index),nt=o(G,2),K=nt[0],V=nt[1];if(K!=null){N.linkRange=new k.Range(D.index-V,K.length());var B=m.default.formats(K.domNode);N.preview.textContent=B,N.preview.setAttribute("href",B),N.show(),N.position(N.quill.getBounds(N.linkRange));return}}else delete N.linkRange;N.hide()}})}},{key:"show",value:function(){s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),C}(l.BaseTooltip);L.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),r.default=O},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(29),s=R(o),c=i(36),a=i(38),y=i(64),g=i(65),u=R(g),l=i(66),f=R(l),h=i(67),m=R(h),k=i(37),b=i(26),v=i(39),d=i(40),p=i(56),w=R(p),E=i(68),x=R(E),O=i(27),L=R(O),S=i(69),C=R(S),T=i(70),N=R(T),D=i(71),M=R(D),F=i(72),G=R(F),nt=i(73),K=R(nt),V=i(13),B=R(V),H=i(74),$=R(H),J=i(75),X=R(J),j=i(57),Z=R(j),et=i(41),rt=R(et),st=i(28),ct=R(st),vt=i(59),pt=R(vt),gt=i(60),I=R(gt),U=i(61),W=R(U),q=i(108),P=R(q),_=i(62),A=R(_);function R(z){return z&&z.__esModule?z:{default:z}}s.default.register({"attributors/attribute/direction":a.DirectionAttribute,"attributors/class/align":c.AlignClass,"attributors/class/background":k.BackgroundClass,"attributors/class/color":b.ColorClass,"attributors/class/direction":a.DirectionClass,"attributors/class/font":v.FontClass,"attributors/class/size":d.SizeClass,"attributors/style/align":c.AlignStyle,"attributors/style/background":k.BackgroundStyle,"attributors/style/color":b.ColorStyle,"attributors/style/direction":a.DirectionStyle,"attributors/style/font":v.FontStyle,"attributors/style/size":d.SizeStyle},!0),s.default.register({"formats/align":c.AlignClass,"formats/direction":a.DirectionClass,"formats/indent":y.IndentClass,"formats/background":k.BackgroundStyle,"formats/color":b.ColorStyle,"formats/font":v.FontClass,"formats/size":d.SizeClass,"formats/blockquote":u.default,"formats/code-block":B.default,"formats/header":f.default,"formats/list":m.default,"formats/bold":w.default,"formats/code":V.Code,"formats/italic":x.default,"formats/link":L.default,"formats/script":C.default,"formats/strike":N.default,"formats/underline":M.default,"formats/image":G.default,"formats/video":K.default,"formats/list/item":h.ListItem,"modules/formula":$.default,"modules/syntax":X.default,"modules/toolbar":Z.default,"themes/bubble":P.default,"themes/snow":A.default,"ui/icons":rt.default,"ui/picker":ct.default,"ui/icon-picker":I.default,"ui/color-picker":pt.default,"ui/tooltip":W.default},!0),r.default=s.default},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.IndentClass=void 0;var o=function(){function m(k,b){for(var v=0;v<b.length;v++){var d=b[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(k,d.key,d)}}return function(k,b,v){return b&&m(k.prototype,b),v&&m(k,v),k}}(),s=function m(k,b,v){k===null&&(k=Function.prototype);var d=Object.getOwnPropertyDescriptor(k,b);if(d===void 0){var p=Object.getPrototypeOf(k);return p===null?void 0:m(p,b,v)}else{if("value"in d)return d.value;var w=d.get;return w===void 0?void 0:w.call(v)}},c=i(0),a=y(c);function y(m){return m&&m.__esModule?m:{default:m}}function g(m,k){if(!(m instanceof k))throw new TypeError("Cannot call a class as a function")}function u(m,k){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:m}function l(m,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);m.prototype=Object.create(k&&k.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(m,k):m.__proto__=k)}var f=function(m){l(k,m);function k(){return g(this,k),u(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}return o(k,[{key:"add",value:function(v,d){if(d==="+1"||d==="-1"){var p=this.value(v)||0;d=d==="+1"?p+1:p-1}return d===0?(this.remove(v),!0):s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"add",this).call(this,v,d)}},{key:"canAdd",value:function(v,d){return s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"canAdd",this).call(this,v,d)||s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"canAdd",this).call(this,v,parseInt(d))}},{key:"value",value:function(v){return parseInt(s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"value",this).call(this,v))||void 0}}]),k}(a.default.Attributor.Class),h=new f("indent","ql-indent",{scope:a.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});r.IndentClass=h},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(4),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function a(l,f){if(!(l instanceof f))throw new TypeError("Cannot call a class as a function")}function y(l,f){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:l}function g(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);l.prototype=Object.create(f&&f.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(l,f):l.__proto__=f)}var u=function(l){g(f,l);function f(){return a(this,f),y(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return f}(s.default);u.blotName="blockquote",u.tagName="blockquote",r.default=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function f(h,m){for(var k=0;k<m.length;k++){var b=m[k];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,m,k){return m&&f(h.prototype,m),k&&f(h,k),h}}(),s=i(4),c=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function y(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function g(f,h){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:f}function u(f,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);f.prototype=Object.create(h&&h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(f,h):f.__proto__=h)}var l=function(f){u(h,f);function h(){return y(this,h),g(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}return o(h,null,[{key:"formats",value:function(k){return this.tagName.indexOf(k.tagName)+1}}]),h}(c.default);l.blotName="header",l.tagName=["H1","H2","H3","H4","H5","H6"],r.default=l},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ListItem=void 0;var o=function(){function p(w,E){for(var x=0;x<E.length;x++){var O=E[x];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(w,O.key,O)}}return function(w,E,x){return E&&p(w.prototype,E),x&&p(w,x),w}}(),s=function p(w,E,x){w===null&&(w=Function.prototype);var O=Object.getOwnPropertyDescriptor(w,E);if(O===void 0){var L=Object.getPrototypeOf(w);return L===null?void 0:p(L,E,x)}else{if("value"in O)return O.value;var S=O.get;return S===void 0?void 0:S.call(x)}},c=i(0),a=f(c),y=i(4),g=f(y),u=i(25),l=f(u);function f(p){return p&&p.__esModule?p:{default:p}}function h(p,w,E){return w in p?Object.defineProperty(p,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):p[w]=E,p}function m(p,w){if(!(p instanceof w))throw new TypeError("Cannot call a class as a function")}function k(p,w){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:p}function b(p,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);p.prototype=Object.create(w&&w.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(p,w):p.__proto__=w)}var v=function(p){b(w,p);function w(){return m(this,w),k(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return o(w,[{key:"format",value:function(x,O){x===d.blotName&&!O?this.replaceWith(a.default.create(this.statics.scope)):s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,x,O)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(x,O){return this.parent.isolate(this.offset(this.parent),this.length()),x===this.parent.statics.blotName?(this.parent.replaceWith(x,O),this):(this.parent.unwrap(),s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"replaceWith",this).call(this,x,O))}}],[{key:"formats",value:function(x){return x.tagName===this.tagName?void 0:s(w.__proto__||Object.getPrototypeOf(w),"formats",this).call(this,x)}}]),w}(g.default);v.blotName="list-item",v.tagName="LI";var d=function(p){b(w,p),o(w,null,[{key:"create",value:function(x){var O=x==="ordered"?"OL":"UL",L=s(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,O);return(x==="checked"||x==="unchecked")&&L.setAttribute("data-checked",x==="checked"),L}},{key:"formats",value:function(x){if(x.tagName==="OL")return"ordered";if(x.tagName==="UL")return x.hasAttribute("data-checked")?x.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function w(E){m(this,w);var x=k(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,E)),O=function(S){if(S.target.parentNode===E){var C=x.statics.formats(E),T=a.default.find(S.target);C==="checked"?T.format("list","unchecked"):C==="unchecked"&&T.format("list","checked")}};return E.addEventListener("touchstart",O),E.addEventListener("mousedown",O),x}return o(w,[{key:"format",value:function(x,O){this.children.length>0&&this.children.tail.format(x,O)}},{key:"formats",value:function(){return h({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(x,O){if(x instanceof v)s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertBefore",this).call(this,x,O);else{var L=O==null?this.length():O.offset(this),S=this.split(L);S.parent.insertBefore(x,S)}}},{key:"optimize",value:function(x){s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"optimize",this).call(this,x);var O=this.next;O!=null&&O.prev===this&&O.statics.blotName===this.statics.blotName&&O.domNode.tagName===this.domNode.tagName&&O.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(O.moveChildren(this),O.remove())}},{key:"replace",value:function(x){if(x.statics.blotName!==this.statics.blotName){var O=a.default.create(this.statics.defaultChild);x.moveChildren(O),this.appendChild(O)}s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"replace",this).call(this,x)}}]),w}(l.default);d.blotName="list",d.scope=a.default.Scope.BLOCK_BLOT,d.tagName=["OL","UL"],d.defaultChild="list-item",d.allowedChildren=[v],r.ListItem=v,r.default=d},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(56),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function a(l,f){if(!(l instanceof f))throw new TypeError("Cannot call a class as a function")}function y(l,f){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:l}function g(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);l.prototype=Object.create(f&&f.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(l,f):l.__proto__=f)}var u=function(l){g(f,l);function f(){return a(this,f),y(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return f}(s.default);u.blotName="italic",u.tagName=["EM","I"],r.default=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,k){for(var b=0;b<k.length;b++){var v=k[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,k,b){return k&&h(m.prototype,k),b&&h(m,b),m}}(),s=function h(m,k,b){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,k);if(v===void 0){var d=Object.getPrototypeOf(m);return d===null?void 0:h(d,k,b)}else{if("value"in v)return v.value;var p=v.get;return p===void 0?void 0:p.call(b)}},c=i(6),a=y(c);function y(h){return h&&h.__esModule?h:{default:h}}function g(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function u(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=function(h){l(m,h);function m(){return g(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return o(m,null,[{key:"create",value:function(b){return b==="super"?document.createElement("sup"):b==="sub"?document.createElement("sub"):s(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,b)}},{key:"formats",value:function(b){if(b.tagName==="SUB")return"sub";if(b.tagName==="SUP")return"super"}}]),m}(a.default);f.blotName="script",f.tagName=["SUB","SUP"],r.default=f},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function a(l,f){if(!(l instanceof f))throw new TypeError("Cannot call a class as a function")}function y(l,f){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:l}function g(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);l.prototype=Object.create(f&&f.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(l,f):l.__proto__=f)}var u=function(l){g(f,l);function f(){return a(this,f),y(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return f}(s.default);u.blotName="strike",u.tagName="S",r.default=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function a(l,f){if(!(l instanceof f))throw new TypeError("Cannot call a class as a function")}function y(l,f){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:l}function g(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);l.prototype=Object.create(f&&f.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(l,f):l.__proto__=f)}var u=function(l){g(f,l);function f(){return a(this,f),y(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return f}(s.default);u.blotName="underline",u.tagName="U",r.default=u},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function k(b,v){for(var d=0;d<v.length;d++){var p=v[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,v,d){return v&&k(b.prototype,v),d&&k(b,d),b}}(),s=function k(b,v,d){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,v);if(p===void 0){var w=Object.getPrototypeOf(b);return w===null?void 0:k(w,v,d)}else{if("value"in p)return p.value;var E=p.get;return E===void 0?void 0:E.call(d)}},c=i(0),a=g(c),y=i(27);function g(k){return k&&k.__esModule?k:{default:k}}function u(k,b){if(!(k instanceof b))throw new TypeError("Cannot call a class as a function")}function l(k,b){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:k}function f(k,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);k.prototype=Object.create(b&&b.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(k,b):k.__proto__=b)}var h=["alt","height","width"],m=function(k){f(b,k);function b(){return u(this,b),l(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"format",value:function(d,p){h.indexOf(d)>-1?p?this.domNode.setAttribute(d,p):this.domNode.removeAttribute(d):s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,d,p)}}],[{key:"create",value:function(d){var p=s(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,d);return typeof d=="string"&&p.setAttribute("src",this.sanitize(d)),p}},{key:"formats",value:function(d){return h.reduce(function(p,w){return d.hasAttribute(w)&&(p[w]=d.getAttribute(w)),p},{})}},{key:"match",value:function(d){return/\.(jpe?g|gif|png)$/.test(d)||/^data:image\/.+;base64/.test(d)}},{key:"sanitize",value:function(d){return(0,y.sanitize)(d,["http","https","data"])?d:"//:0"}},{key:"value",value:function(d){return d.getAttribute("src")}}]),b}(a.default.Embed);m.blotName="image",m.tagName="IMG",r.default=m},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function k(b,v){for(var d=0;d<v.length;d++){var p=v[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,v,d){return v&&k(b.prototype,v),d&&k(b,d),b}}(),s=function k(b,v,d){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,v);if(p===void 0){var w=Object.getPrototypeOf(b);return w===null?void 0:k(w,v,d)}else{if("value"in p)return p.value;var E=p.get;return E===void 0?void 0:E.call(d)}},c=i(4),a=i(27),y=g(a);function g(k){return k&&k.__esModule?k:{default:k}}function u(k,b){if(!(k instanceof b))throw new TypeError("Cannot call a class as a function")}function l(k,b){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:k}function f(k,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);k.prototype=Object.create(b&&b.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(k,b):k.__proto__=b)}var h=["height","width"],m=function(k){f(b,k);function b(){return u(this,b),l(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"format",value:function(d,p){h.indexOf(d)>-1?p?this.domNode.setAttribute(d,p):this.domNode.removeAttribute(d):s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,d,p)}}],[{key:"create",value:function(d){var p=s(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,d);return p.setAttribute("frameborder","0"),p.setAttribute("allowfullscreen",!0),p.setAttribute("src",this.sanitize(d)),p}},{key:"formats",value:function(d){return h.reduce(function(p,w){return d.hasAttribute(w)&&(p[w]=d.getAttribute(w)),p},{})}},{key:"sanitize",value:function(d){return y.default.sanitize(d)}},{key:"value",value:function(d){return d.getAttribute("src")}}]),b}(c.BlockEmbed);m.blotName="video",m.className="ql-video",m.tagName="IFRAME",r.default=m},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.FormulaBlot=void 0;var o=function(){function d(p,w){for(var E=0;E<w.length;E++){var x=w[E];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,w,E){return w&&d(p.prototype,w),E&&d(p,E),p}}(),s=function d(p,w,E){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,w);if(x===void 0){var O=Object.getPrototypeOf(p);return O===null?void 0:d(O,w,E)}else{if("value"in x)return x.value;var L=x.get;return L===void 0?void 0:L.call(E)}},c=i(35),a=f(c),y=i(5),g=f(y),u=i(9),l=f(u);function f(d){return d&&d.__esModule?d:{default:d}}function h(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function m(d,p){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:d}function k(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(d,p):d.__proto__=p)}var b=function(d){k(p,d);function p(){return h(this,p),m(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return o(p,null,[{key:"create",value:function(E){var x=s(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,E);return typeof E=="string"&&(window.katex.render(E,x,{throwOnError:!1,errorColor:"#f00"}),x.setAttribute("data-value",E)),x}},{key:"value",value:function(E){return E.getAttribute("data-value")}}]),p}(a.default);b.blotName="formula",b.className="ql-formula",b.tagName="SPAN";var v=function(d){k(p,d),o(p,null,[{key:"register",value:function(){g.default.register(b,!0)}}]);function p(){h(this,p);var w=m(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return w}return p}(l.default);r.FormulaBlot=b,r.default=v},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CodeToken=r.CodeBlock=void 0;var o=function(){function E(x,O){for(var L=0;L<O.length;L++){var S=O[L];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(x,S.key,S)}}return function(x,O,L){return O&&E(x.prototype,O),L&&E(x,L),x}}(),s=function E(x,O,L){x===null&&(x=Function.prototype);var S=Object.getOwnPropertyDescriptor(x,O);if(S===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:E(C,O,L)}else{if("value"in S)return S.value;var T=S.get;return T===void 0?void 0:T.call(L)}},c=i(0),a=m(c),y=i(5),g=m(y),u=i(9),l=m(u),f=i(13),h=m(f);function m(E){return E&&E.__esModule?E:{default:E}}function k(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function b(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function v(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var d=function(E){v(x,E);function x(){return k(this,x),b(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return o(x,[{key:"replaceWith",value:function(L){this.domNode.textContent=this.domNode.textContent,this.attach(),s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"replaceWith",this).call(this,L)}},{key:"highlight",value:function(L){var S=this.domNode.textContent;this.cachedText!==S&&((S.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=L(S),this.domNode.normalize(),this.attach()),this.cachedText=S)}}]),x}(h.default);d.className="ql-syntax";var p=new a.default.Attributor.Class("token","hljs",{scope:a.default.Scope.INLINE}),w=function(E){v(x,E),o(x,null,[{key:"register",value:function(){g.default.register(p,!0),g.default.register(d,!0)}}]);function x(O,L){k(this,x);var S=b(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,O,L));if(typeof S.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var C=null;return S.quill.on(g.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(C),C=setTimeout(function(){S.highlight(),C=null},S.options.interval)}),S.highlight(),S}return o(x,[{key:"highlight",value:function(){var L=this;if(!this.quill.selection.composing){this.quill.update(g.default.sources.USER);var S=this.quill.getSelection();this.quill.scroll.descendants(d).forEach(function(C){C.highlight(L.options.highlight)}),this.quill.update(g.default.sources.SILENT),S!=null&&this.quill.setSelection(S,g.default.sources.SILENT)}}}]),x}(l.default);w.DEFAULTS={highlight:function(){return window.hljs==null?null:function(E){var x=window.hljs.highlightAuto(E);return x.value}}(),interval:1e3},r.CodeBlock=d,r.CodeToken=p,r.default=w},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(e,r){e.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(e,r){e.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(e,r){e.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(e,r){e.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(e,r){e.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BubbleTooltip=void 0;var o=function x(O,L,S){O===null&&(O=Function.prototype);var C=Object.getOwnPropertyDescriptor(O,L);if(C===void 0){var T=Object.getPrototypeOf(O);return T===null?void 0:x(T,L,S)}else{if("value"in C)return C.value;var N=C.get;return N===void 0?void 0:N.call(S)}},s=function(){function x(O,L){for(var S=0;S<L.length;S++){var C=L[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(O,C.key,C)}}return function(O,L,S){return L&&x(O.prototype,L),S&&x(O,S),O}}(),c=i(3),a=k(c),y=i(8),g=k(y),u=i(43),l=k(u),f=i(15),h=i(41),m=k(h);function k(x){return x&&x.__esModule?x:{default:x}}function b(x,O){if(!(x instanceof O))throw new TypeError("Cannot call a class as a function")}function v(x,O){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:x}function d(x,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);x.prototype=Object.create(O&&O.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(x,O):x.__proto__=O)}var p=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],w=function(x){d(O,x);function O(L,S){b(this,O),S.modules.toolbar!=null&&S.modules.toolbar.container==null&&(S.modules.toolbar.container=p);var C=v(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,L,S));return C.quill.container.classList.add("ql-bubble"),C}return s(O,[{key:"extendToolbar",value:function(S){this.tooltip=new E(this.quill,this.options.bounds),this.tooltip.root.appendChild(S.container),this.buildButtons([].slice.call(S.container.querySelectorAll("button")),m.default),this.buildPickers([].slice.call(S.container.querySelectorAll("select")),m.default)}}]),O}(l.default);w.DEFAULTS=(0,a.default)(!0,{},l.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(O){O?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var E=function(x){d(O,x);function O(L,S){b(this,O);var C=v(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,L,S));return C.quill.on(g.default.events.EDITOR_CHANGE,function(T,N,D,M){if(T===g.default.events.SELECTION_CHANGE)if(N!=null&&N.length>0&&M===g.default.sources.USER){C.show(),C.root.style.left="0px",C.root.style.width="",C.root.style.width=C.root.offsetWidth+"px";var F=C.quill.getLines(N.index,N.length);if(F.length===1)C.position(C.quill.getBounds(N));else{var G=F[F.length-1],nt=C.quill.getIndex(G),K=Math.min(G.length()-1,N.index+N.length-nt),V=C.quill.getBounds(new f.Range(nt,K));C.position(V)}}else document.activeElement!==C.textbox&&C.quill.hasFocus()&&C.hide()}),C}return s(O,[{key:"listen",value:function(){var S=this;o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){S.root.classList.remove("ql-editing")}),this.quill.on(g.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!S.root.classList.contains("ql-hidden")){var C=S.quill.getSelection();C!=null&&S.position(S.quill.getBounds(C))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(S){var C=o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"position",this).call(this,S),T=this.root.querySelector(".ql-tooltip-arrow");if(T.style.marginLeft="",C===0)return C;T.style.marginLeft=-1*C-T.offsetWidth/2+"px"}}]),O}(u.BaseTooltip);E.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),r.BubbleTooltip=E,r.default=w},function(e,r,i){e.exports=i(63)}]).default})})(Af);const on=lf(Af.exports);var Of={exports:{}};/*! For license information please see quill-cursors.js.LICENSE.txt */(function(n,t){(function(e,r){n.exports=r()})(self,()=>(()=>{var e={582:(s,c,a)=>{a.d(c,{Z:()=>f});var y=a(81),g=a.n(y),u=a(645),l=a.n(u)()(g());l.push([s.id,".ql-container{position:relative;overflow:hidden}@media(pointer: coarse){.ql-cursor-caret-container{z-index:-1}}.ql-cursor.hidden{display:none}.ql-cursor .ql-cursor-caret-container,.ql-cursor .ql-cursor-flag{position:absolute}.ql-cursor .ql-cursor-flag{z-index:1;transform:translate3d(-1px, -100%, 0);opacity:0;visibility:hidden;color:#fff;padding-bottom:2px;border-radius:0 3px 3px 0}.ql-cursor .ql-cursor-flag.flag-flipped{border-radius:3px 0 0 3px;transform:translate3d(calc(-100% + 1px ), -100%, 0)}@media screen{.ql-cursor .ql-cursor-flag{transition:opacity 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms,visibility 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms}}.ql-cursor .ql-cursor-flag .ql-cursor-name{margin-left:5px;margin-right:5px;display:inline-block;margin-top:-2px;white-space:nowrap}.ql-cursor .ql-cursor-flag.no-delay[style]{transition-delay:unset !important}.ql-cursor .ql-cursor-caret-container{cursor:text;margin-left:-9px;padding:0 9px}.ql-cursor .ql-cursor-caret-container.hover+.ql-cursor-flag{opacity:1;visibility:visible;transition:none}.ql-cursor .ql-cursor-caret-container.no-pointer{pointer-events:none}.ql-cursor .ql-cursor-caret-container .ql-cursor-caret{position:absolute;top:0;bottom:0;width:2px;margin-left:-1px;background-color:attr(data-color)}.ql-cursor .ql-cursor-selection-block{position:absolute;pointer-events:none}",""]);const f=l},645:s=>{s.exports=function(c){var a=[];return a.toString=function(){return this.map(function(y){var g="",u=y[5]!==void 0;return y[4]&&(g+="@supports (".concat(y[4],") {")),y[2]&&(g+="@media ".concat(y[2]," {")),u&&(g+="@layer".concat(y[5].length>0?" ".concat(y[5]):""," {")),g+=c(y),u&&(g+="}"),y[2]&&(g+="}"),y[4]&&(g+="}"),g}).join("")},a.i=function(y,g,u,l,f){typeof y=="string"&&(y=[[null,y,void 0]]);var h={};if(u)for(var m=0;m<this.length;m++){var k=this[m][0];k!=null&&(h[k]=!0)}for(var b=0;b<y.length;b++){var v=[].concat(y[b]);u&&h[v[0]]||(f!==void 0&&(v[5]===void 0||(v[1]="@layer".concat(v[5].length>0?" ".concat(v[5]):""," {").concat(v[1],"}")),v[5]=f),g&&(v[2]&&(v[1]="@media ".concat(v[2]," {").concat(v[1],"}")),v[2]=g),l&&(v[4]?(v[1]="@supports (".concat(v[4],") {").concat(v[1],"}"),v[4]=l):v[4]="".concat(l)),a.push(v))}},a}},81:s=>{s.exports=function(c){return c[1]}},465:(s,c,a)=>{s=a.nmd(s);var y="__lodash_hash_undefined__",g=9007199254740991,u="[object Arguments]",l="[object Boolean]",f="[object Date]",h="[object Function]",m="[object GeneratorFunction]",k="[object Map]",b="[object Number]",v="[object Object]",d="[object Promise]",p="[object RegExp]",w="[object Set]",E="[object String]",x="[object Symbol]",O="[object WeakMap]",L="[object ArrayBuffer]",S="[object DataView]",C="[object Float32Array]",T="[object Float64Array]",N="[object Int8Array]",D="[object Int16Array]",M="[object Int32Array]",F="[object Uint8Array]",G="[object Uint8ClampedArray]",nt="[object Uint16Array]",K="[object Uint32Array]",V=/\w*$/,B=/^\[object .+?Constructor\]$/,H=/^(?:0|[1-9]\d*)$/,$={};$[u]=$["[object Array]"]=$[L]=$[S]=$[l]=$[f]=$[C]=$[T]=$[N]=$[D]=$[M]=$[k]=$[b]=$[v]=$[p]=$[w]=$[E]=$[x]=$[F]=$[G]=$[nt]=$[K]=!0,$["[object Error]"]=$[h]=$[O]=!1;var J=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g,X=typeof self=="object"&&self&&self.Object===Object&&self,j=J||X||Function("return this")(),Z=c&&!c.nodeType&&c,et=Z&&s&&!s.nodeType&&s,rt=et&&et.exports===Z;function st(Q,at){return Q.set(at[0],at[1]),Q}function ct(Q,at){return Q.add(at),Q}function vt(Q,at,dt,_t){var Rt=-1,qt=Q?Q.length:0;for(_t&&qt&&(dt=Q[++Rt]);++Rt<qt;)dt=at(dt,Q[Rt],Rt,Q);return dt}function pt(Q){var at=!1;if(Q!=null&&typeof Q.toString!="function")try{at=!!(Q+"")}catch{}return at}function gt(Q){var at=-1,dt=Array(Q.size);return Q.forEach(function(_t,Rt){dt[++at]=[Rt,_t]}),dt}function I(Q,at){return function(dt){return Q(at(dt))}}function U(Q){var at=-1,dt=Array(Q.size);return Q.forEach(function(_t){dt[++at]=_t}),dt}var W,q=Array.prototype,P=Function.prototype,_=Object.prototype,A=j["__core-js_shared__"],R=(W=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",z=P.toString,Y=_.hasOwnProperty,tt=_.toString,ut=RegExp("^"+z.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=rt?j.Buffer:void 0,mt=j.Symbol,yt=j.Uint8Array,ot=I(Object.getPrototypeOf,Object),Et=Object.create,te=_.propertyIsEnumerable,xe=q.splice,re=Object.getOwnPropertySymbols,de=bt?bt.isBuffer:void 0,fe=I(Object.keys,Object),Le=cn(j,"DataView"),Ae=cn(j,"Map"),We=cn(j,"Promise"),ie=cn(j,"Set"),Ne=cn(j,"WeakMap"),Pe=cn(Object,"create"),Tr=fn(Le),an=fn(Ae),Rr=fn(We),ir=fn(ie),io=fn(Ne),ci=mt?mt.prototype:void 0,ui=ci?ci.valueOf:void 0;function ln(Q){var at=-1,dt=Q?Q.length:0;for(this.clear();++at<dt;){var _t=Q[at];this.set(_t[0],_t[1])}}function Oe(Q){var at=-1,dt=Q?Q.length:0;for(this.clear();++at<dt;){var _t=Q[at];this.set(_t[0],_t[1])}}function De(Q){var at=-1,dt=Q?Q.length:0;for(this.clear();++at<dt;){var _t=Q[at];this.set(_t[0],_t[1])}}function Wn(Q){this.__data__=new Oe(Q)}function Ge(Q,at,dt){var _t=Q[at];Y.call(Q,at)&&ao(_t,dt)&&(dt!==void 0||at in Q)||(Q[at]=dt)}function Lr(Q,at){for(var dt=Q.length;dt--;)if(ao(Q[dt][0],at))return dt;return-1}function Ye(Q,at,dt,_t,Rt,qt,Yt){var Dt;if(_t&&(Dt=qt?_t(Q,Rt,qt,Yt):_t(Q)),Dt!==void 0)return Dt;if(!$t(Q))return Q;var oe=it(Q);if(oe){if(Dt=function(Ot){var Ut=Ot.length,se=Ot.constructor(Ut);return Ut&&typeof Ot[0]=="string"&&Y.call(Ot,"index")&&(se.index=Ot.index,se.input=Ot.input),se}(Q),!at)return function(Ot,Ut){var se=-1,Pt=Ot.length;for(Ut||(Ut=Array(Pt));++se<Pt;)Ut[se]=Ot[se];return Ut}(Q,Dt)}else{var Jt=un(Q),hn=Jt==h||Jt==m;if(ht(Q))return function(Ot,Ut){if(Ut)return Ot.slice();var se=new Ot.constructor(Ot.length);return Ot.copy(se),se}(Q,at);if(Jt==v||Jt==u||hn&&!qt){if(pt(Q))return qt?Q:{};if(Dt=function(Ot){return typeof Ot.constructor!="function"||Gn(Ot)?{}:$t(Ut=ot(Ot))?Et(Ut):{};var Ut}(hn?{}:Q),!at)return function(Ot,Ut){return oo(Ot,fi(Ot),Ut)}(Q,function(Ot,Ut){return Ot&&oo(Ut,Lt(Ut),Ot)}(Dt,Q))}else{if(!$[Jt])return qt?Q:{};Dt=function(Ot,Ut,se,Pt){var Mt,Ze=Ot.constructor;switch(Ut){case L:return Nr(Ot);case l:case f:return new Ze(+Ot);case S:return function(It,pe){var ee=pe?Nr(It.buffer):It.buffer;return new It.constructor(ee,It.byteOffset,It.byteLength)}(Ot,Pt);case C:case T:case N:case D:case M:case F:case G:case nt:case K:return function(It,pe){var ee=pe?Nr(It.buffer):It.buffer;return new It.constructor(ee,It.byteOffset,It.length)}(Ot,Pt);case k:return function(It,pe,ee){return vt(pe?ee(gt(It),!0):gt(It),st,new It.constructor)}(Ot,Pt,se);case b:case E:return new Ze(Ot);case p:return function(It){var pe=new It.constructor(It.source,V.exec(It));return pe.lastIndex=It.lastIndex,pe}(Ot);case w:return function(It,pe,ee){return vt(pe?ee(U(It),!0):U(It),ct,new It.constructor)}(Ot,Pt,se);case x:return Mt=Ot,ui?Object(ui.call(Mt)):{}}}(Q,Jt,Ye,at)}}Yt||(Yt=new Wn);var Nn=Yt.get(Q);if(Nn)return Nn;if(Yt.set(Q,Dt),!oe)var Yn=dt?function(Ot){return function(Ut,se,Pt){var Mt=se(Ut);return it(Ut)?Mt:function(Ze,It){for(var pe=-1,ee=It.length,Xe=Ze.length;++pe<ee;)Ze[Xe+pe]=It[pe];return Ze}(Mt,Pt(Ut))}(Ot,Lt,fi)}(Q):Lt(Q);return function(Ot,Ut){for(var se=-1,Pt=Ot?Ot.length:0;++se<Pt&&Ut(Ot[se],se)!==!1;);}(Yn||Q,function(Ot,Ut){Yn&&(Ot=Q[Ut=Ot]),Ge(Dt,Ut,Ye(Ot,at,dt,_t,Ut,Q,Yt))}),Dt}function Nr(Q){var at=new Q.constructor(Q.byteLength);return new yt(at).set(new yt(Q)),at}function oo(Q,at,dt,_t){dt||(dt={});for(var Rt=-1,qt=at.length;++Rt<qt;){var Yt=at[Rt],Dt=_t?_t(dt[Yt],Q[Yt],Yt,dt,Q):void 0;Ge(dt,Yt,Dt===void 0?Q[Yt]:Dt)}return dt}function Ln(Q,at){var dt,_t,Rt=Q.__data__;return((_t=typeof(dt=at))=="string"||_t=="number"||_t=="symbol"||_t=="boolean"?dt!=="__proto__":dt===null)?Rt[typeof at=="string"?"string":"hash"]:Rt.map}function cn(Q,at){var dt=function(_t,Rt){return _t==null?void 0:_t[Rt]}(Q,at);return function(_t){return!(!$t(_t)||(Rt=_t,R&&R in Rt))&&(kt(_t)||pt(_t)?ut:B).test(fn(_t));var Rt}(dt)?dt:void 0}ln.prototype.clear=function(){this.__data__=Pe?Pe(null):{}},ln.prototype.delete=function(Q){return this.has(Q)&&delete this.__data__[Q]},ln.prototype.get=function(Q){var at=this.__data__;if(Pe){var dt=at[Q];return dt===y?void 0:dt}return Y.call(at,Q)?at[Q]:void 0},ln.prototype.has=function(Q){var at=this.__data__;return Pe?at[Q]!==void 0:Y.call(at,Q)},ln.prototype.set=function(Q,at){return this.__data__[Q]=Pe&&at===void 0?y:at,this},Oe.prototype.clear=function(){this.__data__=[]},Oe.prototype.delete=function(Q){var at=this.__data__,dt=Lr(at,Q);return!(dt<0||(dt==at.length-1?at.pop():xe.call(at,dt,1),0))},Oe.prototype.get=function(Q){var at=this.__data__,dt=Lr(at,Q);return dt<0?void 0:at[dt][1]},Oe.prototype.has=function(Q){return Lr(this.__data__,Q)>-1},Oe.prototype.set=function(Q,at){var dt=this.__data__,_t=Lr(dt,Q);return _t<0?dt.push([Q,at]):dt[_t][1]=at,this},De.prototype.clear=function(){this.__data__={hash:new ln,map:new(Ae||Oe),string:new ln}},De.prototype.delete=function(Q){return Ln(this,Q).delete(Q)},De.prototype.get=function(Q){return Ln(this,Q).get(Q)},De.prototype.has=function(Q){return Ln(this,Q).has(Q)},De.prototype.set=function(Q,at){return Ln(this,Q).set(Q,at),this},Wn.prototype.clear=function(){this.__data__=new Oe},Wn.prototype.delete=function(Q){return this.__data__.delete(Q)},Wn.prototype.get=function(Q){return this.__data__.get(Q)},Wn.prototype.has=function(Q){return this.__data__.has(Q)},Wn.prototype.set=function(Q,at){var dt=this.__data__;if(dt instanceof Oe){var _t=dt.__data__;if(!Ae||_t.length<199)return _t.push([Q,at]),this;dt=this.__data__=new De(_t)}return dt.set(Q,at),this};var fi=re?I(re,Object):function(){return[]},un=function(Q){return tt.call(Q)};function so(Q,at){return!!(at=at==null?g:at)&&(typeof Q=="number"||H.test(Q))&&Q>-1&&Q%1==0&&Q<at}function Gn(Q){var at=Q&&Q.constructor;return Q===(typeof at=="function"&&at.prototype||_)}function fn(Q){if(Q!=null){try{return z.call(Q)}catch{}try{return Q+""}catch{}}return""}function ao(Q,at){return Q===at||Q!=Q&&at!=at}(Le&&un(new Le(new ArrayBuffer(1)))!=S||Ae&&un(new Ae)!=k||We&&un(We.resolve())!=d||ie&&un(new ie)!=w||Ne&&un(new Ne)!=O)&&(un=function(Q){var at=tt.call(Q),dt=at==v?Q.constructor:void 0,_t=dt?fn(dt):void 0;if(_t)switch(_t){case Tr:return S;case an:return k;case Rr:return d;case ir:return w;case io:return O}return at});var it=Array.isArray;function lt(Q){return Q!=null&&function(at){return typeof at=="number"&&at>-1&&at%1==0&&at<=g}(Q.length)&&!kt(Q)}var ht=de||function(){return!1};function kt(Q){var at=$t(Q)?tt.call(Q):"";return at==h||at==m}function $t(Q){var at=typeof Q;return!!Q&&(at=="object"||at=="function")}function Lt(Q){return lt(Q)?function(at,dt){var _t=it(at)||function(Dt){return function(oe){return function(Jt){return!!Jt&&typeof Jt=="object"}(oe)&&lt(oe)}(Dt)&&Y.call(Dt,"callee")&&(!te.call(Dt,"callee")||tt.call(Dt)==u)}(at)?function(Dt,oe){for(var Jt=-1,hn=Array(Dt);++Jt<Dt;)hn[Jt]=oe(Jt);return hn}(at.length,String):[],Rt=_t.length,qt=!!Rt;for(var Yt in at)!dt&&!Y.call(at,Yt)||qt&&(Yt=="length"||so(Yt,Rt))||_t.push(Yt);return _t}(Q):function(at){if(!Gn(at))return fe(at);var dt=[];for(var _t in Object(at))Y.call(at,_t)&&_t!="constructor"&&dt.push(_t);return dt}(Q)}s.exports=function(Q){return Ye(Q,!0,!0)}},307:(s,c,a)=>{s=a.nmd(s);var y="__lodash_hash_undefined__",g=9007199254740991,u="[object Arguments]",l="[object Array]",f="[object Boolean]",h="[object Date]",m="[object Error]",k="[object Function]",b="[object Map]",v="[object Number]",d="[object Object]",p="[object Promise]",w="[object RegExp]",E="[object Set]",x="[object String]",O="[object WeakMap]",L="[object ArrayBuffer]",S="[object DataView]",C=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[u]=N[l]=N[L]=N[f]=N[S]=N[h]=N[m]=N[k]=N[b]=N[v]=N[d]=N[w]=N[E]=N[x]=N[O]=!1;var D=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g,M=typeof self=="object"&&self&&self.Object===Object&&self,F=D||M||Function("return this")(),G=c&&!c.nodeType&&c,nt=G&&s&&!s.nodeType&&s,K=nt&&nt.exports===G,V=K&&D.process,B=function(){try{return V&&V.binding&&V.binding("util")}catch{}}(),H=B&&B.isTypedArray;function $(it,lt){for(var ht=-1,kt=it==null?0:it.length;++ht<kt;)if(lt(it[ht],ht,it))return!0;return!1}function J(it){var lt=-1,ht=Array(it.size);return it.forEach(function(kt,$t){ht[++lt]=[$t,kt]}),ht}function X(it){var lt=-1,ht=Array(it.size);return it.forEach(function(kt){ht[++lt]=kt}),ht}var j,Z,et,rt=Array.prototype,st=Function.prototype,ct=Object.prototype,vt=F["__core-js_shared__"],pt=st.toString,gt=ct.hasOwnProperty,I=(j=/[^.]+$/.exec(vt&&vt.keys&&vt.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"",U=ct.toString,W=RegExp("^"+pt.call(gt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),q=K?F.Buffer:void 0,P=F.Symbol,_=F.Uint8Array,A=ct.propertyIsEnumerable,R=rt.splice,z=P?P.toStringTag:void 0,Y=Object.getOwnPropertySymbols,tt=q?q.isBuffer:void 0,ut=(Z=Object.keys,et=Object,function(it){return Z(et(it))}),bt=De(F,"DataView"),mt=De(F,"Map"),yt=De(F,"Promise"),ot=De(F,"Set"),Et=De(F,"WeakMap"),te=De(Object,"create"),xe=Ye(bt),re=Ye(mt),de=Ye(yt),fe=Ye(ot),Le=Ye(Et),Ae=P?P.prototype:void 0,We=Ae?Ae.valueOf:void 0;function ie(it){var lt=-1,ht=it==null?0:it.length;for(this.clear();++lt<ht;){var kt=it[lt];this.set(kt[0],kt[1])}}function Ne(it){var lt=-1,ht=it==null?0:it.length;for(this.clear();++lt<ht;){var kt=it[lt];this.set(kt[0],kt[1])}}function Pe(it){var lt=-1,ht=it==null?0:it.length;for(this.clear();++lt<ht;){var kt=it[lt];this.set(kt[0],kt[1])}}function Tr(it){var lt=-1,ht=it==null?0:it.length;for(this.__data__=new Pe;++lt<ht;)this.add(it[lt])}function an(it){var lt=this.__data__=new Ne(it);this.size=lt.size}function Rr(it,lt){for(var ht=it.length;ht--;)if(Nr(it[ht][0],lt))return ht;return-1}function ir(it){return it==null?it===void 0?"[object Undefined]":"[object Null]":z&&z in Object(it)?function(lt){var ht=gt.call(lt,z),kt=lt[z];try{lt[z]=void 0;var $t=!0}catch{}var Lt=U.call(lt);return $t&&(ht?lt[z]=kt:delete lt[z]),Lt}(it):function(lt){return U.call(lt)}(it)}function io(it){return Gn(it)&&ir(it)==u}function ci(it,lt,ht,kt,$t){return it===lt||(it==null||lt==null||!Gn(it)&&!Gn(lt)?it!=it&&lt!=lt:function(Lt,Q,at,dt,_t,Rt){var qt=Ln(Lt),Yt=Ln(Q),Dt=qt?l:Ge(Lt),oe=Yt?l:Ge(Q),Jt=(Dt=Dt==u?d:Dt)==d,hn=(oe=oe==u?d:oe)==d,Nn=Dt==oe;if(Nn&&cn(Lt)){if(!cn(Q))return!1;qt=!0,Jt=!1}if(Nn&&!Jt)return Rt||(Rt=new an),qt||fn(Lt)?ui(Lt,Q,at,dt,_t,Rt):function(Pt,Mt,Ze,It,pe,ee,Xe){switch(Ze){case S:if(Pt.byteLength!=Mt.byteLength||Pt.byteOffset!=Mt.byteOffset)return!1;Pt=Pt.buffer,Mt=Mt.buffer;case L:return!(Pt.byteLength!=Mt.byteLength||!ee(new _(Pt),new _(Mt)));case f:case h:case v:return Nr(+Pt,+Mt);case m:return Pt.name==Mt.name&&Pt.message==Mt.message;case w:case x:return Pt==Mt+"";case b:var Zn=J;case E:var hi=1&It;if(Zn||(Zn=X),Pt.size!=Mt.size&&!hi)return!1;var or=Xe.get(Pt);if(or)return or==Mt;It|=2,Xe.set(Pt,Mt);var Pn=ui(Zn(Pt),Zn(Mt),It,pe,ee,Xe);return Xe.delete(Pt),Pn;case"[object Symbol]":if(We)return We.call(Pt)==We.call(Mt)}return!1}(Lt,Q,Dt,at,dt,_t,Rt);if(!(1&at)){var Yn=Jt&&gt.call(Lt,"__wrapped__"),Ot=hn&&gt.call(Q,"__wrapped__");if(Yn||Ot){var Ut=Yn?Lt.value():Lt,se=Ot?Q.value():Q;return Rt||(Rt=new an),_t(Ut,se,at,dt,Rt)}}return!!Nn&&(Rt||(Rt=new an),function(Pt,Mt,Ze,It,pe,ee){var Xe=1&Ze,Zn=ln(Pt),hi=Zn.length;if(hi!=ln(Mt).length&&!Xe)return!1;for(var or=hi;or--;){var Pn=Zn[or];if(!(Xe?Pn in Mt:gt.call(Mt,Pn)))return!1}var Ol=ee.get(Pt);if(Ol&&ee.get(Mt))return Ol==Mt;var lo=!0;ee.set(Pt,Mt),ee.set(Mt,Pt);for(var Ts=Xe;++or<hi;){var co=Pt[Pn=Zn[or]],uo=Mt[Pn];if(It)var Tl=Xe?It(uo,co,Pn,Mt,Pt,ee):It(co,uo,Pn,Pt,Mt,ee);if(!(Tl===void 0?co===uo||pe(co,uo,Ze,It,ee):Tl)){lo=!1;break}Ts||(Ts=Pn=="constructor")}if(lo&&!Ts){var fo=Pt.constructor,ho=Mt.constructor;fo==ho||!("constructor"in Pt)||!("constructor"in Mt)||typeof fo=="function"&&fo instanceof fo&&typeof ho=="function"&&ho instanceof ho||(lo=!1)}return ee.delete(Pt),ee.delete(Mt),lo}(Lt,Q,at,dt,_t,Rt))}(it,lt,ht,kt,ci,$t))}function ui(it,lt,ht,kt,$t,Lt){var Q=1&ht,at=it.length,dt=lt.length;if(at!=dt&&!(Q&&dt>at))return!1;var _t=Lt.get(it);if(_t&&Lt.get(lt))return _t==lt;var Rt=-1,qt=!0,Yt=2&ht?new Tr:void 0;for(Lt.set(it,lt),Lt.set(lt,it);++Rt<at;){var Dt=it[Rt],oe=lt[Rt];if(kt)var Jt=Q?kt(oe,Dt,Rt,lt,it,Lt):kt(Dt,oe,Rt,it,lt,Lt);if(Jt!==void 0){if(Jt)continue;qt=!1;break}if(Yt){if(!$(lt,function(hn,Nn){if(Yn=Nn,!Yt.has(Yn)&&(Dt===hn||$t(Dt,hn,ht,kt,Lt)))return Yt.push(Nn);var Yn})){qt=!1;break}}else if(Dt!==oe&&!$t(Dt,oe,ht,kt,Lt)){qt=!1;break}}return Lt.delete(it),Lt.delete(lt),qt}function ln(it){return function(lt,ht,kt){var $t=ht(lt);return Ln(lt)?$t:function(Lt,Q){for(var at=-1,dt=Q.length,_t=Lt.length;++at<dt;)Lt[_t+at]=Q[at];return Lt}($t,kt(lt))}(it,ao,Wn)}function Oe(it,lt){var ht,kt,$t=it.__data__;return((kt=typeof(ht=lt))=="string"||kt=="number"||kt=="symbol"||kt=="boolean"?ht!=="__proto__":ht===null)?$t[typeof lt=="string"?"string":"hash"]:$t.map}function De(it,lt){var ht=function(kt,$t){return kt==null?void 0:kt[$t]}(it,lt);return function(kt){return!(!so(kt)||function($t){return!!I&&I in $t}(kt))&&(fi(kt)?W:C).test(Ye(kt))}(ht)?ht:void 0}ie.prototype.clear=function(){this.__data__=te?te(null):{},this.size=0},ie.prototype.delete=function(it){var lt=this.has(it)&&delete this.__data__[it];return this.size-=lt?1:0,lt},ie.prototype.get=function(it){var lt=this.__data__;if(te){var ht=lt[it];return ht===y?void 0:ht}return gt.call(lt,it)?lt[it]:void 0},ie.prototype.has=function(it){var lt=this.__data__;return te?lt[it]!==void 0:gt.call(lt,it)},ie.prototype.set=function(it,lt){var ht=this.__data__;return this.size+=this.has(it)?0:1,ht[it]=te&&lt===void 0?y:lt,this},Ne.prototype.clear=function(){this.__data__=[],this.size=0},Ne.prototype.delete=function(it){var lt=this.__data__,ht=Rr(lt,it);return!(ht<0||(ht==lt.length-1?lt.pop():R.call(lt,ht,1),--this.size,0))},Ne.prototype.get=function(it){var lt=this.__data__,ht=Rr(lt,it);return ht<0?void 0:lt[ht][1]},Ne.prototype.has=function(it){return Rr(this.__data__,it)>-1},Ne.prototype.set=function(it,lt){var ht=this.__data__,kt=Rr(ht,it);return kt<0?(++this.size,ht.push([it,lt])):ht[kt][1]=lt,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new ie,map:new(mt||Ne),string:new ie}},Pe.prototype.delete=function(it){var lt=Oe(this,it).delete(it);return this.size-=lt?1:0,lt},Pe.prototype.get=function(it){return Oe(this,it).get(it)},Pe.prototype.has=function(it){return Oe(this,it).has(it)},Pe.prototype.set=function(it,lt){var ht=Oe(this,it),kt=ht.size;return ht.set(it,lt),this.size+=ht.size==kt?0:1,this},Tr.prototype.add=Tr.prototype.push=function(it){return this.__data__.set(it,y),this},Tr.prototype.has=function(it){return this.__data__.has(it)},an.prototype.clear=function(){this.__data__=new Ne,this.size=0},an.prototype.delete=function(it){var lt=this.__data__,ht=lt.delete(it);return this.size=lt.size,ht},an.prototype.get=function(it){return this.__data__.get(it)},an.prototype.has=function(it){return this.__data__.has(it)},an.prototype.set=function(it,lt){var ht=this.__data__;if(ht instanceof Ne){var kt=ht.__data__;if(!mt||kt.length<199)return kt.push([it,lt]),this.size=++ht.size,this;ht=this.__data__=new Pe(kt)}return ht.set(it,lt),this.size=ht.size,this};var Wn=Y?function(it){return it==null?[]:(it=Object(it),function(lt,ht){for(var kt=-1,$t=lt==null?0:lt.length,Lt=0,Q=[];++kt<$t;){var at=lt[kt];dt=at,A.call(it,dt)&&(Q[Lt++]=at)}var dt;return Q}(Y(it)))}:function(){return[]},Ge=ir;function Lr(it,lt){return!!(lt=lt==null?g:lt)&&(typeof it=="number"||T.test(it))&&it>-1&&it%1==0&&it<lt}function Ye(it){if(it!=null){try{return pt.call(it)}catch{}try{return it+""}catch{}}return""}function Nr(it,lt){return it===lt||it!=it&&lt!=lt}(bt&&Ge(new bt(new ArrayBuffer(1)))!=S||mt&&Ge(new mt)!=b||yt&&Ge(yt.resolve())!=p||ot&&Ge(new ot)!=E||Et&&Ge(new Et)!=O)&&(Ge=function(it){var lt=ir(it),ht=lt==d?it.constructor:void 0,kt=ht?Ye(ht):"";if(kt)switch(kt){case xe:return S;case re:return b;case de:return p;case fe:return E;case Le:return O}return lt});var oo=io(function(){return arguments}())?io:function(it){return Gn(it)&&gt.call(it,"callee")&&!A.call(it,"callee")},Ln=Array.isArray,cn=tt||function(){return!1};function fi(it){if(!so(it))return!1;var lt=ir(it);return lt==k||lt=="[object GeneratorFunction]"||lt=="[object AsyncFunction]"||lt=="[object Proxy]"}function un(it){return typeof it=="number"&&it>-1&&it%1==0&&it<=g}function so(it){var lt=typeof it;return it!=null&&(lt=="object"||lt=="function")}function Gn(it){return it!=null&&typeof it=="object"}var fn=H?function(it){return function(lt){return it(lt)}}(H):function(it){return Gn(it)&&un(it.length)&&!!N[ir(it)]};function ao(it){return(lt=it)!=null&&un(lt.length)&&!fi(lt)?function(ht,kt){var $t=Ln(ht),Lt=!$t&&oo(ht),Q=!$t&&!Lt&&cn(ht),at=!$t&&!Lt&&!Q&&fn(ht),dt=$t||Lt||Q||at,_t=dt?function(Yt,Dt){for(var oe=-1,Jt=Array(Yt);++oe<Yt;)Jt[oe]=Dt(oe);return Jt}(ht.length,String):[],Rt=_t.length;for(var qt in ht)!kt&&!gt.call(ht,qt)||dt&&(qt=="length"||Q&&(qt=="offset"||qt=="parent")||at&&(qt=="buffer"||qt=="byteLength"||qt=="byteOffset")||Lr(qt,Rt))||_t.push(qt);return _t}(it):function(ht){if($t=(kt=ht)&&kt.constructor,kt!==(typeof $t=="function"&&$t.prototype||ct))return ut(ht);var kt,$t,Lt=[];for(var Q in Object(ht))gt.call(ht,Q)&&Q!="constructor"&&Lt.push(Q);return Lt}(it);var lt}s.exports=function(it,lt){return ci(it,lt)}},210:function(s,c,a){var y=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(c,"__esModule",{value:!0});var g,u=y(a(465)),l=y(a(307));(function(f){f.compose=function(h,m,k){h===void 0&&(h={}),m===void 0&&(m={}),typeof h!="object"&&(h={}),typeof m!="object"&&(m={});var b=u.default(m);for(var v in k||(b=Object.keys(b).reduce(function(d,p){return b[p]!=null&&(d[p]=b[p]),d},{})),h)h[v]!==void 0&&m[v]===void 0&&(b[v]=h[v]);return Object.keys(b).length>0?b:void 0},f.diff=function(h,m){h===void 0&&(h={}),m===void 0&&(m={}),typeof h!="object"&&(h={}),typeof m!="object"&&(m={});var k=Object.keys(h).concat(Object.keys(m)).reduce(function(b,v){return l.default(h[v],m[v])||(b[v]=m[v]===void 0?null:m[v]),b},{});return Object.keys(k).length>0?k:void 0},f.invert=function(h,m){h===void 0&&(h={}),m===void 0&&(m={}),h=h||{};var k=Object.keys(m).reduce(function(b,v){return m[v]!==h[v]&&h[v]!==void 0&&(b[v]=m[v]),b},{});return Object.keys(h).reduce(function(b,v){return h[v]!==m[v]&&m[v]===void 0&&(b[v]=null),b},k)},f.transform=function(h,m,k){if(k===void 0&&(k=!1),typeof h!="object")return m;if(typeof m=="object"){if(!k)return m;var b=Object.keys(m).reduce(function(v,d){return h[d]===void 0&&(v[d]=m[d]),v},{});return Object.keys(b).length>0?b:void 0}}})(g||(g={})),c.default=g},895:function(s,c,a){var y=this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}},g=y(a(103)),u=y(a(465)),l=y(a(307)),f=y(a(210)),h=y(a(430)),m=String.fromCharCode(0),k=function(){function b(v){Array.isArray(v)?this.ops=v:v!=null&&Array.isArray(v.ops)?this.ops=v.ops:this.ops=[]}return b.prototype.insert=function(v,d){var p={};return typeof v=="string"&&v.length===0?this:(p.insert=v,d!=null&&typeof d=="object"&&Object.keys(d).length>0&&(p.attributes=d),this.push(p))},b.prototype.delete=function(v){return v<=0?this:this.push({delete:v})},b.prototype.retain=function(v,d){if(v<=0)return this;var p={retain:v};return d!=null&&typeof d=="object"&&Object.keys(d).length>0&&(p.attributes=d),this.push(p)},b.prototype.push=function(v){var d=this.ops.length,p=this.ops[d-1];if(v=u.default(v),typeof p=="object"){if(typeof v.delete=="number"&&typeof p.delete=="number")return this.ops[d-1]={delete:p.delete+v.delete},this;if(typeof p.delete=="number"&&v.insert!=null&&(d-=1,typeof(p=this.ops[d-1])!="object"))return this.ops.unshift(v),this;if(l.default(v.attributes,p.attributes)){if(typeof v.insert=="string"&&typeof p.insert=="string")return this.ops[d-1]={insert:p.insert+v.insert},typeof v.attributes=="object"&&(this.ops[d-1].attributes=v.attributes),this;if(typeof v.retain=="number"&&typeof p.retain=="number")return this.ops[d-1]={retain:p.retain+v.retain},typeof v.attributes=="object"&&(this.ops[d-1].attributes=v.attributes),this}}return d===this.ops.length?this.ops.push(v):this.ops.splice(d,0,v),this},b.prototype.chop=function(){var v=this.ops[this.ops.length-1];return v&&v.retain&&!v.attributes&&this.ops.pop(),this},b.prototype.filter=function(v){return this.ops.filter(v)},b.prototype.forEach=function(v){this.ops.forEach(v)},b.prototype.map=function(v){return this.ops.map(v)},b.prototype.partition=function(v){var d=[],p=[];return this.forEach(function(w){(v(w)?d:p).push(w)}),[d,p]},b.prototype.reduce=function(v,d){return this.ops.reduce(v,d)},b.prototype.changeLength=function(){return this.reduce(function(v,d){return d.insert?v+h.default.length(d):d.delete?v-d.delete:v},0)},b.prototype.length=function(){return this.reduce(function(v,d){return v+h.default.length(d)},0)},b.prototype.slice=function(v,d){v===void 0&&(v=0),d===void 0&&(d=1/0);for(var p=[],w=h.default.iterator(this.ops),E=0;E<d&&w.hasNext();){var x=void 0;E<v?x=w.next(v-E):(x=w.next(d-E),p.push(x)),E+=h.default.length(x)}return new b(p)},b.prototype.compose=function(v){var d=h.default.iterator(this.ops),p=h.default.iterator(v.ops),w=[],E=p.peek();if(E!=null&&typeof E.retain=="number"&&E.attributes==null){for(var x=E.retain;d.peekType()==="insert"&&d.peekLength()<=x;)x-=d.peekLength(),w.push(d.next());E.retain-x>0&&p.next(E.retain-x)}for(var O=new b(w);d.hasNext()||p.hasNext();)if(p.peekType()==="insert")O.push(p.next());else if(d.peekType()==="delete")O.push(d.next());else{var L=Math.min(d.peekLength(),p.peekLength()),S=d.next(L),C=p.next(L);if(typeof C.retain=="number"){var T={};typeof S.retain=="number"?T.retain=L:T.insert=S.insert;var N=f.default.compose(S.attributes,C.attributes,typeof S.retain=="number");if(N&&(T.attributes=N),O.push(T),!p.hasNext()&&l.default(O.ops[O.ops.length-1],T)){var D=new b(d.rest());return O.concat(D).chop()}}else typeof C.delete=="number"&&typeof S.retain=="number"&&O.push(C)}return O.chop()},b.prototype.concat=function(v){var d=new b(this.ops.slice());return v.ops.length>0&&(d.push(v.ops[0]),d.ops=d.ops.concat(v.ops.slice(1))),d},b.prototype.diff=function(v,d){if(this.ops===v.ops)return new b;var p=[this,v].map(function(L){return L.map(function(S){if(S.insert!=null)return typeof S.insert=="string"?S.insert:m;throw new Error("diff() called "+(L===v?"on":"with")+" non-document")}).join("")}),w=new b,E=g.default(p[0],p[1],d),x=h.default.iterator(this.ops),O=h.default.iterator(v.ops);return E.forEach(function(L){for(var S=L[1].length;S>0;){var C=0;switch(L[0]){case g.default.INSERT:C=Math.min(O.peekLength(),S),w.push(O.next(C));break;case g.default.DELETE:C=Math.min(S,x.peekLength()),x.next(C),w.delete(C);break;case g.default.EQUAL:C=Math.min(x.peekLength(),O.peekLength(),S);var T=x.next(C),N=O.next(C);l.default(T.insert,N.insert)?w.retain(C,f.default.diff(T.attributes,N.attributes)):w.push(N).delete(C)}S-=C}}),w.chop()},b.prototype.eachLine=function(v,d){d===void 0&&(d=`
`);for(var p=h.default.iterator(this.ops),w=new b,E=0;p.hasNext();){if(p.peekType()!=="insert")return;var x=p.peek(),O=h.default.length(x)-p.peekLength(),L=typeof x.insert=="string"?x.insert.indexOf(d,O)-O:-1;if(L<0)w.push(p.next());else if(L>0)w.push(p.next(L));else{if(v(w,p.next(1).attributes||{},E)===!1)return;E+=1,w=new b}}w.length()>0&&v(w,{},E)},b.prototype.invert=function(v){var d=new b;return this.reduce(function(p,w){if(w.insert)d.delete(h.default.length(w));else{if(w.retain&&w.attributes==null)return d.retain(w.retain),p+w.retain;if(w.delete||w.retain&&w.attributes){var E=w.delete||w.retain;return v.slice(p,p+E).forEach(function(x){w.delete?d.push(x):w.retain&&w.attributes&&d.retain(h.default.length(x),f.default.invert(w.attributes,x.attributes))}),p+E}}return p},0),d.chop()},b.prototype.transform=function(v,d){if(d===void 0&&(d=!1),d=!!d,typeof v=="number")return this.transformPosition(v,d);for(var p=v,w=h.default.iterator(this.ops),E=h.default.iterator(p.ops),x=new b;w.hasNext()||E.hasNext();)if(w.peekType()!=="insert"||!d&&E.peekType()==="insert")if(E.peekType()==="insert")x.push(E.next());else{var O=Math.min(w.peekLength(),E.peekLength()),L=w.next(O),S=E.next(O);if(L.delete)continue;S.delete?x.push(S):x.retain(O,f.default.transform(L.attributes,S.attributes,d))}else x.retain(h.default.length(w.next()));return x.chop()},b.prototype.transformPosition=function(v,d){d===void 0&&(d=!1),d=!!d;for(var p=h.default.iterator(this.ops),w=0;p.hasNext()&&w<=v;){var E=p.peekLength(),x=p.peekType();p.next(),x!=="delete"?(x==="insert"&&(w<v||!d)&&(v+=E),w+=E):v-=Math.min(E,v-w)}return v},b.Op=h.default,b.AttributeMap=f.default,b}();s.exports=k},977:function(s,c,a){var y=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0});var g=y(a(430)),u=function(){function l(f){this.ops=f,this.index=0,this.offset=0}return l.prototype.hasNext=function(){return this.peekLength()<1/0},l.prototype.next=function(f){f||(f=1/0);var h=this.ops[this.index];if(h){var m=this.offset,k=g.default.length(h);if(f>=k-m?(f=k-m,this.index+=1,this.offset=0):this.offset+=f,typeof h.delete=="number")return{delete:f};var b={};return h.attributes&&(b.attributes=h.attributes),typeof h.retain=="number"?b.retain=f:typeof h.insert=="string"?b.insert=h.insert.substr(m,f):b.insert=h.insert,b}return{retain:1/0}},l.prototype.peek=function(){return this.ops[this.index]},l.prototype.peekLength=function(){return this.ops[this.index]?g.default.length(this.ops[this.index])-this.offset:1/0},l.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},l.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var f=this.offset,h=this.index,m=this.next(),k=this.ops.slice(this.index);return this.offset=f,this.index=h,[m].concat(k)}return[]},l}();c.default=u},430:function(s,c,a){var y=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0});var g,u=y(a(977));(function(l){l.iterator=function(f){return new u.default(f)},l.length=function(f){return typeof f.delete=="number"?f.delete:typeof f.retain=="number"?f.retain:typeof f.insert=="string"?f.insert.length:1}})(g||(g={})),c.default=g},103:s=>{var c=-1;function a(d,p,w,E){if(d===p)return d?[[0,d]]:[];if(w!=null){var x=function(T,N,D){var M=typeof D=="number"?{index:D,length:0}:D.oldRange,F=typeof D=="number"?null:D.newRange,G=T.length,nt=N.length;if(M.length===0&&(F===null||F.length===0)){var K=M.index,V=T.slice(0,K),B=T.slice(K),H=F?F.index:null,$=K+nt-G;if((H===null||H===$)&&!($<0||$>nt)){var J=N.slice(0,$);if((Z=N.slice($))===B){var X=Math.min(K,$);if((rt=V.slice(0,X))===(ct=J.slice(0,X)))return b(rt,V.slice(X),J.slice(X),B)}}if(H===null||H===K){var j=K,Z=(J=N.slice(0,j),N.slice(j));if(J===V){var et=Math.min(G-j,nt-j);if((st=B.slice(B.length-et))===(vt=Z.slice(Z.length-et)))return b(V,B.slice(0,B.length-et),Z.slice(0,Z.length-et),st)}}}if(M.length>0&&F&&F.length===0){var rt=T.slice(0,M.index),st=T.slice(M.index+M.length);if(!(nt<(X=rt.length)+(et=st.length))){var ct=N.slice(0,X),vt=N.slice(nt-et);if(rt===ct&&st===vt)return b(rt,T.slice(X,G-et),N.slice(X,nt-et),st)}}return null}(d,p,w);if(x)return x}var O=g(d,p),L=d.substring(0,O);O=u(d=d.substring(O),p=p.substring(O));var S=d.substring(d.length-O),C=function(T,N){var D;if(!T)return[[1,N]];if(!N)return[[c,T]];var M=T.length>N.length?T:N,F=T.length>N.length?N:T,G=M.indexOf(F);if(G!==-1)return D=[[1,M.substring(0,G)],[0,F],[1,M.substring(G+F.length)]],T.length>N.length&&(D[0][0]=D[2][0]=c),D;if(F.length===1)return[[c,T],[1,N]];var nt=function(j,Z){var et=j.length>Z.length?j:Z,rt=j.length>Z.length?Z:j;if(et.length<4||2*rt.length<et.length)return null;function st(q,P,_){for(var A,R,z,Y,tt=q.substring(_,_+Math.floor(q.length/4)),ut=-1,bt="";(ut=P.indexOf(tt,ut+1))!==-1;){var mt=g(q.substring(_),P.substring(ut)),yt=u(q.substring(0,_),P.substring(0,ut));bt.length<yt+mt&&(bt=P.substring(ut-yt,ut)+P.substring(ut,ut+mt),A=q.substring(0,_-yt),R=q.substring(_+mt),z=P.substring(0,ut-yt),Y=P.substring(ut+mt))}return 2*bt.length>=q.length?[A,R,z,Y,bt]:null}var ct,vt,pt,gt,I,U=st(et,rt,Math.ceil(et.length/4)),W=st(et,rt,Math.ceil(et.length/2));return U||W?(ct=W?U&&U[4].length>W[4].length?U:W:U,j.length>Z.length?(vt=ct[0],pt=ct[1],gt=ct[2],I=ct[3]):(gt=ct[0],I=ct[1],vt=ct[2],pt=ct[3]),[vt,pt,gt,I,ct[4]]):null}(T,N);if(nt){var K=nt[0],V=nt[1],B=nt[2],H=nt[3],$=nt[4],J=a(K,B),X=a(V,H);return J.concat([[0,$]],X)}return function(j,Z){for(var et=j.length,rt=Z.length,st=Math.ceil((et+rt)/2),ct=st,vt=2*st,pt=new Array(vt),gt=new Array(vt),I=0;I<vt;I++)pt[I]=-1,gt[I]=-1;pt[ct+1]=0,gt[ct+1]=0;for(var U=et-rt,W=U%2!=0,q=0,P=0,_=0,A=0,R=0;R<st;R++){for(var z=-R+q;z<=R-P;z+=2){for(var Y=ct+z,tt=(ot=z===-R||z!==R&&pt[Y-1]<pt[Y+1]?pt[Y+1]:pt[Y-1]+1)-z;ot<et&&tt<rt&&j.charAt(ot)===Z.charAt(tt);)ot++,tt++;if(pt[Y]=ot,ot>et)P+=2;else if(tt>rt)q+=2;else if(W&&(mt=ct+U-z)>=0&&mt<vt&&gt[mt]!==-1&&ot>=(bt=et-gt[mt]))return y(j,Z,ot,tt)}for(var ut=-R+_;ut<=R-A;ut+=2){for(var bt,mt=ct+ut,yt=(bt=ut===-R||ut!==R&&gt[mt-1]<gt[mt+1]?gt[mt+1]:gt[mt-1]+1)-ut;bt<et&&yt<rt&&j.charAt(et-bt-1)===Z.charAt(rt-yt-1);)bt++,yt++;if(gt[mt]=bt,bt>et)A+=2;else if(yt>rt)_+=2;else if(!W){var ot;if((Y=ct+U-ut)>=0&&Y<vt&&pt[Y]!==-1&&(tt=ct+(ot=pt[Y])-Y,ot>=(bt=et-bt)))return y(j,Z,ot,tt)}}}return[[c,j],[1,Z]]}(T,N)}(d=d.substring(0,d.length-O),p=p.substring(0,p.length-O));return L&&C.unshift([0,L]),S&&C.push([0,S]),l(C,E),C}function y(d,p,w,E){var x=d.substring(0,w),O=p.substring(0,E),L=d.substring(w),S=p.substring(E),C=a(x,O),T=a(L,S);return C.concat(T)}function g(d,p){if(!d||!p||d.charAt(0)!==p.charAt(0))return 0;for(var w=0,E=Math.min(d.length,p.length),x=E,O=0;w<x;)d.substring(O,x)==p.substring(O,x)?O=w=x:E=x,x=Math.floor((E-w)/2+w);return f(d.charCodeAt(x-1))&&x--,x}function u(d,p){if(!d||!p||d.slice(-1)!==p.slice(-1))return 0;for(var w=0,E=Math.min(d.length,p.length),x=E,O=0;w<x;)d.substring(d.length-x,d.length-O)==p.substring(p.length-x,p.length-O)?O=w=x:E=x,x=Math.floor((E-w)/2+w);return h(d.charCodeAt(d.length-x))&&x--,x}function l(d,p){d.push([0,""]);for(var w,E=0,x=0,O=0,L="",S="";E<d.length;)if(E<d.length-1&&!d[E][1])d.splice(E,1);else switch(d[E][0]){case 1:O++,S+=d[E][1],E++;break;case c:x++,L+=d[E][1],E++;break;case 0:var C=E-O-x-1;if(p){if(C>=0&&k(d[C][1])){var T=d[C][1].slice(-1);if(d[C][1]=d[C][1].slice(0,-1),L=T+L,S=T+S,!d[C][1]){d.splice(C,1),E--;var N=C-1;d[N]&&d[N][0]===1&&(O++,S=d[N][1]+S,N--),d[N]&&d[N][0]===c&&(x++,L=d[N][1]+L,N--),C=N}}m(d[E][1])&&(T=d[E][1].charAt(0),d[E][1]=d[E][1].slice(1),L+=T,S+=T)}if(E<d.length-1&&!d[E][1]){d.splice(E,1);break}if(L.length>0||S.length>0){L.length>0&&S.length>0&&((w=g(S,L))!==0&&(C>=0?d[C][1]+=S.substring(0,w):(d.splice(0,0,[0,S.substring(0,w)]),E++),S=S.substring(w),L=L.substring(w)),(w=u(S,L))!==0&&(d[E][1]=S.substring(S.length-w)+d[E][1],S=S.substring(0,S.length-w),L=L.substring(0,L.length-w)));var D=O+x;L.length===0&&S.length===0?(d.splice(E-D,D),E-=D):L.length===0?(d.splice(E-D,D,[1,S]),E=E-D+1):S.length===0?(d.splice(E-D,D,[c,L]),E=E-D+1):(d.splice(E-D,D,[c,L],[1,S]),E=E-D+2)}E!==0&&d[E-1][0]===0?(d[E-1][1]+=d[E][1],d.splice(E,1)):E++,O=0,x=0,L="",S=""}d[d.length-1][1]===""&&d.pop();var M=!1;for(E=1;E<d.length-1;)d[E-1][0]===0&&d[E+1][0]===0&&(d[E][1].substring(d[E][1].length-d[E-1][1].length)===d[E-1][1]?(d[E][1]=d[E-1][1]+d[E][1].substring(0,d[E][1].length-d[E-1][1].length),d[E+1][1]=d[E-1][1]+d[E+1][1],d.splice(E-1,1),M=!0):d[E][1].substring(0,d[E+1][1].length)==d[E+1][1]&&(d[E-1][1]+=d[E+1][1],d[E][1]=d[E][1].substring(d[E+1][1].length)+d[E+1][1],d.splice(E+1,1),M=!0)),E++;M&&l(d,p)}function f(d){return d>=55296&&d<=56319}function h(d){return d>=56320&&d<=57343}function m(d){return h(d.charCodeAt(0))}function k(d){return f(d.charCodeAt(d.length-1))}function b(d,p,w,E){return k(d)||m(E)?null:function(x){for(var O=[],L=0;L<x.length;L++)x[L][1].length>0&&O.push(x[L]);return O}([[0,d],[c,p],[1,w],[0,E]])}function v(d,p,w){return a(d,p,w,!0)}v.INSERT=1,v.DELETE=c,v.EQUAL=0,s.exports=v},165:function(s,c,a){var y,g;(g=typeof(y=function(){var u,l={};function f(k,b,v){var d=k.getClientRects();if(d.length===2){var p=k.getBoundingClientRect();return d[b][v]<p[v]}return!1}function h(k){if(!k||screen.deviceXDPI===screen.logicalXDPI)return k;if("length"in k)return Array.prototype.map.call(k,h);var b=screen.deviceXDPI/screen.logicalXDPI;return{top:k.top/b,bottom:k.bottom/b,left:k.left/b,right:k.right/b,width:k.width/b,height:k.height/b}}function m(k,b){var v,d=0,p=1024;if(p>=b.length)return Array.prototype.push.apply(k,b);for(;d<b.length;)v=Array.prototype.push.apply(k,Array.prototype.slice.call(b,d,d+p)),d+=p;return v}return l.isBroken=function(){if(u===void 0){var k=document.createElement("p"),b=document.createElement("span"),v=document.createTextNode("aa"),d=document.createTextNode("aa"),p=document.createElement("img");p.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");var w=document.createRange();if(u={},k.appendChild(v),k.appendChild(b),b.appendChild(p),b.appendChild(d),document.body.appendChild(k),w.setStart(v,1),w.setEnd(b,0),u.getClientRects=u.getBoundingClientRect=w.getClientRects().length>1,u.getClientRects||(w.setEnd(d,1),u.getClientRects=u.getBoundingClientRect=w.getClientRects().length===2),!u.getBoundingClientRect){w.setEnd(w.startContainer,w.startOffset);var E=w.getBoundingClientRect();u.getBoundingClientRect=E.top===0&&E.left===0}if(document.body.removeChild(k),!u.getBoundingClientRect){var x=document.createElement("p");x.style.width="0px",x.style.fontSize="20px",x.style.whiteSpace="normal",x.style.wordBreak="normal";var O=document.createTextNode("m mm");x.appendChild(O),document.body.appendChild(x),w.setStart(O,1),w.setEnd(O,2),f(w,1,"left")?u.getBoundingClientRect=!0:(w.setStart(O,1),w.setEnd(O,3),f(w,0,"top")&&(u.getBoundingClientRect=!0)),document.body.removeChild(x)}var L=window.ActiveXObject&&new Function("/*@cc_on return @_jscript_version; @*/")();u.ieZoom=!!L&&L<=10}return u},l.getClientRects=function(k){var b=this.isBroken();if(b.ieZoom)return h(k.getClientRects());if(!b.getClientRects)return k.getClientRects();var v=[],d=[],p=k.endContainer,w=k.endOffset,E=document.createRange();function x(O){for(var L=0;O=O.previousSibling;)L++;return L}for(;p!==k.commonAncestorContainer;)E.setStart(p,0),E.setEnd(p,w),m(d,E.getClientRects()),w=x(p),p=p.parentNode;return(E=k.cloneRange()).setEnd(p,w),m(v,E.getClientRects()),m(v,d),v},l.getBoundingClientRect=function(k){var b=this.getClientRects(k);if(b.length===0)return null;var v,d=k.getBoundingClientRect(),p=this.isBroken();if(p.ieZoom)return h(d);if(!p.getBoundingClientRect)return d;if(d.width===0&&d.height===0)return b[0];for(var w=0,E=b.length;w<E;w++){var x=b[w];v?(v.left=Math.min(v.left,x.left),v.top=Math.min(v.top,x.top),v.right=Math.max(v.right,x.right),v.bottom=Math.max(v.bottom,x.bottom)):v={left:x.left,top:x.top,right:x.right,bottom:x.bottom}}return v&&(v.width=v.right-v.left,v.height=v.bottom-v.top),v},l})=="function"?y.call(c,a,c,s):y)===void 0||(s.exports=g)},33:(s,c,a)=>{a.r(c),a.d(c,{default:()=>N});var y=function(){if(typeof Map<"u")return Map;function D(M,F){var G=-1;return M.some(function(nt,K){return nt[0]===F&&(G=K,!0)}),G}return function(){function M(){this.__entries__=[]}return Object.defineProperty(M.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),M.prototype.get=function(F){var G=D(this.__entries__,F),nt=this.__entries__[G];return nt&&nt[1]},M.prototype.set=function(F,G){var nt=D(this.__entries__,F);~nt?this.__entries__[nt][1]=G:this.__entries__.push([F,G])},M.prototype.delete=function(F){var G=this.__entries__,nt=D(G,F);~nt&&G.splice(nt,1)},M.prototype.has=function(F){return!!~D(this.__entries__,F)},M.prototype.clear=function(){this.__entries__.splice(0)},M.prototype.forEach=function(F,G){G===void 0&&(G=null);for(var nt=0,K=this.__entries__;nt<K.length;nt++){var V=K[nt];F.call(G,V[1],V[0])}},M}()}(),g=typeof window<"u"&&typeof document<"u"&&window.document===document,u=a.g!==void 0&&a.g.Math===Math?a.g:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),l=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(u):function(D){return setTimeout(function(){return D(Date.now())},1e3/60)},f=["top","right","bottom","left","width","height","size","weight"],h=typeof MutationObserver<"u",m=function(){function D(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(M,F){var G=!1,nt=!1,K=0;function V(){G&&(G=!1,M()),nt&&H()}function B(){l(V)}function H(){var $=Date.now();if(G){if($-K<2)return;nt=!0}else G=!0,nt=!1,setTimeout(B,20);K=$}return H}(this.refresh.bind(this))}return D.prototype.addObserver=function(M){~this.observers_.indexOf(M)||this.observers_.push(M),this.connected_||this.connect_()},D.prototype.removeObserver=function(M){var F=this.observers_,G=F.indexOf(M);~G&&F.splice(G,1),!F.length&&this.connected_&&this.disconnect_()},D.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},D.prototype.updateObservers_=function(){var M=this.observers_.filter(function(F){return F.gatherActive(),F.hasActive()});return M.forEach(function(F){return F.broadcastActive()}),M.length>0},D.prototype.connect_=function(){g&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),h?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},D.prototype.disconnect_=function(){g&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},D.prototype.onTransitionEnd_=function(M){var F=M.propertyName,G=F===void 0?"":F;f.some(function(nt){return!!~G.indexOf(nt)})&&this.refresh()},D.getInstance=function(){return this.instance_||(this.instance_=new D),this.instance_},D.instance_=null,D}(),k=function(D,M){for(var F=0,G=Object.keys(M);F<G.length;F++){var nt=G[F];Object.defineProperty(D,nt,{value:M[nt],enumerable:!1,writable:!1,configurable:!0})}return D},b=function(D){return D&&D.ownerDocument&&D.ownerDocument.defaultView||u},v=x(0,0,0,0);function d(D){return parseFloat(D)||0}function p(D){for(var M=[],F=1;F<arguments.length;F++)M[F-1]=arguments[F];return M.reduce(function(G,nt){return G+d(D["border-"+nt+"-width"])},0)}var w=typeof SVGGraphicsElement<"u"?function(D){return D instanceof b(D).SVGGraphicsElement}:function(D){return D instanceof b(D).SVGElement&&typeof D.getBBox=="function"};function E(D){return g?w(D)?function(M){var F=M.getBBox();return x(0,0,F.width,F.height)}(D):function(M){var F=M.clientWidth,G=M.clientHeight;if(!F&&!G)return v;var nt=b(M).getComputedStyle(M),K=function(j){for(var Z={},et=0,rt=["top","right","bottom","left"];et<rt.length;et++){var st=rt[et],ct=j["padding-"+st];Z[st]=d(ct)}return Z}(nt),V=K.left+K.right,B=K.top+K.bottom,H=d(nt.width),$=d(nt.height);if(nt.boxSizing==="border-box"&&(Math.round(H+V)!==F&&(H-=p(nt,"left","right")+V),Math.round($+B)!==G&&($-=p(nt,"top","bottom")+B)),!function(j){return j===b(j).document.documentElement}(M)){var J=Math.round(H+V)-F,X=Math.round($+B)-G;Math.abs(J)!==1&&(H-=J),Math.abs(X)!==1&&($-=X)}return x(K.left,K.top,H,$)}(D):v}function x(D,M,F,G){return{x:D,y:M,width:F,height:G}}var O=function(){function D(M){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=x(0,0,0,0),this.target=M}return D.prototype.isActive=function(){var M=E(this.target);return this.contentRect_=M,M.width!==this.broadcastWidth||M.height!==this.broadcastHeight},D.prototype.broadcastRect=function(){var M=this.contentRect_;return this.broadcastWidth=M.width,this.broadcastHeight=M.height,M},D}(),L=function(D,M){var F,G,nt,K,V,B,H,$=(G=(F=M).x,nt=F.y,K=F.width,V=F.height,B=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,H=Object.create(B.prototype),k(H,{x:G,y:nt,width:K,height:V,top:nt,right:G+K,bottom:V+nt,left:G}),H);k(this,{target:D,contentRect:$})},S=function(){function D(M,F,G){if(this.activeObservations_=[],this.observations_=new y,typeof M!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=M,this.controller_=F,this.callbackCtx_=G}return D.prototype.observe=function(M){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(M instanceof b(M).Element))throw new TypeError('parameter 1 is not of type "Element".');var F=this.observations_;F.has(M)||(F.set(M,new O(M)),this.controller_.addObserver(this),this.controller_.refresh())}},D.prototype.unobserve=function(M){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(M instanceof b(M).Element))throw new TypeError('parameter 1 is not of type "Element".');var F=this.observations_;F.has(M)&&(F.delete(M),F.size||this.controller_.removeObserver(this))}},D.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},D.prototype.gatherActive=function(){var M=this;this.clearActive(),this.observations_.forEach(function(F){F.isActive()&&M.activeObservations_.push(F)})},D.prototype.broadcastActive=function(){if(this.hasActive()){var M=this.callbackCtx_,F=this.activeObservations_.map(function(G){return new L(G.target,G.broadcastRect())});this.callback_.call(M,F,M),this.clearActive()}},D.prototype.clearActive=function(){this.activeObservations_.splice(0)},D.prototype.hasActive=function(){return this.activeObservations_.length>0},D}(),C=typeof WeakMap<"u"?new WeakMap:new y,T=function D(M){if(!(this instanceof D))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var F=m.getInstance(),G=new S(M,F,this);C.set(this,G)};["observe","unobserve","disconnect"].forEach(function(D){T.prototype[D]=function(){var M;return(M=C.get(this))[D].apply(M,arguments)}});const N=u.ResizeObserver!==void 0?u.ResizeObserver:T},413:(s,c,a)=>{a.r(c),a.d(c,{default:()=>x});var y=a(379),g=a.n(y),u=a(795),l=a.n(u),f=a(569),h=a.n(f),m=a(565),k=a.n(m),b=a(216),v=a.n(b),d=a(589),p=a.n(d),w=a(582),E={};E.styleTagTransform=p(),E.setAttributes=k(),E.insert=h().bind(null,"head"),E.domAPI=l(),E.insertStyleElement=v(),g()(w.Z,E);const x=w.Z&&w.Z.locals?w.Z.locals:void 0},379:s=>{var c=[];function a(u){for(var l=-1,f=0;f<c.length;f++)if(c[f].identifier===u){l=f;break}return l}function y(u,l){for(var f={},h=[],m=0;m<u.length;m++){var k=u[m],b=l.base?k[0]+l.base:k[0],v=f[b]||0,d="".concat(b," ").concat(v);f[b]=v+1;var p=a(d),w={css:k[1],media:k[2],sourceMap:k[3],supports:k[4],layer:k[5]};if(p!==-1)c[p].references++,c[p].updater(w);else{var E=g(w,l);l.byIndex=m,c.splice(m,0,{identifier:d,updater:E,references:1})}h.push(d)}return h}function g(u,l){var f=l.domAPI(l);return f.update(u),function(h){if(h){if(h.css===u.css&&h.media===u.media&&h.sourceMap===u.sourceMap&&h.supports===u.supports&&h.layer===u.layer)return;f.update(u=h)}else f.remove()}}s.exports=function(u,l){var f=y(u=u||[],l=l||{});return function(h){h=h||[];for(var m=0;m<f.length;m++){var k=a(f[m]);c[k].references--}for(var b=y(h,l),v=0;v<f.length;v++){var d=a(f[v]);c[d].references===0&&(c[d].updater(),c.splice(d,1))}f=b}}},569:s=>{var c={};s.exports=function(a,y){var g=function(u){if(c[u]===void 0){var l=document.querySelector(u);if(window.HTMLIFrameElement&&l instanceof window.HTMLIFrameElement)try{l=l.contentDocument.head}catch{l=null}c[u]=l}return c[u]}(a);if(!g)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");g.appendChild(y)}},216:s=>{s.exports=function(c){var a=document.createElement("style");return c.setAttributes(a,c.attributes),c.insert(a,c.options),a}},565:(s,c,a)=>{s.exports=function(y){var g=a.nc;g&&y.setAttribute("nonce",g)}},795:s=>{s.exports=function(c){var a=c.insertStyleElement(c);return{update:function(y){(function(g,u,l){var f="";l.supports&&(f+="@supports (".concat(l.supports,") {")),l.media&&(f+="@media ".concat(l.media," {"));var h=l.layer!==void 0;h&&(f+="@layer".concat(l.layer.length>0?" ".concat(l.layer):""," {")),f+=l.css,h&&(f+="}"),l.media&&(f+="}"),l.supports&&(f+="}");var m=l.sourceMap;m&&typeof btoa<"u"&&(f+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(m))))," */")),u.styleTagTransform(f,g,u.options)})(a,c,y)},remove:function(){(function(y){if(y.parentNode===null)return!1;y.parentNode.removeChild(y)})(a)}}}},589:s=>{s.exports=function(c,a){if(a.styleSheet)a.styleSheet.cssText=c;else{for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(c))}}},621:(s,c,a)=>{var y;(function(g){var u=/^\s+/,l=/\s+$/,f=0,h=g.round,m=g.min,k=g.max,b=g.random;function v(I,U){if(U=U||{},(I=I||"")instanceof v)return I;if(!(this instanceof v))return new v(I,U);var W=function(q){var P,_,A,R={r:0,g:0,b:0},z=1,Y=null,tt=null,ut=null,bt=!1,mt=!1;return typeof q=="string"&&(q=function(yt){yt=yt.replace(u,"").replace(l,"").toLowerCase();var ot,Et=!1;if(V[yt])yt=V[yt],Et=!0;else if(yt=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(ot=pt.rgb.exec(yt))?{r:ot[1],g:ot[2],b:ot[3]}:(ot=pt.rgba.exec(yt))?{r:ot[1],g:ot[2],b:ot[3],a:ot[4]}:(ot=pt.hsl.exec(yt))?{h:ot[1],s:ot[2],l:ot[3]}:(ot=pt.hsla.exec(yt))?{h:ot[1],s:ot[2],l:ot[3],a:ot[4]}:(ot=pt.hsv.exec(yt))?{h:ot[1],s:ot[2],v:ot[3]}:(ot=pt.hsva.exec(yt))?{h:ot[1],s:ot[2],v:ot[3],a:ot[4]}:(ot=pt.hex8.exec(yt))?{r:X(ot[1]),g:X(ot[2]),b:X(ot[3]),a:rt(ot[4]),format:Et?"name":"hex8"}:(ot=pt.hex6.exec(yt))?{r:X(ot[1]),g:X(ot[2]),b:X(ot[3]),format:Et?"name":"hex"}:(ot=pt.hex4.exec(yt))?{r:X(ot[1]+""+ot[1]),g:X(ot[2]+""+ot[2]),b:X(ot[3]+""+ot[3]),a:rt(ot[4]+""+ot[4]),format:Et?"name":"hex8"}:!!(ot=pt.hex3.exec(yt))&&{r:X(ot[1]+""+ot[1]),g:X(ot[2]+""+ot[2]),b:X(ot[3]+""+ot[3]),format:Et?"name":"hex"}}(q)),typeof q=="object"&&(gt(q.r)&&gt(q.g)&&gt(q.b)?(P=q.r,_=q.g,A=q.b,R={r:255*$(P,255),g:255*$(_,255),b:255*$(A,255)},bt=!0,mt=String(q.r).substr(-1)==="%"?"prgb":"rgb"):gt(q.h)&&gt(q.s)&&gt(q.v)?(Y=Z(q.s),tt=Z(q.v),R=function(yt,ot,Et){yt=6*$(yt,360),ot=$(ot,100),Et=$(Et,100);var te=g.floor(yt),xe=yt-te,re=Et*(1-ot),de=Et*(1-xe*ot),fe=Et*(1-(1-xe)*ot),Le=te%6;return{r:255*[Et,de,re,re,fe,Et][Le],g:255*[fe,Et,Et,de,re,re][Le],b:255*[re,re,fe,Et,Et,de][Le]}}(q.h,Y,tt),bt=!0,mt="hsv"):gt(q.h)&&gt(q.s)&&gt(q.l)&&(Y=Z(q.s),ut=Z(q.l),R=function(yt,ot,Et){var te,xe,re;function de(Ae,We,ie){return ie<0&&(ie+=1),ie>1&&(ie-=1),ie<1/6?Ae+6*(We-Ae)*ie:ie<.5?We:ie<2/3?Ae+(We-Ae)*(2/3-ie)*6:Ae}if(yt=$(yt,360),ot=$(ot,100),Et=$(Et,100),ot===0)te=xe=re=Et;else{var fe=Et<.5?Et*(1+ot):Et+ot-Et*ot,Le=2*Et-fe;te=de(Le,fe,yt+1/3),xe=de(Le,fe,yt),re=de(Le,fe,yt-1/3)}return{r:255*te,g:255*xe,b:255*re}}(q.h,Y,ut),bt=!0,mt="hsl"),q.hasOwnProperty("a")&&(z=q.a)),z=H(z),{ok:bt,format:q.format||mt,r:m(255,k(R.r,0)),g:m(255,k(R.g,0)),b:m(255,k(R.b,0)),a:z}}(I);this._originalInput=I,this._r=W.r,this._g=W.g,this._b=W.b,this._a=W.a,this._roundA=h(100*this._a)/100,this._format=U.format||W.format,this._gradientType=U.gradientType,this._r<1&&(this._r=h(this._r)),this._g<1&&(this._g=h(this._g)),this._b<1&&(this._b=h(this._b)),this._ok=W.ok,this._tc_id=f++}function d(I,U,W){I=$(I,255),U=$(U,255),W=$(W,255);var q,P,_=k(I,U,W),A=m(I,U,W),R=(_+A)/2;if(_==A)q=P=0;else{var z=_-A;switch(P=R>.5?z/(2-_-A):z/(_+A),_){case I:q=(U-W)/z+(U<W?6:0);break;case U:q=(W-I)/z+2;break;case W:q=(I-U)/z+4}q/=6}return{h:q,s:P,l:R}}function p(I,U,W){I=$(I,255),U=$(U,255),W=$(W,255);var q,P,_=k(I,U,W),A=m(I,U,W),R=_,z=_-A;if(P=_===0?0:z/_,_==A)q=0;else{switch(_){case I:q=(U-W)/z+(U<W?6:0);break;case U:q=(W-I)/z+2;break;case W:q=(I-U)/z+4}q/=6}return{h:q,s:P,v:R}}function w(I,U,W,q){var P=[j(h(I).toString(16)),j(h(U).toString(16)),j(h(W).toString(16))];return q&&P[0].charAt(0)==P[0].charAt(1)&&P[1].charAt(0)==P[1].charAt(1)&&P[2].charAt(0)==P[2].charAt(1)?P[0].charAt(0)+P[1].charAt(0)+P[2].charAt(0):P.join("")}function E(I,U,W,q){return[j(et(q)),j(h(I).toString(16)),j(h(U).toString(16)),j(h(W).toString(16))].join("")}function x(I,U){U=U===0?0:U||10;var W=v(I).toHsl();return W.s-=U/100,W.s=J(W.s),v(W)}function O(I,U){U=U===0?0:U||10;var W=v(I).toHsl();return W.s+=U/100,W.s=J(W.s),v(W)}function L(I){return v(I).desaturate(100)}function S(I,U){U=U===0?0:U||10;var W=v(I).toHsl();return W.l+=U/100,W.l=J(W.l),v(W)}function C(I,U){U=U===0?0:U||10;var W=v(I).toRgb();return W.r=k(0,m(255,W.r-h(-U/100*255))),W.g=k(0,m(255,W.g-h(-U/100*255))),W.b=k(0,m(255,W.b-h(-U/100*255))),v(W)}function T(I,U){U=U===0?0:U||10;var W=v(I).toHsl();return W.l-=U/100,W.l=J(W.l),v(W)}function N(I,U){var W=v(I).toHsl(),q=(W.h+U)%360;return W.h=q<0?360+q:q,v(W)}function D(I){var U=v(I).toHsl();return U.h=(U.h+180)%360,v(U)}function M(I){var U=v(I).toHsl(),W=U.h;return[v(I),v({h:(W+120)%360,s:U.s,l:U.l}),v({h:(W+240)%360,s:U.s,l:U.l})]}function F(I){var U=v(I).toHsl(),W=U.h;return[v(I),v({h:(W+90)%360,s:U.s,l:U.l}),v({h:(W+180)%360,s:U.s,l:U.l}),v({h:(W+270)%360,s:U.s,l:U.l})]}function G(I){var U=v(I).toHsl(),W=U.h;return[v(I),v({h:(W+72)%360,s:U.s,l:U.l}),v({h:(W+216)%360,s:U.s,l:U.l})]}function nt(I,U,W){U=U||6,W=W||30;var q=v(I).toHsl(),P=360/W,_=[v(I)];for(q.h=(q.h-(P*U>>1)+720)%360;--U;)q.h=(q.h+P)%360,_.push(v(q));return _}function K(I,U){U=U||6;for(var W=v(I).toHsv(),q=W.h,P=W.s,_=W.v,A=[],R=1/U;U--;)A.push(v({h:q,s:P,v:_})),_=(_+R)%1;return A}v.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var I=this.toRgb();return(299*I.r+587*I.g+114*I.b)/1e3},getLuminance:function(){var I,U,W,q=this.toRgb();return I=q.r/255,U=q.g/255,W=q.b/255,.2126*(I<=.03928?I/12.92:g.pow((I+.055)/1.055,2.4))+.7152*(U<=.03928?U/12.92:g.pow((U+.055)/1.055,2.4))+.0722*(W<=.03928?W/12.92:g.pow((W+.055)/1.055,2.4))},setAlpha:function(I){return this._a=H(I),this._roundA=h(100*this._a)/100,this},toHsv:function(){var I=p(this._r,this._g,this._b);return{h:360*I.h,s:I.s,v:I.v,a:this._a}},toHsvString:function(){var I=p(this._r,this._g,this._b),U=h(360*I.h),W=h(100*I.s),q=h(100*I.v);return this._a==1?"hsv("+U+", "+W+"%, "+q+"%)":"hsva("+U+", "+W+"%, "+q+"%, "+this._roundA+")"},toHsl:function(){var I=d(this._r,this._g,this._b);return{h:360*I.h,s:I.s,l:I.l,a:this._a}},toHslString:function(){var I=d(this._r,this._g,this._b),U=h(360*I.h),W=h(100*I.s),q=h(100*I.l);return this._a==1?"hsl("+U+", "+W+"%, "+q+"%)":"hsla("+U+", "+W+"%, "+q+"%, "+this._roundA+")"},toHex:function(I){return w(this._r,this._g,this._b,I)},toHexString:function(I){return"#"+this.toHex(I)},toHex8:function(I){return function(U,W,q,P,_){var A=[j(h(U).toString(16)),j(h(W).toString(16)),j(h(q).toString(16)),j(et(P))];return _&&A[0].charAt(0)==A[0].charAt(1)&&A[1].charAt(0)==A[1].charAt(1)&&A[2].charAt(0)==A[2].charAt(1)&&A[3].charAt(0)==A[3].charAt(1)?A[0].charAt(0)+A[1].charAt(0)+A[2].charAt(0)+A[3].charAt(0):A.join("")}(this._r,this._g,this._b,this._a,I)},toHex8String:function(I){return"#"+this.toHex8(I)},toRgb:function(){return{r:h(this._r),g:h(this._g),b:h(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+h(this._r)+", "+h(this._g)+", "+h(this._b)+")":"rgba("+h(this._r)+", "+h(this._g)+", "+h(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:h(100*$(this._r,255))+"%",g:h(100*$(this._g,255))+"%",b:h(100*$(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+h(100*$(this._r,255))+"%, "+h(100*$(this._g,255))+"%, "+h(100*$(this._b,255))+"%)":"rgba("+h(100*$(this._r,255))+"%, "+h(100*$(this._g,255))+"%, "+h(100*$(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(B[w(this._r,this._g,this._b,!0)]||!1)},toFilter:function(I){var U="#"+E(this._r,this._g,this._b,this._a),W=U,q=this._gradientType?"GradientType = 1, ":"";if(I){var P=v(I);W="#"+E(P._r,P._g,P._b,P._a)}return"progid:DXImageTransform.Microsoft.gradient("+q+"startColorstr="+U+",endColorstr="+W+")"},toString:function(I){var U=!!I;I=I||this._format;var W=!1,q=this._a<1&&this._a>=0;return U||!q||I!=="hex"&&I!=="hex6"&&I!=="hex3"&&I!=="hex4"&&I!=="hex8"&&I!=="name"?(I==="rgb"&&(W=this.toRgbString()),I==="prgb"&&(W=this.toPercentageRgbString()),I!=="hex"&&I!=="hex6"||(W=this.toHexString()),I==="hex3"&&(W=this.toHexString(!0)),I==="hex4"&&(W=this.toHex8String(!0)),I==="hex8"&&(W=this.toHex8String()),I==="name"&&(W=this.toName()),I==="hsl"&&(W=this.toHslString()),I==="hsv"&&(W=this.toHsvString()),W||this.toHexString()):I==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return v(this.toString())},_applyModification:function(I,U){var W=I.apply(null,[this].concat([].slice.call(U)));return this._r=W._r,this._g=W._g,this._b=W._b,this.setAlpha(W._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(C,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(x,arguments)},saturate:function(){return this._applyModification(O,arguments)},greyscale:function(){return this._applyModification(L,arguments)},spin:function(){return this._applyModification(N,arguments)},_applyCombination:function(I,U){return I.apply(null,[this].concat([].slice.call(U)))},analogous:function(){return this._applyCombination(nt,arguments)},complement:function(){return this._applyCombination(D,arguments)},monochromatic:function(){return this._applyCombination(K,arguments)},splitcomplement:function(){return this._applyCombination(G,arguments)},triad:function(){return this._applyCombination(M,arguments)},tetrad:function(){return this._applyCombination(F,arguments)}},v.fromRatio=function(I,U){if(typeof I=="object"){var W={};for(var q in I)I.hasOwnProperty(q)&&(W[q]=q==="a"?I[q]:Z(I[q]));I=W}return v(I,U)},v.equals=function(I,U){return!(!I||!U)&&v(I).toRgbString()==v(U).toRgbString()},v.random=function(){return v.fromRatio({r:b(),g:b(),b:b()})},v.mix=function(I,U,W){W=W===0?0:W||50;var q=v(I).toRgb(),P=v(U).toRgb(),_=W/100;return v({r:(P.r-q.r)*_+q.r,g:(P.g-q.g)*_+q.g,b:(P.b-q.b)*_+q.b,a:(P.a-q.a)*_+q.a})},v.readability=function(I,U){var W=v(I),q=v(U);return(g.max(W.getLuminance(),q.getLuminance())+.05)/(g.min(W.getLuminance(),q.getLuminance())+.05)},v.isReadable=function(I,U,W){var q,P,_,A,R,z=v.readability(I,U);switch(P=!1,(_=W,(A=((_=_||{level:"AA",size:"small"}).level||"AA").toUpperCase())!=="AA"&&A!=="AAA"&&(A="AA"),(R=(_.size||"small").toLowerCase())!=="small"&&R!=="large"&&(R="small"),q={level:A,size:R}).level+q.size){case"AAsmall":case"AAAlarge":P=z>=4.5;break;case"AAlarge":P=z>=3;break;case"AAAsmall":P=z>=7}return P},v.mostReadable=function(I,U,W){var q,P,_,A,R=null,z=0;P=(W=W||{}).includeFallbackColors,_=W.level,A=W.size;for(var Y=0;Y<U.length;Y++)(q=v.readability(I,U[Y]))>z&&(z=q,R=v(U[Y]));return v.isReadable(I,R,{level:_,size:A})||!P?R:(W.includeFallbackColors=!1,v.mostReadable(I,["#fff","#000"],W))};var V=v.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},B=v.hexNames=function(I){var U={};for(var W in I)I.hasOwnProperty(W)&&(U[I[W]]=W);return U}(V);function H(I){return I=parseFloat(I),(isNaN(I)||I<0||I>1)&&(I=1),I}function $(I,U){(function(q){return typeof q=="string"&&q.indexOf(".")!=-1&&parseFloat(q)===1})(I)&&(I="100%");var W=function(q){return typeof q=="string"&&q.indexOf("%")!=-1}(I);return I=m(U,k(0,parseFloat(I))),W&&(I=parseInt(I*U,10)/100),g.abs(I-U)<1e-6?1:I%U/parseFloat(U)}function J(I){return m(1,k(0,I))}function X(I){return parseInt(I,16)}function j(I){return I.length==1?"0"+I:""+I}function Z(I){return I<=1&&(I=100*I+"%"),I}function et(I){return g.round(255*parseFloat(I)).toString(16)}function rt(I){return X(I)/255}var st,ct,vt,pt=(ct="[\\s|\\(]+("+(st="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+st+")[,|\\s]+("+st+")\\s*\\)?",vt="[\\s|\\(]+("+st+")[,|\\s]+("+st+")[,|\\s]+("+st+")[,|\\s]+("+st+")\\s*\\)?",{CSS_UNIT:new RegExp(st),rgb:new RegExp("rgb"+ct),rgba:new RegExp("rgba"+vt),hsl:new RegExp("hsl"+ct),hsla:new RegExp("hsla"+vt),hsv:new RegExp("hsv"+ct),hsva:new RegExp("hsva"+vt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function gt(I){return!!pt.CSS_UNIT.exec(I)}s.exports?s.exports=v:(y=function(){return v}.call(c,a,c,s))===void 0||(s.exports=y)})(Math)},607:function(s,c,a){var y=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0}),c.Cursor=c.default=void 0;var g=y(a(678));c.default=g.default;var u=y(a(353));c.Cursor=u.default,a(413)},353:(s,c,a)=>{Object.defineProperty(c,"__esModule",{value:!0});var y=a(621),g=function(){function u(l,f,h){this.id=l,this.name=f,this.color=h,this.toggleNearCursor=this.toggleNearCursor.bind(this),this._toggleOpenedCursor=this._toggleOpenedCursor.bind(this),this._setHoverState=this._setHoverState.bind(this)}return u.prototype.build=function(l){var f=document.createElement(u.CONTAINER_ELEMENT_TAG);f.classList.add(u.CURSOR_CLASS),f.id="ql-cursor-".concat(this.id),f.innerHTML=l.template;var h=f.getElementsByClassName(u.SELECTION_CLASS)[0],m=f.getElementsByClassName(u.CARET_CONTAINER_CLASS)[0],k=m.getElementsByClassName(u.CARET_CLASS)[0],b=f.getElementsByClassName(u.FLAG_CLASS)[0];return b.style.backgroundColor=this.color,k.style.backgroundColor=this.color,f.getElementsByClassName(u.NAME_CLASS)[0].textContent=this.name,this._hideDelay="".concat(l.hideDelayMs,"ms"),this._hideSpeedMs=l.hideSpeedMs,this._positionFlag=l.positionFlag,b.style.transitionDelay=this._hideDelay,b.style.transitionDuration="".concat(this._hideSpeedMs,"ms"),this._el=f,this._selectionEl=h,this._caretEl=m,this._flagEl=b,m.addEventListener("mouseover",this._setHoverState),this._el},u.prototype.show=function(){this._el.classList.remove(u.HIDDEN_CLASS)},u.prototype.hide=function(){this._el.classList.add(u.HIDDEN_CLASS)},u.prototype.remove=function(){this._el.parentNode.removeChild(this._el)},u.prototype.toggleNearCursor=function(l,f){var h=this._getCoordinates(),m=h.left,k=h.right,b=h.top,v=h.bottom,d=l>=m&&l<=k&&f>=b&&f<=v;return this._caretEl.classList.toggle(u.CONTAINER_HOVER_CLASS,d),d},u.prototype.toggleFlag=function(l){var f=this;this._caretEl.classList.toggle(u.CONTAINER_HOVER_CLASS,l)||(this._flagEl.classList.add(u.NO_DELAY_CLASS),setTimeout(function(){return f._flagEl.classList.remove(u.NO_DELAY_CLASS)},this._hideSpeedMs))},u.prototype.updateCaret=function(l,f){this._caretEl.style.top="".concat(l.top,"px"),this._caretEl.style.left="".concat(l.left,"px"),this._caretEl.style.height="".concat(l.height,"px"),this._positionFlag?this._positionFlag(this._flagEl,l,f):this._updateCaretFlag(l,f)},u.prototype.updateSelection=function(l,f){var h=this;this._clearSelection(),l=l||[],l=Array.from(l),l=this._sanitize(l),(l=this._sortByDomPosition(l)).forEach(function(m){return h._addSelection(m,f)})},u.prototype._setHoverState=function(){document.addEventListener("mousemove",this._toggleOpenedCursor)},u.prototype._toggleOpenedCursor=function(l){var f=this.toggleNearCursor(l.clientX,l.clientY);this._caretEl.classList.toggle(u.CONTAINER_NO_POINTER_CLASS,f),f||document.removeEventListener("mousemove",this._toggleOpenedCursor)},u.prototype._getCoordinates=function(){return this._caretEl.getBoundingClientRect()},u.prototype._updateCaretFlag=function(l,f){this._flagEl.style.width="";var h=this._flagEl.getBoundingClientRect();this._flagEl.classList.remove(u.FLAG_FLIPPED_CLASS),l.left>f.width-h.width&&this._flagEl.classList.add(u.FLAG_FLIPPED_CLASS),this._flagEl.style.left="".concat(l.left,"px"),this._flagEl.style.top="".concat(l.top,"px"),this._flagEl.style.width="".concat(Math.ceil(h.width),"px")},u.prototype._clearSelection=function(){this._selectionEl.innerHTML=""},u.prototype._addSelection=function(l,f){var h=this._selectionBlock(l,f);this._selectionEl.appendChild(h)},u.prototype._selectionBlock=function(l,f){var h=document.createElement(u.SELECTION_ELEMENT_TAG);return h.classList.add(u.SELECTION_BLOCK_CLASS),h.style.top="".concat(l.top-f.top,"px"),h.style.left="".concat(l.left-f.left,"px"),h.style.width="".concat(l.width,"px"),h.style.height="".concat(l.height,"px"),h.style.backgroundColor=y(this.color).setAlpha(.3).toString(),h},u.prototype._sortByDomPosition=function(l){return l.sort(function(f,h){return f.top===h.top?f.left-h.left:f.top-h.top})},u.prototype._sanitize=function(l){var f=this,h=new Set;return l.filter(function(m){if(!m.width||!m.height)return!1;var k=f._serialize(m);return!h.has(k)&&(h.add(k),!0)})},u.prototype._serialize=function(l){return["top:".concat(l.top),"right:".concat(l.right),"bottom:".concat(l.bottom),"left:".concat(l.left)].join(";")},u.CONTAINER_ELEMENT_TAG="SPAN",u.SELECTION_ELEMENT_TAG="SPAN",u.CURSOR_CLASS="ql-cursor",u.SELECTION_CLASS="ql-cursor-selections",u.SELECTION_BLOCK_CLASS="ql-cursor-selection-block",u.CARET_CLASS="ql-cursor-caret",u.CARET_CONTAINER_CLASS="ql-cursor-caret-container",u.CONTAINER_HOVER_CLASS="hover",u.CONTAINER_NO_POINTER_CLASS="no-pointer",u.FLAG_CLASS="ql-cursor-flag",u.FLAG_FLIPPED_CLASS="flag-flipped",u.NAME_CLASS="ql-cursor-name",u.HIDDEN_CLASS="hidden",u.NO_DELAY_CLASS="no-delay",u}();c.default=g},678:function(s,c,a){var y=this&&this.__createBinding||(Object.create?function(d,p,w,E){E===void 0&&(E=w),Object.defineProperty(d,E,{enumerable:!0,get:function(){return p[w]}})}:function(d,p,w,E){E===void 0&&(E=w),d[E]=p[w]}),g=this&&this.__setModuleDefault||(Object.create?function(d,p){Object.defineProperty(d,"default",{enumerable:!0,value:p})}:function(d,p){d.default=p}),u=this&&this.__importStar||function(d){if(d&&d.__esModule)return d;var p={};if(d!=null)for(var w in d)w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)&&y(p,d,w);return g(p,d),p},l=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(c,"__esModule",{value:!0});var f=l(a(353)),h=u(a(165)),m=l(a(338)),k=l(a(33)),b=a(895),v=function(){function d(p,w){w===void 0&&(w={}),this._cursors={},this._isObserving=!1,this._handleCursorTouch=this._handleCursorTouch.bind(this),this.quill=p,this.options=this._setDefaults(w),this._container=this.quill.addContainer(this.options.containerClass),this._boundsContainer=this.options.boundsContainer||this.quill.container,this._currentSelection=this.quill.getSelection(),this._registerSelectionChangeListeners(),this._registerTextChangeListener(),this._registerDomListeners()}return d.prototype.createCursor=function(p,w,E){var x=this._cursors[p];if(!x){x=new f.default(p,w,E),this._cursors[p]=x;var O=x.build(this.options);this._container.appendChild(O)}return x},d.prototype.moveCursor=function(p,w){var E=this._cursors[p];E&&(E.range=w,this._updateCursor(E))},d.prototype.removeCursor=function(p){var w=this._cursors[p];w&&(w.remove(),delete this._cursors[p])},d.prototype.update=function(){var p=this;this.cursors().forEach(function(w){return p._updateCursor(w)})},d.prototype.clearCursors=function(){var p=this;this.cursors().forEach(function(w){return p.removeCursor(w.id)})},d.prototype.toggleFlag=function(p,w){var E=this._cursors[p];E&&E.toggleFlag(w)},d.prototype.cursors=function(){var p=this;return Object.keys(this._cursors).map(function(w){return p._cursors[w]})},d.prototype._registerSelectionChangeListeners=function(){var p=this;this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(w){p._currentSelection=w})},d.prototype._registerTextChangeListener=function(){var p=this;this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(w){return p._handleTextChange(w)})},d.prototype._registerDomListeners=function(){var p=this,w=this.quill.container.getElementsByClassName("ql-editor")[0];w.addEventListener("scroll",function(){return p.update()}),w.addEventListener("touchstart",this._handleCursorTouch)},d.prototype._handleCursorTouch=function(p){var w=this;this.cursors().forEach(function(E){E.toggleNearCursor(p.pageX,p.pageY),setTimeout(function(){return E.toggleFlag(!1)},w.options.hideDelayMs)})},d.prototype._registerResizeObserver=function(){var p=this;if(!this._isObserving){var w=this.quill.container.getElementsByClassName("ql-editor")[0],E=new k.default(function(x){x[0].target.isConnected||(E.disconnect(),p._isObserving=!1),p.update()});E.observe(w),this._isObserving=!0}},d.prototype._updateCursor=function(p){if(this._registerResizeObserver(),!p.range)return p.hide();var w=this._indexWithinQuillBounds(p.range.index),E=this._indexWithinQuillBounds(p.range.index+p.range.length),x=this.quill.getLeaf(w),O=this.quill.getLeaf(E);if(!this._leafIsValid(x)||!this._leafIsValid(O))return p.hide();p.show();var L=this._boundsContainer.getBoundingClientRect(),S=this.quill.getBounds(E);p.updateCaret(S,L);var C=this._lineRanges(p,x,O).reduce(function(T,N){return T.concat(Array.from(h.getClientRects(N)))},[]);p.updateSelection(C,L)},d.prototype._indexWithinQuillBounds=function(p){var w=this.quill.getLength(),E=w?w-1:0;return p=Math.max(p,0),Math.min(p,E)},d.prototype._leafIsValid=function(p){return p&&p[0]&&p[0].domNode&&p[1]>=0},d.prototype._handleTextChange=function(p){var w=this;window.setTimeout(function(){w.options.transformOnTextChange&&w._transformCursors(p),w.options.selectionChangeSource&&(w._emitSelection(),w.update())})},d.prototype._emitSelection=function(){this.quill.emitter.emit(this.quill.constructor.events.SELECTION_CHANGE,this.quill.getSelection(),this._currentSelection,this.options.selectionChangeSource)},d.prototype._setDefaults=function(p){return(p=Object.assign({},p)).template||(p.template=d.DEFAULTS.template),p.containerClass||(p.containerClass=d.DEFAULTS.containerClass),p.selectionChangeSource!==null&&(p.selectionChangeSource||(p.selectionChangeSource=d.DEFAULTS.selectionChangeSource)),p.hideDelayMs=Number.isInteger(p.hideDelayMs)?p.hideDelayMs:d.DEFAULTS.hideDelayMs,p.hideSpeedMs=Number.isInteger(p.hideSpeedMs)?p.hideSpeedMs:d.DEFAULTS.hideSpeedMs,p.transformOnTextChange=!!p.transformOnTextChange,p},d.prototype._lineRanges=function(p,w,E){var x=this.quill.getLines(p.range);return x.reduce(function(O,L,S){if(!L.children){var C=document.createRange();return C.selectNode(L.domNode),O.concat(C)}var T=S===0?w:L.path(0).pop(),N=T[0],D=T[1],M=S===x.length-1?E:L.path(L.length()-1).pop(),F=M[0],G=M[1],nt=document.createRange();return N.domNode.nodeType===Node.TEXT_NODE?nt.setStart(N.domNode,D):nt.setStartBefore(N.domNode),F.domNode.nodeType===Node.TEXT_NODE?nt.setEnd(F.domNode,G):nt.setEndAfter(F.domNode),O.concat(nt)},[])},d.prototype._transformCursors=function(p){var w=this;p=new b(p),this.cursors().filter(function(E){return E.range}).forEach(function(E){E.range.index=p.transformPosition(E.range.index),w._updateCursor(E)})},d.DEFAULTS={template:m.default,containerClass:"ql-cursors",selectionChangeSource:"api",hideDelayMs:3e3,hideSpeedMs:400},d}();c.default=v},338:function(s,c,a){var y=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0});var g=y(a(353)),u=`
  <span class="`.concat(g.default.SELECTION_CLASS,`"></span>
  <span class="`).concat(g.default.CARET_CONTAINER_CLASS,`">
    <span class="`).concat(g.default.CARET_CLASS,`"></span>
  </span>
  <div class="`).concat(g.default.FLAG_CLASS,`">
    <small class="`).concat(g.default.NAME_CLASS,`"></small>
  </div>
`);c.default=u}},r={};function i(s){var c=r[s];if(c!==void 0)return c.exports;var a=r[s]={id:s,loaded:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.n=s=>{var c=s&&s.__esModule?()=>s.default:()=>s;return i.d(c,{a:c}),c},i.d=(s,c)=>{for(var a in c)i.o(c,a)&&!i.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:c[a]})},i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(s,c)=>Object.prototype.hasOwnProperty.call(s,c),i.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.nmd=s=>(s.paths=[],s.children||(s.children=[]),s),i.nc=void 0;var o=i(607);return o.default})())})(Of);const Cy=lf(Of.exports),we="data-block-id",Ht=!1,ae=!0,Ft={UNDO:"command+z,ctrl+z",REDO:"command+shift+z,ctrl+shift+z,ctrl+y",BACKSPACE:"backspace",SELECT_ALL:"command+a,ctrl+a",SHIFT_UP:"shift+up",SHIFT_DOWN:"shift+down",INLINE_CODE:"command+e,ctrl+e",STRIKE:"command+shift+s,ctrl+shift+s",LINK:"command+k,ctrl+k",TEXT:"command+option+0,ctrl+shift+0",H1:"command+option+1,ctrl+shift+1",H2:"command+option+2,ctrl+shift+2",H3:"command+option+3,ctrl+shift+3",H4:"command+option+4,ctrl+shift+4",H5:"command+option+5,ctrl+shift+5",H6:"command+option+6,ctrl+shift+6",BULLETED:"command+option+8,ctrl+shift+8",NUMBERED_LIST:"command+option+9,ctrl+shift+9"};function nr(n,t){setTimeout(()=>{const e=n.richTextAdapters.get(t);e==null||e.quill.focus()})}function Tf(n){var t,e;return((t=n.getSelection(!0))==null?void 0:t.index)===0&&((e=n.getSelection())==null?void 0:e.length)===0}function vi(n,t,e,r,i){var o,s,c,a,y;if(t.flavour==="affine:list"&&t.type===e)return!1;if(t.flavour==="affine:paragraph"){const g=n.getParent(t);if(!g)return!1;const u=g.children.indexOf(t);(o=t.text)==null||o.insert(" ",r.length),n.captureSync(),(s=t.text)==null||s.delete(0,r.length+1);const l={flavour:"affine:list",type:e,text:(c=t==null?void 0:t.text)==null?void 0:c.clone(),children:t.children,...i};n.deleteBlock(t);const f=n.addBlock(l,g,u);nr(n,f)}else t.flavour==="affine:list"&&t.type!==e&&((a=t.text)==null||a.insert(" ",r.length),n.captureSync(),(y=t.text)==null||y.delete(0,r.length+1),n.updateBlock(t,{type:e}));return!0}function ar(n,t,e,r){var i,o,s,c,a;if(t.flavour==="affine:paragraph"&&t.type===e)return!1;if(t.flavour!=="affine:paragraph"){const y=n.getParent(t);if(!y)return!1;const g=y.children.indexOf(t);(i=t.text)==null||i.insert(" ",r.length),n.captureSync(),(o=t.text)==null||o.delete(0,r.length+1);const u={flavour:"affine:paragraph",type:e,text:(s=t==null?void 0:t.text)==null?void 0:s.clone(),children:t.children};n.deleteBlock(t);const l=n.addBlock(u,y,g);nr(n,l)}else t.flavour==="affine:paragraph"&&t.type!==e&&((c=t.text)==null||c.insert(" ",r.length),n.captureSync(),(a=t.text)==null||a.delete(0,r.length+1),n.updateBlock(t,{type:e}));return!0}class wi{constructor(t,e){this.x=t,this.y=e}equals({x:t,y:e}){return this.x===t&&this.y===e}xDistance({x:t}){return this.x-t}yDistance({y:t}){return this.y-t}xDistanceAbsolute(t){return Math.abs(this.xDistance(t))}yDistanceAbsolute(t){return Math.abs(this.yDistance(t))}distance(t){return Math.sqrt(Math.pow(this.xDistance(t),2)+Math.pow(this.yDistance(t),2))}}class Qn{constructor(t,e,r,i){const[o,s]=e<=i?[e,i]:[i,e],[c,a]=t<=r?[t,r]:[r,t];this._top=o,this._right=a,this._left=c,this._bottom=s}get width(){return Math.abs(this._left-this._right)}get height(){return Math.abs(this._bottom-this._top)}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}equals({top:t,left:e,bottom:r,right:i}){return t===this._top&&r===this._bottom&&e===this._left&&i===this._right}isContainPoint({x:t,y:e}){return e>=this._top&&e<=this._bottom&&t>=this.left&&t<=this._right}isContain({top:t,left:e,bottom:r,right:i}){return t>=this._top&&t<=this._bottom&&r>=this._top&&r<=this._bottom&&e>=this._left&&e<=this.right&&i>=this.left&&i<=this._right}isIntersect(t){const{left:e,top:r,width:i,height:o}=t,{left:s,top:c,width:a,height:y}=this,g=e+i>=s+a?e+i:s+a,u=r+o>=c+y?r+o:c+y,l=e<=s?e:s,f=r<=c?r:c;return g-l<=i+a&&u-f<=o+y}isPointDown({x:t,y:e}){return this.bottom<e&&this.left<=t&&this.right>=t}isPointUp({x:t,y:e}){return e<this.top&&this.left<=t&&this.right>=t}isPointLeft({x:t,y:e}){return t<this.left&&this.top<=e&&this.bottom>=e}isPointRight({x:t,y:e}){return t>this.right&&this.top<=e&&this.bottom>=e}fromNewLeft(t){return this._left=t,new Qn(t,this.top,this.right,this.bottom)}static fromLTRB(t,e,r,i){return new Qn(t,e,r,i)}static fromLWTH(t,e,r,i){return new Qn(t,r,t+e,r+i)}static fromPoints(t,e){const{y:r,x:i}=t,{y:o,x:s}=e;return Qn.fromLTRB(i,r,s,o)}static fromDom(t){const{top:e,width:r,left:i,height:o}=t.getBoundingClientRect();return Qn.fromLWTH(i,r,e,o)}}var Gs=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ys(n,t,e,r){n.addEventListener?n.addEventListener(t,e,r):n.attachEvent&&n.attachEvent("on".concat(t),function(){e(window.event)})}function Rf(n,t){for(var e=t.slice(0,t.length-1),r=0;r<e.length;r++)e[r]=n[e[r].toLowerCase()];return e}function Lf(n){typeof n!="string"&&(n=""),n=n.replace(/\s/g,"");for(var t=n.split(","),e=t.lastIndexOf("");e>=0;)t[e-1]+=",",t.splice(e,1),e=t.lastIndexOf("");return t}function Ay(n,t){for(var e=n.length>=t.length?n:t,r=n.length>=t.length?t:n,i=!0,o=0;o<e.length;o++)r.indexOf(e[o])===-1&&(i=!1);return i}var Ii={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":Gs?173:189,"=":Gs?61:187,";":Gs?59:186,"'":222,"[":219,"]":221,"\\":220},Cn={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},_a={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Ee={16:!1,18:!1,17:!1,91:!1},ue={};for(var _o=1;_o<20;_o++)Ii["f".concat(_o)]=111+_o;var Zt=[],bc=!1,Nf="all",Pf=[],_s=function(t){return Ii[t.toLowerCase()]||Cn[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)},Oy=function(t){return Object.keys(Ii).find(function(e){return Ii[e]===t})},Ty=function(t){return Object.keys(Cn).find(function(e){return Cn[e]===t})};function Df(n){Nf=n||"all"}function Mi(){return Nf||"all"}function Ry(){return Zt.slice(0)}function Ly(){return Zt.map(function(n){return Oy(n)||Ty(n)||String.fromCharCode(n)})}function Ny(n){var t=n.target||n.srcElement,e=t.tagName,r=!0;return(t.isContentEditable||(e==="INPUT"||e==="TEXTAREA"||e==="SELECT")&&!t.readOnly)&&(r=!1),r}function Py(n){return typeof n=="string"&&(n=_s(n)),Zt.indexOf(n)!==-1}function Dy(n,t){var e,r;n||(n=Mi());for(var i in ue)if(Object.prototype.hasOwnProperty.call(ue,i))for(e=ue[i],r=0;r<e.length;)e[r].scope===n?e.splice(r,1):r++;Mi()===n&&Df(t||"all")}function Iy(n){var t=n.keyCode||n.which||n.charCode,e=Zt.indexOf(t);if(e>=0&&Zt.splice(e,1),n.key&&n.key.toLowerCase()==="meta"&&Zt.splice(0,Zt.length),(t===93||t===224)&&(t=91),t in Ee){Ee[t]=!1;for(var r in Cn)Cn[r]===t&&(gn[r]=!1)}}function My(n){if(typeof n>"u")Object.keys(ue).forEach(function(s){return delete ue[s]});else if(Array.isArray(n))n.forEach(function(s){s.key&&Zs(s)});else if(typeof n=="object")n.key&&Zs(n);else if(typeof n=="string"){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var i=e[0],o=e[1];typeof i=="function"&&(o=i,i=""),Zs({key:n,scope:i,method:o,splitKey:"+"})}}var Zs=function(t){var e=t.key,r=t.scope,i=t.method,o=t.splitKey,s=o===void 0?"+":o,c=Lf(e);c.forEach(function(a){var y=a.split(s),g=y.length,u=y[g-1],l=u==="*"?"*":_s(u);if(!!ue[l]){r||(r=Mi());var f=g>1?Rf(Cn,y):[];ue[l]=ue[l].filter(function(h){var m=i?h.method===i:!0;return!(m&&h.scope===r&&Ay(h.mods,f))})}})};function _c(n,t,e,r){if(t.element===r){var i;if(t.scope===e||t.scope==="all"){i=t.mods.length>0;for(var o in Ee)Object.prototype.hasOwnProperty.call(Ee,o)&&(!Ee[o]&&t.mods.indexOf(+o)>-1||Ee[o]&&t.mods.indexOf(+o)===-1)&&(i=!1);(t.mods.length===0&&!Ee[16]&&!Ee[18]&&!Ee[17]&&!Ee[91]||i||t.shortcut==="*")&&t.method(n,t)===!1&&(n.preventDefault?n.preventDefault():n.returnValue=!1,n.stopPropagation&&n.stopPropagation(),n.cancelBubble&&(n.cancelBubble=!0))}}}function wc(n,t){var e=ue["*"],r=n.keyCode||n.which||n.charCode;if(!!gn.filter.call(this,n)){if((r===93||r===224)&&(r=91),Zt.indexOf(r)===-1&&r!==229&&Zt.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(h){var m=_a[h];n[h]&&Zt.indexOf(m)===-1?Zt.push(m):!n[h]&&Zt.indexOf(m)>-1?Zt.splice(Zt.indexOf(m),1):h==="metaKey"&&n[h]&&Zt.length===3&&(n.ctrlKey||n.shiftKey||n.altKey||(Zt=Zt.slice(Zt.indexOf(m))))}),r in Ee){Ee[r]=!0;for(var i in Cn)Cn[i]===r&&(gn[i]=!0);if(!e)return}for(var o in Ee)Object.prototype.hasOwnProperty.call(Ee,o)&&(Ee[o]=n[_a[o]]);n.getModifierState&&!(n.altKey&&!n.ctrlKey)&&n.getModifierState("AltGraph")&&(Zt.indexOf(17)===-1&&Zt.push(17),Zt.indexOf(18)===-1&&Zt.push(18),Ee[17]=!0,Ee[18]=!0);var s=Mi();if(e)for(var c=0;c<e.length;c++)e[c].scope===s&&(n.type==="keydown"&&e[c].keydown||n.type==="keyup"&&e[c].keyup)&&_c(n,e[c],s,t);if(r in ue){for(var a=0;a<ue[r].length;a++)if((n.type==="keydown"&&ue[r][a].keydown||n.type==="keyup"&&ue[r][a].keyup)&&ue[r][a].key){for(var y=ue[r][a],g=y.splitKey,u=y.key.split(g),l=[],f=0;f<u.length;f++)l.push(_s(u[f]));l.sort().join("")===Zt.sort().join("")&&_c(n,y,s,t)}}}}function By(n){return Pf.indexOf(n)>-1}function gn(n,t,e){Zt=[];var r=Lf(n),i=[],o="all",s=document,c=0,a=!1,y=!0,g="+",u=!1;for(e===void 0&&typeof t=="function"&&(e=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(o=t.scope),t.element&&(s=t.element),t.keyup&&(a=t.keyup),t.keydown!==void 0&&(y=t.keydown),t.capture!==void 0&&(u=t.capture),typeof t.splitKey=="string"&&(g=t.splitKey)),typeof t=="string"&&(o=t);c<r.length;c++)n=r[c].split(g),i=[],n.length>1&&(i=Rf(Cn,n)),n=n[n.length-1],n=n==="*"?"*":_s(n),n in ue||(ue[n]=[]),ue[n].push({keyup:a,keydown:y,scope:o,mods:i,shortcut:r[c],method:e,key:r[c],splitKey:g,element:s});typeof s<"u"&&!By(s)&&window&&(Pf.push(s),Ys(s,"keydown",function(l){wc(l,s)},u),bc||(bc=!0,Ys(window,"focus",function(){Zt=[]},u)),Ys(s,"keyup",function(l){wc(l,s),Iy(l)},u))}function $y(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(ue).forEach(function(e){var r=ue[e].find(function(i){return i.scope===t&&i.shortcut===n});r&&r.method&&r.method()})}var Xs={getPressedKeyString:Ly,setScope:Df,getScope:Mi,deleteScope:Dy,getPressedKeyCodes:Ry,isPressed:Py,filter:Ny,trigger:$y,unbind:My,keyMap:Ii,modifier:Cn,modifierMap:_a};for(var Js in Xs)Object.prototype.hasOwnProperty.call(Xs,Js)&&(gn[Js]=Xs[Js]);if(typeof window<"u"){var jy=window.hotkeys;gn.noConflict=function(n){return n&&window.hotkeys===gn&&(window.hotkeys=jy),gn},window.hotkeys=gn}gn.filter=()=>!0;class qy{constructor(){this._hotkeys=gn}_setScope(t){this._hotkeys.setScope(t)}addListener(t,e,r){this._hotkeys(t,{scope:r!=null?r:"affine:page"},e)}removeListener(t,e){this._hotkeys.unbind((Array.isArray(t)?t:[t]).join(","),e!=null?e:"affine:page")}disableHotkey(){this._hotkeys.setScope("other")}enableHotkey(){this._setScope("affine:page")}async withDisableHotkey(t){this.disableHotkey();try{return await t()}finally{this.enableHotkey()}}}const jt=new qy;function Bt(n){xg(n)}const If=Eg,Uy=rf,Fy=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;function nn(n,t){if(Fy){const e=document.caretPositionFromPoint(n,t),r=document.createRange();return r.setStart(e.offsetNode,e.offset),r}return document.caretRangeFromPoint(n,t)}function kc(n,t){return Math.abs(n-t)<1e-4}function Lo(n,t){return new CustomEvent(n,{detail:t})}function Hy(){}const zy=(n=0)=>new Promise(t=>setTimeout(t,n));function ws(n,t=document.body){return t.querySelector(`[${we}="${n}"]`)}function hl(n,t=document.body){var r;const e=ws(n,t);return((r=e==null?void 0:e.parentElement)==null?void 0:r.closest(`[${we}]`))||null}function Mf(n,t=document.body){var i;const e=hl(n,t),r=(i=e==null?void 0:e.model)==null?void 0:i.children;if(r!=null&&r.length){const o=r.map(s=>`[${we}='${s.id}']`).join(",");return Array.from(t.querySelectorAll(o))}return[]}function Vy(n,t=document.body){const e=Mf(n,t),r=ws(n,t);if(e&&e.length>0&&r){const i=[...e].indexOf(r);return e[i-1]||null}return null}function Ky(n,t=document.body){const e=Mf(n,t),r=ws(n,t);if(e&&e.length>0&&r){const i=[...e].indexOf(r);return e[i+1]||null}return null}function wa(n){let t=ws(n);if(t!=null&&t.model.children.length)return t.model.children[0];for(;t;){const e=hl(t.model.id);if(e){const r=Ky(t.model.id);if(r)return r.model}t=e}return null}function dl(n,t){const e=hl(t,n);if(e){const r=Vy(t,n);if(r!=null&&r.model){if(r.model.children.length){let i=r.model.children[r.model.children.length-1];for(;i.children.length;)i=i.children[i.children.length-1];return i}return r.model}return e.model}return null}function ks(n){return Bt(n.space.root),document.querySelector(`[${we}="${n.space.root.id}"]`)}function pl(n){Bt(n.space.root);const e=document.querySelector(`[${we}="${n.space.root.id}"]`).closest("editor-container");return Bt(e),e}function oi(n){Bt(n.space.root);const t=document.querySelector(`[${we}="${n.space.root.id}"]`);return t?n.id===n.space.root.id?t:t.querySelector(`[${we}="${n.id}"]`):null}function Jo(){const t=window.getSelection().getRangeAt(0);return(t.startContainer instanceof Text?t.startContainer.parentElement:t.startContainer).closest(`[${we}]`).model}function Fe(n){const t=oi(n),e=t==null?void 0:t.querySelector("rich-text");return e||null}function xs(n){var i;let t=n.commonAncestorContainer;if(t.nodeType===Node.TEXT_NODE)return[Jo()];t.attributes&&!t.attributes.getNamedItem(we)&&(t=(i=t.closest(`[${we}]`))==null?void 0:i.parentElement);const e=[],r=t.querySelectorAll(`[${we}]`);return r.length>1?(r.forEach(o=>{const s=o;Bt(s.model);const c=oi(s.model),a=s.model.flavour==="affine:page"?c==null?void 0:c.querySelector(".affine-default-page-block-title-container"):c==null?void 0:c.querySelector("rich-text");a&&n.intersectsNode(a)&&(c==null?void 0:c.tagName)!=="GROUP-BLOCK"&&e.push(s.model)}),e):[Jo()]}function Wy(n){const t=n.closest(`[${we}]`);return Bt(t.model),t.model}function Es(){return window.getSelection().getRangeAt(0)}function Gy(n,t){let e="";for(let r=0;r<n.childNodes.length;r++){const i=n.childNodes[r];if(i!==t||!t.contains(i))e+=i.textContent||i.innerText||"";else return e}return e}function Vr(n,t,e){var s,c;if(n instanceof Element&&n.classList.contains("affine-default-page-block-title-container"))return(e?(s=n.querySelector("input"))==null?void 0:s.selectionStart:(c=n.querySelector("input"))==null?void 0:c.selectionEnd)||0;let r=0,i=n,o=!1;for(;n&&(!(i!=null&&i.getAttributeNode)||!i.getAttributeNode("contenteditable"));){if(n instanceof Element&&n.hasAttribute("data-block-id")){r=0;break}o?r+=Gy(n,i).length:(o=!0,r+=t),i=n,n=n==null?void 0:n.parentNode}return r}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{H:Yy}=Kh,xc=()=>document.createComment(""),gi=(n,t,e)=>{var r;const i=n._$AA.parentNode,o=t===void 0?n._$AB:t._$AA;if(e===void 0){const s=i.insertBefore(xc(),o),c=i.insertBefore(xc(),o);e=new Yy(s,c,n,n.options)}else{const s=e._$AB.nextSibling,c=e._$AM,a=c!==n;if(a){let y;(r=e._$AQ)===null||r===void 0||r.call(e,n),e._$AM=n,e._$AP!==void 0&&(y=n._$AU)!==c._$AU&&e._$AP(y)}if(s!==o||a){let y=e._$AA;for(;y!==s;){const g=y.nextSibling;i.insertBefore(y,o),y=g}}}return e},lr=(n,t,e=n)=>(n._$AI(t,e),n),Zy={},Xy=(n,t=Zy)=>n._$AH=t,Jy=n=>n._$AH,Qs=n=>{var t;(t=n._$AP)===null||t===void 0||t.call(n,!1,!0);let e=n._$AA;const r=n._$AB.nextSibling;for(;e!==r;){const i=e.nextSibling;e.remove(),e=i}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ec=(n,t,e)=>{const r=new Map;for(let i=t;i<=e;i++)r.set(n[i],i);return r},qn=La(class extends Na{constructor(n){if(super(n),n.type!==Ra.CHILD)throw Error("repeat() can only be used in text expressions")}ht(n,t,e){let r;e===void 0?e=t:t!==void 0&&(r=t);const i=[],o=[];let s=0;for(const c of n)i[s]=r?r(c,s):s,o[s]=e(c,s),s++;return{values:o,keys:i}}render(n,t,e){return this.ht(n,t,e).values}update(n,[t,e,r]){var i;const o=Jy(n),{values:s,keys:c}=this.ht(t,e,r);if(!Array.isArray(o))return this.ut=c,s;const a=(i=this.ut)!==null&&i!==void 0?i:this.ut=[],y=[];let g,u,l=0,f=o.length-1,h=0,m=s.length-1;for(;l<=f&&h<=m;)if(o[l]===null)l++;else if(o[f]===null)f--;else if(a[l]===c[h])y[h]=lr(o[l],s[h]),l++,h++;else if(a[f]===c[m])y[m]=lr(o[f],s[m]),f--,m--;else if(a[l]===c[m])y[m]=lr(o[l],s[m]),gi(n,y[m+1],o[l]),l++,m--;else if(a[f]===c[h])y[h]=lr(o[f],s[h]),gi(n,o[l],o[f]),f--,h++;else if(g===void 0&&(g=Ec(c,h,m),u=Ec(a,l,f)),g.has(a[l]))if(g.has(a[f])){const k=u.get(c[h]),b=k!==void 0?o[k]:null;if(b===null){const v=gi(n,o[l]);lr(v,s[h]),y[h]=v}else y[h]=lr(b,s[h]),gi(n,o[l],b),o[k]=null;h++}else Qs(o[f]),f--;else Qs(o[l]),l++;for(;h<=m;){const k=gi(n,y[m+1]);lr(k,s[h]),y[h++]=k}for(;l<=f;){const k=o[l++];k!==null&&Qs(k)}return this.ut=c,Xy(n,y),Un}});function Bf(n,t){switch(n.flavour){case"affine:paragraph":return ft`
        <paragraph-block
          .model=${n}
          .host=${t}
        ></paragraph-block>
      `;case"affine:list":return ft`
        <list-block
          .model=${n}
          .host=${t}
        ></list-block>
      `;case"affine:group":return ft`
        <group-block
          .model=${n}
          .host=${t}
        ></group-block>
      `;case"affine:database":return ft`
        <database-block
          .model=${n}
          .host=${t}
        ></database-block>
      `;case"affine:database-item":return""}return ft`<div>Unknown block type: "${n.flavour}"</div>`}function Ji(n,t){return ft`
    <style>
      .affine-block-children-container {
        padding-left: 26px;
      }
    </style>
    <div class="affine-block-children-container">
      ${qn(n.children,e=>e.id,e=>Bf(e,t))}
    </div>
  `}function Qy(n,t,e=2){return Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)>e*e}function pn(n,t,e,r,i=null){var g,u;const o={x:0,y:0},s={x:e,y:r},c=n.clientX-((g=t==null?void 0:t.left)!=null?g:0),a=n.clientY-((u=t==null?void 0:t.top)!=null?u:0),y={x:c,y:a,raw:n,delta:o,start:s,keys:{shift:n.shiftKey,cmd:n.metaKey||n.ctrlKey,alt:n.altKey},button:n.button};return i&&(o.x=c-i.x,o.y=a-i.y),y}function gl(n){return n.target instanceof HTMLInputElement}function tv(n){var e;const t=(e=n.target)==null?void 0:e.tagName;return t=="AFFINE-TABLE"||t=="AFFINE-GALLERY"}function ta(n){!gl(n)&&!tv(n)&&n.preventDefault()}function $f(n,t,e,r,i,o,s,c,a){let y=-1/0,g=-1/0,u=!1,l=null,f=null;const h=w=>c(pn(w,f,y,g)),m=w=>{ta(w),f=n.getBoundingClientRect(),y=w.clientX-f.left,g=w.clientY-f.top,u=!1,w.button||(l=pn(w,f,y,g)),document.addEventListener("mouseup",b),document.addEventListener("mouseout",h)},k=w=>{ta(w),f||(f=n.getBoundingClientRect());const E={x:y,y:g},x=w.clientX-f.left,O=w.clientY-f.top,L={x,y:O};if(!l){s(pn(w,f,y,g,l));return}Qy(E,L)&&!u&&(u=!0,t(l)),u&&(e(pn(w,f,y,g,l)),s(pn(w,f,y,g,l)),l=pn(w,f,y,g))},b=w=>{ta(w),u?r(pn(w,f,y,g,l)):i(pn(w,f,y,g)),y=g=-1/0,u=!1,l=null,document.removeEventListener("mouseup",b),document.removeEventListener("mouseout",h)},v=w=>{a(pn(w,f,y,g))},d=w=>{o(pn(w,f,y,g))};return n.addEventListener("mousedown",m),n.addEventListener("mousemove",k),n.addEventListener("contextmenu",v),n.addEventListener("dblclick",d),()=>{n.removeEventListener("mousedown",m),n.removeEventListener("mousemove",k),n.removeEventListener("contextmenu",v),n.removeEventListener("dblclick",d)}}const wo=100,ev=/[^\p{Alpha}\p{M}\p{Nd}\p{Pc}\p{Join_C}]/u,jf=/[^\p{Alpha}\p{M}\p{Nd}\p{Pc}\p{Join_C}\s]/u;function nv(n,t){var e,r;if(n.endContainer.nodeType!==Node.TEXT_NODE){const i=wv(n.endContainer);i&&(n=document.createRange(),n.setStart(i,((e=i.textContent)==null?void 0:e.length)||0),n.setEnd(i,((r=i.textContent)==null?void 0:r.length)||0))}t.setEnd(n.endContainer,n.endOffset)}function rv(n,t){if(n.startContainer.nodeType!==Node.TEXT_NODE){const e=kv(n.startContainer);e&&(n=document.createRange(),n.setStart(e,0),n.setEnd(e,0))}t.setStart(n.endContainer,n.endOffset)}function iv(n,t,e,r){const i=r?e.endContainer:e.startContainer;let o=e;if(i.nodeType!==Node.TEXT_NODE){const s=Array.from(e.commonAncestorContainer.querySelectorAll(".ql-editor"));if(s.length){const c=r?s.reverse().find(g=>{const u=g.getBoundingClientRect();return t>=u.top}):s.find(g=>{const u=g.getBoundingClientRect();return t<=u.bottom});if(!c)throw new Error("Failed to focus text node!");const a=c.getBoundingClientRect(),y=r?a.bottom-6:a.top+6;o=nn(n,y),r&&o?nv(o,e):!r&&o&&rv(o,e)}}return e}async function Sc(n=0){return new Promise(t=>{setTimeout(()=>{t(null)},n)})}function ov(n){const t=document.createRange();let e=n.firstChild;for(;e!=null&&e.firstChild;)e=e.firstChild;return e&&(t.setStart(e,0),t.setEnd(e,0)),t}function sv(n){var r,i;const t=document.createRange();let e=n.lastChild;for(;e!=null&&e.lastChild;)e=e.lastChild;return e&&(t.setStart(e,((r=e.textContent)==null?void 0:r.length)||0),t.setEnd(e,((i=e.textContent)==null?void 0:i.length)||0)),t}async function av(n,t){const e=t.closest(".affine-editor-container"),{top:r,bottom:i}=Qn.fromDom(t),{clientHeight:o}=document.documentElement,s=Number(window.getComputedStyle(t).lineHeight.replace(/\D+$/,""))||16;switch(i<n){case!0:{let a=i;return i<wo&&e&&(e.scrollTop=e.scrollTop-wo+i,await Sc(),a=t.getBoundingClientRect().bottom),a-s/2}case!1:{let a=r;return e&&r>o-wo&&(e.scrollTop=e.scrollTop+(r+wo-o),await Sc(),a=t.getBoundingClientRect().top),a+s/2}}}async function lv(n,t){const{left:e,right:r}=Qn.fromDom(t);let i=null;switch(n){case"start":i=ov(t);break;case"end":i=sv(t);break;default:{const{x:o,y:s}=n;let c=o;const a=await av(s,t);o<=e&&(c=e+1),o>=r&&(c=r-1),i=nn(c,a),ze(i);break}}ze(i)}function qf(n,t){const e=oi(t),r=e==null?void 0:e.querySelector("[contenteditable]");r&&lv(n,r)}function ka(n,t){const e=ks(n),r=pl(n);let i=t;i?e.lastSelectionPosition=i:e.lastSelectionPosition&&(i=e.lastSelectionPosition);const o=dl(r,n.id);o&&i&&qf(i,o)}function No(n,t="start"){const e=ks(n);let r=t;r?e.lastSelectionPosition=r:e.lastSelectionPosition&&(r=e.lastSelectionPosition);const i=wa(n.id);i&&qf(r,i)}function ze(n){const t=window.getSelection();t==null||t.removeAllRanges(),n&&(t==null||t.addRange(n))}function Cc(n,t){const e=n.querySelector("rich-text");Bt(e);const r=e.getBoundingClientRect(),i=r.y+r.height/2,o=nn(t,i);(o==null?void 0:o.startContainer)instanceof Node&&ze(o)}function Uf(){const n=window.getSelection();return n?n.type==="None":!0}function cv(){const n=window.getSelection();return n?n.isCollapsed:!1}function yl(){const n=window.getSelection();return n?!n.isCollapsed:!1}function Ff(n){return n.commonAncestorContainer.nodeType!==Node.TEXT_NODE}function uv(n){var r;const t=[],e=new Map;for(let i=0;i<n.length;i++){const o=n[i],s=o.space.getParent(o),c={id:o.id,children:[]};!s||!e.has(s.id)?t.push(c):(r=e.get(s.id))==null||r.children.push(c),e.set(o.id,c)}return t}function Hf(n){if(n.length===0)return null;const t=n[n.length-1];return t.children.length===0?t:Hf(t.children)}function zf(n){if(!n.root)return{type:"None",selectedBlocks:[]};let t="None",e=[],r=[];const i=ks(n.root),{state:o}=i.selection,s=window.getSelection();if(o.type==="block"){t="Block";const{selectedRichTexts:c}=o;r=c.map(a=>a.model)}else s&&s.type!=="None"&&(t=s.type,r=xs(Es()));if(t!=="None"&&(e=uv(r),t!=="Block"&&s&&e.length>0)){const c=s.getRangeAt(0),a=Vr(c.startContainer,c.startOffset,!0),y=Vr(c.endContainer,c.endOffset,!1);e[0].startPos=a;const g=Hf(e);g&&(g.endPos=y)}return{type:t,selectedBlocks:e}}function Vf(n,t){let e=!0;Bt(n);const{startContainer:r,startOffset:i,endContainer:o,endOffset:s}=n;let c=nn(t.raw.clientX,t.raw.clientY);(c==null?void 0:c.comparePoint(o,s))===1?(e=!1,c==null||c.setEnd(o,s)):c==null||c.setStart(r,i),c&&(c=iv(t.raw.clientX,t.raw.clientY,c,e)),ze(c)}function fv(n){return n instanceof HTMLElement?n.className.includes("affine-paragraph-block-container"):!1}function hv(n){return n.tagName==="GROUP-BLOCK"}function dv(n){return n instanceof HTMLElement?n.className.includes("affine-group-block-container"):!1}function pv(n){const{cursor:t}=window.getComputedStyle(n.raw.target);return t!=="text"}function Kf(n,t){const e=nn(t.raw.clientX,t.raw.clientY),r=e==null?void 0:e.startContainer;if(!t.button&&(r instanceof Node&&ze(e),r instanceof HTMLElement)){if(fv(r)||dv(r))Cc(r,t.raw.clientX);else if(hv(r)){const{root:i}=n,o=i==null?void 0:i.lastChild();if(Bt(o),Uy(o,["affine:paragraph","affine:list"])){const s=oi(o);if(!s)return;Cc(s,t.raw.clientX)}}}}function gv(n,t){var r;const e=window.getSelection();if(e&&e.isCollapsed&&e.anchorNode){const i=(r=e.anchorNode.parentElement)==null?void 0:r.closest("[contenteditable]");i&&yv(e,i)}}function yv(n,t){const e=Ss(t);if(!e.length)return;const[r,i,o]=mv(e,n);bv(n,r,i,e,o),ze(r)}function vv(n,t,e,r){var a,y,g;let i=t[0],o=0,s=t[t.length-1],c=((a=s.textContent)==null?void 0:a.length)||0;for(let u=n;u>=0;u--){const l=t[u];if(l instanceof Text){const f=(y=l.textContent)==null?void 0:y.slice(0,u===n?e.anchorOffset:void 0);if(f){const h=Array.from(f).reverse().join(""),m=h.search(r);if(m!==-1){i=l,o=h.length-m;break}}}}for(let u=n;u<t.length;u++){const l=t[u];if(l instanceof Text){const f=(g=l.textContent)==null?void 0:g.slice(u===n?e.anchorOffset:void 0);if(f){const h=f.search(r);if(h!==-1){s=l,c=u===n?e.anchorOffset+h:h;break}}}}return[i,o,s,c]}function mv(n,t){var g,u;let e=n[0],r=0,i=n[n.length-1],o=((g=i.textContent)==null?void 0:g.length)||0;const s=t.anchorNode instanceof Element?t.anchorNode.firstChild:t.anchorNode,c=((u=s==null?void 0:s.textContent)==null?void 0:u[t.anchorOffset])||"",a=n.findIndex(l=>l===s);if(c&&jf.test(c)&&s)e=s,i=s,r=t.anchorOffset,o=t.anchorOffset+1;else{let l=ev;/\s/.test(c)&&(l=/\S/),/\w/.test(c)&&(l=/\W/);const[f,h,m,k]=vv(a,n,t,l);e=f,r=h,i=m,o=k}const y=document.createRange();return y.setStart(e,r),y.setEnd(i,o),[y,c,a]}function bv(n,t,e,r,i){var o,s;if(Intl.Segmenter&&!jf.test(e)&&!/\w/.test(e)){const[c,a]=_v(t,r,n,e);let y=c,g=a.length-c;for(let u=i;u>=0;u--){const l=r[u],f=u===i?n.anchorOffset:((o=l.textContent)==null?void 0:o.length)||0;if(y<=f){t.setStart(l,f-y);break}else y=y-f}for(let u=i;u<r.length;u++){const l=r[u],f=((s=l.textContent)==null?void 0:s.length)||0,h=u===i?f-n.anchorOffset:f;if(g<=h){t.setEnd(l,f-h+g);break}else g=g-h}}}function _v(n,t,e,r){var l;const i=n.toString(),s=new Intl.Segmenter([],{granularity:"word"}).segment(i)[Symbol.iterator](),c=Array.from(s);let a=0,y=!1;for(let f=0;f<t.length;f++){const h=t[f];if(y||h===n.startContainer)if(y=!0,h!==e.anchorNode)a=a+(((l=h.textContent)==null?void 0:l.length)||0);else{a=a+e.anchorOffset-n.startOffset;break}}let g=c[c.length-1].segment;for(let f=0;f<c.length;f++){const h=c[f];if(a===h.index){g=h.segment;break}if(a<h.index){g=c[f-1].segment;break}}return[g.indexOf(r),g]}function Ss(n,t=[]){if(n.nodeType===Node.TEXT_NODE)t.push(n);else{const e=n.childNodes;for(let r=0;r<e.length;r++)Ss(e[r],t)}return t}function wv(n){return Ss(n).pop()}function kv(n){return Ss(n)[0]}function xv(n){const t=[...n.value];return Bt(n.selectionStart),Bt(n.selectionEnd),t.splice(n.selectionStart,n.selectionEnd-n.selectionStart),t.join("")}function Ev(n,t){const e=n.getParent(t),r=e==null?void 0:e.children.indexOf(t);if(e&&r!==void 0&&r>-1){n.captureSync();let i="";if(t.flavour==="affine:list"){const o={flavour:t.flavour,type:t.type};t.children.length===0?i=n.addBlock(o,e,r+1):i=n.addBlock(o,t,0)}else{const o={flavour:t.flavour,type:"text"};i=n.addBlock(o,e,r+1)}i&&nr(n,i)}}function Sv(n,t,e){var r;n.captureSync(),(r=t.text)==null||r.insert(`
`,e)}function Cv(n,t,e){if(!(t.text instanceof jn))return;const r=n.getParent(t);if(!r)return;const[i,o]=t.text.split(e);n.captureSync(),n.markTextSplit(t.text,i,o),n.updateBlock(t,{text:i});let s=r,c=s.children.indexOf(t)+1;t.flavour==="affine:list"&&t.children.length>0&&(s=t,c=0);const a=n.addBlock({flavour:t.flavour,text:o,type:t.type},s,c);nr(n,a)}function Av(n,t,e){var i;const r=n.getPreviousSibling(t);if(r){n.captureSync();const o={flavour:t.flavour,type:t.type,text:(i=t==null?void 0:t.text)==null?void 0:i.clone(),children:t.children};n.deleteBlock(t);const s=n.addBlock(o,r);requestAnimationFrame(()=>{const c=n.getBlockById(s);Bt(c);const a=Fe(c);a==null||a.quill.setSelection(e,0)})}}async function Ac(n,t,e){var a;const r=n.getParent(t);if(!r||(r==null?void 0:r.flavour)==="affine:group")return;const i=n.getParent(r);if(!i)return;const o=i.children.indexOf(r),s={flavour:t.flavour,text:(a=t==null?void 0:t.text)==null?void 0:a.clone(),children:t.children,type:t.type};n.captureSync(),n.deleteBlock(t);const c=n.addBlock(s,i,o+1);requestAnimationFrame(()=>{const y=n.getBlockById(c);Bt(y);const g=Fe(y);g==null||g.quill.setSelection(e,0)})}function Oc(n,t){var e,r,i,o,s;if(t.flavour==="affine:paragraph")if(t.type!=="text")n.captureSync(),n.updateBlock(t,{type:"text"});else{const c=n.getParent(t);if(!c||(c==null?void 0:c.flavour)==="affine:group"){const a=pl(t),y=dl(a,t.id);if(y&&y.flavour==="affine:paragraph"){n.captureSync();const g=((e=y.text)==null?void 0:e.length)||0;(r=y.text)==null||r.join(t.text),n.deleteBlock(t);const u=Fe(y);(i=u==null?void 0:u.quill)==null||i.setSelection(g,0)}}else{const a=n.getParent(c);if(!a)return;const y=a.children.indexOf(c),g={flavour:t.flavour,text:(o=t==null?void 0:t.text)==null?void 0:o.clone(),children:t.children,type:t.type};n.captureSync(),n.deleteBlock(t),n.addBlock(g,a,y+1)}}else if(t.flavour==="affine:list"){const c=n.getParent(t);if(!c)return;const a=c.children.indexOf(t);n.captureSync();const y={flavour:"affine:paragraph",type:"text",text:(s=t==null?void 0:t.text)==null?void 0:s.clone(),children:t.children};n.deleteBlock(t);const g=n.addBlock(y,c,a);nr(n,g)}}function Ov(n,t){var r;const e=window.getSelection();if(e){const i=e.getRangeAt(0),{height:o,left:s,top:c}=i.getBoundingClientRect();if(o===0&&c===0){const y=(r=i.startContainer.parentElement)==null?void 0:r.getBoundingClientRect();return y&&ka(n,new wi(y.left,y.top)),Ht}const a=nn(s,c-o/2);if((!a||!t.contains(a.startContainer))&&!Wf(i)){const y=pl(n),g=dl(y,n.id);return(g==null?void 0:g.flavour)==="affine:group"?document.querySelector(".affine-default-page-block-title").focus():ka(n,new wi(s,c)),Ht}}return ae}function Wf(n){var t;if(n.startOffset>0&&Number((t=n.startContainer.textContent)==null?void 0:t.length)-n.startOffset>0){const e=n.cloneRange();e.setStart(n.startContainer,n.startOffset-1),e.setEnd(n.startContainer,n.startOffset-1);const r=n.cloneRange();return r.setStart(n.endContainer,n.endOffset+1),r.setEnd(n.endContainer,n.endOffset+1),e.getBoundingClientRect().top!==r.getBoundingClientRect().top}return!1}function Tv(n,t){var r;const e=window.getSelection();if(e){const i=e.getRangeAt(0),{bottom:o,left:s,height:c}=i.getBoundingClientRect();if(c===0&&o===0){const y=(r=i.startContainer.parentElement)==null?void 0:r.getBoundingClientRect();return wa(n.id)?(y&&No(n,new wi(y.left,y.top)),Ht):ae}const a=nn(s,o+c/2);if(!a||!t.contains(a.startContainer))return wa(n.id)?(No(n,new wi(s,o)),Ht):ae;if(Wf(i)){const{height:y,left:g,bottom:u}=a.getBoundingClientRect(),l=nn(g,u+y/2);if(!l||!t.contains(l.startContainer))return No(n,new wi(t.getBoundingClientRect().left||g,o)),Ht}}return ae}function Rv(n,t,e,r,i){const[,o]=e.getLine(i.index);if(o>r.length)return ae;let s=!1;switch(r.trim()){case"[]":case"[ ]":s=vi(n,t,"todo",r,{checked:!1});break;case"[x]":s=vi(n,t,"todo",r,{checked:!0});break;case"-":case"*":s=vi(n,t,"bulleted",r);break;case"#":s=ar(n,t,"h1",r);break;case"##":s=ar(n,t,"h2",r);break;case"###":s=ar(n,t,"h3",r);break;case"####":s=ar(n,t,"h4",r);break;case"#####":s=ar(n,t,"h5",r);break;case"######":s=ar(n,t,"h6",r);break;case">":s=ar(n,t,"quote",r);break;default:s=vi(n,t,"numbered",r)}return s?Ht:ae}const Po=class{static match(n,t,e){const r=n.getSelection();if(!r)return Ht;const[i]=n.getLine(r.index);if(Po._isValid(e,i.domNode.tagName)){for(const o of Po._matches)if(e.match(o.pattern))return o.action(t,n,e,r,o.pattern)}return Ht}static _isValid(n,t){return typeof n<"u"&&n&&Po._ignoreTags.indexOf(t)===-1}};let Qo=Po;Qo._ignoreTags=["PRE"];Qo._matches=[{name:"bolditalic",pattern:/(?:\*){3}(.+?)(?:\*){3}$/g,action:(n,t,e,r,i)=>{var a,y,g,u,l;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return e.match(/^([* \n]+)$/g)?Ht:((a=n.text)==null||a.insert(" ",c+s.length),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{bold:!0,italic:!0}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),(u=n.text)==null||u.delete(c+s.length-3,3),(l=n.text)==null||l.delete(c,3),t.format("bold",!1),t.format("italic",!1),ae)}},{name:"bold",pattern:/(?:\*){2}(.+?)(?:\*){2}$/g,action:(n,t,e,r,i)=>{var a,y,g,u,l;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return e.match(/^([* \n]+)$/g)?Ht:((a=n.text)==null||a.insert(" ",c+s.length),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{bold:!0}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),(u=n.text)==null||u.delete(c+s.length-2,2),(l=n.text)==null||l.delete(c,2),t.format("bold",!1),ae)}},{name:"italic",pattern:/(?:\*){1}(.+?)(?:\*){1}$/g,action:(n,t,e,r,i)=>{var a,y,g,u,l;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return e.match(/^([* \n]+)$/g)?Ht:((a=n.text)==null||a.insert(" ",c+s.length),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{italic:!0}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),(u=n.text)==null||u.delete(c+s.length-1,1),(l=n.text)==null||l.delete(c,1),t.format("italic",!1),ae)}},{name:"strikethrough",pattern:/(?:~~)(.+?)(?:~~)$/g,action:(n,t,e,r,i)=>{var a,y,g,u,l;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return e.match(/^([* \n]+)$/g)?Ht:((a=n.text)==null||a.insert(" ",c+s.length),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{strike:!0}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),(u=n.text)==null||u.delete(c+s.length-2,2),(l=n.text)==null||l.delete(c,2),t.format("strike",!1),ae)}},{name:"underthrough",pattern:/(?:~)(.+?)(?:~)$/g,action:(n,t,e,r,i)=>{var a,y,g,u,l,f;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return e.match(/^([* \n]+)$/g)?Ht:((a=n.text)==null||a.insert(" ",r.index),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{underline:!0}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),(u=n.text)==null||u.delete(r.index,1),(l=n.text)==null||l.delete(r.index-1,1),(f=n.text)==null||f.delete(c,1),t.format("underline",!1),ae)}},{name:"code",pattern:/(?:`)(.+?)(?:`)$/g,action:(n,t,e,r,i)=>{var a,y,g,u,l;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return e.match(/^([* \n]+)$/g)?Ht:((a=n.text)==null||a.insert(" ",c+s.length),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{code:!0}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),(u=n.text)==null||u.delete(c+s.length-1,1),(l=n.text)==null||l.delete(c,1),t.format("code",!1),ae)}},{name:"link",pattern:/(((https?|ftp|file):\/\/)|www.)[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]$/g,action:(n,t,e,r,i)=>{var a,y,g;const o=i.exec(e);if(!o)return Ht;const s=o[0],c=r.index-s.length;return(a=n.text)==null||a.insert(" ",c+s.length),n.space.captureSync(),(y=n.text)==null||y.format(c,s.length,{link:s}),t.setSelection(c+s.length+1,0),(g=n.text)==null||g.delete(c+s.length,1),t.format("link",!1),ae}},{name:"link",pattern:/(?:\[(.+?)\])(?:\((.+?)\))$/g,action:(n,t,e,r,i)=>{var g,u,l,f,h,m,k,b;const o=e.search(i),s=(g=e.match(i))==null?void 0:g[0],c=(u=e.match(/(?:\[(.*?)\])/g))==null?void 0:u[0],a=(l=e.match(/(?:\((.*?)\))/g))==null?void 0:l[0];if(o===-1||!s||!c||!a)return Ht;const y=r.index-s.length;return(f=n.text)==null||f.insert(" ",r.index),n.space.captureSync(),(h=n.text)==null||h.format(y,c.length,{link:a.slice(1,a.length-1)}),t.setSelection(o+s.length+1,0),(m=n.text)==null||m.delete(o+s.length,1),(k=n.text)==null||k.delete(r.index-a.length-1,a.length+1),(b=n.text)==null||b.delete(y,1),t.format("link",!1),ae}}];function Lv(n){var t;return n.getLength()-1===((t=n.getSelection(!0))==null?void 0:t.index)}function Nv(n,t){function e(m,k){const{prefix:b}=k;return Qo.match(this.quill,t,b),ae}function r(m,k){const{prefix:b}=k;return Qo.match(this.quill,t,b)?Ht:ae}function i(){var w,E;const m=Lv(this.quill),k=n.getParent(t),b=(k==null?void 0:k.lastChild())===t,v=t.flavour==="affine:list"&&((w=t.text)==null?void 0:w.length)===0,d=((E=this.quill.getSelection())==null?void 0:E.index)||0,p=[{flavour:"affine:paragraph",type:"quote"}];if(v&&(k==null?void 0:k.flavour)==="affine:group"&&t.children.length===0)Oc(n,t);else if(v&&b)Ac(n,t,d);else if(m){const x=p.findIndex(({flavour:S,type:C})=>t.flavour===S&&t.type===C)!==-1,O=/\n\n$/.test(this.quill.getText());x&&!O?o.bind(this)():(x&&this.quill.deleteText(d,1),Ev(n,t))}else p.findIndex(({flavour:O,type:L})=>t.flavour===O&&t.type===L)!==-1?o.bind(this)():Cv(n,t,d);return Ht}function o(){var k;const m=((k=this.quill.getSelection())==null?void 0:k.index)||0;return Sv(n,t,m),this.quill.setSelection(m+1,0),Ht}function s(){var k;const m=((k=this.quill.getSelection())==null?void 0:k.index)||0;return Av(n,t,m),Ht}function c(){var k;const m=((k=this.quill.getSelection())==null?void 0:k.index)||0;return Ac(n,t,m),Ht}function a(m){return m.index>=0?Ov(t,this.quill.root):ae}function y(m){return m.index>=0?Tv(t,this.quill.root):ae}function g(m){return m.index===0&&m.length===0?(ka(t,"end"),Ht):ae}function u(m){const k=this.quill.getText().length;return m.index+1===k?(No(t,"start"),Ht):ae}function l(m,k){const{quill:b}=this,{prefix:v}=k;return Rv(n,t,b,v,m)}function f(){return Tf(this.quill)?(Oc(n,t),Ht):(Ff(Es()),ae)}return{enterMarkdownMatch:{key:"enter",handler:e},spaceMarkdownMatch:{key:" ",handler:r},hardEnter:{key:"enter",handler:i},softEnter:{key:"enter",shiftKey:!0,handler:o},tab:{key:"tab",handler:s},shiftTab:{key:"tab",shiftKey:!0,handler:c},"list autofill":{key:" ",shiftKey:!1,prefix:/^(\d+\.|-|\*|\[ ?\]|\[x\]|(#){1,6}|>)$/,handler:l},"list autofill shift":{key:" ",shiftKey:!0,prefix:/^(\d+\.|-|\*|\[ ?\]|\[x\]|(#){1,6}|>)$/,handler:l},backspace:{key:"backspace",handler:f},up:{key:"up",shiftKey:!1,handler:a},down:{key:"down",shiftKey:!1,handler:y},"embed left":{key:37,shiftKey:!1,handler:g},right:{key:"right",shiftKey:!1,handler:u}}}const Pv=`.ql-container{box-sizing:border-box;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-container p{margin:0;padding:0}.ql-editor{box-sizing:border-box;height:100%;outline:none;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word;margin:3px 0}.ql-editor>*{cursor:text}.ql-editor.ql-blank:before{color:var(--affine-disable-color);content:attr(data-placeholder);pointer-events:none;position:absolute}
`;var Dv=Object.defineProperty,Iv=Object.getOwnPropertyDescriptor,Qi=(n,t,e,r)=>{for(var i=r>1?void 0:r?Iv(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Dv(t,e,i),i};on.register("modules/cursors",Cy);const Mv=on.import("modules/clipboard");class Bv extends Mv{onPaste(){}}on.register("modules/clipboard",Bv,!0);const Gf=on.import("formats/strike");Gf.tagName="del";on.register(Gf,!0);let vr=class extends zt{createRenderRoot(){return this}firstUpdated(){const{host:n,model:t,placeholder:e,_textContainer:r}=this,{space:i}=n,o=Nv(i,t);this.quill=new on(r,{modules:{cursors:!0,toolbar:!1,history:{maxStack:0,userOnly:!0},keyboard:{bindings:o}},placeholder:e}),i.attachRichText(t.id,this.quill),i.awareness.updateLocalCursor(),this.model.propsUpdated.on(()=>this.requestUpdate()),this.quill.on("text-change",s=>{var y,g,u,l,f,h,m,k,b,v,d,p,w,E;const c={code:"code",link:"link-code"};let a="";if((g=(y=s.ops[1])==null?void 0:y.attributes)!=null&&g.code&&(a="code"),(l=(u=s.ops[1])==null?void 0:u.attributes)!=null&&l.link&&(a="link"),s.ops.length===2&&((f=s.ops[1])==null?void 0:f.insert)&&a){const x=s.ops[0].retain,O=c[a];if(x!==void 0){const L=this.quill.getLeaf(x+Number((h=s.ops[1])==null?void 0:h.insert.toString().length)),S=this.quill.getLeaf(x+Number((m=s.ops[1])==null?void 0:m.insert.toString().length)+1),C=(b=(k=L[0])==null?void 0:k.domNode)==null?void 0:b.parentElement,T=C==null?void 0:C.closest(O),N=(d=(v=S[0])==null?void 0:v.domNode)==null?void 0:d.parentElement,D=N==null?void 0:N.closest(O),M=(p=s.ops[1])==null?void 0:p.insert.toString();(D&&D!==T||!D)&&((E=t.text)==null||E.replace(x,M.length,this.host.isCompositionStart?" ":((w=s.ops[1])==null?void 0:w.insert.toString())||"",{[a]:!1}))}}})}disconnectedCallback(){super.disconnectedCallback(),this.host.space.detachRichText(this.model.id)}updated(){var n,t;(t=this.quill)==null||t.root.setAttribute("data-placeholder",(n=this.placeholder)!=null?n:"")}render(){return ft`
      <div class="affine-rich-text quill-container ql-container"></div>
    `}};vr.styles=Kt`
    ${Ve(Pv)}
  `;Qi([Ki(".affine-rich-text.quill-container")],vr.prototype,"_textContainer",2);Qi([xt()],vr.prototype,"host",2);Qi([xt()],vr.prototype,"model",2);Qi([xt()],vr.prototype,"placeholder",2);vr=Qi([Xt("rich-text")],vr);function Yf(n){var r;const t=(r=window.getSelection())==null?void 0:r.getRangeAt(0),e=nn(n.x,n.y);t&&e&&t.isPointInRange(e.startContainer,e.startOffset)&&t.isPointInRange(e.endContainer,e.endOffset)&&requestAnimationFrame(()=>{ze(t)})}function $v(n,t){return n.left<t.right&&n.right>t.left&&n.top<t.bottom&&n.bottom>t.top}function Tc(n,t){return Array.from(n.keys()).filter(r=>{const i=r.getBoundingClientRect();return $v(i,t)})}function jv(n,t){const e=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y),i=Math.min(n.x,t.x),o=Math.min(n.y,t.y);return new DOMRect(i,o,e,r)}class qv{constructor(t){this.selectedRichTexts=[],this._startRange=null,this._startPoint=null,this._richTextCache=new Map,this.type=t}get startRange(){return this._startRange}get startPoint(){return this._startPoint}get richTextCache(){return this._richTextCache}resetStartRange(t){this._startRange=nn(t.raw.clientX,t.raw.clientY),this._startPoint={x:t.raw.clientX,y:t.raw.clientY}}refreshRichTextBoundsCache(t){Array.from(t.querySelectorAll("rich-text")).forEach(r=>{const i=r.getBoundingClientRect();this._richTextCache.set(r,i)})}clear(){this.type="none",this._richTextCache.clear(),this._startRange=null,this._startPoint=null,this.selectedRichTexts=[]}}class Uv{constructor(t,e,r){this.state=new qv("none"),this._onContainerDragStart=i=>{this.state.resetStartRange(i),!gl(i.raw)&&(pv(i)?this._onBlockSelectionDragStart(i):this._onNativeSelectionDragStart(i))},this._onContainerDragMove=i=>{this.state.type==="native"?this._onNativeSelectionDragMove(i):this.state.type==="block"&&this._onBlockSelectionDragMove(i)},this._onContainerDragEnd=i=>{this.state.type==="native"?this._onNativeSelectionDragEnd(i):this.state.type==="block"&&this._onBlockSelectionDragEnd(i)},this._onContainerClick=i=>{this.state.clear(),this._signals.updateSelectedRects.emit([]),i.raw.target.tagName!=="DEBUG-MENU"&&(i.raw.target instanceof HTMLInputElement||i.keys.shift||Kf(this.space,i))},this._onContainerDblClick=i=>{this.state.clear(),this._signals.updateSelectedRects.emit([]),i.raw.target.tagName!=="DEBUG-MENU"&&(i.raw.target instanceof HTMLInputElement||gv(this.space))},this._onContainerContextMenu=i=>{Yf(i)},this._onContainerMouseMove=i=>{},this._onContainerMouseOut=i=>{},this.space=t,this._signals=r,this._container=e,this._mouseDisposeCallback=$f(this._container,this._onContainerDragStart,this._onContainerDragMove,this._onContainerDragEnd,this._onContainerClick,this._onContainerDblClick,this._onContainerMouseMove,this._onContainerMouseOut,this._onContainerContextMenu)}_onBlockSelectionDragStart(t){this.state.type="block",this.state.resetStartRange(t),this.state.refreshRichTextBoundsCache(this._container),ze(null)}_onBlockSelectionDragMove(t){Bt(this.state.startPoint);const e={x:t.raw.clientX,y:t.raw.clientY},{startPoint:r}=this.state,i=jv(e,r),{richTextCache:o}=this.state,s=Tc(o,i);this.state.selectedRichTexts=s;const c=s.map(a=>o.get(a));this._signals.updateSelectedRects.emit(c),this._signals.updateFrameSelectionRect.emit(i)}_onBlockSelectionDragEnd(t){this._signals.updateFrameSelectionRect.emit(null)}_onNativeSelectionDragStart(t){this.state.type="native"}_onNativeSelectionDragMove(t){Vf(this.state.startRange,t)}_onNativeSelectionDragEnd(t){}dispose(){this._signals.updateSelectedRects.dispose(),this._signals.updateFrameSelectionRect.dispose(),this._mouseDisposeCallback()}selectBlockByRect(t){this.state.type="block",this.state.refreshRichTextBoundsCache(this._container);const{richTextCache:e}=this.state,r=Tc(e,t);this.state.selectedRichTexts=r;const i=[t];this._signals.updateSelectedRects.emit(i)}}var Fv=Object.defineProperty,Hv=Object.getOwnPropertyDescriptor,Zf=(n,t,e,r)=>{for(var i=r>1?void 0:r?Hv(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Fv(t,e,i),i};const zv=()=>ss`<svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M17.6726 6.0059L7.49998 16.1785L2.32739 11.0059L3.5059 9.82739L7.49998 13.8215L16.4941 4.82739L17.6726 6.0059Z"
    />
  </svg>`,Vv=()=>ss`<svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5.332 13.2203L5.01238 14.1792L5.82087 14.9877L6.77971 14.668L13.6405 7.80725L12.1928 6.35954L5.332 13.2203ZM13.1356 5.41673L14.5833 6.86444L15.7238 5.72395C16.1236 5.32417 16.1236 4.67601 15.7238 4.27623C15.324 3.87646 14.6759 3.87646 14.2761 4.27623L13.1356 5.41673ZM13.3333 3.33342L4.27791 12.3888C4.20472 12.462 4.14958 12.5512 4.11686 12.6494L2.92159 16.2352C2.74787 16.7563 3.2437 17.2522 3.76487 17.0785L7.35065 15.8832C7.44884 15.8505 7.53806 15.7953 7.61124 15.7221L16.6666 6.66676C17.5871 5.74628 17.5871 4.2539 16.6666 3.33342C15.7461 2.41295 14.2538 2.41295 13.3333 3.33342Z"
    />
  </svg>`,Kv=()=>ss`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M14.3544 11.3678L16.5109 9.2113C17.9754 7.74683 17.9754 5.37246 16.5109 3.908L16.085 3.48214C14.6206 2.01767 12.2462 2.01767 10.7817 3.48214L8.06422 6.19966C6.59975 7.66413 6.59975 10.0385 8.06422 11.503L8.49008 11.9288C8.75643 12.1952 9.05289 12.4131 9.3685 12.5826L10.042 11.909C10.1513 11.7997 10.2324 11.6729 10.2852 11.5376C9.97446 11.4201 9.68307 11.2362 9.43289 10.986L9.00703 10.5602C8.06326 9.61639 8.06326 8.08624 9.00703 7.14247L11.7246 4.42495C12.6683 3.48118 14.1985 3.48118 15.1422 4.42495L15.5681 4.85081C16.5119 5.79457 16.5119 7.32472 15.5681 8.26849L14.1479 9.6887C14.3104 10.2349 14.3792 10.803 14.3544 11.3678ZM5.63767 8.62376L3.48116 10.7803C2.0167 12.2447 2.0167 14.6191 3.48116 16.0836L3.90702 16.5094C5.37149 17.9739 7.74586 17.9739 9.21032 16.5094L11.9278 13.7919C13.3923 12.3274 13.3923 9.95307 11.9278 8.48861L11.502 8.06275C11.2356 7.79639 10.9392 7.57848 10.6236 7.40901L9.95003 8.08255C9.84074 8.19184 9.75969 8.31867 9.70686 8.45398C10.0176 8.57152 10.309 8.75538 10.5592 9.00556L10.985 9.43142C11.9288 10.3752 11.9288 11.9053 10.985 12.8491L8.26752 15.5666C7.32375 16.5104 5.7936 16.5104 4.84983 15.5666L4.42397 15.1408C3.4802 14.197 3.4802 12.6668 4.42397 11.7231L5.84418 10.3029C5.68166 9.75667 5.61282 9.18854 5.63767 8.62376ZM12.78 14.3772C12.9325 14.2416 13.1295 14.1666 13.3336 14.1666C13.5547 14.1666 13.7666 14.2544 13.9229 14.4107C14.0792 14.567 14.167 14.7789 14.167 15V16.6666L14.1611 16.7641C14.1361 16.975 14.0314 17.1684 13.8685 17.3047C13.7056 17.4411 13.4968 17.51 13.2848 17.4976C13.0728 17.4852 12.8735 17.3922 12.7277 17.2378C12.5819 17.0833 12.5005 16.879 12.5003 16.6666V15L12.5061 14.9025C12.53 14.6997 12.6275 14.5129 12.78 14.3772ZM15.2625 12.7273C15.417 12.5815 15.6212 12.5002 15.8336 12.5H16.667L16.7645 12.5058C16.9754 12.5309 17.1688 12.6356 17.3051 12.7984C17.4414 12.9613 17.5104 13.1701 17.498 13.3821C17.4855 13.5942 17.3926 13.7934 17.2381 13.9392C17.0837 14.0851 16.8794 14.1664 16.667 14.1666H15.8336L15.7361 14.1608C15.5252 14.1357 15.3319 14.031 15.1955 13.8681C15.0592 13.7053 14.9902 13.4965 15.0027 13.2845C15.0151 13.0724 15.1081 12.8731 15.2625 12.7273ZM2.74439 6.07737C2.90067 5.92109 3.11263 5.83329 3.33365 5.83329H4.16698C4.38799 5.83329 4.59995 5.92109 4.75623 6.07737C4.91252 6.23365 5.00031 6.44561 5.00031 6.66662C5.00031 6.88764 4.91252 7.0996 4.75623 7.25588C4.59995 7.41216 4.38799 7.49996 4.16698 7.49996H3.33365C3.11263 7.49996 2.90067 7.41216 2.74439 7.25588C2.58811 7.0996 2.50031 6.88764 2.50031 6.66662C2.50031 6.44561 2.58811 6.23365 2.74439 6.07737ZM6.11334 2.71055C6.26587 2.57492 6.46287 2.49998 6.66698 2.49996C6.88799 2.49996 7.09995 2.58775 7.25623 2.74403C7.41251 2.90031 7.50031 3.11228 7.50031 3.33329V4.99996L7.49448 5.09746C7.46939 5.30837 7.36472 5.50174 7.20184 5.63807C7.03896 5.77439 6.83018 5.84338 6.61814 5.83093C6.40611 5.81849 6.20683 5.72554 6.06102 5.5711C5.91521 5.41665 5.83388 5.21236 5.83365 4.99996V3.33329L5.83948 3.23579C5.86336 3.03308 5.96081 2.84619 6.11334 2.71055Z"
  />
</svg> `;let ts=class extends zt{constructor(){super(),this.disabled=!1,this.tabIndex=0,this.addEventListener("keypress",n=>{this.disabled||n.key==="Enter"&&this.click()})}render(){return ft`<slot></slot>`}};ts.styles=Kt`
    :host {
      display: flex;
      justify-content: center;
      align-items: center;
      border: none;
      width: 28px;
      height: 28px;
      border-radius: 3px;
      background: transparent;
      cursor: pointer;
      user-select: none;
      fill: var(--affine-icon-color);
    }

    :host(:hover) {
      background: var(--affine-hover-background);
      fill: var(--affine-primary-color);
    }

    :host(:active) {
      background: transparent;
      fill: var(--affine-primary-color);
    }

    :host([disabled]),
    :host(:disabled) {
      background: transparent;
      fill: var(--affine-icon-color);
      cursor: not-allowed;
    }
  `;Zf([xt({type:Boolean})],ts.prototype,"disabled",2);ts=Zf([Xt("icon-button")],ts);let ea=null;const Xf=n=>{const t=document.createElement("template");if(typeof n=="string")n=n.trim(),t.innerHTML=n;else{const{strings:e,values:r}=n,i=[...r,""],o=e.reduce((s,c,a)=>s+c+i[a],"");t.innerHTML=o}return t.content.firstChild},Wv=()=>{const n=Kt`
    position: fixed;
    z-index: 9999;
    top: 16px;
    left: 16px;
    right: 16px;
    bottom: 78px;
    pointer-events: none;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
  `,t=ft`<div style="${n}"></div>`,e=Xf(t);return document.body.appendChild(e),e},Gv=(n,t=2500)=>{ea||(ea=Wv());const e=Kt`
    max-width: 480px;
    text-align: center;
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    padding: 6px 12px;
    margin: 10px 0 0 0;
    color: var(--affine-tooltip-color);
    background: var(--affine-tooltip-background);
    box-shadow: var(--affine-tooltip-shadow);
    border-radius: 10px;
    transition: all 230ms cubic-bezier(0.21, 1.02, 0.73, 1);
    opacity: 0;
  `,r=ft`<div style="${e}"></div>`,i=Xf(r);i.textContent=n,ea.appendChild(i);const o=[{opacity:0},{opacity:1}],s={duration:230,easing:"cubic-bezier(0.21, 1.02, 0.73, 1)",fill:"forwards"};return i.animate(o,s),setTimeout(async()=>{const c=o.reverse();await i.animate(c,s).finished,i.style.maxHeight="0",i.style.margin="0",i.style.padding="0",await zy(230),i.remove()},t),i},Yv=Kt`
  tool-tip {
    position: absolute;
    left: 0;
    top: 0;
    inline-size: max-content;
    text-align: center;
    font-size: var(--affine-font-xs);
    padding: 4px 12px;
    border-radius: 10px 10px 10px 0px;
    color: var(--affine-tooltip-color);
    background: var(--affine-tooltip-background);
    box-shadow: var(--affine-tooltip-shadow);
    border-radius: 10px 10px 10px 0px;

    opacity: 0;
    transform: translateX(0) translateY(calc(-100% - 8px));
    transition: opacity 0.2s ease, transform 0.2s ease;
    pointer-events: none;
    user-select: none;
  }

  .has-tool-tip {
    position: relative;
  }
  .has-tool-tip:is(:hover, :focus-visible, :active) > tool-tip {
    opacity: 1;
    transition-delay: 200ms;
  }
`,Zv=Kt`
  .affine-link-edit-popover {
    box-sizing: border-box;
    width: 382px;
    height: 128px;
    padding: 24px;
    box-shadow: var(--affine-popover-shadow);
    background: var(--affine-popover-background);
    border-radius: 0px 10px 10px 10px;

    display: grid;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(2, 1fr);
    gap: 12px;
    grid-template-areas:
      'text text-input .'
      'link link-input btn';
    justify-items: center;
    align-items: center;
  }

  .affine-edit-text-text {
    grid-area: text;
  }

  .affine-edit-text-input {
    grid-area: text-input;
  }

  .affine-edit-link-text {
    grid-area: link;
  }

  .affine-edit-link-input {
    grid-area: link-input;
  }

  .affine-confirm-button {
    grid-area: btn;
    fill: var(--affine-primary-color);
  }
  .affine-confirm-button[disabled],
  .affine-confirm-button:disabled {
    fill: var(--affine-icon-color);
  }
`,Xv=Kt`
  .overlay-container {
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-base);
    font-style: normal;
    line-height: 24px;
    color: var(--affine-popover-color);
    z-index: var(--affine-z-index-popover);
    animation: affine-popover-fade-in 0.2s ease;
  }

  @keyframes affine-popover-fade-in {
    from {
      opacity: 0;
      transform: translateY(-3px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .overlay-mask {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
  }

  input {
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-base);
    box-sizing: border-box;
    padding: 6px 12px;
    width: 260px;
    height: 34px;
    color: inherit;

    border: 1px solid var(--affine-border-color);
    outline: none;
    border-radius: 10px;
    background: transparent;
  }
  input::placeholder {
    color: var(--affine-placeholder-color);
  }
  input:focus {
    border: 1px solid var(--affine-primary-color);
  }

  .affine-link-popover {
    display: flex;
    align-items: center;
    height: 34px;
    padding: 0 12px;

    background: var(--affine-popover-background);
    box-shadow: var(--affine-popover-shadow);
    border-radius: 0px 10px 10px 10px;
  }

  .affine-link-popover-input {
    border: none;
  }
  .affine-link-popover-input::placeholder {
    color: var(--affine-placeholder-color);
  }
  .affine-link-popover-input:focus {
    border: none;
  }

  .affine-link-preview {
    width: 260px;
    height: 28px;
    display: flex;
    align-items: center;
    user-select: none;
    cursor: pointer;
  }

  .affine-link-popover-dividing-line {
    margin: 0 6px;
    width: 1px;
    height: 20px;
    background-color: var(--affine-border-color);
  }

  ${Zv}
  ${Yv}
`;var Jv=Object.defineProperty,Qv=Object.getOwnPropertyDescriptor,Ke=(n,t,e,r)=>{for(var i=r>1?void 0:r?Qv(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Jv(t,e,i),i};const Jf=["http","https","ftp","sftp","mailto","tel"],tm=/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,em=/^(?:(?:(?:https?|s?ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;function Qf(n){return Jf.some(r=>n.startsWith(r+":"))?n:tm.test(n)?"mailto:"+n:"http://"+n}const nm=n=>{if(!n)return!1;const t=Qf(n);return t===n?!0:em.test(t)};let Re=class extends zt{constructor(){super(...arguments),this.left="0px",this.top="0px",this.type="create",this.showMask=!0,this.text="",this.previewLink="",this.link="",this.bodyOverflowStyle="",this.disableConfirm=!0}connectedCallback(){super.connectedCallback(),this.showMask&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow="hidden")}firstUpdated(n){super.firstUpdated(n),this.linkInput&&this.linkInput.focus()}disconnectedCallback(){super.disconnectedCallback(),this.showMask&&(document.body.style.overflow=this.bodyOverflowStyle)}hide(){this.dispatchEvent(new CustomEvent("updateLink",{detail:{type:"cancel"}}))}onConfirm(){var e,r;if(this.disableConfirm)return;if(!this.linkInput)throw new Error("Failed to update link! Link input not found!");const n=Qf(this.linkInput.value),t=(r=(e=this.textInput)==null?void 0:e.value)!=null?r:void 0;!n||this.dispatchEvent(Lo("updateLink",{type:"confirm",link:n,text:t}))}onCopy(n){navigator.clipboard.writeText(this.previewLink),Gv("Copied link to clipboard")}onUnlink(n){this.dispatchEvent(Lo("updateLink",{type:"remove"}))}onEdit(n){this.dispatchEvent(Lo("editLink",null)),this.disableConfirm=!1}onKeyup(n){if(n.key==="Enter"&&this.onConfirm(),!this.linkInput)throw new Error("Failed to update link! Link input not found!");const t=nm(this.linkInput.value);this.disableConfirm=!t}confirmBtnTemplate(){return ft`<icon-button
      class="affine-confirm-button"
      ?disabled=${this.disableConfirm}
      @click=${this.onConfirm}
      >${zv()}</icon-button
    >`}createLinkTemplate(){return ft`<div class="affine-link-popover">
      <input
        id="link-input"
        class="affine-link-popover-input"
        type="text"
        spellcheck="false"
        placeholder="Paste or type a link"
        value=${this.previewLink}
        @keyup=${this.onKeyup}
      />
      <span class="affine-link-popover-dividing-line"></span>
      ${this.confirmBtnTemplate()}
    </div>`}previewTemplate(){return ft`<div class="affine-link-popover">
      <div class="affine-link-preview has-tool-tip" @click=${this.onCopy}>
        <tool-tip inert role="tooltip">Click to copy link</tool-tip>
        ${this.previewLink}
      </div>
      <span class="affine-link-popover-dividing-line"></span>
      <icon-button class="has-tool-tip" @click=${this.onUnlink}>
        ${Kv()}
        <tool-tip inert role="tooltip">Remove</tool-tip>
      </icon-button>
      <icon-button class="has-tool-tip" @click=${this.onEdit}>
        ${Vv()}
        <tool-tip inert role="tooltip">Edit link</tool-tip>
      </icon-button>
    </div>`}simpleTemplate(){return!this.previewLink?this.createLinkTemplate():this.previewTemplate()}editTemplate(){return ft`<div class="affine-link-edit-popover">
      <label class="affine-edit-text-text" for="text-input">Text</label>
      <input
        class="affine-edit-text-input"
        id="text-input"
        type="text"
        placeholder="Enter text"
        value=${this.text}
        @keyup=${this.onKeyup}
      />
      <label class="affine-edit-link-text" for="link-input">Link</label>
      <input
        id="link-input"
        class="affine-edit-link-input"
        type="text"
        spellcheck="false"
        placeholder="Paste or type a link"
        value=${this.previewLink}
        @keyup=${this.onKeyup}
      />
      ${this.confirmBtnTemplate()}
    </div>`}render(){const n=this.showMask?ft`<div class="overlay-mask" @click="${this.hide}"></div>`:ft``,t=this.type==="create"?this.simpleTemplate():this.editTemplate();return ft`
      <div class="overlay-root">
        ${n}
        <div
          class="overlay-container"
          style="position: absolute; left: ${this.left}; top: ${this.top};${this.style.cssText}"
        >
          ${t}
        </div>
      </div>
    `}};Re.styles=Xv;Ke([xt()],Re.prototype,"left",2);Ke([xt()],Re.prototype,"top",2);Ke([xt()],Re.prototype,"type",2);Ke([xt()],Re.prototype,"showMask",2);Ke([xt()],Re.prototype,"text",2);Ke([xt()],Re.prototype,"previewLink",2);Ke([ke()],Re.prototype,"link",2);Ke([ke()],Re.prototype,"bodyOverflowStyle",2);Ke([ke()],Re.prototype,"disableConfirm",2);Ke([Ki("#text-input")],Re.prototype,"textInput",2);Ke([Ki("#link-input")],Re.prototype,"linkInput",2);Re=Ke([Xt("edit-link-panel")],Re);const rm=(n,t,{showMask:e,previewLink:r})=>{const i=n.getBoundingClientRect(),o=document.body.getBoundingClientRect(),s=i.top-o.top+i.height,c=5,a=document.createElement("edit-link-panel");return a.left=`${i.left}px`,a.top=`${s+c}px`,a.showMask=e,a.previewLink=r,t.appendChild(a),a},im=(n,t,e)=>{let i;const o=c=>{clearTimeout(i)},s=c=>{i=window.setTimeout(()=>{e.abort()},300)};return n.addEventListener("mouseover",o),n.addEventListener("mouseout",s),t.addEventListener("mouseover",o),t.addEventListener("mouseout",s),()=>{n.removeEventListener("mouseover",o),n.removeEventListener("mouseout",s),t.removeEventListener("mouseover",o),t.removeEventListener("mouseout",s)}},th=async({anchorEl:n,container:t=document.body,text:e="",link:r="",showMask:i=!0,interactionKind:o="always",signal:s=new AbortController})=>{if(!n)throw new Error("Can't show tooltip without anchor element!");if(s.signal.aborted)return Promise.resolve({type:"cancel"});const c=rm(n,t,{showMask:i,previewLink:r}),a=o==="hover"?im(n,c,s):Hy;return new Promise(y=>{s.signal.addEventListener("abort",()=>{c.remove(),y({type:"cancel"})}),c.addEventListener("editLink",g=>{s.signal.aborted||(c.type="edit",c.showMask=!0,c.text=e,a())}),c.addEventListener("updateLink",g=>{s.signal.aborted||(c.remove(),y(g.detail))})})},om=Kt`
  width: 0.8em;
  height: 0.8em;
  vertical-align: middle;
  font-size: inherit;
  margin-bottom: 0.1em;
`,sm=ss`<svg
  width="14"
  height="14"
  viewBox="0 0 14 14"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
  style="${om}"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.0478 7.95778L11.5573 6.44822C12.5825 5.4231 12.5825 3.76104 11.5573 2.73591L11.2592 2.43781C10.2341 1.41269 8.57204 1.41269 7.54691 2.43781L5.64465 4.34008C4.61952 5.3652 4.61952 7.02726 5.64465 8.05239L5.94275 8.35049C6.1292 8.53694 6.33672 8.68948 6.55764 8.80811L7.02912 8.33663C7.10562 8.26013 7.16236 8.17135 7.19934 8.07663C6.98182 7.99435 6.77784 7.86565 6.60272 7.69052L6.30461 7.39242C5.64398 6.73179 5.64398 5.66068 6.30461 5.00004L8.20688 3.09778C8.86752 2.43714 9.93862 2.43714 10.5993 3.09778L10.8974 3.39588C11.558 4.05652 11.558 5.12762 10.8974 5.78826L9.90321 6.7824C10.017 7.16474 10.0652 7.56244 10.0478 7.95778Z"
    fill="#6880FF"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.94637 6.03685L2.43681 7.5464C1.41169 8.57153 1.41169 10.2336 2.43681 11.2587L2.73492 11.5568C3.76004 12.5819 5.4221 12.5819 6.44723 11.5568L8.34949 9.65455C9.37462 8.62942 9.37462 6.96736 8.34949 5.94224L8.05139 5.64414C7.86494 5.45769 7.65742 5.30515 7.4365 5.18652L6.96502 5.658C6.88852 5.7345 6.83178 5.82328 6.7948 5.918C7.01233 6.00028 7.2163 6.12898 7.39142 6.3041L7.68953 6.60221C8.35016 7.26284 8.35016 8.33395 7.68953 8.99458L5.78726 10.8968C5.12662 11.5575 4.05552 11.5575 3.39488 10.8969L3.09678 10.5987C2.43614 9.93811 2.43614 8.86701 3.09678 8.20637L4.09093 7.21222C3.97716 6.82989 3.92898 6.43219 3.94637 6.03685Z"
    fill="#6880FF"
  />
</svg>`;var am=Object.defineProperty,lm=Object.getOwnPropertyDescriptor,Cs=(n,t,e,r)=>{for(var i=r>1?void 0:r?lm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&am(t,e,i),i};let Kr=class extends zt{constructor(){super(),this.popoverHoverOpenDelay=150,this.popoverTimer=0,this.addEventListener("mouseover",this.onHover),this.addEventListener("mouseout",this.onHoverEnd)}onHover(n){this.popoverTimer=window.setTimeout(async()=>{this.onDelayHover(n)},this.popoverHoverOpenDelay)}async onDelayHover(n){var r;const t=on.find(this);Bt(t);const e=(r=t.domNode.textContent)!=null?r:void 0;jt.withDisableHotkey(async()=>{const i=await th({anchorEl:n.target,text:e,link:this.href,showMask:!1,interactionKind:"hover"});if(i.type==="confirm"){const o=i.link,s=i.text,c=s!==e;Bt(t),this.updateLink(t,o,c?s:void 0);return}if(i.type==="remove"){Bt(t),this.updateLink(t,!1);return}})}async updateLink(n,t,e){var o,s,c,a;const r=Wy(this),{space:i}=r;if(e){const y=n.offset();i.captureSync(),(o=r.text)==null||o.delete(y,n.length()),(s=r.text)==null||s.insert(e,y),(c=r.text)==null||c.format(y,e.length,{link:t})}else i.captureSync(),(a=r.text)==null||a.format(n.offset(),n.length(),{link:t})}async onHoverEnd(n){clearTimeout(this.popoverTimer)}render(){return ft`<a href=${this.href} rel="noopener noreferrer" target="_blank"
      >${sm}<slot></slot
    ></a>`}};Kr.styles=Kt`
    a {
      color: var(--affine-link-color);
      text-decoration: none;
    }

    /*
    a:visited {
      color: var(--affine-link-visited-color);
    }
    */

    a:hover {
      text-decoration: underline;
    }
  `;Cs([xt()],Kr.prototype,"href",2);Cs([xt()],Kr.prototype,"popoverHoverOpenDelay",2);Cs([ke()],Kr.prototype,"popoverTimer",2);Kr=Cs([Xt("link-node")],Kr);const vl=on.import("formats/link");vl.tagName="link-node";vl.PROTOCOL_WHITELIST=Jf;on.register(vl,!0);const cm=on.import("blots/inline");class Wr extends cm{static create(t){const e=super.create();return e.style.backgroundColor="rgba(35, 131, 226, 0.28)",e}static formats(t){return!0}format(t,e){const r=this.domNode;e||(r.style.backgroundColor="",r.getAttribute("style")||r.removeAttribute("style")),(t!==this.statics.blotName||!e)&&super.format(t,e)}}Wr.blotName="mock-select";Wr.tagName="span";Wr.className="affine-mock-select";on.register({"formats/mock-select":Wr},!0);const um=async(n,t)=>{var f,h;if(!yl()){t.preventDefault();return}const e=Jo(),r=Fe(e);if(!r)return;const{quill:i}=r,o=i.getSelection();Bt(o);const s=i.getFormat(o);if(s!=null&&s.link){n.captureSync();const{index:m,length:k}=o;(f=e.text)==null||f.format(m,k,{link:!1});return}i.format("mock-select",!0);const[c,a]=i.scroll.descendant(Wr,o.index);if(!c)throw console.error("Error on getBlotNode",Wr,i,o),new Error("Failed to getBlotNode, node not found!");const y=c,g=y==null?void 0:y.domNode;if(!g)throw console.error("Error on createLink",y,i,o),new Error("Failed to create link, mockSelectDom not found!");const u=await th({anchorEl:g});if(i.formatText(o,{"mock-select":!1}),u.type!=="confirm")return;const l=u.link;n.captureSync(),(h=e.text)==null||h.format(o.index,o.length,{link:l})};function fm(n,t){var g,u,l,f;const e=window.getSelection(),r=t[0],i=t[t.length-1],o=Fe(r),s=Fe(i);Bt(o),Bt(s),Bt(e);const c=Vr(e.anchorNode,e.anchorOffset,!0),a=Vr(e.focusNode,e.focusOffset,!1);(g=o.model.text)==null||g.delete(c,o.model.text.length-c),((u=s.model.text)==null?void 0:u.length)===a||((l=s.model.text)==null||l.delete(0,a),(f=o.model.text)==null||f.join(s.model.text));for(let h=1;h<=t.length-1;h++)n.deleteBlock(t[h]);o.quill.setSelection(c,0)}function eh(n,t,e){var o;const r=(o=window.getSelection())==null?void 0:o.getRangeAt(0);Bt(r);const i=xs(r);e.captureSync(),i.forEach(s=>{If(s,["affine:paragraph","affine:list"]),s.flavour===n?e.updateBlock(s,{type:t}):nh(e,s,n,t)})}function nh(n,t,e,r){var a;const i=n.getParent(t);Bt(i);const o={flavour:e,type:r,text:(a=t==null?void 0:t.text)==null?void 0:a.clone(),children:t.children},s=i.children.indexOf(t);n.deleteBlock(t);const c=n.addBlock(o,i,s);nr(n,c)}function hm(n,t,e,r){t.captureSync();for(const i of e)If(i,["affine:paragraph","affine:list"]),i.flavour===n?t.updateBlock(i,{type:r}):nh(t,i,"affine:paragraph",r)}function rh(n,t){if(!(t.target instanceof HTMLInputElement)&&!Uf()){if(cv()){const e=Jo(),r=Fe(e);if(r){const{quill:i}=r;Tf(i)}}else if(yl()){const e=Es();if(Ff(e)){t.preventDefault();const r=xs(e);fm(n,r)}}}}function dm(n,t,e){var h,m,k;const r=window.getSelection(),i=n[0],o=n[n.length-1],s=Fe(i),c=Fe(o);Bt(s),Bt(c),Bt(r);const a=Vr(r.anchorNode,r.anchorOffset,!0),y=Vr(r.focusNode,r.focusOffset,!1),g=[],u=s.quill.getFormat(a,s.quill.getLength()-a-1),l=c.quill.getFormat(0,y);g.push(u,l);for(let b=1;b<n.length-1;b++){const v=Fe(n[b]);Bt(v);const d=v.quill.getFormat(0,v.quill.getLength()-1);g.push(d)}const f=g.every(b=>b[e]);t.captureSync(),(h=s.model.text)==null||h.format(a,s.quill.getLength()-a-1,{[e]:!f}),(m=c.model.text)==null||m.format(0,y,{[e]:!f});for(let b=1;b<n.length-1;b++){const v=Fe(n[b]);Bt(v),(k=v.model.text)==null||k.format(0,v.quill.getLength()-1,{[e]:!f})}c.quill.setSelection(y,0),(e==="code"||e==="link")&&c.quill.format(e,!1)}function Rc(n,t,e){var r;if(t.preventDefault(),!(t.target instanceof HTMLInputElement)&&!Uf()&&yl()){const i=xs(Es());if(i.length===1){const o=Fe(i[0]);Bt(o);const{quill:s}=o,c=s.getSelection();Bt(c),n.captureSync();const{index:a,length:y}=c,g=s.getFormat(c);(r=i[0].text)==null||r.format(a,y,{[e]:!g[e]}),s.setSelection(a+y,0),(e==="code"||e==="link")&&s.format(e,!1)}else dm(i,n,e)}}function pm(){const n=document.querySelectorAll(".ql-editor"),t=n[0],e=n[n.length-1],r=document.createRange();Bt(t),Bt(e),Bt(r);const i=ih(e),o=oh(t);r.setStart(o,0),r.setEnd(i,i.length),ze(r)}function ih(n){return n.lastChild?ih(n.lastChild):n}function oh(n){return n.firstChild?oh(n.firstChild):n}function gm(n,t){n.captureSync(),Bt(t[0].text),t[0].text.delete(0,t[0].text.length);for(let e=1;e<t.length;e++)n.deleteBlock(t[e])}function xa(n,t){requestAnimationFrame(()=>{if(!n.root)return;n.root.children.forEach(r=>{const i=oi(r);if(!i)return;const o=i.getBoundingClientRect();if(!o)return;const[s,c,a,y]=JSON.parse(r.xywh),g=o.width/t,u=o.height/t;(!kc(g,a)||!kc(u,y))&&n.updateBlock(r,{xywh:JSON.stringify([s,c,g,u])})})})}const{UNDO:sh,REDO:ah,INLINE_CODE:lh,STRIKE:ch,LINK:uh}=Ft;function fh(n){jt.addListener(lh,t=>Rc(n,t,"code")),jt.addListener(ch,t=>Rc(n,t,"strike")),jt.addListener(uh,t=>{t.preventDefault(),jt.withDisableHotkey(async()=>{await um(n,t)})}),jt.addListener(sh,()=>n.undo()),jt.addListener(ah,()=>n.redo())}function hh(){jt.removeListener([sh,ah,lh,ch,uh])}const ym=`.affine-default-viewport{overflow-x:hidden;overflow-y:auto;height:100%}.affine-default-page-block-container{font-family:var(--affine-font-family);font-size:var(--affine-font-base);line-height:var(--affine-line-height-base);color:var(--affine-text-color);font-weight:400;width:720px;margin:0 auto;cursor:default;min-height:calc(100% - 78px);height:auto;overflow:hidden;padding-bottom:150px}.affine-default-page-block-container>.affine-block-children-container{padding-left:0}.affine-default-page-block-title{width:100%;font-size:40px;line-height:50px;font-weight:700;outline:none;border:0;font-family:inherit;color:inherit}.affine-default-page-block-title::placeholder{color:var(--affine-placeholder-color)}.affine-default-page-block-title-container{margin-top:78px}
`;var vm=Object.defineProperty,mm=Object.getOwnPropertyDescriptor,Or=(n,t,e,r)=>{for(var i=r>1?void 0:r?mm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&vm(t,e,i),i};function bm(n){const t=n.value;n.focus(),n.value="",n.value=t}function _m(n){if(n===null)return ft``;const t={left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"};return ft`
    <style>
      .affine-page-frame-selection-rect {
        position: absolute;
        background: var(--affine-selected-color);
        z-index: 1;
        pointer-events: none;
      }
    </style>
    <div
      class="affine-page-frame-selection-rect"
      style=${Ce(t)}
    ></div>
  `}function wm(n){return ft`
    <style>
      .affine-page-selected-rects-container > div {
        position: fixed;
        background: var(--affine-selected-color);
        z-index: 1;
        pointer-events: none;
        border-radius: 5px;
      }
    </style>
    <div class="affine-page-selected-rects-container">
      ${n.map(t=>{const e={display:"block",left:t.left+"px",top:t.top+"px",width:t.width+"px",height:t.height+"px"};return ft`<div style=${Ce(e)}></div>`})}
    </div>
  `}let zn=class extends zt{constructor(){super(...arguments),this.flavour="affine:page",this.lastSelectionPosition="start",this.frameSelectionRect=null,this.selectedRects=[],this.signals={updateFrameSelectionRect:new le,updateSelectedRects:new le},this.isCompositionStart=!1,this._handleCompositionStart=()=>{this.isCompositionStart=!0},this._handleCompositionEnd=()=>{this.isCompositionStart=!1}}_bindHotkeys(){const{space:n}=this,{BACKSPACE:t,SELECT_ALL:e,H1:r,H2:i,H3:o,H4:s,H5:c,H6:a,SHIFT_UP:y,SHIFT_DOWN:g,NUMBERED_LIST:u,BULLETED:l,TEXT:f}=Ft;fh(n),jt.addListener(t,h=>{const{state:m}=this.selection;if(gl(h)){const k=h.target;if(k.selectionStart!==k.selectionEnd){h.preventDefault();const b=xv(k);n.updateBlock(this.model,{title:b})}return}if(m.type==="native")rh(n,h);else if(m.type==="block"){const{selectedRichTexts:k}=m;gm(n,k.map(b=>b.model)),m.clear(),this.signals.updateSelectedRects.emit([])}}),jt.addListener(e,h=>{h.preventDefault(),pm(),this.selection.state.type="native"}),jt.addListener(r,()=>this._updateType("affine:paragraph","h1",n)),jt.addListener(i,()=>this._updateType("affine:paragraph","h2",n)),jt.addListener(o,()=>this._updateType("affine:paragraph","h3",n)),jt.addListener(s,()=>this._updateType("affine:paragraph","h4",n)),jt.addListener(c,()=>this._updateType("affine:paragraph","h5",n)),jt.addListener(a,()=>this._updateType("affine:paragraph","h6",n)),jt.addListener(u,()=>this._updateType("affine:list","numbered",n)),jt.addListener(l,()=>this._updateType("affine:list","bulleted",n)),jt.addListener(f,()=>this._updateType("affine:paragraph","text",n)),jt.addListener(y,h=>{}),jt.addListener(g,h=>{})}_removeHotkeys(){hh(),jt.removeListener([Ft.UNDO,Ft.REDO,Ft.BACKSPACE,Ft.SELECT_ALL,Ft.INLINE_CODE,Ft.STRIKE,Ft.H1,Ft.H2,Ft.H3,Ft.H4,Ft.H5,Ft.H6,Ft.SHIFT_UP,Ft.SHIFT_DOWN,Ft.LINK,Ft.BULLETED,Ft.NUMBERED_LIST,Ft.TEXT])}_onTitleKeyDown(n){const t=!this.space.isEmpty;if(n.key==="Enter"&&t){Bt(this._title.selectionStart);const e=this._title.selectionStart,r=this._title.value.slice(0,e),i=this._title.value.slice(e),o=this.model.children[0],s={flavour:"affine:paragraph",text:new jn(this.space,i)},c=this.space.addBlock(s,o,0);this.space.updateBlock(this.model,{title:r}),nr(this.space,c)}else n.key==="ArrowDown"&&t&&(n.preventDefault(),nr(this.space,this.model.children[0].children[0].id))}_onTitleInput(n){const{space:t}=this;if(!this.model.id){const r=n.target.value,i=t.addBlock({flavour:"affine:page",title:r}),o=t.addBlock({flavour:"affine:group"},i);t.addBlock({flavour:"affine:paragraph"},o);return}const e=n.target.value;t.updateBlock(this.model,{title:e})}_updateType(n,t,e){const{state:r}=this.selection;r.selectedRichTexts.length>0?hm(n,e,r.selectedRichTexts.map(i=>i.model),t):eh(n,t,e)}_clearSelection(){this.selection.state.clear(),this.signals.updateSelectedRects.emit([])}createRenderRoot(){return this}update(n){n.has("mouseRoot")&&n.has("space")&&(this.selection=new Uv(this.space,this.mouseRoot,this.signals)),super.update(n)}firstUpdated(){this._bindHotkeys(),jt.enableHotkey(),this.model.propsUpdated.on(()=>{this.model.title!==this._title.value&&(this._title.value=this.model.title||"",this.requestUpdate())}),this.signals.updateFrameSelectionRect.on(e=>{this.frameSelectionRect=e,this.requestUpdate()}),this.signals.updateSelectedRects.on(e=>{this.selectedRects=e,this.requestUpdate()}),xa(this.space,1),this.addEventListener("keydown",e=>{e.ctrlKey||e.metaKey||e.shiftKey||xa(this.space,1)});const n=this.mouseRoot.querySelector(".affine-default-viewport"),t=le.fromEvent(n,"scroll");this._scrollDisposable=t.on(()=>this._clearSelection()),window.addEventListener("compositionstart",this._handleCompositionStart),window.addEventListener("compositionend",this._handleCompositionEnd),bm(this._title)}disconnectedCallback(){super.disconnectedCallback(),this._removeHotkeys(),this._scrollDisposable.dispose(),this.selection.dispose(),window.removeEventListener("compositionstart",this._handleCompositionStart),window.removeEventListener("compositionend",this._handleCompositionEnd)}render(){this.setAttribute(we,this.model.id);const n=Ji(this.model,this),t=_m(this.frameSelectionRect),e=wm(this.selectedRects);return ft`
      <div class="affine-default-viewport">
        <div class="affine-default-page-block-container">
          <div class="affine-default-page-block-title-container">
            <input
              placeholder="Title"
              class="affine-default-page-block-title"
              value=${this.model.title}
              @keydown=${this._onTitleKeyDown}
              @input=${this._onTitleInput}
            />
          </div>
          ${n}
        </div>
        ${t} ${e}
      </div>
    `}};zn.styles=Kt`
    ${Ve(ym)}
  `;Or([xt()],zn.prototype,"space",2);Or([xt()],zn.prototype,"mouseRoot",2);Or([ke()],zn.prototype,"frameSelectionRect",2);Or([ke()],zn.prototype,"selectedRects",2);Or([xt({hasChanged(){return!0}})],zn.prototype,"model",2);Or([Ki(".affine-default-page-block-title")],zn.prototype,"_title",2);zn=Or([Xt("default-page-block")],zn);const Bi=48,$i=48;function km(n,t,e){const r=JSON.parse(n.xywh),[i,o,s,c]=r,a=s+Bi,y=c+$i;return i<t&&t<=i+a&&o<e&&e<=o+y}function na(n,t,e){for(let r=n.length-1;r>=0;r--)if(km(n[r],t,e))return n[r];return null}function ko(n,t){const[e,r,i,o]=JSON.parse(t),[s,c]=n.toViewCoord(e,r);return new DOMRect(s,c,i*n.zoom,o*n.zoom)}function xm(n){const t=r=>{r.preventDefault();const{viewport:i}=n;if(r.ctrlKey){const o=r.deltaX!==0?-r.deltaX:-r.deltaY;i.applyDeltaZoom(o),n.signals.viewportUpdated.emit()}else{const o=r.deltaX/i.zoom,s=r.deltaY/i.zoom;i.applyDeltaCenter(o,s),n.signals.viewportUpdated.emit()}};return n.addEventListener("wheel",t),()=>n.removeEventListener("wheel",t)}function dh(n,t){return{position:"absolute",left:n.x+"px",top:n.y+"px",width:n.width+Bi*t+"px",height:n.height+$i*t+"px",borderRadius:`${10*t}px`,pointerEvents:"none",boxSizing:"border-box"}}function Em(n,t){if(!n)return ft`<div></div>`;const e={...dh(n,t),border:"1px solid var(--affine-primary-color)"};return ft`
    <div class="affine-edgeless-hover-rect" style=${Ce(e)}></div>
  `}function Lc(n,t){const e={position:"absolute",left:n-6+"px",top:t-6+"px",width:"12px",height:"12px",borderRadius:"6px",zIndex:"10",border:"2px var(--affine-primary-color) solid",background:"white",cursor:"not-allowed"};return ft` <div style=${Ce(e)}></div> `}function Sm(n,t){const e=n.blockSelectionState,{type:r}=e;if(r==="none")return ft``;const{rect:i}=e,o={border:`${e.active?2:1}px solid var(--affine-primary-color)`,...dh(i,t)};let s=null;if(!e.active){const c=[i.x,i.y+i.height/2+$i*t/2],a=[i.x+i.width+Bi*t,i.y+i.height/2+$i*t/2],y=Lc(c[0],c[1]),g=Lc(a[0],a[1]);s=ft` ${y}${g} `}return ft`
    ${s}
    <div class="affine-edgeless-selected-rect" style=${Ce(o)}></div>
  `}function Cm(n){if(n===null)return ft``;const t={left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"};return ft`
    <style>
      .affine-edgeless-frame-selection-rect {
        position: absolute;
        background: var(--affine-selected-color);
        z-index: 1;
        pointer-events: none;
      }
    </style>
    <div
      class="affine-edgeless-frame-selection-rect"
      style=${Ce(t)}
    ></div>
  `}function Am(n,t,e){const{xywh:r}=n,{zoom:i,viewportX:o,viewportY:s}=e,[c,a,y,g]=JSON.parse(r),u=(c-o)*i,l=(a-s)*i,f={position:"absolute",transform:`translate(${u}px, ${l}px) scale(${i})`,transformOrigin:"0 0",width:y+Bi+"px",height:g+$i+"px",padding:`${Bi/2}px`,background:"white"};return ft`
    <div class="affine-edgeless-block-child" style=${Ce(f)}>
      ${Bf(n,t)}
    </div>
  `}function Om(n,t,e){const{zoom:r,viewportX:i,viewportY:o}=e,s=-i*r,c=-o*r,a={backgroundImage:"linear-gradient(#cccccc66 1px, transparent 1px),linear-gradient(90deg, #cccccc66 1px, transparent 1px)"},y={},u=location.href.includes("grid")?a:y;return ft`
    <style>
      .affine-block-children-container.edgeless {
        padding-left: 0;
        position: relative;
        overflow: hidden;
        height: 100%;

        /* background-image: linear-gradient(#cccccc66 1px, transparent 1px),
          linear-gradient(90deg, #cccccc66 1px, transparent 1px); */
        background-size: ${20*e.zoom}px ${20*e.zoom}px;
        background-position: ${s}px ${c}px;
        background-color: #fff;
      }
    </style>
    <div
      class="affine-block-children-container edgeless"
      style=${Ce(u)}
    >
      ${qn(n.children,l=>l.id,l=>Am(l,t,e))}
    </div>
  `}const Tm=.3;class Rm{constructor(){this._width=0,this._height=0,this._zoom=1,this._centerX=0,this._centerY=0}get zoom(){return this._zoom}get centerX(){return this._centerX}get centerY(){return this._centerY}get viewportX(){return this._centerX-this._width/2/this._zoom}get viewportY(){return this._centerY-this._height/2/this._zoom}get width(){return this._width}get height(){return this._height}toModelCoord(t,e){return[this.viewportX+t/this._zoom,this.viewportY+e/this._zoom]}toViewCoord(t,e){return[(t-this.viewportX)*this._zoom,(e-this.viewportY)*this._zoom]}setSize(t,e){this._width=t,this._height=e}setZoom(t){this._zoom=t}applyDeltaZoom(t){const e=this.zoom*(100+t)/100,r=Math.max(e,Tm);this.setZoom(r)}applyDeltaCenter(t,e){this._centerX+=t,this._centerY+=e}setCenter(t,e){this._centerX=t,this._centerY=e}}class Lm{constructor(t){this._blockSelectionState={type:"none"},this._startRange=null,this._hoverState=null,this._frameSelectionState=null,this._onContainerDragStart=e=>{const{viewport:r}=this._container,[i,o]=r.toModelCoord(e.x,e.y),s=na(this._blocks,i,o);s?this._handleClickOnSelected(s,e):(this._blockSelectionState={type:"none"},this._frameSelectionState={start:new DOMPoint(e.raw.x,e.raw.y),end:new DOMPoint(e.raw.x,e.raw.y)},this._container.signals.updateSelection.emit(this.blockSelectionState),ze(null)),this._startRange=nn(e.raw.clientX,e.raw.clientY)},this._onContainerDragMove=e=>{switch(this.blockSelectionState.type){case"none":break;case"single":if(this.blockSelectionState.active)Vf(this._startRange,e);else if(!this._frameSelectionState){const r=this.blockSelectionState.selected,[i,o,s,c]=JSON.parse(r.xywh),{zoom:a}=this._container.viewport;this._space.updateBlock(r,{xywh:JSON.stringify([i+e.delta.x/a,o+e.delta.y/a,s,c])}),this._container.signals.updateSelection.emit(this.blockSelectionState)}break}this._frameSelectionState&&this._updateFrameSelectionState(e.raw.x,e.raw.y)},this._onContainerDragEnd=e=>{this._frameSelectionState=null},this._onContainerClick=e=>{const{viewport:r}=this._container,[i,o]=r.toModelCoord(e.x,e.y),s=na(this._blocks,i,o);s?this._handleClickOnSelected(s,e):(this._blockSelectionState={type:"none"},this._container.signals.updateSelection.emit(this.blockSelectionState),ze(null))},this._onContainerDblClick=e=>{},this._onContainerMouseMove=e=>{const{viewport:r}=this._container,[i,o]=r.toModelCoord(e.x,e.y),s=na(this._blocks,i,o);this._updateHoverState(s),this._container.signals.hoverUpdated.emit()},this._onContainerMouseOut=e=>{},this._onContainerContextMenu=e=>{Yf(e)},this._container=t,this._mouseDisposeCallback=$f(this._container,this._onContainerDragStart,this._onContainerDragMove,this._onContainerDragEnd,this._onContainerClick,this._onContainerDblClick,this._onContainerMouseMove,this._onContainerMouseOut,this._onContainerContextMenu),this._wheelDisposeCallback=xm(t)}get blockSelectionState(){return this._blockSelectionState}get hoverRect(){return this._hoverState?this._hoverState.rect:null}get frameSelectionRect(){if(!this._frameSelectionState)return null;const{start:t,end:e}=this._frameSelectionState,r=Math.min(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.x,e.x),s=Math.max(t.y,e.y);return new DOMRect(r,i,o-r,s-i)}get _space(){return this._container.space}get _blocks(){var t,e;return(e=(t=this._space.root)==null?void 0:t.children)!=null?e:[]}get isActive(){return this._blockSelectionState.type==="single"&&this._blockSelectionState.active}_updateFrameSelectionState(t,e){this._frameSelectionState&&(this._frameSelectionState.end=new DOMPoint(t,e)),this._hoverState&&(this._blockSelectionState={type:"single",selected:this._hoverState.block,rect:this._hoverState.rect,active:!1})}_updateHoverState(t){t?this._hoverState={rect:ko(this._container.viewport,t.xywh),block:t}:this._hoverState=null}_handleClickOnSelected(t,e){const{viewport:r}=this._container;switch(this.blockSelectionState.type){case"none":this._blockSelectionState={type:"single",active:!1,selected:t,rect:ko(r,t.xywh)},this._container.signals.updateSelection.emit(this.blockSelectionState);break;case"single":this.blockSelectionState.selected===t?(this.blockSelectionState.active=!0,this._container.signals.updateSelection.emit(this.blockSelectionState)):(this._blockSelectionState={type:"single",active:!1,selected:t,rect:ko(r,t.xywh)},this._container.signals.updateSelection.emit(this.blockSelectionState)),Kf(this._space,e);break}}syncBlockSelectionRect(){var t;if(this.blockSelectionState.type==="single"){const e=ko(this._container.viewport,this.blockSelectionState.selected.xywh);this.blockSelectionState.rect=e}this._updateHoverState(((t=this._hoverState)==null?void 0:t.block)||null),this._container.signals.updateSelection.emit(this.blockSelectionState)}dispose(){this._mouseDisposeCallback(),this._wheelDisposeCallback()}}const Nm=`.affine-edgeless-page-block-container{position:relative;box-sizing:border-box;overflow:hidden;height:100%;font-family:var(--affine-font-family);font-size:var(--affine-font-base);line-height:var(--affine-line-height-base);color:var(--affine-edgeless-text-color);font-weight:400}
`;var Pm=Object.defineProperty,Dm=Object.getOwnPropertyDescriptor,to=(n,t,e,r)=>{for(var i=r>1?void 0:r?Dm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Pm(t,e,i),i};let mr=class extends zt{constructor(){super(...arguments),this.flavour="edgeless",this.viewport=new Rm,this.signals={viewportUpdated:new le,updateSelection:new le,hoverUpdated:new le}}_bindHotkeys(){const{space:n}=this;jt.addListener(Ft.BACKSPACE,this._handleBackspace.bind(this)),jt.addListener(Ft.H1,()=>this._updateType("affine:paragraph","h1",n)),jt.addListener(Ft.H2,()=>this._updateType("affine:paragraph","h2",n)),jt.addListener(Ft.H3,()=>this._updateType("affine:paragraph","h3",n)),jt.addListener(Ft.H4,()=>this._updateType("affine:paragraph","h4",n)),jt.addListener(Ft.H5,()=>this._updateType("affine:paragraph","h5",n)),jt.addListener(Ft.H6,()=>this._updateType("affine:paragraph","h6",n)),jt.addListener(Ft.NUMBERED_LIST,()=>this._updateType("affine:list","numbered",n)),jt.addListener(Ft.BULLETED,()=>this._updateType("affine:list","bulleted",n)),jt.addListener(Ft.TEXT,()=>this._updateType("affine:paragraph","text",n)),fh(n)}_updateType(n,t,e){eh(n,t,e)}_removeHotkeys(){jt.removeListener([Ft.BACKSPACE],this.flavour),hh()}_handleBackspace(n){this._selection.blockSelectionState.type==="single"&&rh(this.space,n)}_initViewport(){const n=this.mouseRoot.getBoundingClientRect();this.viewport.setSize(n.width,n.height);const t=this.model.children[0],[e,r,i,o]=JSON.parse(t.xywh);this.viewport.setCenter(e+i/2,r+o/2)}_clearSelection(){requestAnimationFrame(()=>{this._selection.isActive||ze(null)})}createRenderRoot(){return this}update(n){n.has("mouseRoot")&&n.has("space")&&(this._selection=new Lm(this)),super.update(n)}firstUpdated(){this.model.children.forEach(n=>{n.propsUpdated.on(()=>this._selection.syncBlockSelectionRect())}),this.signals.viewportUpdated.on(()=>this._selection.syncBlockSelectionRect()),this.signals.hoverUpdated.on(()=>this.requestUpdate()),this.signals.updateSelection.on(()=>this.requestUpdate()),this._historyDisposable=this.space.signals.historyUpdated.on(()=>{this._clearSelection()}),this._bindHotkeys(),this.addEventListener("keydown",n=>{n.ctrlKey||n.metaKey||n.shiftKey||xa(this.space,this.viewport.zoom)}),requestAnimationFrame(()=>{this._initViewport(),this.requestUpdate()}),this._clearSelection()}disconnectedCallback(){super.disconnectedCallback(),this.signals.updateSelection.dispose(),this.signals.viewportUpdated.dispose(),this.signals.hoverUpdated.dispose(),this._historyDisposable.dispose(),this._selection.dispose(),this._removeHotkeys()}render(){this.setAttribute(we,this.model.id);const n=Om(this.model,this,this.viewport),{_selection:t}=this,{frameSelectionRect:e}=t,{zoom:r}=this.viewport,i=Sm(t,r),o=Cm(e),s=Em(t.hoverRect,r);return ft`
      <style></style>
      <div class="affine-edgeless-page-block-container">
        ${n} ${s} ${o} ${i}
      </div>
    `}};mr.styles=Kt`
    ${Ve(Nm)}
  `;to([xt()],mr.prototype,"space",2);to([xt()],mr.prototype,"mouseRoot",2);to([xt({hasChanged(){return!0}})],mr.prototype,"model",2);to([ke()],mr.prototype,"viewport",2);mr=to([Xt("edgeless-page-block")],mr);class Im extends Sr{constructor(t,e){var r;super(t,e),this.flavour="affine:page",this.title="",this.title=(r=e.title)!=null?r:""}block2html(t,e,r,i,o){return`<div>${this.title}${t}</div>`}block2Text(t,e,r){return`${(this.title||"").slice(e||0,r)}${t}`}}var Mm=Object.defineProperty,Bm=Object.getOwnPropertyDescriptor,ph=(n,t,e,r)=>{for(var i=r>1?void 0:r?Bm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Mm(t,e,i),i};let Ea=class extends zt{constructor(){super(),this.count=0}async _notify(){this.count++,await this.updateComplete;const n={detail:this.count,bubbles:!0,composed:!0};this.dispatchEvent(new CustomEvent("block-count-update",n))}render(){return ft` <div @click=${this._notify}>${this.count}</div> `}};ph([xt()],Ea.prototype,"count",2);Ea=ph([Xt("counter-block")],Ea);const $m=`.affine-paragraph-block-container{border-radius:5px}.affine-paragraph-block-container.selected{background-color:var(--affine-selected-color)}.h1{font-size:calc(var(--affine-font-base) + 12px);line-height:calc(var(--affine-line-height-base) + 14px);margin-top:calc(var(--affine-paragraph-space) + 20px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h1 code{font-size:calc(var(--affine-font-base) + 8px)}.h2{font-size:calc(var(--affine-font-base) + 10px);line-height:calc(var(--affine-line-height-base) + 12px);margin-top:calc(var(--affine-paragraph-space) + 18px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h2 code{font-size:calc(var(--affine-font-base) + 6px)}.h3{font-size:calc(var(--affine-font-base) + 8px);line-height:calc(var(--affine-line-height-base) + 10px);margin-top:calc(var(--affine-paragraph-space) + 16px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h3 code{font-size:calc(var(--affine-font-base) + 4px)}.h4{font-size:calc(var(--affine-font-base) + 6px);line-height:calc(var(--affine-line-height-base) + 8px);margin-top:calc(var(--affine-paragraph-space) + 14px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h4 code{font-size:calc(var(--affine-font-base) + 2px)}.h5{font-size:calc(var(--affine-font-base) + 4px);line-height:calc(var(--affine-line-height-base) + 4px);margin-top:calc(var(--affine-paragraph-space) + 12px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h5 code{font-size:calc(var(--affine-font-base))}.h6{font-size:calc(var(--affine-font-base) + 2px);line-height:calc(var(--affine-line-height-base) + 2px);margin-top:calc(var(--affine-paragraph-space) + 10px);font-weight:600;--affine-link-color: var(--affine-link-color2)}.h6 code{font-size:calc(var(--affine-font-base) - 2px)}.quote{font-size:18px;line-height:26px;padding-left:12px;margin-top:18px;position:relative}.quote:after{content:"";width:4px;height:100%;position:absolute;left:0;top:0;background:var(--affine-quote-color);border-radius:4px}.text{margin-top:var(--affine-paragraph-space);font-size:var(--affine-font-base)}strong{font-weight:600}code{background:var(--affine-code-background);color:var(--affine-code-color);font-family:var(--affine-font-family2);padding:0 5px;border-radius:5px;font-size:calc(var(--affine-font-base) - 4px)}u{text-decoration:none;border-bottom:1px solid var(--affine-text-color)}del{text-decoration:line-through}em{font-style:italic}
`;var jm=Object.defineProperty,qm=Object.getOwnPropertyDescriptor,ml=(n,t,e,r)=>{for(var i=r>1?void 0:r?qm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&jm(t,e,i),i};const Um=n=>{const{type:t}=n;switch(t){case"h1":return"Heading 1";case"h2":return"Heading 2";case"h3":return"Heading 3";case"h4":return"Heading 4";case"h5":return"Heading 5";case"h6":return"Heading 6";default:return""}};let ji=class extends zt{createRenderRoot(){return this}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(we,this.model.id);const{type:n}=this.model,t=Ji(this.model,this.host),e=Um(this.model);return ft`
      <div class="affine-paragraph-block-container ${n}">
        <rich-text
          .host=${this.host}
          .model=${this.model}
          .placeholder=${e}
        ></rich-text>
        ${t}
      </div>
    `}};ji.styles=Kt`
    ${Ve($m)}
  `;ml([xt({hasChanged(){return!0}})],ji.prototype,"model",2);ml([xt()],ji.prototype,"host",2);ji=ml([Xt("paragraph-block")],ji);class Fm extends Sr{constructor(t,e){var r;super(t,e),this.flavour="affine:paragraph",this.type="text",this.type=(r=e.type)!=null?r:"text"}block2html(t,e,r,i,o){const s=super.block2html(t,e,r,i,o);switch(this.type){case"text":return`<p>${s}</p>`;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return`<${this.type}>${s}</${this.type}>`;case"quote":return`<blockquote>${s}</blockquote>`;default:return s}}}const Hm=()=>ft`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <circle cx="12" cy="12" r="2" />
    </svg>
  `,zm=()=>ft`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M12 13.5C12.8284 13.5 13.5 12.8284 13.5 12C13.5 11.1716 12.8284 10.5 12 10.5C11.1716 10.5 10.5 11.1716 10.5 12C10.5 12.8284 11.1716 13.5 12 13.5ZM12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14Z"
      />
    </svg>
  `,Vm=()=>ft`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path
        d="M11.6056 10.1634C11.8234 9.94555 12.1766 9.94555 12.3944 10.1634L13.8366 11.6056C14.0545 11.8234 14.0545 12.1766 13.8366 12.3944L12.3944 13.8366C12.1766 14.0545 11.8234 14.0545 11.6056 13.8366L10.1634 12.3944C9.94555 12.1766 9.94555 11.8234 10.1634 11.6056L11.6056 10.1634Z"
      />
    </svg>
  `,Km=()=>ft`
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M13.4422 12L12 10.5578L10.5578 12L12 13.4422L13.4422 12ZM12.3944 10.1634C12.1766 9.94555 11.8234 9.94555 11.6056 10.1634L10.1634 11.6056C9.94555 11.8234 9.94555 12.1766 10.1634 12.3944L11.6056 13.8366C11.8234 14.0545 12.1766 14.0545 12.3944 13.8366L13.8366 12.3944C14.0545 12.1766 14.0545 11.8234 13.8366 11.6056L12.3944 10.1634Z"
        fill="#7389FD"
      />
    </svg>
  `,Wm=()=>ft`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7 4C5.34315 4 4 5.34315 4 7V17C4 18.6569 5.34315 20 7 20H17C18.6569 20 20 18.6569 20 17V7C20 5.34315 18.6569 4 17 4H7ZM17.5665 9.56473C17.8785 9.25181 17.8776 8.74528 17.5647 8.43336C17.2518 8.12144 16.7453 8.12225 16.4334 8.43517L10.3547 14.5333L7.56666 11.7352C7.2548 11.4222 6.74827 11.4213 6.43529 11.7331C6.1223 12.045 6.12139 12.5515 6.43325 12.8645L9.64626 16.0891C10.037 16.4813 10.672 16.4814 11.0629 16.0893L17.5665 9.56473Z"
        fill="#A6ABB7"
      />
    </svg>
  `,Gm=()=>ft`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M17 5.6H7C6.2268 5.6 5.6 6.2268 5.6 7V17C5.6 17.7732 6.2268 18.4 7 18.4H17C17.7732 18.4 18.4 17.7732 18.4 17V7C18.4 6.2268 17.7732 5.6 17 5.6ZM7 4C5.34315 4 4 5.34315 4 7V17C4 18.6569 5.34315 20 7 20H17C18.6569 20 20 18.6569 20 17V7C20 5.34315 18.6569 4 17 4H7Z"
        fill="#A6ABB7"
      />
    </svg>
  `,Nc=[Hm(),zm(),Vm(),Km()],Ym=n=>{const t="a".charCodeAt(0),r="z".charCodeAt(0)-t+1;let i="";for(;n>=0;)i=String.fromCharCode(n%r+t)+i,n=Math.floor(n/r)-1;return i},Zm=n=>{const t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let e="";for(const r in t)for(;n>=t[r];)e+=r,n-=t[r];return e},Xm=(n,t)=>{const e=[()=>t+1,Ym,()=>Zm(t+1)];return e[n%e.length](t)},Jm=({index:n,deep:t})=>`${Xm(t,n)} .`;function Qm({model:n,index:t,deep:e,onClick:r}){return ft`<div
    class="affine-list-block__prefix ${n.type==="todo"?"affine-list-block__todo-prefix":""}"
    @click="${i=>{r==null||r(i)}}"
  >
    ${(()=>{switch(n.type){case"bulleted":return Nc[e%Nc.length];case"numbered":return Jm({deep:e,index:t});case"todo":return n.checked?Wm():Gm();default:return""}})()}
  </div>`}const t0=(n,t)=>{var o;const e=((o=n.space.getParent(t))==null?void 0:o.children)||[],r=e.findIndex(s=>s===t);let i=0;for(let s=0;s<r;s++)e[s].flavour===t.flavour&&e[s].type===t.type?i+=1:i=0;return i},e0=(n,t)=>{let e=0,r=n.space.getParent(t);for(;(r==null?void 0:r.flavour)===t.flavour;)e++,r=n.space.getParent(r);return e},n0=(n,t)=>{const e=e0(n,t),r=t0(n,t);return{deep:e,index:r}},r0=`.affine-list-block-container{box-sizing:border-box;border-radius:5px;margin-top:2px}.affine-list-block-container--first{margin-top:var(--affine-paragraph-space)}.affine-list-block-container .affine-list-block-container{margin-top:0}.affine-list-block-container.selected{background-color:var(--affine-selected-color)}.affine-list-rich-text-wrapper{display:flex}.affine-list-rich-text-wrapper rich-text{flex:1}.affine-list-block__prefix{flex-shrink:0;min-width:26px;height:26px;margin-top:3px;margin-right:4px;display:flex;align-items:center;justify-content:flex-start;color:var(--affine-code-color);font-size:14px;line-height:var(--affine-line-height-base);user-select:none}.affine-list-block__todo-prefix{cursor:pointer}.affine-list-block__todo{width:16px;height:16px;border-radius:4px;border:1px solid var(--affine-icon-color)}.affine-list-block__todo.affine-list-block__todo--active{background:var(--affine-icon-color)}.affine-list--checked{color:var(--affine-icon-color)}
`;var i0=Object.defineProperty,o0=Object.getOwnPropertyDescriptor,bl=(n,t,e,r)=>{for(var i=r>1?void 0:r?o0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&i0(t,e,i),i};function s0(n){const t=ks(n).selection,e=oi(n);if(!e)throw console.error("list block model:",n,"blockElement:",e),new Error("Failed to select list! blockElement not found!");const r=e.getBoundingClientRect();t.selectBlockByRect(r)}let qi=class extends zt{createRenderRoot(){return this}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(we,this.model.id);const{deep:n,index:t}=n0(this.host,this.model),e=Qm({model:this.model,deep:n,index:t,onClick:()=>{if(this.model.type!=="todo"){s0(this.model);return}this.host.space.captureSync(),this.host.space.updateBlock(this.model,{checked:!this.model.checked})}}),r=Ji(this.model,this.host);return ft`
      <div
        class=${`affine-list-block-container ${t===0&&n===0?"affine-list-block-container--first":""}`}
      >
        <div
          class=${`affine-list-rich-text-wrapper ${this.model.checked?"affine-list--checked":""}`}
        >
          ${e}
          <rich-text .host=${this.host} .model=${this.model}></rich-text>
        </div>
        ${r}
      </div>
    `}};qi.styles=Kt`
    ${Ve(r0)}
  `;bl([xt({hasChanged(){return!0}})],qi.prototype,"model",2);bl([xt()],qi.prototype,"host",2);qi=bl([Xt("list-block")],qi);class gh extends Sr{constructor(t,e){var r,i;super(t,e),this.flavour="affine:list",this.type=(r=e.type)!=null?r:"bulleted",this.checked=(i=e.checked)!=null?i:!1}block2html(t,e,r,i,o){let s=super.block2html(t,e,r,i,o);const c=this.space.getBlockById(e),a=this.space.getBlockById(r);switch(this.type){case"bulleted":s=`<li>${s}</li>`;break;case"numbered":s=`<li>${s}</li>`;break;case"todo":s=`<li><input disabled type="checkbox" ${this.checked?"checked":""}>${s}</li>`;break}if((c==null?void 0:c.flavour)!==this.flavour||c.type!==this.type)switch(this.type){case"bulleted":case"todo":s=`<ul>${s}`;break;case"numbered":s=`<ol>${s}`;break}if((a==null?void 0:a.flavour)!==this.flavour||a.type!==this.type)switch(this.type){case"bulleted":case"todo":s=`${s}</ul>`;break;case"numbered":s=`${s}</ol>`;break}return s}}class a0 extends Sr{constructor(t,e){var r;super(t,e),this.flavour="affine:group",this.xywh=(r=e.xywh)!=null?r:"[0,0,720,480]"}}const l0=`.affine-group-block-container>.affine-block-children-container{padding-left:0}.affine-group-block-container.selected{background-color:var(--affine-selected-color)}
`;var c0=Object.defineProperty,u0=Object.getOwnPropertyDescriptor,_l=(n,t,e,r)=>{for(var i=r>1?void 0:r?u0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&c0(t,e,i),i};let Ui=class extends zt{createRenderRoot(){return this}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(we,this.model.id);const n=Ji(this.model,this.host);return ft`
      <div class="affine-group-block-container">${n}</div>
    `}};Ui.styles=Kt`
    ${Ve(l0)}
  `;_l([xt({hasChanged(){return!0}})],Ui.prototype,"model",2);_l([xt()],Ui.prototype,"host",2);Ui=_l([Xt("group-block")],Ui);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rr=La(class extends Na{constructor(n){var t;if(super(n),n.type!==Ra.ATTRIBUTE||n.name!=="class"||((t=n.strings)===null||t===void 0?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(n){return" "+Object.keys(n).filter(t=>n[t]).join(" ")+" "}update(n,[t]){var e,r;if(this.nt===void 0){this.nt=new Set,n.strings!==void 0&&(this.st=new Set(n.strings.join(" ").split(/\s/).filter(o=>o!=="")));for(const o in t)t[o]&&!(!((e=this.st)===null||e===void 0)&&e.has(o))&&this.nt.add(o);return this.render(t)}const i=n.element.classList;this.nt.forEach(o=>{o in t||(i.remove(o),this.nt.delete(o))});for(const o in t){const s=!!t[o];s===this.nt.has(o)||((r=this.st)===null||r===void 0?void 0:r.has(o))||(s?(i.add(o),this.nt.add(o)):(i.remove(o),this.nt.delete(o)))}return Un}});var f0=Object.defineProperty,h0=Object.getOwnPropertyDescriptor,yh=(n,t,e,r)=>{for(var i=r>1?void 0:r?h0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&f0(t,e,i),i};let Gr=class extends zt{static valueToRender(n){return n}static valueToCompare(n){return n}render(){return ft`<div
      class=${rr({"affine-text-field":!0})}
      style=${Ce({})}
    >
      <affine-input
        value=${Gr.valueToRender(this.field)}
      ></affine-input>
    </div>`}};Gr.styles=Kt``;yh([xt()],Gr.prototype,"field",2);Gr=yh([Xt("affine-text-field")],Gr);const d0=Gr;var p0=Object.defineProperty,g0=Object.getOwnPropertyDescriptor,vh=(n,t,e,r)=>{for(var i=r>1?void 0:r?g0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&p0(t,e,i),i};let Yr=class extends zt{static valueToRender(n){return isNaN(n)?"":n+""}static valueToCompare(n){return n}render(){return ft`<div
      class=${rr({"affine-number-field":!0})}
      style=${Ce({})}
    >
      <affine-input
        value=${Yr.valueToRender(this.field)}
        type="number"
      ></affine-input>
    </div>`}};Yr.styles=Kt``;vh([xt()],Yr.prototype,"field",2);Yr=vh([Xt("affine-number-field")],Yr);const y0=Yr;var v0=Object.defineProperty,m0=Object.getOwnPropertyDescriptor,mh=(n,t,e,r)=>{for(var i=r>1?void 0:r?m0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&v0(t,e,i),i};let Fi=class extends zt{static valueToRender(n){return""}static valueToCompare(n){return n}render(){return ft`<div
      class=${rr({"affine-checkbox-field":!0})}
      style=${Ce({})}
    >
      <input
        type="checkbox"
        ?checked=${this.field}
        @change=${this.handleChange}
      />
    </div>`}handleChange(n){this.dispatchEvent(new CustomEvent("change",{detail:{value:n.target.checked},bubbles:!0,composed:!0}))}};Fi.styles=Kt`
    .affine-checkbox-field {
      padding: 0 8px;
    }
  `;mh([xt()],Fi.prototype,"field",2);Fi=mh([Xt("affine-checkbox-field")],Fi);const b0=Fi;var _0=Object.defineProperty,w0=Object.getOwnPropertyDescriptor,bh=(n,t,e,r)=>{for(var i=r>1?void 0:r?w0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&_0(t,e,i),i};let Hi=class extends zt{getDefaultField(){return{multi:!1,options:["yes","no"],selected:[0]}}static valueToRender(n){return n&&n.options[n.selected[0]]||""}static valueToCompare(n){return n?n.selected[0]:""}render(){const n=this.field||this.getDefaultField();return ft`<div
      class=${rr({"affine-select-field":!0})}
      style=${Ce({})}
    >
      <select
        ?multiple=${n.multi}
        @change=${t=>this.handleChange(t)}
      >
        ${qn(n.options,(t,e)=>ft`
              <option
                ?selected=${n.selected.includes(e)}
                value=${t}
                data-index=${e}
              >
                ${t}
              </option>
            `)}
      </select>
    </div>`}handleChange(n){const t=this.field||this.getDefaultField(),e=[n.target.selectedIndex];this.dispatchEvent(new CustomEvent("change",{detail:{value:{...t,selected:e}},bubbles:!0,composed:!0}))}};Hi.styles=Kt`
    .affine-select-field {
      padding: 0 8px;
    }
  `;bh([xt()],Hi.prototype,"field",2);Hi=bh([Xt("affine-select-field")],Hi);const k0=Hi;var x0=Object.defineProperty,E0=Object.getOwnPropertyDescriptor,_h=(n,t,e,r)=>{for(var i=r>1?void 0:r?E0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&x0(t,e,i),i};let Zr=class extends zt{static valueToRender(n){return n?new Date(n).toLocaleDateString():""}static valueToCompare(n){return n}render(){return ft`<div
      class=${rr({"affine-date-field":!0})}
      style=${Ce({})}
    >
      <affine-input
        value=${Zr.valueToRender(this.field)}
      ></affine-input>
    </div>`}};Zr.styles=Kt``;_h([xt()],Zr.prototype,"field",2);Zr=_h([Xt("affine-date-field")],Zr);const S0=Zr;var Dr=(n=>(n[n.Text=0]="Text",n[n.Number=1]="Number",n[n.Checkbox=2]="Checkbox",n[n.Select=3]="Select",n[n.Date=4]="Date",n[n.Url=5]="Url",n[n.Image=6]="Image",n))(Dr||{});class eo{static create(t){return{}}static getField(t){switch(t){case 0:return d0;case 1:return y0;case 2:return b0;case 3:return k0;case 4:return S0;default:return}}static renderField(t,e,r){switch(t){case 0:return ft`<affine-text-field
          .field=${e}
          @change=${r}
        ></affine-text-field>`;case 1:return ft`<affine-number-field
          .field=${e}
          @change=${r}
        ></affine-number-field>`;case 2:return ft`<affine-checkbox-field
          .field=${e}
          @change=${r}
        ></affine-checkbox-field>`;case 3:return ft`<affine-select-field
          .field=${e}
          @change=${r}
        ></affine-select-field>`;case 4:return ft`<affine-date-field
          .field=${e}
          @change=${r}
        ></affine-date-field>`;default:return e+""}}static compareField(t,e,r){const i=eo.getField(t);if(!i)return 0;const o=i==null?void 0:i.valueToCompare(e),s=i==null?void 0:i.valueToCompare(r);switch(typeof o){case"number":return o-s;default:return(o+"").localeCompare(s+"")}}}const wl=`.affine-table{width:100%;overflow-x:scroll;overflow-y:auto}.affine-table-cell{border-right:1px solid #eee;border-bottom:1px solid #eee;display:inline-block;height:100%}.affine-table-row{display:flex;border-bottom:1px solid #eee}.affine-table-footer{display:flex;height:40px}
`;var C0=Object.defineProperty,A0=Object.getOwnPropertyDescriptor,As=(n,t,e,r)=>{for(var i=r>1?void 0:r?A0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&C0(t,e,i),i};let Xr=class extends zt{firstUpdated(){}willUpdate(n){}render(){return ft`<input
      class="affine-input"
      value=${this.value}
      type=${this.type}
      placeholder=${this.placeholder}
      @change=${this.handleChange}
    />`}handleChange(n){n.target.value!=this.value&&this.dispatchEvent(new CustomEvent("change",{detail:{value:n.target.value},bubbles:!0,composed:!0}))}};Xr.styles=Kt`
    .affine-input {
      display: inline-block;
      border-radius: 5px;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      font-family: inherit;
      font-size: inherit;
      padding: 0 5px;
      border: none;
    }
    .affine-input:focus {
      outline: none;
      border-color: #6af;
    }
    .affine-input::placeholder {
      color: #ccc;
    }
    .affine-input:disabled {
      background-color: #f5f5f5;
      border-color: #eee;
    }
  `;As([xt()],Xr.prototype,"value",2);As([xt()],Xr.prototype,"type",2);As([xt()],Xr.prototype,"placeholder",2);Xr=As([Xt("affine-input")],Xr);var O0=Object.defineProperty,T0=Object.getOwnPropertyDescriptor,si=(n,t,e,r)=>{for(var i=r>1?void 0:r?T0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&O0(t,e,i),i};let je=class extends zt{connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","table"),super.connectedCallback()}render(){return ft`<div class="affine-table">
      ${this.renderTableHead()}${this.renderTableBody()}${this.renderTableFooter()}
      <slot></slot>
    </div>`}willUpdate(n){console.log(this.model,n)}getRowHeight(n){var t;return((t=this.currentView.row[n])==null?void 0:t.height)||je.defaultRowHeight}getColWidth(n){var t;return((t=this.currentView.col[n])==null?void 0:t.width)||je.defaultColWidth}renderTableHead(){return ft`<affine-table-row .height=${je.defaultRowHeight}
      >${qn(this.schemas,n=>ft`<affine-table-cell .width=${this.getColWidth(n.id)}
            ><affine-input
              value=${n.name}
              @change=${t=>this.handleSchemaChange(t,n.id)}
            ></affine-input>
          </affine-table-cell>`)}
      <button @click=${()=>this.model.addSchema()}>+</button>
    </affine-table-row>`}renderTableBody(){return ft`
      ${qn(this.items,n=>n.id,n=>ft`<affine-table-row
            .model=${n}
            .schemas=${this.schemas}
            .height=${this.getRowHeight(n.id)}
            >${qn(this.schemas,t=>t.id,t=>ft`<affine-table-cell .width=${this.getColWidth(t.id)}>
                  <!-- <rich-text .host=${this.host} .model=${n}></rich-text> -->

                  ${eo.renderField(t.type,n.fields[t.id],e=>{this.handleFieldChange(e,n,t.id)})}
                </affine-table-cell>`)}</affine-table-row
          >`)}
    `}renderTableFooter(){return ft`<div class="affine-table-footer">
      <button @click=${()=>this.model.addItem({})}>+</button>
    </div>`}handleSchemaChange(n,t){this.model.updateSchema(t,{name:n.detail.value})}handleFieldChange(n,t,e){t.updateField(e,n.detail.value)}};je.styles=Kt`
    ${Ve(wl)}
  `;je.defaultRowHeight=36;je.defaultColWidth=150;si([xt()],je.prototype,"model",2);si([xt()],je.prototype,"host",2);si([xt()],je.prototype,"schemas",2);si([xt()],je.prototype,"items",2);si([xt()],je.prototype,"currentView",2);je=si([Xt("affine-table")],je);var R0=Object.defineProperty,L0=Object.getOwnPropertyDescriptor,wh=(n,t,e,r)=>{for(var i=r>1?void 0:r?L0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&R0(t,e,i),i};let es=class extends zt{render(){return ft`<div
      class=${rr({"affine-table-cell":!0})}
      style=${Ce({width:this.width+"px"})}
    >
      <slot></slot>
    </div>`}};es.styles=Kt`
    ${Ve(wl)}
  `;wh([xt()],es.prototype,"width",2);es=wh([Xt("affine-table-cell")],es);var N0=Object.defineProperty,P0=Object.getOwnPropertyDescriptor,no=(n,t,e,r)=>{for(var i=r>1?void 0:r?P0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&N0(t,e,i),i};let br=class extends zt{render(){return ft`<div
      class=${rr({"affine-table-row":!0})}
      style=${Ce({height:this.height+"px",lineHeight:this.height+"px"})}
    >
      <slot></slot>
    </div> `}};br.styles=Kt`
    ${Ve(wl)}
  `;no([xt()],br.prototype,"model",2);no([xt()],br.prototype,"schemas",2);no([xt()],br.prototype,"height",2);no([xt()],br.prototype,"selected",2);br=no([Xt("affine-table-row")],br);var D0=Object.defineProperty,I0=Object.getOwnPropertyDescriptor,ro=(n,t,e,r)=>{for(var i=r>1?void 0:r?I0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&D0(t,e,i),i};let _r=class extends zt{render(){return ft`<div class="affine-gallery-card">
      <slot></slot>
    </div>`}willUpdate(n){console.log(this.model,n)}};_r.styles=Kt`
    .affine-gallery-card {
      box-shadow: rgb(15 15 15 / 10%) 0px 0px 0px 1px,
        rgb(15 15 15 / 10%) 0px 2px 4px;
      border-radius: 3px;
      padding: 8px 10px;
    }
  `;ro([xt()],_r.prototype,"model",2);ro([xt()],_r.prototype,"view",2);ro([xt()],_r.prototype,"schema",2);ro([xt()],_r.prototype,"item",2);_r=ro([Xt("affine-gallery-card")],_r);var M0=Object.defineProperty,B0=Object.getOwnPropertyDescriptor,ai=(n,t,e,r)=>{for(var i=r>1?void 0:r?B0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&M0(t,e,i),i};let An=class extends zt{render(){return ft`<div class="affine-gallery">
      ${qn(this.items,n=>n.id,n=>ft`<affine-gallery-card .item=${n}>
          ${qn(this.schemas,t=>t.id,t=>ft` ${eo.renderField(t.type,n.fields[t.id],e=>{this.handleFieldChange(e,n,t.id)})}`)}
        </affine-gallery-card>`)}
      <slot></slot>
    </div>`}willUpdate(n){console.log(this.model,n)}handleSchemaChange(n,t){this.model.updateSchema(t,{name:n.detail.value})}handleFieldChange(n,t,e){t.updateField(e,n.detail.value)}};An.styles=Kt`
    .affine-gallery {
      display: grid;
      position: relative;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
      padding: 16px 2px;
    }
  `;An.defaultHeight=36;An.defaultWidth=150;ai([xt()],An.prototype,"model",2);ai([xt()],An.prototype,"host",2);ai([xt()],An.prototype,"schemas",2);ai([xt()],An.prototype,"items",2);ai([xt()],An.prototype,"currentView",2);An=ai([Xt("affine-gallery")],An);var jr=(n=>(n[n.Table=0]="Table",n[n.Board=1]="Board",n[n.Timeline=2]="Timeline",n[n.Calender=3]="Calender",n[n.List=4]="List",n[n.Gallery=5]="Gallery",n))(jr||{});function $0(n,t,e){return n.filter(()=>!0)}var ki=(n=>(n[n.ASC=0]="ASC",n[n.DESC=1]="DESC",n[n.NONE=2]="NONE",n))(ki||{});function j0(n,t,e){return e.length?[...n].sort((r,i)=>{let o=0;return e.some(s=>{var a;if(s.direction==2)return;const c=(a=t.find(y=>y.id==s.id))==null?void 0:a.type;if(c!=null&&(o=eo.compareField(c,r.fields[s.id],i.fields[s.id]),o!=0))return o=s.direction===0?o:-o,!0}),o}):n}class ns extends Sr{constructor(t,e){var r;if(super(t,e),this.flavour="affine:database",this.name="",this.views=[],this.children=[],this.schemas=[],this.currentViewId="",!e.views)return ns.createDefaultDatabaseBlock(t,e);this.views=e.views||[],this.schemas=e.schemas||[],this.children=e.children||[],this.name=e.name||"",this.setActiveView(e.currentViewId||((r=this.views[0])==null?void 0:r.id))}static createDefaultDatabaseBlock(t,e){const r=new ns(t,{...e,name:"TEST_DATABASE",views:[],children:[],schemas:[{id:"0",name:"Text",type:Dr.Text},{id:"1",name:"Number",type:Dr.Number},{id:"2",name:"Checkbox",type:Dr.Checkbox},{id:"3",name:"Select",type:Dr.Select}],currentViewId:"0"});return r.addView(),r.addView(void 0,{type:jr.Gallery}),r}getItems(){const t=this.currentView;let e=$0(this.children,this.schemas,t.filters);return e=j0(e,this.schemas,t.sorts),console.log(e),e}getItemById(t){const e=this.childMap.get(t);if(!(e==null||e<0||e>this.children.length))return this.children[e]}addItem(t,e=this.children.length){this.space.addBlock({flavour:"affine:database-item",...t},this,e)}updateItem(t,e){this.space.updateBlockById(t,e)}deleteItem(t){this.space.deleteBlockById(t)}syncViews(){this.propsUpdated.emit()}addView(t=this.views.length,e){const r={id:`${this.views.length}`,name:`View${this.views.length}`,sorts:[],filters:[],type:jr.Table,row:{},col:{},...e};this.views.splice(t,0,r),this.views=[...this.views],this.syncViews(),this.setActiveView(r.id)}updateView(t,e){const r=this.views.findIndex(i=>i.id==t);this.views[r]={...this.views[r],...e},this.syncViews()}deleteView(t){this.views=this.views.filter(e=>e.id!==t),this.syncViews()}setActiveView(t){this.space.updateBlock(this,{currentViewId:t}),this.currentView=this.views.find(e=>e.id==this.currentViewId)||this.views[0]}syncSchemas(){this.propsUpdated.emit()}addSchema(t=this.schemas.length,e){const r={id:`${this.schemas.length}`,name:`Text${this.schemas.length}`,type:Dr.Text,...e};this.schemas.splice(t,1,r),this.schemas=[...this.schemas],this.syncSchemas(),this.children.forEach(i=>i.addField(r.id))}updateSchema(t,e){const r=this.schemas.findIndex(i=>i.id==t);this.schemas[r]={...this.schemas[r],...e},this.syncSchemas(),this.children.forEach(i=>i.updateField(t))}deleteSchema(t){this.schemas=this.schemas.filter(e=>e.id!==t),this.syncSchemas(),this.children.forEach(e=>e.deleteField(t))}getSchemaById(t){return this.schemas.find(e=>e.id==t)}get currentSorts(){var t;return((t=this.currentView)==null?void 0:t.sorts)||[]}get currentFilters(){var t;return((t=this.currentView)==null?void 0:t.filters)||[]}addSort(t=this.currentSorts.length,e={}){const r={id:this.schemas[0].id,direction:ki.ASC,...e};this.currentView.sorts.splice(t,1,r),this.currentView.sorts=[...this.currentSorts],this.syncViews()}updateSort(t,e){const r=this.currentSorts.findIndex(i=>i.id==t);this.currentSorts[r]={...this.currentSorts[r],...e},this.syncViews()}deleteSort(t){this.currentView.sorts=this.currentSorts.filter(e=>e.id!==t),this.syncViews()}}class q0 extends Sr{constructor(t,e){super(t,e),this.flavour="affine:database-item",this.fields=e.fields||{}}syncFields(){this.propsUpdated.emit()}addField(t,e){this.fields[t]=e,this.syncFields()}updateField(t,e){this.fields[t]=e,this.syncFields()}deleteField(t){delete this.fields[t],this.syncFields()}}const U0="",F0=`.affine-database-toolbar{height:40px;line-height:40px;border-bottom:1px solid #eee;display:flex}.view-list{flex:1}.view-name{padding:0 8px;color:#aaa;cursor:pointer;border-radius:4px}.view-name:hover{background:#eee}.view-name.active{padding:0 8px;color:inherit}
`;var H0=Object.defineProperty,z0=Object.getOwnPropertyDescriptor,Os=(n,t,e,r)=>{for(var i=r>1?void 0:r?z0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&H0(t,e,i),i};let Jr=class extends zt{render(){return ft`<div class="affine-database-toolbar">
      <div class="view-list">
        ${qn(this.views,n=>ft`<span
              class=${rr({"view-name":!0,active:this.currentView.id==n.id})}
              @click=${()=>{this.model.setActiveView(n.id)}}
              >${n.name}</span
            >`)}
        <button
          @click=${()=>{this.model.addView()}}
        >
          +
        </button>
      </div>
      <div>
        <button
          @click=${()=>{const n=this.model.currentSorts[0];n?this.model.updateSort(n.id,{direction:n.direction==ki.ASC?ki.DESC:ki.ASC}):this.model.addSort()}}
        >
          排序
        </button>
        <button>筛选</button>
        <button>分组</button>
      </div>

      <slot></slot>
    </div>`}};Jr.styles=Kt`
    ${Ve(F0)}
  `;Os([xt()],Jr.prototype,"model",2);Os([xt()],Jr.prototype,"views",2);Os([xt()],Jr.prototype,"currentView",2);Jr=Os([Xt("affine-database-toolbar")],Jr);var V0=Object.defineProperty,K0=Object.getOwnPropertyDescriptor,kl=(n,t,e,r)=>{for(var i=r>1?void 0:r?K0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&V0(t,e,i),i};let zi=class extends zt{createRenderRoot(){return this}willUpdate(n){}firstUpdated(){this.model.propsUpdated.on(()=>this.requestUpdate()),this.model.childrenUpdated.on(()=>this.requestUpdate())}render(){this.setAttribute(we,this.model.id);const n=Ji(this.model,this.host);return ft`
      <div
        class="affine-database-block-container"
        @mousedown=${t=>t.stopPropagation()}
        @mouseup=${t=>t.stopPropagation()}
      >
        <affine-database-toolbar
          .model=${this.model}
          .views=${this.model.views}
          .currentView=${this.model.currentView}
        ></affine-database-toolbar>
        ${this.renderView()}${n}
      </div>
    `}renderView(){var n;switch((n=this.model.currentView)==null?void 0:n.type){case jr.Table:return ft`<affine-table
          .model=${this.model}
          .host=${this.host}
          .items=${this.model.getItems()}
          .currentView=${this.model.currentView}
          .schemas=${this.model.schemas}
        ></affine-table>`;case jr.Gallery:return ft`<affine-gallery
          .model=${this.model}
          .host=${this.host}
          .items=${this.model.getItems()}
          .currentView=${this.model.currentView}
          .schemas=${this.model.schemas}
        ></affine-gallery>`;case jr.Board:return ft`<affine-board
          .model=${this.model}
          .host=${this.host}
          .items=${this.model.getItems()}
          .currentView=${this.model.currentView}
          .schemas=${this.model.schemas}
        ></affine-board>`;default:return null}}};zi.styles=Kt`
    ${Ve(U0)}
  `;kl([xt({hasChanged(){return!0}})],zi.prototype,"model",2);kl([xt()],zi.prototype,"host",2);zi=kl([Xt("database-block")],zi);const kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},xh="__ $BLOCKSUITE_BLOCKS$ __";kh[xh]===!0&&console.error("@blocksuite/blocks was already imported. This breaks constructor checks and will lead to issues!");kh[xh]=!0;/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const W0=(n,t,e)=>{for(const r of t)if(r[0]===n)return(0,r[1])();return e==null?void 0:e()},Sa={"affine:paragraph":Fm,"affine:page":Im,"affine:list":gh,"affine:group":a0,"affine:database":ns,"affine:database-item":q0};var G0=Object.defineProperty,Y0=Object.getOwnPropertyDescriptor,Rn=(n,t,e,r)=>{for(var i=r>1?void 0:r?Y0(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&G0(t,e,i),i};let rn=class extends zt{constructor(){super(...arguments),this.mode="page",this.clipboard=new z1(this,this),this.contentParser=new H1(this),this.isEmptyPage=!0,this.unsubscribe=[]}update(n){n.has("space")&&(this.placeholderModel=new Sa["affine:page"](this.space,{})),super.update(n)}_subscribeStore(){const n=this.space.signals.updated.on(()=>{this.isEmptyPage=this.space.isEmpty});this.unsubscribe.push(n.dispose);const t=this.space.signals.rootAdded.on(e=>{this.model=e,this.model.childrenUpdated.on(()=>this.requestUpdate()),this.requestUpdate()});this.unsubscribe.push(t.dispose)}createRenderRoot(){return this}connectedCallback(){var n;if(super.connectedCallback(),!this.space)throw new Error("EditorContainer's store is not set!");this.placeholderModel=new Sa["affine:page"](this.space,{}),window.addEventListener("affine.switch-mode",({detail:t})=>{this.mode=t}),this._subscribeStore(),(n=this._placeholderInput)==null||n.focus()}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribe.forEach(n=>n())}render(){const n=ft`
      <default-page-block
        .mouseRoot=${this}
        .space=${this.space}
        .model=${this.placeholderModel}
      ></default-page-block>
    `,t=ft`
      <default-page-block
        .mouseRoot=${this}
        .space=${this.space}
        .model=${this.model}
      ></default-page-block>
    `,e=ft`
      <edgeless-page-block
        .mouseRoot=${this}
        .space=${this.space}
        .model=${this.model}
      ></edgeless-page-block>
    `,r=ft`
      ${W0(this.mode,[["page",()=>t],["edgeless",()=>e]])}
    `;return ft`
      <style>
        .affine-editor-container {
          height: 100%;
          position: relative;
          overflow-y: auto;
          overflow-x: hidden;
        }
      </style>
      <div class="affine-editor-container">
        ${this.isEmptyPage?n:r}
        <debug-menu
          .space=${this.space}
          .contentParser=${this.contentParser}
        ></debug-menu>
      </div>
    `}};Rn([xt()],rn.prototype,"space",2);Rn([ke()],rn.prototype,"mode",2);Rn([ke()],rn.prototype,"model",2);Rn([ke()],rn.prototype,"clipboard",2);Rn([ke()],rn.prototype,"contentParser",2);Rn([ke()],rn.prototype,"isEmptyPage",2);Rn([Ki(".affine-block-placeholder-input")],rn.prototype,"_placeholderInput",2);Rn([ke()],rn.prototype,"placeholderModel",2);Rn([ke()],rn.prototype,"unsubscribe",2);rn=Rn([Xt("editor-container")],rn);var bn=(n=>(n.BLOCKS_CLIP_WRAPPED="blocksuite/x-c+w",n.HTML="text/html",n.TEXT="text/plain",n.IMAGE_BMP="image/bmp",n.IMAGE_GIF="image/gif",n.IMAGE_JPEG="image/jpeg",n.IMAGE_JPG="image/jpg",n.IMAGE_PNG="image/png",n.IMAGE_SVG="image/svg",n.IMAGE_WEBP="image/webp",n))(bn||{}),Me=(n=>(n.copy="copy",n.cut="cut",n.paste="paste",n))(Me||{});class Z0{constructor(t){this.signals={[Me.copy]:new le,[Me.cut]:new le,[Me.paste]:new le},this._copyHandler=this._copyHandler.bind(this),this._cutHandler=this._cutHandler.bind(this),this._pasteHandler=this._pasteHandler.bind(this),this.initialClipboardTargetEvent(t)}initialClipboardTargetEvent(t){!t||(this.disposeClipboardTargetEvent(t),t.addEventListener(Me.copy,this._copyHandler),t.addEventListener(Me.cut,this._cutHandler),t.addEventListener(Me.paste,this._pasteHandler),document.addEventListener(Me.copy,this._copyHandler),document.addEventListener(Me.cut,this._cutHandler),document.addEventListener(Me.paste,this._pasteHandler))}disposeClipboardTargetEvent(t){!t||(t.removeEventListener(Me.copy,this._copyHandler),t.removeEventListener(Me.cut,this._cutHandler),t.removeEventListener(Me.paste,this._pasteHandler))}_copyHandler(t){this.signals.copy.emit(t)}_cutHandler(t){this.signals.cut.emit(t)}_pasteHandler(t){this.signals.paste.emit(t)}dispose(t){this.signals.copy.dispose(),this.signals.cut.dispose(),this.signals.paste.dispose(),this.disposeClipboardTargetEvent(t)}}class ra{constructor(t,e){this.mimeType=t,this.data=e}hasData(){return this.data!==null&&this.data!==void 0}}class X0{constructor(t){this._editor=t,this.handleCopy=this.handleCopy.bind(this),this.handleCut=this.handleCut.bind(this)}handleCopy(t){t.preventDefault(),t.stopPropagation();const e=this._getClipItems();!e.length||this._copyToClipboard(t,e)}handleCut(t){this.handleCopy(t)}_getClipItems(){const t=[],r=zf(this._editor.space).selectedBlocks,i=this._getCustomClip(r);i&&t.push(i);const o=this._getTextClip(r);o&&t.push(o);const s=this._getHtmlClip(r);return s&&t.push(s),t}_getCustomClip(t){const e=t.map(r=>this._getClipInfoBySelectionInfo(r));return new ra(bn.BLOCKS_CLIP_WRAPPED,JSON.stringify({data:e}))}_getHtmlClip(t){const e=this._editor.contentParser.block2Html(t);return new ra(bn.HTML,e)}_getTextClip(t){const e=this._editor.contentParser.block2Text(t);return new ra(bn.TEXT,e)}_getClipInfoBySelectionInfo(t){var c;const e=this._editor.space.getBlockById(t.id);if(!e)return null;let{flavour:r,type:i}=e,o=[];e.flavour==="affine:page"?(r="affine:paragraph",i="text",o=[{insert:e.block2Text("",t==null?void 0:t.startPos,t==null?void 0:t.endPos)}]):o=(c=e==null?void 0:e.text)==null?void 0:c.sliceToDelta((t==null?void 0:t.startPos)||0,t==null?void 0:t.endPos);const s=[];return t.children.forEach(a=>{const y=this._getClipInfoBySelectionInfo(a);y&&s.push(y)}),{flavour:r,type:i,text:o,checked:e instanceof gh?e.checked:void 0,children:s}}_copyToClipboard(t,e){const r=t.clipboardData;if(r)try{e.forEach(i=>{r.setData(i.mimeType,i.data)})}catch{}else this._copyToClipboardFromPc(e)}_copyToClipboardFromPc(t){let e=!1;const r=document.createElement("textarea");r.value="temp",document.body.appendChild(r),r.select(),r.setSelectionRange(0,r.value.length);const i=function(o){const s=o.clipboardData;s&&t.forEach(c=>{s.setData(c.mimeType,c.data)}),o.preventDefault(),o.stopPropagation(),r.removeEventListener("copy",i)};r.addEventListener("copy",i);try{e=document.execCommand("copy")}finally{r.removeEventListener("copy",i),document.body.removeChild(r)}return e}}const Do=class{static checkIfTextContainsMd(n){n=n.replace(/¨/g,"\xA8T"),n=n.replace(/\$/g,"\xA8D"),n=n.replace(/\r\n/g,`
`),n=n.replace(/\r/g,`
`),n=n.replace(/\u00A0/g,"&nbsp;"),n=`

${n}

`,n=Do._detab(n);for(let t=0;t<Do._checkRegArr.length;t++){const e=t===3?`${n}\xA80`:n;if(Do._checkRegArr[t].test(e))return!0}return!1}static _detab(n){return n=n.replace(/\t(?=\t)/g," "),n=n.replace(/\t/g,"\xA8A\xA8B"),n=n.replace(/¨B(.+?)¨A/g,(t,e)=>{let r=e;const i=4-r.length%4;for(let o=0;o<i;o++)r+=" ";return r}),n=n.replace(/¨A/g," "),n=n.replace(/¨B/g,""),n}};let Eh=Do;Eh._checkRegArr=[/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm,/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,/!\[([^\[\]]+)]()()()()()/g,/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,/\[([^\[\]]+)]()()()()()/g];const mi=class{constructor(n){this._editor=n,this.handlePaste=this.handlePaste.bind(this)}async handlePaste(n){n.preventDefault(),n.stopPropagation();const t=await this._clipboardEvent2Blocks(n);this.insertBlocks(t)}async _clipboardEvent2Blocks(n){const t=n.clipboardData;return t?mi._isPureFileInClipboard(t)?this._file2Blocks(t):this._clipboardData2Blocks(t):void 0}getOptimalClip(n){for(let t=0;t<mi._optimalMimeTypes.length;t++){const e=mi._optimalMimeTypes[t],r=n==null?void 0:n.getData(e);if(r)return{type:e,data:r}}return null}async _clipboardData2Blocks(n){const t=this.getOptimalClip(n);if((t==null?void 0:t.type)===bn.BLOCKS_CLIP_WRAPPED)return JSON.parse(t.data).data;const e=n.getData(bn.TEXT),r=Eh.checkIfTextContainsMd(e);return(t==null?void 0:t.type)===bn.HTML&&!r?this._editor.contentParser.htmlText2Block(t.data):r?this._editor.contentParser.markdown2Block(e):this._editor.contentParser.text2blocks(e)}async _file2Blocks(n){return mi._getImageFile(n)?[]:[]}static _isPureFileInClipboard(n){const t=n.types;return t.length===1&&t[0]==="Files"||t.length===2&&(t.includes("text/plain")||t.includes("text/html"))&&t.includes("Files")}static _getImageFile(n){const t=n.files;if(t&&t[0]&&t[0].type.indexOf("image")>-1)return t[0]}insertBlocks(n,t){var r,i,o,s,c,a,y,g,u,l;if(n.length===0)return;const e=t||zf(this._editor.space);if(e.type==="Range"||e.type==="Caret"){const f=e.selectedBlocks[e.selectedBlocks.length-1],h=this._editor.space.getBlockById(f.id);let m=h,k=0;if(h)if(h.flavour==="affine:page")if(((r=h.children[0])==null?void 0:r.flavour)==="affine:group")m=h.children[0];else{const v=this._editor.space.addBlock({flavour:"affine:group"},h.id);m=this._editor.space.getBlockById(v)}else h.flavour!=="affine:group"&&(m=this._editor.space.getParent(h),k=((m==null?void 0:m.children.indexOf(h))||0)+1);const b=[];if((h==null?void 0:h.flavour)!=="affine:page"){const v=f.endPos||((i=h==null?void 0:h.text)==null?void 0:i.length)||0,d=n[0].text,p=d.reduce((x,O)=>x+(O.insert||"").length,0);(o=h==null?void 0:h.text)==null||o.insertList(d,v),h&&this._addBlocks(n[0].children,h,0,b),m&&this._addBlocks(n.slice(1),m,k,b);let w=h==null?void 0:h.id,E=v+p;if(b.length>0){const x=(s=h==null?void 0:h.text)==null?void 0:s.sliceToDelta(v+p);w=b[b.length-1];const O=this._editor.space.getBlockById(w);(a=h==null?void 0:h.text)==null||a.delete(v+p,(c=h==null?void 0:h.text)==null?void 0:c.length),E=((y=O==null?void 0:O.text)==null?void 0:y.length)||0,(u=O==null?void 0:O.text)==null||u.insertList(x,(g=O==null?void 0:O.text)==null?void 0:g.length)}setTimeout(()=>{var x;w&&((x=this._editor.space.richTextAdapters.get(w))==null||x.quill.setSelection(E,0))})}else m&&this._addBlocks(n,m,k,b)}else if(e.type==="Block"){const f=this._editor.space.getBlockById(e.selectedBlocks[e.selectedBlocks.length-1].id);let h=f,m=0;if(f)if(f.flavour==="affine:page")if(((l=f.children[0])==null?void 0:l.flavour)==="affine:group")h=f.children[0];else{const b=this._editor.space.addBlock({flavour:"affine:group"},f.id);h=this._editor.space.getBlockById(b)}else f.flavour!=="affine:group"&&(h=this._editor.space.getParent(f),m=((h==null?void 0:h.children.indexOf(f))||0)+1);const k=[];h&&this._addBlocks(n,h,m,k)}}_addBlocks(n,t,e,r){var i;for(let o=0;o<n.length;o++){const s=n[o],c={flavour:s.flavour,type:s.type,checked:s.checked},a=this._editor.space.addBlock(c,t,e+o),y=this._editor.space.getBlockById(a);s.text&&((i=y==null?void 0:y.text)==null||i.applyDelta(s.text)),r.push(a),y&&this._addBlocks(s.children,y,0,r)}}};let Sh=mi;Sh._optimalMimeTypes=[bn.BLOCKS_CLIP_WRAPPED,bn.HTML,bn.TEXT];function Ch(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let li=Ch();function J0(n){li=n}const Q0=/[&<>"']/,t1=/[&<>"']/g,e1=/[<>"']|&(?!#?\w+;)/,n1=/[<>"']|&(?!#?\w+;)/g,r1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pc=n=>r1[n];function ve(n,t){if(t){if(Q0.test(n))return n.replace(t1,Pc)}else if(e1.test(n))return n.replace(n1,Pc);return n}const i1=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Ah(n){return n.replace(i1,(t,e)=>(e=e.toLowerCase(),e==="colon"?":":e.charAt(0)==="#"?e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""))}const o1=/(^|[^\[])\^/g;function Gt(n,t){n=typeof n=="string"?n:n.source,t=t||"";const e={replace:(r,i)=>(i=i.source||i,i=i.replace(o1,"$1"),n=n.replace(r,i),e),getRegex:()=>new RegExp(n,t)};return e}const s1=/[^\w:]/g,a1=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Dc(n,t,e){if(n){let r;try{r=decodeURIComponent(Ah(e)).replace(s1,"").toLowerCase()}catch{return null}if(r.indexOf("javascript:")===0||r.indexOf("vbscript:")===0||r.indexOf("data:")===0)return null}t&&!a1.test(e)&&(e=f1(t,e));try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const xo={},l1=/^[^:]+:\/*[^/]*$/,c1=/^([^:]+:)[\s\S]*$/,u1=/^([^:]+:\/*[^/]*)[\s\S]*$/;function f1(n,t){xo[" "+n]||(l1.test(n)?xo[" "+n]=n+"/":xo[" "+n]=Io(n,"/",!0)),n=xo[" "+n];const e=n.indexOf(":")===-1;return t.substring(0,2)==="//"?e?t:n.replace(c1,"$1")+t:t.charAt(0)==="/"?e?t:n.replace(u1,"$1")+t:n+t}const rs={exec:function(){}};function sn(n){let t=1,e,r;for(;t<arguments.length;t++){e=arguments[t];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n}function Ic(n,t){const e=n.replace(/\|/g,(o,s,c)=>{let a=!1,y=s;for(;--y>=0&&c[y]==="\\";)a=!a;return a?"|":" |"}),r=e.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function Io(n,t,e){const r=n.length;if(r===0)return"";let i=0;for(;i<r;){const o=n.charAt(r-i-1);if(o===t&&!e)i++;else if(o!==t&&e)i++;else break}return n.slice(0,r-i)}function h1(n,t){if(n.indexOf(t[1])===-1)return-1;const e=n.length;let r=0,i=0;for(;i<e;i++)if(n[i]==="\\")i++;else if(n[i]===t[0])r++;else if(n[i]===t[1]&&(r--,r<0))return i;return-1}function Oh(n){n&&n.sanitize&&!n.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function Mc(n,t){if(t<1)return"";let e="";for(;t>1;)t&1&&(e+=n),t>>=1,n+=n;return e+n}function Bc(n,t,e,r){const i=t.href,o=t.title?ve(t.title):null,s=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const c={type:"link",raw:e,href:i,title:o,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,c}return{type:"image",raw:e,href:i,title:o,text:ve(s)}}function d1(n,t){const e=n.match(/^(\s+)(?:```)/);if(e===null)return t;const r=e[1];return t.split(`
`).map(i=>{const o=i.match(/^\s+/);if(o===null)return i;const[s]=o;return s.length>=r.length?i.slice(r.length):i}).join(`
`)}class xl{constructor(t){this.options=t||li}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const r=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Io(r,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const r=e[0],i=d1(r,e[3]||"");return{type:"code",raw:r,lang:e[2]?e[2].trim():e[2],text:i}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(/#$/.test(r)){const i=Io(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const r=e[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:e[0],tokens:this.lexer.blockTokens(r,[]),text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let r,i,o,s,c,a,y,g,u,l,f,h,m=e[1].trim();const k=m.length>1,b={type:"list",raw:"",ordered:k,start:k?+m.slice(0,-1):"",loose:!1,items:[]};m=k?`\\d{1,9}\\${m.slice(-1)}`:`\\${m}`,this.options.pedantic&&(m=k?m:"[*+-]");const v=new RegExp(`^( {0,3}${m})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;t&&(h=!1,!(!(e=v.exec(t))||this.rules.block.hr.test(t)));){if(r=e[0],t=t.substring(r.length),g=e[2].split(`
`,1)[0],u=t.split(`
`,1)[0],this.options.pedantic?(s=2,f=g.trimLeft()):(s=e[2].search(/[^ ]/),s=s>4?1:s,f=g.slice(s),s+=e[1].length),a=!1,!g&&/^ *$/.test(u)&&(r+=u+`
`,t=t.substring(u.length+1),h=!0),!h){const p=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))`),w=new RegExp(`^ {0,${Math.min(3,s-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),E=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:\`\`\`|~~~)`),x=new RegExp(`^ {0,${Math.min(3,s-1)}}#`);for(;t&&(l=t.split(`
`,1)[0],g=l,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(E.test(g)||x.test(g)||p.test(g)||w.test(t)));){if(g.search(/[^ ]/)>=s||!g.trim())f+=`
`+g.slice(s);else if(!a)f+=`
`+g;else break;!a&&!g.trim()&&(a=!0),r+=l+`
`,t=t.substring(l.length+1)}}b.loose||(y?b.loose=!0:/\n *\n *$/.test(r)&&(y=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(f),i&&(o=i[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,""))),b.items.push({type:"list_item",raw:r,task:!!i,checked:o,loose:!1,text:f}),b.raw+=r}b.items[b.items.length-1].raw=r.trimRight(),b.items[b.items.length-1].text=f.trimRight(),b.raw=b.raw.trimRight();const d=b.items.length;for(c=0;c<d;c++){this.lexer.state.top=!1,b.items[c].tokens=this.lexer.blockTokens(b.items[c].text,[]);const p=b.items[c].tokens.filter(E=>E.type==="space"),w=p.every(E=>{const x=E.raw.split("");let O=0;for(const L of x)if(L===`
`&&(O+=1),O>1)return!0;return!1});!b.loose&&p.length&&w&&(b.loose=!0,b.items[c].loose=!0)}return b}}html(t){const e=this.rules.block.html.exec(t);if(e){const r={type:"html",raw:e[0],pre:!this.options.sanitizer&&(e[1]==="pre"||e[1]==="script"||e[1]==="style"),text:e[0]};if(this.options.sanitize){const i=this.options.sanitizer?this.options.sanitizer(e[0]):ve(e[0]);r.type="paragraph",r.text=i,r.tokens=this.lexer.inline(i)}return r}}def(t){const e=this.rules.block.def.exec(t);if(e){e[3]&&(e[3]=e[3].substring(1,e[3].length-1));const r=e[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:r,raw:e[0],href:e[2],title:e[3]}}}table(t){const e=this.rules.block.table.exec(t);if(e){const r={type:"table",header:Ic(e[1]).map(i=>({text:i})),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){r.raw=e[0];let i=r.align.length,o,s,c,a;for(o=0;o<i;o++)/^ *-+: *$/.test(r.align[o])?r.align[o]="right":/^ *:-+: *$/.test(r.align[o])?r.align[o]="center":/^ *:-+ *$/.test(r.align[o])?r.align[o]="left":r.align[o]=null;for(i=r.rows.length,o=0;o<i;o++)r.rows[o]=Ic(r.rows[o],r.header.length).map(y=>({text:y}));for(i=r.header.length,s=0;s<i;s++)r.header[s].tokens=this.lexer.inline(r.header[s].text);for(i=r.rows.length,s=0;s<i;s++)for(a=r.rows[s],c=0;c<a.length;c++)a[c].tokens=this.lexer.inline(a[c].text);return r}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:ve(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):ve(e[0]):e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const r=e[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const s=Io(r.slice(0,-1),"\\");if((r.length-s.length)%2===0)return}else{const s=h1(e[2],"()");if(s>-1){const a=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let i=e[2],o="";if(this.options.pedantic){const s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);s&&(i=s[1],o=s[3])}else o=e[3]?e[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),Bc(e,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let i=(r[2]||r[1]).replace(/\s+/g," ");if(i=e[i.toLowerCase()],!i||!i.href){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Bc(r,i,r[0],this.lexer)}}emStrong(t,e,r=""){let i=this.rules.inline.emStrong.lDelim.exec(t);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;const o=i[1]||i[2]||"";if(!o||o&&(r===""||this.rules.inline.punctuation.exec(r))){const s=i[0].length-1;let c,a,y=s,g=0;const u=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(u.lastIndex=0,e=e.slice(-1*t.length+s);(i=u.exec(e))!=null;){if(c=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!c)continue;if(a=c.length,i[3]||i[4]){y+=a;continue}else if((i[5]||i[6])&&s%3&&!((s+a)%3)){g+=a;continue}if(y-=a,y>0)continue;if(a=Math.min(a,a+y+g),Math.min(s,a)%2){const f=t.slice(1,s+i.index+a);return{type:"em",raw:t.slice(0,s+i.index+a+1),text:f,tokens:this.lexer.inlineTokens(f)}}const l=t.slice(2,s+i.index+a-1);return{type:"strong",raw:t.slice(0,s+i.index+a+1),text:l,tokens:this.lexer.inlineTokens(l)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(/\n/g," ");const i=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return i&&o&&(r=r.substring(1,r.length-1)),r=ve(r,!0),{type:"codespan",raw:e[0],text:r}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t,e){const r=this.rules.inline.autolink.exec(t);if(r){let i,o;return r[2]==="@"?(i=ve(this.options.mangle?e(r[1]):r[1]),o="mailto:"+i):(i=ve(r[1]),o=i),{type:"link",raw:r[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}url(t,e){let r;if(r=this.rules.inline.url.exec(t)){let i,o;if(r[2]==="@")i=ve(this.options.mangle?e(r[0]):r[0]),o="mailto:"+i;else{let s;do s=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0];while(s!==r[0]);i=ve(r[0]),r[1]==="www."?o="http://"+i:o=i}return{type:"link",raw:r[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t,e){const r=this.rules.inline.text.exec(t);if(r){let i;return this.lexer.state.inRawBlock?i=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):ve(r[0]):r[0]:i=ve(this.options.smartypants?e(r[0]):r[0]),{type:"text",raw:r[0],text:i}}}}const Ct={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:rs,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ct._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Ct._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Ct.def=Gt(Ct.def).replace("label",Ct._label).replace("title",Ct._title).getRegex();Ct.bullet=/(?:[*+-]|\d{1,9}[.)])/;Ct.listItemStart=Gt(/^( *)(bull) */).replace("bull",Ct.bullet).getRegex();Ct.list=Gt(Ct.list).replace(/bull/g,Ct.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ct.def.source+")").getRegex();Ct._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Ct._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Ct.html=Gt(Ct.html,"i").replace("comment",Ct._comment).replace("tag",Ct._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Ct.paragraph=Gt(Ct._paragraph).replace("hr",Ct.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ct._tag).getRegex();Ct.blockquote=Gt(Ct.blockquote).replace("paragraph",Ct.paragraph).getRegex();Ct.normal=sn({},Ct);Ct.gfm=sn({},Ct.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});Ct.gfm.table=Gt(Ct.gfm.table).replace("hr",Ct.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ct._tag).getRegex();Ct.gfm.paragraph=Gt(Ct._paragraph).replace("hr",Ct.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ct.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ct._tag).getRegex();Ct.pedantic=sn({},Ct.normal,{html:Gt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ct._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:rs,paragraph:Gt(Ct.normal._paragraph).replace("hr",Ct.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ct.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const wt={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:rs,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:rs,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};wt._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";wt.punctuation=Gt(wt.punctuation).replace(/punctuation/g,wt._punctuation).getRegex();wt.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;wt.escapedEmSt=/\\\*|\\_/g;wt._comment=Gt(Ct._comment).replace("(?:-->|$)","-->").getRegex();wt.emStrong.lDelim=Gt(wt.emStrong.lDelim).replace(/punct/g,wt._punctuation).getRegex();wt.emStrong.rDelimAst=Gt(wt.emStrong.rDelimAst,"g").replace(/punct/g,wt._punctuation).getRegex();wt.emStrong.rDelimUnd=Gt(wt.emStrong.rDelimUnd,"g").replace(/punct/g,wt._punctuation).getRegex();wt._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;wt._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;wt._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;wt.autolink=Gt(wt.autolink).replace("scheme",wt._scheme).replace("email",wt._email).getRegex();wt._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;wt.tag=Gt(wt.tag).replace("comment",wt._comment).replace("attribute",wt._attribute).getRegex();wt._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;wt._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;wt._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;wt.link=Gt(wt.link).replace("label",wt._label).replace("href",wt._href).replace("title",wt._title).getRegex();wt.reflink=Gt(wt.reflink).replace("label",wt._label).replace("ref",Ct._label).getRegex();wt.nolink=Gt(wt.nolink).replace("ref",Ct._label).getRegex();wt.reflinkSearch=Gt(wt.reflinkSearch,"g").replace("reflink",wt.reflink).replace("nolink",wt.nolink).getRegex();wt.normal=sn({},wt);wt.pedantic=sn({},wt.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Gt(/^!?\[(label)\]\((.*?)\)/).replace("label",wt._label).getRegex(),reflink:Gt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",wt._label).getRegex()});wt.gfm=sn({},wt.normal,{escape:Gt(wt.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});wt.gfm.url=Gt(wt.gfm.url,"i").replace("email",wt.gfm._extended_email).getRegex();wt.breaks=sn({},wt.gfm,{br:Gt(wt.br).replace("{2,}","*").getRegex(),text:Gt(wt.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function p1(n){return n.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function $c(n){let t="",e,r;const i=n.length;for(e=0;e<i;e++)r=n.charCodeAt(e),Math.random()>.5&&(r="x"+r.toString(16)),t+="&#"+r+";";return t}class Vn{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||li,this.options.tokenizer=this.options.tokenizer||new xl,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:Ct.normal,inline:wt.normal};this.options.pedantic?(e.block=Ct.pedantic,e.inline=wt.pedantic):this.options.gfm&&(e.block=Ct.gfm,this.options.breaks?e.inline=wt.breaks:e.inline=wt.gfm),this.tokenizer.rules=e}static get rules(){return{block:Ct,inline:wt}}static lex(t,e){return new Vn(e).lex(t)}static lexInline(t,e){return new Vn(e).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let e;for(;e=this.inlineQueue.shift();)this.inlineTokens(e.src,e.tokens);return this.tokens}blockTokens(t,e=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(c,a,y)=>a+"    ".repeat(y.length));let r,i,o,s;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(c=>(r=c.call({lexer:this},t,e))?(t=t.substring(r.raw.length),e.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&e.length>0?e[e.length-1].raw+=`
`:e.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),e.push(r);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let c=1/0;const a=t.slice(1);let y;this.options.extensions.startBlock.forEach(function(g){y=g.call({lexer:this},a),typeof y=="number"&&y>=0&&(c=Math.min(c,y))}),c<1/0&&c>=0&&(o=t.substring(0,c+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){i=e[e.length-1],s&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(r),s=o.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(r);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){let r,i,o,s=t,c,a,y;if(this.tokens.links){const g=Object.keys(this.tokens.links);if(g.length>0)for(;(c=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)g.includes(c[0].slice(c[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,c.index)+"["+Mc("a",c[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(c=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,c.index)+"["+Mc("a",c[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(c=this.tokenizer.rules.inline.escapedEmSt.exec(s))!=null;)s=s.slice(0,c.index)+"++"+s.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(a||(y=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(g=>(r=g.call({lexer:this},t,e))?(t=t.substring(r.raw.length),e.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):e.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),i=e[e.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):e.push(r);continue}if(r=this.tokenizer.emStrong(t,s,y)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.autolink(t,$c)){t=t.substring(r.raw.length),e.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t,$c))){t=t.substring(r.raw.length),e.push(r);continue}if(o=t,this.options.extensions&&this.options.extensions.startInline){let g=1/0;const u=t.slice(1);let l;this.options.extensions.startInline.forEach(function(f){l=f.call({lexer:this},u),typeof l=="number"&&l>=0&&(g=Math.min(g,l))}),g<1/0&&g>=0&&(o=t.substring(0,g+1))}if(r=this.tokenizer.inlineText(o,p1)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(y=r.raw.slice(-1)),a=!0,i=e[e.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):e.push(r);continue}if(t){const g="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return e}}class El{constructor(t){this.options=t||li}code(t,e,r){const i=(e||"").match(/\S*/)[0];if(this.options.highlight){const o=this.options.highlight(t,i);o!=null&&o!==t&&(r=!0,t=o)}return t=t.replace(/\n$/,"")+`
`,i?'<pre><code class="'+this.options.langPrefix+ve(i,!0)+'">'+(r?t:ve(t,!0))+`</code></pre>
`:"<pre><code>"+(r?t:ve(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t){return t}heading(t,e,r,i){if(this.options.headerIds){const o=this.options.headerPrefix+i.slug(r);return`<h${e} id="${o}">${t}</h${e}>
`}return`<h${e}>${t}</h${e}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,e,r){const i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+t+"</"+i+`>
`}listitem(t){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>
`}table(t,e){return e&&(e=`<tbody>${e}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+e+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,e){const r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,e,r){if(t=Dc(this.options.sanitize,this.options.baseUrl,t),t===null)return r;let i='<a href="'+ve(t)+'"';return e&&(i+=' title="'+e+'"'),i+=">"+r+"</a>",i}image(t,e,r){if(t=Dc(this.options.sanitize,this.options.baseUrl,t),t===null)return r;let i=`<img src="${t}" alt="${r}"`;return e&&(i+=` title="${e}"`),i+=this.options.xhtml?"/>":">",i}text(t){return t}}class Th{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,r){return""+r}image(t,e,r){return""+r}br(){return""}}class Rh{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let r=t,i=0;if(this.seen.hasOwnProperty(r)){i=this.seen[t];do i++,r=t+"-"+i;while(this.seen.hasOwnProperty(r))}return e||(this.seen[t]=i,this.seen[r]=0),r}slug(t,e={}){const r=this.serialize(t);return this.getNextSafeSlug(r,e.dryrun)}}class _n{constructor(t){this.options=t||li,this.options.renderer=this.options.renderer||new El,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Th,this.slugger=new Rh}static parse(t,e){return new _n(e).parse(t)}static parseInline(t,e){return new _n(e).parseInline(t)}parse(t,e=!0){let r="",i,o,s,c,a,y,g,u,l,f,h,m,k,b,v,d,p,w,E;const x=t.length;for(i=0;i<x;i++){if(f=t[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[f.type]&&(E=this.options.extensions.renderers[f.type].call({parser:this},f),E!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type))){r+=E||"";continue}switch(f.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{r+=this.renderer.heading(this.parseInline(f.tokens),f.depth,Ah(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue}case"code":{r+=this.renderer.code(f.text,f.lang,f.escaped);continue}case"table":{for(u="",g="",c=f.header.length,o=0;o<c;o++)g+=this.renderer.tablecell(this.parseInline(f.header[o].tokens),{header:!0,align:f.align[o]});for(u+=this.renderer.tablerow(g),l="",c=f.rows.length,o=0;o<c;o++){for(y=f.rows[o],g="",a=y.length,s=0;s<a;s++)g+=this.renderer.tablecell(this.parseInline(y[s].tokens),{header:!1,align:f.align[s]});l+=this.renderer.tablerow(g)}r+=this.renderer.table(u,l);continue}case"blockquote":{l=this.parse(f.tokens),r+=this.renderer.blockquote(l);continue}case"list":{for(h=f.ordered,m=f.start,k=f.loose,c=f.items.length,l="",o=0;o<c;o++)v=f.items[o],d=v.checked,p=v.task,b="",v.task&&(w=this.renderer.checkbox(d),k?v.tokens.length>0&&v.tokens[0].type==="paragraph"?(v.tokens[0].text=w+" "+v.tokens[0].text,v.tokens[0].tokens&&v.tokens[0].tokens.length>0&&v.tokens[0].tokens[0].type==="text"&&(v.tokens[0].tokens[0].text=w+" "+v.tokens[0].tokens[0].text)):v.tokens.unshift({type:"text",text:w}):b+=w),b+=this.parse(v.tokens,k),l+=this.renderer.listitem(b,p,d);r+=this.renderer.list(l,h,m);continue}case"html":{r+=this.renderer.html(f.text);continue}case"paragraph":{r+=this.renderer.paragraph(this.parseInline(f.tokens));continue}case"text":{for(l=f.tokens?this.parseInline(f.tokens):f.text;i+1<x&&t[i+1].type==="text";)f=t[++i],l+=`
`+(f.tokens?this.parseInline(f.tokens):f.text);r+=e?this.renderer.paragraph(l):l;continue}default:{const O='Token with "'+f.type+'" type was not found.';if(this.options.silent){console.error(O);return}else throw new Error(O)}}}return r}parseInline(t,e){e=e||this.renderer;let r="",i,o,s;const c=t.length;for(i=0;i<c;i++){if(o=t[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]&&(s=this.options.extensions.renderers[o.type].call({parser:this},o),s!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type))){r+=s||"";continue}switch(o.type){case"escape":{r+=e.text(o.text);break}case"html":{r+=e.html(o.text);break}case"link":{r+=e.link(o.href,o.title,this.parseInline(o.tokens,e));break}case"image":{r+=e.image(o.href,o.title,o.text);break}case"strong":{r+=e.strong(this.parseInline(o.tokens,e));break}case"em":{r+=e.em(this.parseInline(o.tokens,e));break}case"codespan":{r+=e.codespan(o.text);break}case"br":{r+=e.br();break}case"del":{r+=e.del(this.parseInline(o.tokens,e));break}case"text":{r+=e.text(o.text);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(a);return}else throw new Error(a)}}}return r}}function At(n,t,e){if(typeof n>"u"||n===null)throw new Error("marked(): input parameter is undefined or null");if(typeof n!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected");if(typeof t=="function"&&(e=t,t=null),t=sn({},At.defaults,t||{}),Oh(t),e){const i=t.highlight;let o;try{o=Vn.lex(n,t)}catch(a){return e(a)}const s=function(a){let y;if(!a)try{t.walkTokens&&At.walkTokens(o,t.walkTokens),y=_n.parse(o,t)}catch(g){a=g}return t.highlight=i,a?e(a):e(null,y)};if(!i||i.length<3||(delete t.highlight,!o.length))return s();let c=0;At.walkTokens(o,function(a){a.type==="code"&&(c++,setTimeout(()=>{i(a.text,a.lang,function(y,g){if(y)return s(y);g!=null&&g!==a.text&&(a.text=g,a.escaped=!0),c--,c===0&&s()})},0))}),c===0&&s();return}function r(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+ve(i.message+"",!0)+"</pre>";throw i}try{const i=Vn.lex(n,t);if(t.walkTokens){if(t.async)return Promise.all(At.walkTokens(i,t.walkTokens)).then(()=>_n.parse(i,t)).catch(r);At.walkTokens(i,t.walkTokens)}return _n.parse(i,t)}catch(i){r(i)}}At.options=At.setOptions=function(n){return sn(At.defaults,n),J0(At.defaults),At};At.getDefaults=Ch;At.defaults=li;At.use=function(...n){const t=sn({},...n),e=At.defaults.extensions||{renderers:{},childTokens:{}};let r;n.forEach(i=>{if(i.extensions&&(r=!0,i.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if(o.renderer){const s=e.renderers?e.renderers[o.name]:null;s?e.renderers[o.name]=function(...c){let a=o.renderer.apply(this,c);return a===!1&&(a=s.apply(this,c)),a}:e.renderers[o.name]=o.renderer}if(o.tokenizer){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[o.level]?e[o.level].unshift(o.tokenizer):e[o.level]=[o.tokenizer],o.start&&(o.level==="block"?e.startBlock?e.startBlock.push(o.start):e.startBlock=[o.start]:o.level==="inline"&&(e.startInline?e.startInline.push(o.start):e.startInline=[o.start]))}o.childTokens&&(e.childTokens[o.name]=o.childTokens)})),i.renderer){const o=At.defaults.renderer||new El;for(const s in i.renderer){const c=o[s];o[s]=(...a)=>{let y=i.renderer[s].apply(o,a);return y===!1&&(y=c.apply(o,a)),y}}t.renderer=o}if(i.tokenizer){const o=At.defaults.tokenizer||new xl;for(const s in i.tokenizer){const c=o[s];o[s]=(...a)=>{let y=i.tokenizer[s].apply(o,a);return y===!1&&(y=c.apply(o,a)),y}}t.tokenizer=o}if(i.walkTokens){const o=At.defaults.walkTokens;t.walkTokens=function(s){let c=[];return c.push(i.walkTokens.call(this,s)),o&&(c=c.concat(o.call(this,s))),c}}r&&(t.extensions=e),At.setOptions(t)})};At.walkTokens=function(n,t){let e=[];for(const r of n)switch(e=e.concat(t.call(At,r)),r.type){case"table":{for(const i of r.header)e=e.concat(At.walkTokens(i.tokens,t));for(const i of r.rows)for(const o of i)e=e.concat(At.walkTokens(o.tokens,t));break}case"list":{e=e.concat(At.walkTokens(r.items,t));break}default:At.defaults.extensions&&At.defaults.extensions.childTokens&&At.defaults.extensions.childTokens[r.type]?At.defaults.extensions.childTokens[r.type].forEach(function(i){e=e.concat(At.walkTokens(r[i],t))}):r.tokens&&(e=e.concat(At.walkTokens(r.tokens,t)))}return e};At.parseInline=function(n,t){if(typeof n>"u"||n===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof n!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected");t=sn({},At.defaults,t||{}),Oh(t);try{const e=Vn.lexInline(n,t);return t.walkTokens&&At.walkTokens(e,t.walkTokens),_n.parseInline(e,t)}catch(e){if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+ve(e.message+"",!0)+"</pre>";throw e}};At.Parser=_n;At.parser=_n.parse;At.Renderer=El;At.TextRenderer=Th;At.Lexer=Vn;At.lexer=Vn.lex;At.Tokenizer=xl;At.Slugger=Rh;At.parse=At;At.options;At.setOptions;At.use;At.walkTokens;At.parseInline;_n.parse;Vn.lex;function g1(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])}return n}function Ca(n,t){return Array(t+1).join(n)}function y1(n){return n.replace(/^\n*/,"")}function v1(n){for(var t=n.length;t>0&&n[t-1]===`
`;)t--;return n.substring(0,t)}var m1=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function Sl(n){return Cl(n,m1)}var Lh=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function Nh(n){return Cl(n,Lh)}function b1(n){return Dh(n,Lh)}var Ph=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function _1(n){return Cl(n,Ph)}function w1(n){return Dh(n,Ph)}function Cl(n,t){return t.indexOf(n.nodeName)>=0}function Dh(n,t){return n.getElementsByTagName&&t.some(function(e){return n.getElementsByTagName(e).length})}var Se={};Se.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};Se.lineBreak={filter:"br",replacement:function(n,t,e){return e.br+`
`}};Se.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,t,e){var r=Number(t.nodeName.charAt(1));if(e.headingStyle==="setext"&&r<3){var i=Ca(r===1?"=":"-",n.length);return`

`+n+`
`+i+`

`}else return`

`+Ca("#",r)+" "+n+`

`}};Se.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};Se.list={filter:["ul","ol"],replacement:function(n,t){var e=t.parentNode;return e.nodeName==="LI"&&e.lastElementChild===t?`
`+n:`

`+n+`

`}};Se.listItem={filter:"li",replacement:function(n,t,e){n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=e.bulletListMarker+"   ",i=t.parentNode;if(i.nodeName==="OL"){var o=i.getAttribute("start"),s=Array.prototype.indexOf.call(i.children,t);r=(o?Number(o)+s:s+1)+".  "}return r+n+(t.nextSibling&&!/\n$/.test(n)?`
`:"")}};Se.indentedCodeBlock={filter:function(n,t){return t.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,t,e){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Se.fencedCodeBlock={filter:function(n,t){return t.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,t,e){for(var r=t.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],o=t.firstChild.textContent,s=e.fence.charAt(0),c=3,a=new RegExp("^"+s+"{3,}","gm"),y;y=a.exec(o);)y[0].length>=c&&(c=y[0].length+1);var g=Ca(s,c);return`

`+g+i+`
`+o.replace(/\n$/,"")+`
`+g+`

`}};Se.horizontalRule={filter:"hr",replacement:function(n,t,e){return`

`+e.hr+`

`}};Se.inlineLink={filter:function(n,t){return t.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,t){var e=t.getAttribute("href"),r=is(t.getAttribute("title"));return r&&(r=' "'+r+'"'),"["+n+"]("+e+r+")"}};Se.referenceLink={filter:function(n,t){return t.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,t,e){var r=t.getAttribute("href"),i=is(t.getAttribute("title"));i&&(i=' "'+i+'"');var o,s;switch(e.linkReferenceStyle){case"collapsed":o="["+n+"][]",s="["+n+"]: "+r+i;break;case"shortcut":o="["+n+"]",s="["+n+"]: "+r+i;break;default:var c=this.references.length+1;o="["+n+"]["+c+"]",s="["+c+"]: "+r+i}return this.references.push(s),o},references:[],append:function(n){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};Se.emphasis={filter:["em","i"],replacement:function(n,t,e){return n.trim()?e.emDelimiter+n+e.emDelimiter:""}};Se.strong={filter:["strong","b"],replacement:function(n,t,e){return n.trim()?e.strongDelimiter+n+e.strongDelimiter:""}};Se.code={filter:function(n){var t=n.previousSibling||n.nextSibling,e=n.parentNode.nodeName==="PRE"&&!t;return n.nodeName==="CODE"&&!e},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",e="`",r=n.match(/`+/gm)||[];r.indexOf(e)!==-1;)e=e+"`";return e+t+n+t+e}};Se.image={filter:"img",replacement:function(n,t){var e=is(t.getAttribute("alt")),r=t.getAttribute("src")||"",i=is(t.getAttribute("title")),o=i?' "'+i+'"':"";return r?"!["+e+"]("+r+o+")":""}};function is(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function Ih(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var t in n.rules)this.array.push(n.rules[t])}Ih.prototype={add:function(n,t){this.array.unshift(t)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var t;return(t=ia(this.array,n,this.options))||(t=ia(this._keep,n,this.options))||(t=ia(this._remove,n,this.options))?t:this.defaultRule},forEach:function(n){for(var t=0;t<this.array.length;t++)n(this.array[t],t)}};function ia(n,t,e){for(var r=0;r<n.length;r++){var i=n[r];if(k1(i,t,e))return i}}function k1(n,t,e){var r=n.filter;if(typeof r=="string"){if(r===t.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(n,t,e))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function x1(n){var t=n.element,e=n.isBlock,r=n.isVoid,i=n.isPre||function(u){return u.nodeName==="PRE"};if(!(!t.firstChild||i(t))){for(var o=null,s=!1,c=null,a=jc(c,t,i);a!==t;){if(a.nodeType===3||a.nodeType===4){var y=a.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!s&&y[0]===" "&&(y=y.substr(1)),!y){a=oa(a);continue}a.data=y,o=a}else if(a.nodeType===1)e(a)||a.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,s=!1):r(a)||i(a)?(o=null,s=!0):o&&(s=!1);else{a=oa(a);continue}var g=jc(c,a,i);c=a,a=g}o&&(o.data=o.data.replace(/ $/,""),o.data||oa(o))}}function oa(n){var t=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),t}function jc(n,t,e){return n&&n.parentNode===t||e(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var Mh=typeof window<"u"?window:{};function E1(){var n=Mh.DOMParser,t=!1;try{new n().parseFromString("","text/html")&&(t=!0)}catch{}return t}function S1(){var n=function(){};return C1()?n.prototype.parseFromString=function(t){var e=new window.ActiveXObject("htmlfile");return e.designMode="on",e.open(),e.write(t),e.close(),e}:n.prototype.parseFromString=function(t){var e=document.implementation.createHTMLDocument("");return e.open(),e.write(t),e.close(),e},n}function C1(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{window.ActiveXObject&&(n=!0)}return n}var A1=E1()?Mh.DOMParser:S1();function O1(n,t){var e;if(typeof n=="string"){var r=T1().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");e=r.getElementById("turndown-root")}else e=n.cloneNode(!0);return x1({element:e,isBlock:Sl,isVoid:Nh,isPre:t.preformattedCode?R1:null}),e}var sa;function T1(){return sa=sa||new A1,sa}function R1(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function L1(n,t){return n.isBlock=Sl(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=N1(n),n.flankingWhitespace=P1(n,t),n}function N1(n){return!Nh(n)&&!_1(n)&&/^\s*$/i.test(n.textContent)&&!b1(n)&&!w1(n)}function P1(n,t){if(n.isBlock||t.preformattedCode&&n.isCode)return{leading:"",trailing:""};var e=D1(n.textContent);return e.leadingAscii&&qc("left",n,t)&&(e.leading=e.leadingNonAscii),e.trailingAscii&&qc("right",n,t)&&(e.trailing=e.trailingNonAscii),{leading:e.leading,trailing:e.trailing}}function D1(n){var t=n.match(/^(([ \t\r\n]*)(\s*))[\s\S]*?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function qc(n,t,e){var r,i,o;return n==="left"?(r=t.previousSibling,i=/ $/):(r=t.nextSibling,i=/^ /),r&&(r.nodeType===3?o=i.test(r.nodeValue):e.preformattedCode&&r.nodeName==="CODE"?o=!1:r.nodeType===1&&!Sl(r)&&(o=i.test(r.textContent))),o}var I1=Array.prototype.reduce,M1=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function os(n){if(!(this instanceof os))return new os(n);var t={rules:Se,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,r){return r.isBlock?`

`:""},keepReplacement:function(e,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(e,r){return r.isBlock?`

`+e+`

`:e}};this.options=g1({},t,n),this.rules=new Ih(this.options)}os.prototype={turndown:function(n){if(!j1(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var t=Bh.call(this,new O1(n,this.options));return B1.call(this,t)},use:function(n){if(Array.isArray(n))for(var t=0;t<n.length;t++)this.use(n[t]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,t){return this.rules.add(n,t),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return M1.reduce(function(t,e){return t.replace(e[0],e[1])},n)}};function Bh(n){var t=this;return I1.call(n.childNodes,function(e,r){r=new L1(r,t.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:t.escape(r.nodeValue):r.nodeType===1&&(i=$1.call(t,r)),$h(e,i)},"")}function B1(n){var t=this;return this.rules.forEach(function(e){typeof e.append=="function"&&(n=$h(n,e.append(t.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function $1(n){var t=this.rules.forNode(n),e=Bh.call(this,n),r=n.flankingWhitespace;return(r.leading||r.trailing)&&(e=e.trim()),r.leading+t.replacement(e,n,this.options)+r.trailing}function $h(n,t){var e=v1(n),r=y1(t),i=Math.max(n.length-e.length,t.length-r.length),o=`

`.substring(0,i);return e+o+r}function j1(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}const Ir={injectHtmlCss:()=>`
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <style>
    :root {
      --affine-primary-color: #3a4c5c;
      --affine-font-family: Avenir Next, apple-system, BlinkMacSystemFont, Helvetica Neue, Tahoma, PingFang SC, Microsoft Yahei, Arial, Hiragino Sans GB, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
      --affine-font-family2: Roboto Mono, apple-system, BlinkMacSystemFont, Helvetica Neue, Tahoma, PingFang SC, Microsoft Yahei, Arial, Hiragino Sans GB, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
  }
    body {
      font-family: var(--affine-font-family);
      color: var(--affine-primary-color);
    }
    </style>
    `,exportFile:(n,t,e)=>{const r=document.createElement("a");r.setAttribute("href","data:"+e+";charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",n),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)},decorateHtml:(n,t)=>{const e=Ir.injectHtmlCss();return`<!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <title>${n}</title>
          ${e}
        </head>
        <body>
            <div style="margin:0 auto;width:720px" >
                 ${t}
            </div>
        </body>
        </html>`},exportHtml:(n,t)=>{Ir.exportFile((n||"Untitled")+".html",Ir.decorateHtml(n,t),"text/html")},exportMarkdown:(n,t)=>{const e=new os;e.addRule("input",{filter:["input"],replacement:function(i,o){return o.getAttribute("checked")===null?"[ ] ":"[x] "}});const r=e.turndown(t);Ir.exportFile((n||"Undefined")+".md",r,"text/plain")}},Uc=["DEL","STRONG","B","EM","I","U","S","SPAN","A","INPUT","MARK","CODE","LABEL","BIG","SMALL","ABBR","CITE"];class q1{constructor(t){this._contentParser=t}registerParsers(){this._contentParser.registerParserHtmlText2Block("nodeParser",this._nodePaser.bind(this)),this._contentParser.registerParserHtmlText2Block("commonParser",this._commonParser.bind(this)),this._contentParser.registerParserHtmlText2Block("listItemParser",this._listItemParser.bind(this)),this._contentParser.registerParserHtmlText2Block("blockQuoteParser",this._blockQuoteParser.bind(this))}_nodePaser(t){var i,o,s,c,a,y,g,u,l,f,h;let e;if(e=(i=this._contentParser.getParserHtmlText2Block("customNodeParser"))==null?void 0:i(t),e&&e.length>0)return e;const r=t.tagName;if(t instanceof Text||Uc.includes(r))e=(o=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:o({element:t,flavour:"affine:paragraph",type:"text"});else switch(r){case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":e=(s=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:s({element:t,flavour:"affine:paragraph",type:r.toLowerCase()});break;case"BLOCKQUOTE":e=(c=this._contentParser.getParserHtmlText2Block("blockQuoteParser"))==null?void 0:c(t);break;case"P":t.firstChild instanceof Text&&(((a=t.firstChild.textContent)==null?void 0:a.startsWith("[] "))||((y=t.firstChild.textContent)==null?void 0:y.startsWith("[ ] "))||((g=t.firstChild.textContent)==null?void 0:g.startsWith("[x] ")))?e=(u=this._contentParser.getParserHtmlText2Block("listItemParser"))==null?void 0:u(t):e=(l=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:l({element:t,flavour:"affine:paragraph",type:"text"});break;case"DIV":e=(f=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:f({element:t,flavour:"affine:paragraph",type:"text"});break;case"LI":e=(h=this._contentParser.getParserHtmlText2Block("listItemParser"))==null?void 0:h(t);break}return e&&e.length>0?e:Array.from(t.children).map(m=>{var b;const k=((b=this._contentParser.getParserHtmlText2Block("nodeParser"))==null?void 0:b(m))||[];return k&&k.length?k:[]}).flat().filter(m=>m)}_commonParser({element:t,flavour:e,type:r,checked:i,ignoreEmptyElement:o=!0}){const s=this._commonHTML2Block(t,e,r,i,o);return s?[s]:null}_commonHTML2Block(t,e,r,i,o=!0){const s=t.childNodes;let c=!1;const a=[],y=[];for(let g=0;g<s.length;g++){const u=s.item(g);if(!!u){if(!c){if(u instanceof Text){a.push(...this._commonHTML2Text(u,{},o));continue}const l=u;if(Uc.includes(l.tagName)){a.push(...this._commonHTML2Text(u,{},o));continue}}if(u instanceof Element){const l=this._nodePaser(u);l&&y.push(...l)}c=!0}}return{flavour:e,type:r,checked:i,text:a,children:y}}_commonHTML2Text(t,e={},r=!0){if(t instanceof Text)return(t.textContent||"").split(`
`).map(a=>({insert:a,attributes:e}));const i=t,o=Array.from(i.childNodes),s=F1(i);return o.length?o.reduce((a,y)=>{const g=this._commonHTML2Text(y,{...e,...s},r);return a.push(...g),a},[]).filter(a=>a):r?[]:[{insert:"",attributes:s}]}_listItemParser(t){var c,a,y,g,u,l,f,h;let r=((c=t.parentElement)==null?void 0:c.tagName)==="OL"?"numbered":"bulleted",i,o;return(((a=o=t.firstElementChild)==null?void 0:a.tagName)==="INPUT"||((g=o=(y=t.firstElementChild)==null?void 0:y.firstElementChild)==null?void 0:g.tagName)==="INPUT")&&(r="todo",i=(o==null?void 0:o.getAttribute("checked"))!==null),t.firstChild instanceof Text&&((u=t.firstChild.textContent)!=null&&u.startsWith("[] ")?(t.firstChild.textContent=t.firstChild.textContent.slice(3),r="todo",i=!1):(l=t.firstChild.textContent)!=null&&l.startsWith("[ ] ")?(t.firstChild.textContent=t.firstChild.textContent.slice(4),r="todo",i=!1):(f=t.firstChild.textContent)!=null&&f.startsWith("[x] ")&&(t.firstChild.textContent=t.firstChild.textContent.slice(4),r="todo",i=!0)),(h=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:h({element:t,flavour:"affine:list",type:r,checked:i})}_blockQuoteParser(t){var i;const e=o=>{const s=[];return o.forEach(c=>{const a=c.text.filter(g=>g.insert);s.length>0&&a.length>0&&s.push({insert:`
`}),s.push(...a);const y=e(c.children);s.length>0&&y.length>0&&s.push({insert:`
`}),s.push(...y)}),s},r=(i=this._contentParser.getParserHtmlText2Block("commonParser"))==null?void 0:i({element:t,flavour:"affine:paragraph",type:"text"});return r?[{flavour:"affine:paragraph",type:"quote",text:e(r),children:[]}]:null}}const U1=n=>["A"].includes(n.tagName),F1=n=>{const t=n.tagName,e={},r=(n.getAttribute("style")||"").split(";").reduce((i,o)=>{const[s,c]=o.split(":");return s&&c&&(i[s]=c),i},{});return(r["font-weight"]==="bold"||Number(r["font-weight"])>400||["STRONG","B","H1","H2","H3","H4","H5","H6"].includes(n.tagName))&&(e.bold=!0),U1(n)&&(e.link=n.getAttribute("href")||n.getAttribute("src")),(t==="EM"||r.fontStyle==="italic")&&(e.italic=!0),(t==="U"||r["text-decoration"]&&r["text-decoration"].indexOf("underline")!==-1||r["border-bottom"])&&(e.underline=!0),t==="CODE"&&(e.code=!0),(t==="S"||t==="DEL"||r["text-decoration"]&&r["text-decoration"].indexOf("line-through")!==-1)&&(e.strike=!0),t==="MARK"&&(e.background="yellow"),e};class H1{constructor(t){this.signals={beforeHtml2Block:new le},this._parsers={},this._editor=t,this._parseHtml=new q1(this),this._parseHtml.registerParsers()}onExportHtml(){const t=this._editor.space.root;if(!t)return;const e=this.block2Html(this._getSelectedBlock(t).children);Ir.exportHtml(t.title,e)}onExportMarkdown(){const t=this._editor.space.root;if(!t)return;const e=this.block2Html(this._getSelectedBlock(t).children);Ir.exportMarkdown(t.title,e)}block2Html(t){return t.reduce((r,i,o,s)=>r+this._getHtmlInfoBySelectionInfo(i,o>0?s[o-1]:null,o<s.length-1?s[o+1]:null),"")}block2Text(t){return t.reduce((r,i)=>r+this._getTextInfoBySelectionInfo(i),"")}htmlText2Block(t){var r;const e=document.createElement("html");return e.innerHTML=t,(r=e.querySelector("head"))==null||r.remove(),this.signals.beforeHtml2Block.emit(e),this._convertHtml2Blocks(e)}markdown2Block(t){const e={name:"underline",level:"inline",start(i){return i.indexOf("~")},tokenizer(i){const s=/^~([^~]+)~/.exec(i);if(s)return{type:"underline",raw:s[0],text:s[1].trim()}},renderer(i){return`<u>${i.text}</u>`}};At.use({extensions:[e]});const r=At.parse(t);return this.htmlText2Block(r)}registerParserHtmlText2Block(t,e){this._parsers[t]=e}getParserHtmlText2Block(t){return this._parsers[t]||null}text2blocks(t){return t.split(`
`).map(e=>({flavour:"affine:paragraph",type:"text",text:[{insert:e}],children:[]}))}_getSelectedBlock(t){return{id:t.id,children:t.children.map(r=>this._getSelectedBlock(r))}}_getHtmlInfoBySelectionInfo(t,e,r){const i=this._editor.space.getBlockById(t.id);if(!i)return"";const o=t.children.reduce((c,a,y,g)=>{const u=this._getHtmlInfoBySelectionInfo(a,y>0?g[y-1]:null,y<g.length-1?g[y+1]:null);return u&&c.push(u),c},[]);return i.block2html(o.join(""),(e==null?void 0:e.id)||"",(r==null?void 0:r.id)||"",t.startPos,t.endPos)}_getTextInfoBySelectionInfo(t){const e=this._editor.space.getBlockById(t.id);if(!e)return"";const r=[];return t.children.forEach(o=>{const s=this._getTextInfoBySelectionInfo(o);s&&r.push(s)}),e.block2Text(r.join(""),t.startPos,t.endPos)}_convertHtml2Blocks(t){return Array.from(t.children).map(e=>{var i;const r=((i=this.getParserHtmlText2Block("nodeParser"))==null?void 0:i(e))||[];return r&&r.length?r:[]}).flat().filter(e=>e)}}class z1{constructor(t,e){this._editor=t,this._clipboardTarget=e,this._copy=new X0(this._editor),this._paste=new Sh(this._editor),this._clipboardEventDispatcher=new Z0(this._clipboardTarget),this._clipboardEventDispatcher.signals.copy.on(this._copy.handleCopy),this._clipboardEventDispatcher.signals.cut.on(this._copy.handleCut),this._clipboardEventDispatcher.signals.paste.on(this._paste.handlePaste)}set clipboardTarget(t){this._clipboardEventDispatcher.disposeClipboardTargetEvent(this._clipboardTarget),this._clipboardTarget=t,this._clipboardEventDispatcher.initialClipboardTargetEvent(this._clipboardTarget)}get clipboardTarget(){return this._clipboardTarget}importMarkdown(t,e){const r=this._editor.contentParser.markdown2Block(t);this._paste.insertBlocks(r,{type:"Block",selectedBlocks:[{id:e,children:[]}]})}dispose(){this._clipboardEventDispatcher.dispose(this.clipboardTarget)}}const jh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},qh="__ $BLOCKSUITE_EDITOR$ __";jh[qh]===!0&&console.error("@blocksuite/editor was already imported. This breaks constructor checks and will lead to issues!");jh[qh]=!0;const V1=n=>{const t=document.createElement("editor-container");return t.space=n,t};const Al=new URLSearchParams(location.search);var Fc;const K1=(Fc=Al.get("room"))!=null?Fc:"",W1=Al.get("isTest")==="true";function G1(){var r;const n=[];((r=Al.get("syncModes"))!=null?r:"debug").split(",").forEach(i=>{switch(i){case"debug":n.push(xy);break;case"indexeddb":n.push(mc);break;default:throw new TypeError(`Unknown provider ("${i}") supplied in search param ?syncModes=... (for example "debug" and "indexeddb")`)}});const e=n.includes(mc)?sl:Tg();return{providers:n,idGenerator:e}}window.onload=()=>{const n=new $g({room:K1,...G1()});if(window.store=n,window.blockSchema=Sa,!W1){const t=n.createSpace("page0").register(window.blockSchema),e=V1(t);document.body.appendChild(e)}};
